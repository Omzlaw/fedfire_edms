var Dynamsoft=Dynamsoft||{WebTwainEnv:{}},DCP_DWT_OnClickCloseInstall,EnumDWT_Error;Dynamsoft.WebTwainEnv.AutoLoad=!0;Dynamsoft.WebTwainEnv.Containers=[{ContainerId:"dwtcontrolContainer",Width:270,Height:350}];Dynamsoft.WebTwainEnv.ProductKey="f0078xQAAAC9Ai95ZaTJwafPTnV4iN2NLB42dv5oSr4gK++LUUtoru7rnATrhQRcwSW2OUqzRlC0mwu3dtd3itDh3LJcFl4xiYGpoDAACZCbz";Dynamsoft.WebTwainEnv.IfAddMD5InUploadHeader=!1;Dynamsoft.WebTwainEnv.IfConfineMaskWithinTheViewer=!1;
/*!
* Dynamsoft JavaScript Library
* Product: Dynamsoft Web Twain
* Web Site: http://www.dynamsoft.com
*
* Copyright 2020, Dynamsoft Corporation 
* Author: Dynamsoft Support Team
* Version: 16.1.1
*/
Dynamsoft=window.Dynamsoft||{Lib:{}},function(n){var t=n.WebTwainEnv||(n.WebTwainEnv={});t.initQueue=[];n.initOrder=n.initOrder||[];n.unloadQueue=n.unloadQueue||[]}(Dynamsoft);Dynamsoft.WebTwainEnv.IfUseActiveXForIE10Plus=!1;Dynamsoft=Dynamsoft||{},function(n,t,i){var f=20200521,u,r;t._preDefine_ver&&t._preDefine_ver>=f||(t._preDefine_ver=f,u=function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n},r=function(n){if(null==n||"object"!=typeof n)return n;var t,i,u;if(n instanceof Date)return t=new Date,t.setTime(n.getTime()),t;if(n instanceof Array){for(t=[],u=n.length,i=0;i<u;i++)t[i]=r(n[i]);return t}if(n instanceof Object){t={};for(i in n)n.hasOwnProperty(i)&&(t[i]=r(n[i]));return t}return 0},t.Lib||(t.Lib={}),u(t.Lib,{win:n,doc:n.document,debug:!1,nil:i,mix:u,clone:r,keys:Object.keys,guid:function(n){for(var i=[],r="0123456789abcdef",u,t=0;t<8;t++)i.push(r.substr(Math.floor(Math.random()*16),1));for(i.push("-"),t=0;t<4;t++)i.push(r.substr(Math.floor(Math.random()*16),1));for(i.push("-4"),t=0;t<3;t++)i.push(r.substr(Math.floor(Math.random()*16),1));for(i.push("-"),u=r.substr(Math.floor(Math.random()*16),1),u=r.substr(u&3|8,1),i.push(u),t=0;t<3;t++)i.push(r.substr(Math.floor(Math.random()*16),1));for(i.push("-"),t=0;t<8;t++)i.push(r.substr(Math.floor(Math.random()*16),1));return i.unshift(n),i.join("")},now:Date.now||function(){return+new Date},noop:function(){}}))}(typeof window!="undefined"?window:this,Dynamsoft),function(n){function i(n,t){return{}.hasOwnProperty.call(n,t)}var r=!{toString:1}.propertyIsEnumerable("toString"),t=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toString","toLocaleString","valueOf"];n.keys=Object.keys||function(n){var e=[],u,f;for(u in n)i(n,u)&&e.push(u);if(r)for(f=t.length-1;f>=0;f--)u=t[f],i(n,u)&&e.push(u);return e}}(Dynamsoft.Lib),function(n,t){function r(n){return n===t}function a(n){return n!==t}function h(t,i){s["[object "+t+"]"]=i=t.toLowerCase();n["is"+t]=function(t){return n.type(t)===i}}var e=20200716;if(!n._isXXX_ver||!(n._isXXX_ver>=e)){n._isXXX_ver=e;var c=n.mix,o,u,i=!1,v=i,f={}.hasOwnProperty,s={},l=typeof HTMLElement=="object";c(n,{isDef:a,isUndef:r,isUndefined:r,isNull:function(n){return n===null},isNaN:function(n){return isNaN(n)},type:function(n){return n===null||n===t?String(n):s[{}.toString.call(n)]||"object"},isPlainObject:function(t){if(!t||n.type(t)!=="object"||t.nodeType||t.window==t)return i;var u,e;try{if((e=t.constructor)&&!f(t,"constructor")&&!f(e.prototype,"isPrototypeOf"))return i}catch(o){return i}for(u in t);return r(u)||f(t,u)},isDOM:function(n){return l?n instanceof HTMLElement:n&&typeof n=="object"&&(n.nodeType===1||n.nodeType===9)&&typeof n.nodeName=="string"},isDOMInBody:function(t){var i=t;if(n.isDOM(t))while(!i&&i!=document.body)i=i.parentNode;else i=0;return!!i}});h("Function");n.each=o=function(t,u,f){if(t){var o,s,h,e=0,c=t.length,l=r(c)||n.isFunction(t);if(f=f||null,l){for(h=n.keys(t);e<h.length;e++)if(o=h[e],u.call(f,t[o],o,t)===i)break}else for(s=t[0];e<c;s=t[++e])if(u.call(f,s,e,t)===i)break}return t};u=["String","Object","Boolean","Number"];Array.isArray?n.isArray=Array.isArray:u.push("Array");o(u,h)}}(Dynamsoft.Lib),function(n){var u=n.mix,i=n.win,t,r=20200521;n._log_ver&&n.isNumber(n._log_ver)&&n._log_ver>=r||(n._log_ver=r,n.isDef(i.console)&&(t=i.console,n.isFunction(t.log)&&n.isFunction(t.error)||(t=!1)),u(n,{log:function(i){n.debug&&t&&t.log(i)},error:function(i){n.debug&&t&&t.error(i)},getLogger:function(){var t=n.log;return{warn:t,log:t,info:t,debug:t}}}))}(Dynamsoft.Lib),function(n){var t=20200521;n._random_ver&&n._random_ver>=t||(n._random_ver=t,n.getRandom=function(){for(var i=n.now()%1e4,t=[],u,r=0;r<5;r++){if(u=Math.floor(Math.random()*10),r==0&&u==0){r=-1;continue}t.push(u)}return i<10?t.push("000"):i<100?t.push("00"):i<1e3&&t.push("0"),t.push(i),t.join("")})}(Dynamsoft.Lib),function(n){var t=20200521;n._strUtil_ver&&n.isNumber(n._strUtil_ver)&&n._strUtil_ver>=t||(n._strUtil_ver=t,n.mix(n,{startsWith:function(n,t){return n.lastIndexOf(t,0)===0},endsWith:function(n,t){var i=n.length-t.length;return i>=0&&n.indexOf(t,i)===i},replaceAll:function(n,t,i){return n.replace(new RegExp(t,"gi"),i)},upperCaseFirst:function(n){return n.charAt(0).toUpperCase()+n.substr(1)},makeArray:function(t){var r,u,f,i,e;if(t==null)return[];if(n.isArray(t))return t;if(r=typeof t.length,u=typeof t,r!=="number"||t.alert||u==="string"||u==="function"&&!("item"in t&&r==="number"))return[t];for(f=[],i=0,e=t.length;i<e;i++)f[i]=t[i];return f}}))}(Dynamsoft.Lib),function(n){var t=20200521;n._extend_ver&&n.isNumber(n._extend_ver)&&n._extend_ver>=t||(n._extend_ver=t,n.extend=function(t,i){var r=function(){t.apply(this,arguments);i&&i.apply(this,arguments)};return n.each(t.prototype,function(n,t){r.prototype[t]=n}),r.prototype.constructor=r,r})}(Dynamsoft.Lib),function(n){function t(t){var i=this,r=i.constructor;for(i.__attrs={},i.__attrVals={},i.userConfig=t;r;)i.addAttrs(r.ATTRS),r=r.superclass?r.superclass.constructor:null;n.mix(i.__attrs,t)}var i=20200521;n._attribute_ver&&n.isNumber(n._attribute_ver)&&n._attribute_ver>=i||(n._attribute_ver=i,n.mix(t.prototype,{get:function(n){var t=this;return n in t.__attrs?t.__attrs[n]:""},set:function(n,t){var i=this;n in i.__attrs&&(i.__attrs[n]=t)},addAttrs:function(t){n.mix(this.__attrs,t)}}),t.extend=function(t){var u=this,r,i;return t=t||{},t.constructor&&(r=t.constructor),i=n.extend(u,r),n.mix(i,t),i},n.Attributes=t)}(Dynamsoft.Lib),function(n){function f(n){return n<10?"0"+n:n}function l(t,i,r,u,f,s){var d=s,v,w,l,y,h,p,c,a,b,k;for(s+=u,l=0,v=r!==undefined?r:n.keys(t),h=[],w=v.length;l<w;l++)y=v[l],p=o(y,t,i,r,u,f,s),p!==undefined&&(c=e.quote(y),c+=":",u&&(c+=" "),c+=p,h[h.length]=c);return h.length?u?(b=",\n"+s,k=h.join(b),a="{\n"+s+k+"\n"+d+"}"):a="{"+h.join(",")+"}":a="{}",a}function a(n,t,i,r,u,f){var v=f,c,s,l,a;f+=r;for(var e=[],y=n.length,h=0;h<y;)c=o(String(h),n,t,i,r,u,f),e[e.length]=c===undefined?"null":c,++h;return e.length?r?(l="\n,"+f,a=e.join(l),s="[\n"+f+a+"\n"+v+"]"):s="["+e.join(",")+"]":s="[]",s}function h(t,i,r){var u=t[i],f,o,e,s,l,c;if(typeof u=="object")if(n.isArray(u)){for(f=0,o=u.length,s=[];f<o;)e=h(u,String(f),r),e!==undefined&&(s[s.length]=e);u=s}else for(l=n.keys(u),f=0,o=l.length;f<o;f++)c=l[f],e=h(u,c,r),e===undefined?delete u[c]:u[c]=e;return r.call(t,i,u)}var c=20200521,u,e,o,i,r,t,s;if(!n._json_ver||!(n._json_ver>=c)){if(n._json_ver=c,u=n.win.JSON,u&&u.parse&&u.stringify){n.parse=u.parse;n.stringify=u.stringify;return}e=function(){var i={"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t",'"':'\\"'},t={},r=/["\b\f\n\r\t\x00-\x1f]/g,u=/\\\\|\\\/|\\b|\\f|\\n|\\r|\\t|\\"|\\u[0-9a-zA-Z]{4}/g;return n.each(i,function(n,i){t[n]=i}),t["\\/"]="/",t["\\\\"]="\\",{quote:function(n){return'"'+n.replace(r,function(n){var t;return(t=i[n])||(t="\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)),t})+'"'},unQuote:function(n){return n.slice(1,n.length-1).replace(u,function(n){var i;return(i=t[n])||(i=String.fromCharCode(parseInt(n.slice(2),16))),i})}}}();o=function(t,i,r,u,o,s,h){var c=i[t];c&&typeof c=="object"&&(typeof c.toJSON=="function"?c=c.toJSON(t):c instanceof Date?c=isFinite(c.valueOf())?c.getUTCFullYear()+"-"+f(c.getUTCMonth()+1)+"-"+f(c.getUTCDate())+"T"+f(c.getUTCHours())+":"+f(c.getUTCMinutes())+":"+f(c.getUTCSeconds())+"Z":null:(c instanceof String||c instanceof Number||c instanceof Boolean)&&(c=c.valueOf()));r!==undefined&&(c=r.call(i,t,c));switch(typeof c){case"number":return isFinite(c)?String(c):"null";case"string":return e.quote(c);case"boolean":return String(c);case"object":return c?n.isArray(c)?a(c,r,u,o,s,h):l(c,r,u,o,s,h):"null"}return undefined};n.stringify=function(t,i,r){var u="",f,e;return i&&(typeof i=="function"?e=i:n.isArray(i)&&(f=i)),typeof r=="number"?(r=Math.min(10,r),u=new Array(r+1).join(" ")):typeof r=="string"&&(u=r.slice(0,10)),o("",{"":t},e,f,u,[],"")};i={};r={SHIFT_TYPE:1,REDUCE_TYPE:2,ACCEPT_TYPE:0,TYPE_INDEX:0,PRODUCTION_INDEX:1,TO_INDEX:2};i.yy={unQuote:e.unQuote};t=function(t){var i=this;i.rules=[];n.mix(i,t);i.resetInput(i.input)};t.prototype={constructor:function(t){var i=this;i.rules=[];n.mix(i,t);i.resetInput(i.input)},resetInput:function(i){n.mix(this,{input:i,matched:"",stateStack:[t.STATIC.INITIAL],match:"",text:"",firstLine:1,lineNumber:1,lastLine:1,firstColumn:1,lastColumn:1})},getCurrentRules:function(){var i=this,r=i.stateStack[i.stateStack.length-1],u=[];return r=i.mapState(r),n.each(i.rules,function(i){var f=i.state||i[3];f?n.inArray(r,f)&&u.push(i):r==t.STATIC.INITIAL&&u.push(i)}),u},pushState:function(n){this.stateStack.push(n)},popState:function(){return this.stateStack.pop()},getStateStack:function(){return this.stateStack},showDebugInfo:function(){var u=this,r=t.STATIC.DEBUG_CONTEXT_LIMIT,n=u.matched,e=u.match,o=u.input,f,i;return n=n.slice(0,n.length-e.length),f=(n.length>r?"...":"")+n.slice(-r).replace(/\n/," "),i=e+o,i=i.slice(0,r)+(i.length>r?"...":""),f+i+"\n"+new Array(f.length+1).join("-")+"^"},mapSymbol:function(n){var i=this,t=i.symbolMap;return t?t[n]||(t[n]=++i.symbolId):n},mapReverseSymbol:function(t){var r=this,u=r.symbolMap,i=r.reverseSymbolMap;return!i&&u&&(i=r.reverseSymbolMap={},n.each(u,function(n,t){i[n]=t})),i?i[t]:t},mapState:function(n){var i=this,t=i.stateMap;return t?t[n]||(t[n]=++i.stateId):n},lex:function(){var i=this,e=i.input,s,r,o,u,f,c=i.getCurrentRules(),h;if(i.match=i.text="",!e)return i.mapSymbol(t.STATIC.END_TAG);for(s=0;s<c.length;s++){r=c[s];var a=r.regexp||r[1],v=r.token||r[0],l=r.action||r[2]||undefined;if(o=e.match(a))return f=o[0].match(/\n.*/g),f&&(i.lineNumber+=f.length),n.mix(i,{firstLine:i.lastLine,lastLine:i.lineNumber+1,firstColumn:i.lastColumn,lastColumn:f?f[f.length-1].length-1:i.lastColumn+o[0].length}),h=i.match=o[0],i.matches=o,i.text=h,i.matched+=h,u=l&&l.call(i),u=u===undefined?v:i.mapSymbol(u),e=e.slice(h.length),i.input=e,u?u:i.lex()}return n.error("lex error at line "+i.lineNumber+":\n"+i.showDebugInfo()),undefined}};t.STATIC={INITIAL:"I",DEBUG_CONTEXT_LIMIT:20,END_TAG:"$EOF"};s=new t({rules:[[2,/^"(\\"|\\\\|\\\/|\\b|\\f|\\n|\\r|\\t|\\u[0-9a-zA-Z]{4}|[^\\"\x00-\x1f])*"/,0],[0,/^[\t\r\n\x20]/,0],[3,/^,/,0],[4,/^:/,0],[5,/^\[/,0],[6,/^\]/,0],[7,/^\{/,0],[8,/^\}/,0],[9,/^-?\d+(?:\.\d+)?(?:e-?\d+)?/i,0],[10,/^true|false/,0],[11,/^null/,0],[12,/^./,0]]});i.lexer=s;s.symbolMap={$EOF:1,STRING:2,COMMA:3,COLON:4,LEFT_BRACKET:5,RIGHT_BRACKET:6,LEFT_BRACE:7,RIGHT_BRACE:8,NUMBER:9,BOOLEAN:10,NULL:11,INVALID:12,$START:13,json:14,value:15,object:16,array:17,elementList:18,member:19,memberList:20};i.productions=[[13,[14]],[14,[15],function(){return this.$1}],[15,[2],function(){return this.yy.unQuote(this.$1)}],[15,[9],function(){return parseFloat(this.$1)}],[15,[16],function(){return this.$1}],[15,[17],function(){return this.$1}],[15,[10],function(){return this.$1==="true"}],[15,[11],function(){return null}],[18,[15],function(){return[this.$1]}],[18,[18,3,15],function(){return this.$1[this.$1.length]=this.$3,this.$1}],[17,[5,6],function(){return[]}],[17,[5,18,6],function(){return this.$2}],[19,[2,4,15],function(){return{key:this.yy.unQuote(this.$1),value:this.$3}}],[20,[19],function(){var n={};return n[this.$1.key]=this.$1.value,n}],[20,[20,3,19],function(){return this.$1[this.$3.key]=this.$3.value,this.$1}],[16,[7,8],function(){return{}}],[16,[7,20,8],function(){return this.$2}]];i.table={gotos:{"0":{"14":7,"15":8,"16":9,"17":10},"2":{"15":12,"16":9,"17":10,"18":13},"3":{"19":16,"20":17},"18":{"15":23,"16":9,"17":10},"20":{"15":24,"16":9,"17":10},"21":{"19":25}},action:{"0":{"2":[1,0,1],"5":[1,0,2],"7":[1,0,3],"9":[1,0,4],"10":[1,0,5],"11":[1,0,6]},"1":{"1":[2,2,0],"3":[2,2,0],"6":[2,2,0],"8":[2,2,0]},"2":{"2":[1,0,1],"5":[1,0,2],"6":[1,0,11],"7":[1,0,3],"9":[1,0,4],"10":[1,0,5],"11":[1,0,6]},"3":{"2":[1,0,14],"8":[1,0,15]},"4":{"1":[2,3,0],"3":[2,3,0],"6":[2,3,0],"8":[2,3,0]},"5":{"1":[2,6,0],"3":[2,6,0],"6":[2,6,0],"8":[2,6,0]},"6":{"1":[2,7,0],"3":[2,7,0],"6":[2,7,0],"8":[2,7,0]},"7":{"1":[0,0,0]},"8":{"1":[2,1,0]},"9":{"1":[2,4,0],"3":[2,4,0],"6":[2,4,0],"8":[2,4,0]},"10":{"1":[2,5,0],"3":[2,5,0],"6":[2,5,0],"8":[2,5,0]},"11":{"1":[2,10,0],"3":[2,10,0],"6":[2,10,0],"8":[2,10,0]},"12":{"3":[2,8,0],"6":[2,8,0]},"13":{"3":[1,0,18],"6":[1,0,19]},"14":{"4":[1,0,20]},"15":{"1":[2,15,0],"3":[2,15,0],"6":[2,15,0],"8":[2,15,0]},"16":{"3":[2,13,0],"8":[2,13,0]},"17":{"3":[1,0,21],"8":[1,0,22]},"18":{"2":[1,0,1],"5":[1,0,2],"7":[1,0,3],"9":[1,0,4],"10":[1,0,5],"11":[1,0,6]},"19":{"1":[2,11,0],"3":[2,11,0],"6":[2,11,0],"8":[2,11,0]},"20":{"2":[1,0,1],"5":[1,0,2],"7":[1,0,3],"9":[1,0,4],"10":[1,0,5],"11":[1,0,6]},"21":{"2":[1,0,14]},"22":{"1":[2,16,0],"3":[2,16,0],"6":[2,16,0],"8":[2,16,0]},"23":{"3":[2,9,0],"6":[2,9,0]},"24":{"3":[2,12,0],"8":[2,12,0]},"25":{"3":[2,14,0],"8":[2,14,0]}}};i.parse=function(t){var u=this,h=u.lexer,c,e,l,b=u.table,nt=b.gotos,a=b.action,tt=u.productions,f=[null],i=[0],w,k,g;for(h.resetInput(t);;){if(c=i[i.length-1],e||(e=h.lex()),!e)return n.log("it is not a valid input: "+t,"error"),!1;if(l=a[c]&&a[c][e],!l)return w=[],a[c]&&n.each(a[c],function(n,t){w.push(u.lexer.mapReverseSymbol(t))}),k="Syntax error at line "+h.lineNumber+":\n"+h.showDebugInfo()+"\nexpect "+w.join(", "),n.log(k),!1;switch(l[r.TYPE_INDEX]){case r.SHIFT_TYPE:i.push(e);f.push(h.text);i.push(l[r.TO_INDEX]);e=null;break;case r.REDUCE_TYPE:var o=tt[l[r.PRODUCTION_INDEX]],it=o.symbol||o[0],d=o.action||o[2],rt=o.rhs||o[1],s=rt.length,v=0,y,p=f[f.length-s];for(u.$$=p,y=undefined;v<s;v++)u["$"+(s-v)]=f[f.length-1-v];d&&(y=d.call(u));p=y!==undefined?y:u.$$;s&&(i=i.slice(0,-2*s),f=f.slice(0,-1*s));i.push(it);f.push(p);g=nt[i[i.length-2]][i[i.length-1]];i.push(g);break;case r.ACCEPT_TYPE:return p}}};n.parse=function(n,t){var r=i.parse(String(n));return t?h({"":r},"",t):r}}}(Dynamsoft.Lib),function(n){var i=20200521;if(!n._array_ver||!(n._array_ver>=i)){n._array_ver=i;var r=Array.prototype,t=r.indexOf,u=r.filter;n.isFunction(t)||(t=function(n,t){var r,f,u,i;if(this==null||(f=Object(this),u=f.length>>>0,u===0)||(i=+t||0,Math.abs(i)===Infinity&&(i=0),i>=u))return-1;for(r=Math.max(i>=0?i:u-Math.abs(i),0);r<u;){if(r in f&&f[r]===n)return r;r++}return-1});n.mix(n,{filter:u?function(n,t,i){return u.call(n,t,i||this)}:function(t,i,r){var u=[];return n.each(t,function(n,t,f){i.call(r||this,n,t,f)&&u.push(n)}),u},indexOf:function(n,i){return t.call(i,n)},uniq:function(n){for(var i,r=[],u=n.length,t=0;t<u;t++){for(i=t+1;i<u;i++)n[t]===n[i]&&(t++,i=t);r.push(n[t])}return r}})}}(Dynamsoft.Lib),function(n){var r=20200521,t,i;n._function_ver&&n._function_ver>=r||(n._function_ver=r,t=Array.prototype,i=Function.prototype,n.isFunction(i.bind)||(i.bind=function(n){var i=this,r;return 1<arguments.length?(r=t.slice.call(arguments,1),function(){return i.apply(n,arguments.length?r.concat(t.slice.call(arguments)):r)}):function(){return arguments.length?i.apply(n,arguments):i.call(n)}}))}(Dynamsoft.Lib),function(n){var i=20200521;if(!n._string_ver||!(n._string_ver>=i)){n._string_ver=i;var f=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,r=String.prototype,u="",t=r.trim;t||(t=r.trim=function(){return this.replace(f,u)});n.trim=function(n){return n==null?u:t.call(n)}}}(Dynamsoft.Lib),function(n,t){function v(n){var t=typeof n;return n==null||t!=="object"&&t!=="function"}function b(){if(f)return f;var n=i;return r(o,function(t){n+=t+"|"}),n=n.slice(0,-1),f=new RegExp(n,"g")}function k(){if(e)return e;var n=i;return r(s,function(t){n+=t+"|"}),n+="&#(\\d{1,5});",e=new RegExp(n,"g")}function u(n){return encodeURIComponent(String(n))}var i="",y=!0,h=n.getLogger(),c=n.isDef,r=n.each,l="&",a="=",p=16,o={"&amp;":"&","&gt;":">","&lt;":"<","&#x60;":"`","&#x2F;":"/","&quot;":'"',"&#x27;":"'"},s={},f,e,w=/[\-#$\^*()+\[\]{}|\\,.?\s]/g;r(o,function(n,t){s[n]=t});n.mix(n,{urlEncode:u,urlDecode:function(n){return decodeURIComponent(n.replace(/\+/g," "))},fromUnicode:function(n){return n.replace(/\\u([a-f\d]{4})/ig,function(n,t){return String.fromCharCode(parseInt(t,p))})},escapeHtml:function(n){return(n+"").replace(b(),function(n){return s[n]})},escapeRegExp:function(n){return n.replace(w,"\\$&")},unEscapeHtml:function(n){return n.replace(k(),function(n,t){return o[n]||String.fromCharCode(+t)})},param:function(t,f,e,o){f=f||l;e=e||a;n.isUndef(o)&&(o=y);var s=[];return r(t,function(t,h){var l=u(h);v(t)?(s.push(l),c(t)&&s.push(e,u(t+i)),s.push(f)):n.isArray(t)&&t.length&&r(t,function(n){v(n)&&(s.push(l,o?u("[]"):i),c(n)&&s.push(e,u(n+i)),s.push(f))})}),s.pop(),s.join(i)},unparam:function(i,r,u){if(!n.isString(i)||!(i=n.trim(i)))return{};r=r||l;u=u||a;for(var o={},v,y=n.urlDecode,c=i.split(r),f,e,s=0,p=c.length;s<p;++s){if(v=n.indexOf(u,c[s]),v===-1)f=y(c[s]),e=t;else{f=y(c[s].substring(0,v));e=c[s].substring(v+1);try{e=y(e)}catch(w){h.error("decodeURIComponent error : "+e);h.error(w)}n.endsWith(f,"[]")&&(f=f.substring(0,f.length-2))}f in o?n.isArray(o[f])?o[f].push(e):o[f]=[o[f],e]:o[f]=e}return o}})}(Dynamsoft.Lib),function(n){function r(n,t){for(var r,i=[],u=0;u<n.length;u++)(r=n[u],r&&r!==".")&&(r===".."?i.length&&i[i.length-1]!==".."?i.pop():t&&i.push(".."):i.push(r));return i}var t=/^(\/?)([\s\S]+\/(?!$)|\/)?((?:\.{1,2}$|[\s\S]+?)?(\.[^.\/]*)?)$/,i=n.Path={resolve:function(){for(var f="",e,o=arguments,t,u=0,i=o.length-1;i>=0&&!u;i--)t=o[i],n.isString(t)&&!!t&&(f=t+"/"+f,u=t.charAt(0)==="/");return e=r(n.filter(f.split("/"),function(n){return!!n}),!u).join("/"),(u?"/":"")+e||"."},normalize:function(t){var i=t.charAt(0)==="/",u=t.slice(-1)==="/";return t=r(n.filter(t.split("/"),function(n){return!!n}),!i).join("/"),t||i||(t="."),t&&u&&(t+="/"),(i?"/":"")+t},join:function(){var t=n.makeArray(arguments);return i.normalize(n.filter(t,function(t){return t&&n.isString(t)}).join("/"))},relative:function(t,r){t=i.normalize(t);r=i.normalize(r);for(var e=n.filter(t.split("/"),function(n){return!!n}),f=[],s,o=n.filter(r.split("/"),function(n){return!!n}),h=Math.min(e.length,o.length),u=0;u<h;u++)if(e[u]!==o[u])break;for(s=u;u<e.length;)f.push(".."),u++;return f=f.concat(o.slice(s)),f.join("/")},basename:function(n,i){var u=n.match(t)||[],r;return r=u[3]||"",i&&r&&r.slice(-1*i.length)===i&&(r=r.slice(0,-1*i.length)),r},dirname:function(n){var r=n.match(t)||[],u=r[1]||"",i=r[2]||"";return!u&&!i?".":(i&&(i=i.substring(0,i.length-1)),u+i)},extname:function(n){return(n.match(t)||[])[4]||""}}}(Dynamsoft.Lib),function(n,t){function i(t){t._queryMap||(t._queryMap=n.unparam(t._query))}function r(n){this._query=n||""}r.prototype={constructor:r,clone:function(){return new r(this.toString())},reset:function(n){var t=this;return t._query=n||"",t._queryMap=null,t},count:function(){var r=this,t=0;return i(r),n.each(r._queryMap,function(i){n.isArray(i)?t+=i.length:t++}),t},has:function(t){var u=this,r;return i(u),r=u._queryMap,t?t in r:!n.isEmptyObject(r)},get:function(n){var r=this,t;return i(r),t=r._queryMap,n?t[n]:t},keys:function(){var t=this;return i(t),n.keys(t._queryMap)},set:function(t,u){var f=this,e;return i(f),e=f._queryMap,n.isString(t)?f._queryMap[t]=u:(t instanceof r&&(t=t.get()),n.each(t,function(n,t){e[t]=n})),f},remove:function(n){var t=this;return i(t),n?delete t._queryMap[n]:t._queryMap={},t},add:function(t,u){var e=this,o,f;return n.isString(t)?(i(e),o=e._queryMap,f=o[t],f=n.isUndef(f)?u:[].concat(f).concat(u),o[t]=f):(t instanceof r&&(t=t.get()),n.each(t,function(n,t){e.add(t,n)})),e},toString:function(r){var u=this;return i(u),n.param(u._queryMap,t,t,r)}};n.uriQuery=r}(Dynamsoft.Lib),function(n){function y(n){return n.length===1?"0"+n:n}function u(n,t){return n.toLowerCase()===t.toLowerCase()}function i(n,t){return encodeURI(n).replace(t,function(n){return"%"+y(n.charCodeAt(0).toString(16))})}function t(i){if(i instanceof t)return i.clone();var e,u=this;return n.mix(u,{scheme:"",userInfo:"",hostname:"",port:"",path:"",query:"",fragment:""}),e=t.getComponents(i),r(e,function(t,i){if(t=t||"",i==="query")u.query=new f(t);else{try{t=n.urlDecode(t)}catch(r){h.error(r+"urlDecode error : "+t)}u[i]=t}}),u}var f=n.uriQuery,r=n.each,e=n.Path,h=n.getLogger(),o=/[#\/\?@]/g,c=/[#\?]/g,l=/[#@]/g,a=/#/g,s={scheme:1,userInfo:2,hostname:3,port:4,path:5,query:6,fragment:7},v=new RegExp("^(?:([\\w\\d+.-]+):)?(?://(?:([^/?#@]*)@)?([\\w\\d\\-\\u0100-\\uffff.+%]*|\\[[^\\]]+\\])(?::([0-9]+))?)?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");t.prototype={constructor:t,clone:function(){var n=new t,i=this;return r(s,function(t,r){n[r]=i[r]}),n.query=n.query.clone(),n},resolve:function(i){n.isString(i)&&(i=new t(i));var s=this,f=0,o,u=s.clone();return r(["scheme","userInfo","hostname","port","path","query","fragment"],function(t){if(t==="path")if(f)u[t]=i[t];else{var r=i.path;r&&(f=1,n.startsWith(r,"/")||(u.hostname&&!u.path?r="/"+r:u.path&&(o=u.path.lastIndexOf("/"),o!==-1&&(r=u.path.slice(0,o+1)+r))),u.path=e.normalize(r))}else t==="query"?(f||i.query.toString())&&(u.query=i.query.clone(),f=1):(f||i[t])&&(u[t]=i[t],f=1)}),u},getScheme:function(){return this.scheme},setScheme:function(n){return this.scheme=n,this},getHostname:function(){return this.hostname},setHostname:function(n){return this.hostname=n,this},setUserInfo:function(n){return this.userInfo=n,this},getUserInfo:function(){return this.userInfo},setPort:function(n){return this.port=n,this},getPort:function(){return this.port},setPath:function(n){return this.path=n,this},getPath:function(){return this.path},setQuery:function(t){return n.isString(t)&&(n.startsWith(t,"?")&&(t=t.slice(1)),t=new f(i(t,l))),this.query=t,this},getQuery:function(){return this.query},getFragment:function(){return this.fragment},setFragment:function(t){var i=this;return n.startsWith(t,"#")&&(t=t.slice(1)),i.fragment=t,i},isSameOriginAs:function(n){var t=this;return u(t.hostname,n.hostname)&&u(t.scheme,n.scheme)&&u(t.port,n.port)},toString:function(t){var r=[],u=this,h,s,f,l,v,y,p;return(h=u.scheme)&&(r.push(i(h,o)),r.push(":")),(s=u.hostname)&&(r.push("//"),(p=u.userInfo)&&(r.push(i(p,o)),r.push("@")),r.push(encodeURIComponent(s)),(l=u.port)&&(r.push(":"),r.push(l))),(f=u.path)&&(s&&!n.startsWith(f,"/")&&(f="/"+f),f=e.normalize(f),r.push(i(f,c))),(y=u.query.toString.call(u.query,t))&&(r.push("?"),r.push(y)),(v=u.fragment)&&(r.push("#"),r.push(i(v,a))),r.join("")}};t.getComponents=function(n){var i,t;return n=n||"",i=n.match(v)||[],t={},r(s,function(n,r){t[r]=i[n]}),t};n.Uri=t}(Dynamsoft.Lib),function(n){var t=n.Lib,i=t.win,r=20200716;if(!t._promise_ver||!t.isNumber(t._promise_ver)||!(t._promise_ver>=r)){if(t._promise_ver=r,t.isFunction(i.__zone_symbol__Promise)&&(t.nativePromise=i.__zone_symbol__Promise),self&&self.Promise){t.Promise=self.Promise;t.nativePromise||(t.nativePromise=t.Promise);return}if(i&&i.Promise){t.Promise=i.Promise;t.nativePromise||(t.nativePromise=t.Promise);return}!function(n){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self);t.Promise=n()}}(function(){return function n(t,i,r){function u(f,o){var h,c,s;if(!i[f]){if(!t[f]){if(h="function"==typeof _dereq_&&_dereq_,!o&&h)return h(f,!0);if(e)return e(f,!0);c=new Error("Cannot find module '"+f+"'");throw c.code="MODULE_NOT_FOUND",c;}s=i[f]={exports:{}};t[f][0].call(s.exports,function(n){var i=t[f][1][n];return u(i?i:n)},s,s.exports,n,t,i,r)}return i[f].exports}for(var e="function"==typeof _dereq_&&_dereq_,f=0;f<r.length;f++)u(r[f]);return u}({1:[function(n,t){function i(){this._customScheduler=!1;this._isTickUsed=!1;this._lateQueue=new r(16);this._normalQueue=new r(16);this._haveDrainedQueues=!1;var n=this;this.drainQueues=function(){n._drainQueues()};this._schedule=e}function o(n,t,i){this._lateQueue.push(n,t,i);this._queueTick()}function s(n,t,i){this._normalQueue.push(n,t,i);this._queueTick()}function h(n){this._normalQueue._pushOne(n);this._queueTick()}function u(n){for(;n.length()>0;)c(n)}function c(n){var t=n.shift(),i,r;"function"!=typeof t?t._settlePromises():(i=n.shift(),r=n.shift(),t.call(i,r))}var f,e,r;try{throw new Error;}catch(l){f=l}e=n("./schedule");r=n("./queue");i.prototype.setScheduler=function(n){var t=this._schedule;return this._schedule=n,this._customScheduler=!0,t};i.prototype.hasCustomScheduler=function(){return this._customScheduler};i.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues};i.prototype.fatalError=function(n,t){t?(process.stderr.write("Fatal "+(n instanceof Error?n.stack:n)+"\n"),process.exit(2)):this.throwLater(n)};i.prototype.throwLater=function(n,t){if(1===arguments.length&&(t=n,n=function(){throw t;}),"undefined"!=typeof setTimeout)setTimeout(function(){n(t)},0);else try{this._schedule(function(){n(t)})}catch(i){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n");}};i.prototype.invokeLater=o;i.prototype.invoke=s;i.prototype.settlePromises=h;i.prototype._drainQueues=function(){u(this._normalQueue);this._reset();this._haveDrainedQueues=!0;u(this._lateQueue)};i.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))};i.prototype._reset=function(){this._isTickUsed=!1};t.exports=i;t.exports.firstLineError=f},{"./queue":17,"./schedule":18}],2:[function(n,t){t.exports=function(n,t,i,r){var u=!1,f=function(n,t){this._reject(t)},e=function(n,t){t.promiseRejectionQueued=!0;t.bindingPromise._then(f,f,null,this,n)},o=function(n,t){0==(50397184&this._bitField)&&this._resolveCallback(t.target)},s=function(n,t){t.promiseRejectionQueued||this._reject(n)};n.prototype.bind=function(f){var c,h,l,a;return u||(u=!0,n.prototype._propagateFrom=r.propagateFromFunction(),n.prototype._boundValue=r.boundValueFunction()),c=i(f),h=new n(t),h._propagateFrom(this,1),l=this._target(),(h._setBoundTo(c),c instanceof n)?(a={promiseRejectionQueued:!1,promise:h,target:l,bindingPromise:c},l._then(t,e,void 0,h,a),c._then(o,s,void 0,h,a),h._setOnCancel(c)):h._resolveCallback(l),h};n.prototype._setBoundTo=function(n){void 0!==n?(this._bitField=2097152|this._bitField,this._boundTo=n):this._bitField=-2097153&this._bitField};n.prototype._isBound=function(){return 2097152==(2097152&this._bitField)};n.bind=function(t,i){return n.resolve(i).bind(t)}}},{}],3:[function(n,t){function u(){try{Promise===i&&(Promise=r)}catch(n){}return i}var r,i;"undefined"!=typeof Promise&&(r=Promise);i=n("./promise")();i.noConflict=u;t.exports=i},{"./promise":15}],4:[function(n,t){t.exports=function(t,i,r,u){var f=n("./util"),o=f.tryCatch,s=f.errorObj,e=t._async;t.prototype["break"]=t.prototype.cancel=function(){var n,t,i;if(!u.cancellation())return this._warn("cancellation is disabled");for(n=this,t=n;n._isCancellable();){if(!n._cancelBy(t)){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}if(i=n._cancellationParent,null==i||!i._isCancellable()){n._isFollowing()?n._followee().cancel():n._cancelBranched();break}n._isFollowing()&&n._followee().cancel();n._setWillBeCancelled();t=n;n=i}};t.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--};t.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0};t.prototype._cancelBy=function(n){return n===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),this._enoughBranchesHaveCancelled()?(this._invokeOnCancel(),!0):!1)};t.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()};t.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),e.invoke(this._cancelPromises,this,void 0))};t.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()};t.prototype._unsetOnCancel=function(){this._onCancelField=void 0};t.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()};t.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()};t.prototype._doInvokeOnCancel=function(n,t){var i,r;if(f.isArray(n))for(i=0;i<n.length;++i)this._doInvokeOnCancel(n[i],t);else void 0!==n&&("function"==typeof n?t||(r=o(n).call(this._boundValue()),r===s&&(this._attachExtraTrace(r.e),e.throwLater(r.e))):n._resultCancelled(this))};t.prototype._invokeOnCancel=function(){var n=this._onCancel();this._unsetOnCancel();e.invoke(this._doInvokeOnCancel,this,n)};t.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())};t.prototype._resultCancelled=function(){this.cancel()}}},{"./util":21}],5:[function(n,t){t.exports=function(t){function u(n,u,o){return function(s){var c=o._boundValue(),l,h,a,y,v,p;n:for(l=0;l<n.length;++l)if(h=n[l],h===Error||null!=h&&h.prototype instanceof Error){if(s instanceof h)return i(u).call(c,s)}else if("function"==typeof h){if(a=i(h).call(c,s),a===e)return a;if(a)return i(u).call(c,s)}else if(r.isObject(s)){for(y=f(h),v=0;v<y.length;++v)if(p=y[v],h[p]!=s[p])continue n;return i(u).call(c,s)}return t}}var r=n("./util"),f=n("./es5").keys,i=r.tryCatch,e=r.errorObj;return u}},{"./es5":10,"./util":21}],6:[function(n,t){t.exports=function(n){function t(){this._trace=new t.CapturedTrace(u())}function f(){if(r)return new t}function u(){var n=i.length-1;if(n>=0)return i[n]}var r=!1,i=[];return n.prototype._promiseCreated=function(){},n.prototype._pushContext=function(){},n.prototype._popContext=function(){return null},n._peekContext=n.prototype._peekContext=function(){},t.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,i.push(this._trace))},t.prototype._popContext=function(){if(void 0!==this._trace){var n=i.pop(),t=n._promiseCreated;return n._promiseCreated=null,t}return null},t.CapturedTrace=null,t.create=f,t.deactivateLongStackTraces=function(){},t.activateLongStackTraces=function(){var i=n.prototype._pushContext,f=n.prototype._popContext,e=n._peekContext,o=n.prototype._peekContext,s=n.prototype._promiseCreated;t.deactivateLongStackTraces=function(){n.prototype._pushContext=i;n.prototype._popContext=f;n._peekContext=e;n.prototype._peekContext=o;n.prototype._promiseCreated=s;r=!1};r=!0;n.prototype._pushContext=t.prototype._pushContext;n.prototype._popContext=t.prototype._popContext;n._peekContext=n.prototype._peekContext=u;n.prototype._promiseCreated=function(){var n=this._peekContext();n&&null==n._promiseCreated&&(n._promiseCreated=this)}},t}},{}],7:[function(n,t){t.exports=function(t,i,r,u){function s(n,t){return{promise:t}}function ut(){return!1}function dt(n,t,i){var r=this;try{n(t,i,function(n){if("function"!=typeof n)throw new TypeError("onCancel must be a function, got: "+f.toString(n));r._attachCancellationCallback(n)})}catch(u){return u}}function gt(n){if(!this._isCancellable())return this;var t=this._onCancel();void 0!==t?f.isArray(t)?t.push(n):this._setOnCancel([t,n]):this._setOnCancel(n)}function ni(){return this._onCancelField}function ti(n){this._onCancelField=n}function ii(){this._cancellationParent=void 0;this._onCancelField=void 0}function ft(n,t){if(0!=(1&t)){this._cancellationParent=n;var i=n._branchesRemainingToCancel;void 0===i&&(i=0);n._branchesRemainingToCancel=i+1}0!=(2&t)&&n._isBound()&&this._setBoundTo(n._boundTo)}function ri(n,t){0!=(2&t)&&n._isBound()&&this._setBoundTo(n._boundTo)}function ui(){var n=this._boundTo;return void 0!==n&&n instanceof t?n.isFulfilled()?n.value():void 0:n}function fi(){this._trace=new o(this._peekContext())}function ei(n,t){var i,r;bi(n)&&(i=this._trace,(void 0!==i&&t&&(i=i._parent),void 0!==i)?i.attachExtraTrace(n):n.__stackCleaned__||(r=b(n),f.notEnumerableProp(n,"stack",r.message+"\n"+r.stack.join("\n")),f.notEnumerableProp(n,"__stackCleaned__",!0)))}function oi(){this._trace=void 0}function si(n,t,i,r,u){var h,c,l,e,a,f,v;if(void 0===n&&null!==t&&g){if(void 0!==u&&u._returnedNonUndefined())return;if(0==(65535&r._bitField))return;if(i&&(i+=" "),h="",c="",t._trace){for(var o=t._trace.stack.split("\n"),s=w(o),f=s.length-1;f>=0;--f)if(l=s[f],!ki.test(l)){e=l.match(di);e&&(h="at "+e[1]+":"+e[2]+":"+e[3]+" ");break}if(s.length>0)for(a=s[0],f=0;f<o.length;++f)if(o[f]===a){f>0&&(c="\n"+o[f-1]);break}}v="a promise was created in a "+i+"handler "+h+"but was not returned from it, see http://goo.gl/rRqMUw"+c;r._warn(v,!0,t)}}function hi(n,t){var i=n+" is deprecated and will be removed in a future version.";return t&&(i+=" Use "+t+" instead."),p(i)}function p(n,i,r){var o,u,f;e.warnings&&(u=new wi(n),i?r._attachExtraTrace(u):e.longStackTraces&&(o=t._peekContext())?o.attachExtraTrace(u):(f=b(u),u.stack=f.message+"\n"+f.stack.join("\n")),y("warning",u)||et(u,"",!0))}function ci(n,t){for(var i=0;i<t.length-1;++i)t[i].push("From previous event:"),t[i]=t[i].join("\n");return i<t.length&&(t[i]=t[i].join("\n")),n+"\n"+t.join("\n")}function li(n){for(var t=0;t<n.length;++t)(0===n[t].length||t+1<n.length&&n[t][0]===n[t+1][0])&&(n.splice(t,1),t--)}function ai(n){for(var t,o,i=n[0],r=1;r<n.length;++r){for(var u=n[r],f=i.length-1,s=i[f],e=-1,t=u.length-1;t>=0;--t)if(u[t]===s){e=t;break}for(t=e;t>=0;--t){if(o=u[t],i[f]!==o)break;i.pop();f--}i=u}}function w(n){for(var r=[],i=0;i<n.length;++i){var t=n[i],u="    (No stack trace)"===t||a.test(t),f=u&&it(t);u&&!f&&(vt&&" "!==t.charAt(0)&&(t="    "+t),r.push(t))}return r}function vi(n){for(var r,t=n.stack.replace(/\s+$/g,"").split("\n"),i=0;i<t.length;++i)if(r=t[i],"    (No stack trace)"===r||a.test(r))break;return i>0&&"SyntaxError"!=n.name&&(t=t.slice(i)),t}function b(n){var t=n.stack,i=n.toString();return t="string"==typeof t&&t.length>0?vi(n):["    (No stack trace)"],{message:i,stack:"SyntaxError"==n.name?t:w(t)}}function et(n,t,i){var r,u;"undefined"!=typeof console&&(f.isObject(n)?(u=n.stack,r=t+v(u,n)):r=t+String(n),"function"==typeof l?l(r,i):("function"==typeof console.log||"object"==typeof console.log)&&console.log(r))}function ot(n,t,i,r){var u=!1;try{"function"==typeof t&&(u=!0,"rejectionHandled"===n?t(r):t(i,r))}catch(f){h.throwLater(f)}"unhandledRejection"===n?y(n,i,r)||u||et(i,"Unhandled rejection "):y(n,r)}function st(n){var t,i,r;if("function"==typeof n)t="[function "+(n.name||"anonymous")+"]";else{if(t=n&&"function"==typeof n.toString?n.toString():f.toString(n),i=/\[object [a-zA-Z0-9$_]+\]/,i.test(t))try{r=JSON.stringify(n);t=r}catch(u){}0===t.length&&(t="(empty array)")}return"(<"+yi(t)+">, no stack trace)"}function yi(n){var t=41;return n.length<t?n:n.substr(0,t-3)+"..."}function k(){return"function"==typeof rt}function d(n){var t=n.match(tr);if(t)return{fileName:t[1],line:parseInt(t[2],10)}}function pi(n,t){var r,i;if(k()){for(var u,o,s=(n.stack||"").split("\n"),h=(t.stack||"").split("\n"),f=-1,e=-1,r=0;r<s.length;++r)if(i=d(s[r]),i){u=i.fileName;f=i.line;break}for(r=0;r<h.length;++r)if(i=d(h[r]),i){o=i.fileName;e=i.line;break}0>f||0>e||!u||!o||u!==o||f>=e||(it=function(n){if(at.test(n))return!0;var t=d(n);return t&&t.fileName===u&&f<=t.line&&t.line<=e?!0:!1})}}function o(n){this._parent=n;this._promisesCreated=0;var t=this._length=1+(void 0===n?0:n._length);rt(this,o);t>32&&this.uncycle()}var ht,ct,l,lt,h=t._async,wi=n("./errors").Warning,f=n("./util"),c=n("./es5"),bi=f.canAttachTrace,at=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,ki=/\((?:timers\.js):\d+:\d+\)/,di=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,a=null,v=null,vt=!1,yt=!(0==f.env("BLUEBIRD_DEBUG")||!f.env("BLUEBIRD_DEBUG")&&"development"!==f.env("NODE_ENV")),pt=!(0==f.env("BLUEBIRD_WARNINGS")||!yt&&!f.env("BLUEBIRD_WARNINGS")),gi=!(0==f.env("BLUEBIRD_LONG_STACK_TRACES")||!yt&&!f.env("BLUEBIRD_LONG_STACK_TRACES")),g=0!=f.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(pt||!!f.env("BLUEBIRD_W_FORGOTTEN_RETURN")),nt,rt,e;!function(){function i(){for(var t=0;t<n.length;++t)n[t]._notifyUnhandledRejection();r()}function r(){n.length=0}var n=[];lt=function(t){n.push(t);setTimeout(i,1)};c.defineProperty(t,"_unhandledRejectionCheck",{value:i});c.defineProperty(t,"_unhandledRejectionClear",{value:r})}();t.prototype.suppressUnhandledRejections=function(){var n=this._target();n._bitField=-1048577&n._bitField|524288};t.prototype._ensurePossibleRejectionHandled=function(){0==(524288&this._bitField)&&(this._setRejectionIsUnhandled(),lt(this))};t.prototype._notifyUnhandledRejectionIsHandled=function(){ot("rejectionHandled",ht,void 0,this)};t.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField};t.prototype._returnedNonUndefined=function(){return 0!=(268435456&this._bitField)};t.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var n=this._settledValue();this._setUnhandledRejectionIsNotified();ot("unhandledRejection",ct,n,this)}};t.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField};t.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField};t.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0};t.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField};t.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField;this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())};t.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0};t.prototype._warn=function(n,t,i){return p(n,t,i||this)};t.onPossiblyUnhandledRejection=function(n){var i=t._getContext();ct=f.contextBind(i,n)};t.onUnhandledRejectionHandled=function(n){var i=t._getContext();ht=f.contextBind(i,n)};nt=function(){};t.longStackTraces=function(){if(h.haveItemsQueued()&&!e.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!e.longStackTraces&&k()){var n=t.prototype._captureStackTrace,r=t.prototype._attachExtraTrace,u=t.prototype._dereferenceTrace;e.longStackTraces=!0;nt=function(){if(h.haveItemsQueued()&&!e.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");t.prototype._captureStackTrace=n;t.prototype._attachExtraTrace=r;t.prototype._dereferenceTrace=u;i.deactivateLongStackTraces();e.longStackTraces=!1};t.prototype._captureStackTrace=fi;t.prototype._attachExtraTrace=ei;t.prototype._dereferenceTrace=oi;i.activateLongStackTraces()}};t.hasLongStackTraces=function(){return e.longStackTraces&&k()};var tt={unhandledrejection:{before:function(){var n=f.global.onunhandledrejection;return f.global.onunhandledrejection=null,n},after:function(n){f.global.onunhandledrejection=n}},rejectionhandled:{before:function(){var n=f.global.onrejectionhandled;return f.global.onrejectionhandled=null,n},after:function(n){f.global.onrejectionhandled=n}}},wt=function(){var t=function(n,t){if(!n)return!f.global.dispatchEvent(t);var i;try{return i=n.before(),!f.global.dispatchEvent(t)}finally{n.after(i)}},n;try{return"function"==typeof CustomEvent?(n=new CustomEvent("CustomEvent"),f.global.dispatchEvent(n),function(n,i){n=n.toLowerCase();var u={detail:i,cancelable:!0},r=new CustomEvent(n,u);return c.defineProperty(r,"promise",{value:i.promise}),c.defineProperty(r,"reason",{value:i.reason}),t(tt[n],r)}):"function"==typeof Event?(n=new Event("CustomEvent"),f.global.dispatchEvent(n),function(n,i){n=n.toLowerCase();var r=new Event(n,{cancelable:!0});return r.detail=i,c.defineProperty(r,"promise",{value:i.promise}),c.defineProperty(r,"reason",{value:i.reason}),t(tt[n],r)}):(n=document.createEvent("CustomEvent"),n.initCustomEvent("testingtheevent",!1,!0,{}),f.global.dispatchEvent(n),function(n,i){n=n.toLowerCase();var r=document.createEvent("CustomEvent");return r.initCustomEvent(n,!1,!0,i),t(tt[n],r)})}catch(i){}return function(){return!1}}(),bt=function(){return f.isNode?function(){return process.emit.apply(process,arguments)}:f.global?function(n){var i="on"+n.toLowerCase(),t=f.global[i];return t?(t.apply(f.global,[].slice.call(arguments,1)),!0):!1}:function(){return!1}}(),nr={promiseCreated:s,promiseFulfilled:s,promiseRejected:s,promiseResolved:s,promiseCancelled:s,promiseChained:function(n,t,i){return{promise:t,child:i}},warning:function(n,t){return{warning:t}},unhandledRejection:function(n,t,i){return{reason:t,promise:i}},rejectionHandled:s},y=function(n){var i=!1,t;try{i=bt.apply(null,arguments)}catch(r){h.throwLater(r);i=!0}t=!1;try{t=wt(n,nr[n].apply(null,arguments))}catch(r){h.throwLater(r);t=!0}return t||i};t.config=function(n){var i,s,o;if((n=Object(n),"longStackTraces"in n&&(n.longStackTraces?t.longStackTraces():!n.longStackTraces&&t.hasLongStackTraces()&&nt()),"warnings"in n)&&(i=n.warnings,e.warnings=!!i,g=e.warnings,f.isObject(i)&&"wForgottenReturn"in i&&(g=!!i.wForgottenReturn)),"cancellation"in n&&n.cancellation&&!e.cancellation){if(h.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");t.prototype._clearCancellationData=ii;t.prototype._propagateFrom=ft;t.prototype._onCancel=ni;t.prototype._setOnCancel=ti;t.prototype._attachCancellationCallback=gt;t.prototype._execute=dt;kt=ft;e.cancellation=!0}return("monitoring"in n&&(n.monitoring&&!e.monitoring?(e.monitoring=!0,t.prototype._fireEvent=y):!n.monitoring&&e.monitoring&&(e.monitoring=!1,t.prototype._fireEvent=ut)),"asyncHooks"in n&&f.nodeSupportsAsyncResource)&&(s=e.asyncHooks,o=!!n.asyncHooks,s!==o&&(e.asyncHooks=o,o?r():u())),t};t.prototype._fireEvent=ut;t.prototype._execute=function(n,t,i){try{n(t,i)}catch(r){return r}};t.prototype._onCancel=function(){};t.prototype._setOnCancel=function(){};t.prototype._attachCancellationCallback=function(){};t.prototype._captureStackTrace=function(){};t.prototype._attachExtraTrace=function(){};t.prototype._dereferenceTrace=function(){};t.prototype._clearCancellationData=function(){};t.prototype._propagateFrom=function(){};var kt=ri,it=function(){return!1},tr=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;return f.inherits(o,Error),i.CapturedTrace=o,o.prototype.uncycle=function(){var u=this._length,s,n,c,i,r,h,e;if(!(2>u)){for(var t=[],o={},n=0,f=this;void 0!==f;++n)t.push(f),f=f._parent;for(u=this._length=n,n=u-1;n>=0;--n)s=t[n].stack,void 0===o[s]&&(o[s]=n);for(n=0;u>n;++n)if(c=t[n].stack,i=o[c],void 0!==i&&i!==n){for(i>0&&(t[i-1]._parent=void 0,t[i-1]._length=1),t[n]._parent=void 0,t[n]._length=1,r=n>0?t[n-1]:this,u-1>i?(r._parent=t[i+1],r._parent.uncycle(),r._length=r._parent._length+1):(r._parent=void 0,r._length=1),h=r._length+1,e=n-2;e>=0;--e)t[e]._length=h,h++;return}}},o.prototype.attachExtraTrace=function(n){if(!n.__stackCleaned__){this.uncycle();for(var r=b(n),u=r.message,t=[r.stack],i=this;void 0!==i;)t.push(w(i.stack.split("\n"))),i=i._parent;ai(t);li(t);f.notEnumerableProp(n,"stack",ci(u,t));f.notEnumerableProp(n,"__stackCleaned__",!0)}},rt=function(){var i=/^\s*at\s*/,t=function(n,t){return"string"==typeof n?n:void 0!==t.name&&void 0!==t.message?t.toString():st(t)},r,n,u;if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace)return Error.stackTraceLimit+=6,a=i,v=t,r=Error.captureStackTrace,it=function(n){return at.test(n)},function(n,t){Error.stackTraceLimit+=6;r(n,t);Error.stackTraceLimit-=6};if(n=new Error,"string"==typeof n.stack&&n.stack.split("\n")[0].indexOf("stackDetection@")>=0)return a=/@/,v=t,vt=!0,function(n){n.stack=(new Error).stack};try{throw new Error;}catch(f){u="stack"in f}return"stack"in n||!u||"number"!=typeof Error.stackTraceLimit?(v=function(n,t){return"string"==typeof n?n:"object"!=typeof t&&"function"!=typeof t||void 0===t.name||void 0===t.message?st(t):t.toString()},null):(a=i,v=t,function(n){Error.stackTraceLimit+=6;try{throw new Error;}catch(t){n.stack=t.stack}Error.stackTraceLimit-=6})}([]),"undefined"!=typeof console&&"undefined"!=typeof console.warn&&(l=function(n){console.warn(n)},f.isNode&&process.stderr.isTTY?l=function(n,t){var i=t?"\x1b[33m":"\x1b[31m";console.warn(i+n+"\x1b[0m\n")}:f.isNode||"string"!=typeof(new Error).stack||(l=function(n,t){console.warn("%c"+n,t?"color: darkorange":"color: red")})),e={warnings:pt,longStackTraces:!1,cancellation:!1,monitoring:!1,asyncHooks:!1},gi&&t.longStackTraces(),{asyncHooks:function(){return e.asyncHooks},longStackTraces:function(){return e.longStackTraces},warnings:function(){return e.warnings},cancellation:function(){return e.cancellation},monitoring:function(){return e.monitoring},propagateFromFunction:function(){return kt},boundValueFunction:function(){return ui},checkForgottenReturns:si,setBounds:pi,warn:p,deprecated:hi,CapturedTrace:o,fireDomEvent:wt,fireGlobalEvent:bt}}},{"./errors":9,"./es5":10,"./util":21}],8:[function(n,t){t.exports=function(n){function t(){return this.value}function i(){throw this.reason;}n.prototype["return"]=n.prototype.thenReturn=function(i){return i instanceof n&&i.suppressUnhandledRejections(),this._then(t,void 0,void 0,{value:i},void 0)};n.prototype["throw"]=n.prototype.thenThrow=function(n){return this._then(i,void 0,void 0,{reason:n},void 0)};n.prototype.catchThrow=function(n){if(arguments.length<=1)return this._then(void 0,i,void 0,{reason:n},void 0);var t=arguments[1],r=function(){throw t;};return this.caught(n,r)};n.prototype.catchReturn=function(i){var r,u;return arguments.length<=1?(i instanceof n&&i.suppressUnhandledRejections(),this._then(void 0,t,void 0,{value:i},void 0)):(r=arguments[1],r instanceof n&&r.suppressUnhandledRejections(),u=function(){return r},this.caught(i,u))}}},{}],9:[function(n,t){function r(n,t){function i(r){return this instanceof i?(u(this,"message","string"==typeof r?r:t),u(this,"name",n),void(Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this))):new i(r)}return y(i,Error),i}function e(n){return this instanceof e?(u(this,"name","OperationalError"),u(this,"message",n),this.cause=n,this.isOperational=!0,void(n instanceof Error?(u(this,"message",n.message),u(this,"stack",n.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor))):new e(n)}var c,l,a=n("./es5"),p=a.freeze,v=n("./util"),y=v.inherits,u=v.notEnumerableProp,w=r("Warning","warning"),b=r("CancellationError","cancellation error"),k=r("TimeoutError","timeout error"),o=r("AggregateError","aggregate error"),s,f,h,i;try{c=TypeError;l=RangeError}catch(d){c=r("TypeError","type error");l=r("RangeError","range error")}for(s="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),f=0;f<s.length;++f)"function"==typeof Array.prototype[s[f]]&&(o.prototype[s[f]]=Array.prototype[s[f]]);a.defineProperty(o.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0});o.prototype.isOperational=!0;h=0;o.prototype.toString=function(){var r=Array(4*h+1).join(" "),f="\n"+r+"AggregateError of:\n",n;for(h++,r=Array(4*h+1).join(" "),n=0;n<this.length;++n){for(var u=this[n]===this?"[Circular AggregateError]":this[n]+"",t=u.split("\n"),i=0;i<t.length;++i)t[i]=r+t[i];u=t.join("\n");f+=u+"\n"}return h--,f};y(e,Error);i=Error.__BluebirdErrorTypes__;i||(i=p({CancellationError:b,TimeoutError:k,OperationalError:e,RejectionError:e,AggregateError:o}),a.defineProperty(Error,"__BluebirdErrorTypes__",{value:i,writable:!1,enumerable:!1,configurable:!1}));t.exports={Error:Error,TypeError:c,RangeError:l,CancellationError:i.CancellationError,OperationalError:i.OperationalError,TimeoutError:i.TimeoutError,AggregateError:i.AggregateError,Warning:w}},{"./es5":10,"./util":21}],10:[function(n,t){var i=function(){return void 0===this}();if(i)t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:i,propertyIsWritable:function(n,t){var i=Object.getOwnPropertyDescriptor(n,t);return!(i&&!i.writable&&!i.set)}};else{var u={}.hasOwnProperty,f={}.toString,e={}.constructor.prototype,r=function(n){var t=[];for(var i in n)u.call(n,i)&&t.push(i);return t},o=function(n,t){return{value:n[t]}},s=function(n,t,i){return n[t]=i.value,n},h=function(n){return n},c=function(n){try{return Object(n).constructor.prototype}catch(t){return e}},l=function(n){try{return"[object Array]"===f.call(n)}catch(t){return!1}};t.exports={isArray:l,keys:r,names:r,defineProperty:s,getDescriptor:o,freeze:h,getPrototypeOf:c,isES5:i,propertyIsWritable:function(){return!0}}}},{}],11:[function(n,t){t.exports=function(t,i,r){function o(n,t,i){this.promise=n;this.type=t;this.handler=i;this.called=!1;this.cancelPromise=null}function h(n){this.finallyHandler=n}function e(n,t){return null!=n.cancelPromise?(arguments.length>1?n.cancelPromise._reject(t):n.cancelPromise._cancel(),n.cancelPromise=null,!0):!1}function c(){return u.call(this,this.promise._target()._settledValue())}function l(n){if(!e(this,n))return(f.e=n,f)}function u(n){var u=this.promise,y=this.handler,s,o,v;if(!this.called){if(this.called=!0,s=this.isFinallyHandler()?y.call(u._boundValue()):y.call(u._boundValue(),n),s===r)return s;if(void 0!==s&&(u._setReturnedNonUndefined(),o=i(s,u),o instanceof t)){if(null!=this.cancelPromise){if(o._isCancelled())return v=new a("late cancellation observer"),u._attachExtraTrace(v),f.e=v,f;o.isPending()&&o._attachCancellationCallback(new h(this))}return o._then(c,l,void 0,this,void 0)}}return u.isRejected()?(e(this),f.e=n,f):(e(this),n)}var s=n("./util"),a=t.CancellationError,f=s.errorObj,v=n("./catch_filter")(r);return o.prototype.isFinallyHandler=function(){return 0===this.type},h.prototype._resultCancelled=function(){e(this.finallyHandler)},t.prototype._passThrough=function(n,t,i,r){return"function"!=typeof n?this.then():this._then(i,r,void 0,new o(this,t,n),void 0)},t.prototype.lastly=t.prototype["finally"]=function(n){return this._passThrough(n,0,u,u)},t.prototype.tap=function(n){return this._passThrough(n,1,u)},t.prototype.tapCatch=function(n){var e=arguments.length,i,r,o,f,h;if(1===e)return this._passThrough(n,1,void 0,u);for(r=new Array(e-1),o=0,i=0;e-1>i;++i){if(f=arguments[i],!s.isObject(f))return t.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+s.classString(f)));r[o++]=f}return r.length=o,h=arguments[i],this._passThrough(v(r,h,this),1,void 0,u)},o}},{"./catch_filter":5,"./util":21}],12:[function(n,t){t.exports=function(t,i){var r=n("./util");r.canEvaluate;r.tryCatch;r.errorObj;t.join=function(){var n,t=arguments.length-1,u,r;return t>0&&"function"==typeof arguments[t]&&(n=arguments[t]),u=[].slice.call(arguments),n&&u.pop(),r=new i(u).promise(),void 0!==n?r.spread(n):r}}},{"./util":21}],13:[function(n,t){t.exports=function(t,i,r,u,f){var e=n("./util"),o=e.tryCatch;t.method=function(n){if("function"!=typeof n)throw new t.TypeError("expecting a function but got "+e.classString(n));return function(){var r=new t(i),u,e;return r._captureStackTrace(),r._pushContext(),u=o(n).apply(this,arguments),e=r._popContext(),f.checkForgottenReturns(u,e,"Promise.method",r),r._resolveFromSyncValue(u),r}};t.attempt=t["try"]=function(n){var r,s,h,c,l;return"function"!=typeof n?u("expecting a function but got "+e.classString(n)):(r=new t(i),r._captureStackTrace(),r._pushContext(),arguments.length>1?(f.deprecated("calling Promise.try with more than 1 argument"),h=arguments[1],c=arguments[2],s=e.isArray(h)?o(n).apply(c,h):o(n).call(c,h)):s=o(n)(),l=r._popContext(),f.checkForgottenReturns(s,l,"Promise.try",r),r._resolveFromSyncValue(s),r)};t.prototype._resolveFromSyncValue=function(n){n===e.errorObj?this._rejectCallback(n.e,!1):this._resolveCallback(n,!0)}}},{"./util":21}],14:[function(n,t){function u(n){return n instanceof Error&&r.getPrototypeOf(n)===Error.prototype}function f(n){var t,o,f,e;if(u(n)){for(t=new h(n),t.name=n.name,t.message=n.message,t.stack=n.stack,o=r.keys(n),f=0;f<o.length;++f)e=o[f],c.test(e)||(t[e]=n[e]);return t}return i.markAsOriginatingFromRejection(n),n}function e(n,t){return function(i,r){var u,e;null!==n&&(i?(u=f(o(i)),n._attachExtraTrace(u),n._reject(u)):t?(e=[].slice.call(arguments,1),n._fulfill(e)):n._fulfill(r),n=null)}}var i=n("./util"),o=i.maybeWrapAsError,s=n("./errors"),h=s.OperationalError,r=n("./es5"),c=/^(?:name|message|stack|cause)$/;t.exports=e},{"./errors":9,"./es5":10,"./util":21}],15:[function(n,t){t.exports=function(){function k(){}function st(n,t){if(null==n||n.constructor!==i)throw new h("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof t)throw new h("expecting a function but got "+r.classString(t));}function i(n){n!==u&&st(this,n);this._bitField=0;this._fulfillmentHandler0=void 0;this._rejectionHandler0=void 0;this._promise0=void 0;this._receiver0=void 0;this._resolveFromExecutor(n);this._promiseCreated();this._fireEvent("promiseCreated",this)}function ht(n){this.promise._resolveCallback(n)}function ct(n){this.promise._rejectCallback(n,!1)}function e(n){var t=new i(u);t._fulfillmentHandler0=n;t._rejectionHandler0=n;t._promise0=n;t._receiver0=n}var p=function(){return new h("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},l=function(){return new i.PromiseInspection(this._target())},a=function(n){return i.reject(new h(n))},d={},r=n("./util"),s,h,nt;r.setReflectHandler(l);var it=function(){var n=process.domain;return void 0===n?null:n},lt=function(){return null},g=function(){return{domain:it(),"async":null}},at=r.isNode&&r.nodeSupportsAsyncResource?n("async_hooks").AsyncResource:null,rt=function(){return{domain:it(),"async":new at("Bluebird::Promise")}},w=r.isNode?g:lt;r.notEnumerableProp(i,"_getContext",w);var vt=function(){w=rt;r.notEnumerableProp(i,"_getContext",rt)},yt=function(){w=g;r.notEnumerableProp(i,"_getContext",g)},ut=n("./es5"),ft=n("./async"),o=new ft;ut.defineProperty(i,"_async",{value:o});s=n("./errors");h=i.TypeError=s.TypeError;i.RangeError=s.RangeError;nt=i.CancellationError=s.CancellationError;i.TimeoutError=s.TimeoutError;i.OperationalError=s.OperationalError;i.RejectionError=s.OperationalError;i.AggregateError=s.AggregateError;var u=function(){},et={},tt={},c=n("./thenables")(i,u),v=n("./promise_array")(i,u,c,a,k),ot=n("./context")(i),f=(ot.create,n("./debuggability")(i,ot,vt,yt)),pt=(f.CapturedTrace,n("./finally")(i,c,tt)),wt=n("./catch_filter")(tt),bt=n("./nodeback"),y=r.errorObj,b=r.tryCatch;return i.prototype.toString=function(){return"[object Promise]"},i.prototype.caught=i.prototype["catch"]=function(n){var f=arguments.length,t,i,e,u;if(f>1){for(i=new Array(f-1),e=0,t=0;f-1>t;++t){if(u=arguments[t],!r.isObject(u))return a("Catch statement predicate: expecting an object but got "+r.classString(u));i[e++]=u}if(i.length=e,n=arguments[t],"function"!=typeof n)throw new h("The last argument to .catch() must be a function, got "+r.toString(n));return this.then(void 0,wt(i,n,this))}return this.then(void 0,n)},i.prototype.reflect=function(){return this._then(l,l,void 0,this,void 0)},i.prototype.then=function(n,t){if(f.warnings()&&arguments.length>0&&"function"!=typeof n&&"function"!=typeof t){var i=".then() only accepts functions but was passed: "+r.classString(n);arguments.length>1&&(i+=", "+r.classString(t));this._warn(i)}return this._then(n,t,void 0,void 0,void 0)},i.prototype.done=function(n,t){var i=this._then(n,t,void 0,void 0,void 0);i._setIsFinal()},i.prototype.spread=function(n){return"function"!=typeof n?a("expecting a function but got "+r.classString(n)):this.all()._then(n,void 0,void 0,et,void 0)},i.prototype.toJSON=function(){var n={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(n.fulfillmentValue=this.value(),n.isFulfilled=!0):this.isRejected()&&(n.rejectionReason=this.reason(),n.isRejected=!0),n},i.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new v(this).promise()},i.prototype.error=function(n){return this.caught(r.originatesFromRejection,n)},i.getNewLibraryCopy=t.exports,i.is=function(n){return n instanceof i},i.fromNode=i.fromCallback=function(n){var t=new i(u),f,r;return t._captureStackTrace(),f=arguments.length>1?!!Object(arguments[1]).multiArgs:!1,r=b(n)(bt(t,f)),r===y&&t._rejectCallback(r.e,!0),t._isFateSealed()||t._setAsyncGuaranteed(),t},i.all=function(n){return new v(n).promise()},i.cast=function(n){var t=c(n);return t instanceof i||(t=new i(u),t._captureStackTrace(),t._setFulfilled(),t._rejectionHandler0=n),t},i.resolve=i.fulfilled=i.cast,i.reject=i.rejected=function(n){var t=new i(u);return t._captureStackTrace(),t._rejectCallback(n,!0),t},i.setScheduler=function(n){if("function"!=typeof n)throw new h("expecting a function but got "+r.classString(n));return o.setScheduler(n)},i.prototype._then=function(n,t,f,e,s){var b=void 0!==s,c=b?s:new i(u),h=this._target(),a=h._bitField,y,v,l,p;return b||(c._propagateFrom(this,3),c._captureStackTrace(),void 0===e&&0!=(2097152&this._bitField)&&(e=0!=(50397184&a)?this._boundValue():h===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,c)),y=w(),0!=(50397184&a)?(p=h._settlePromiseCtx,0!=(33554432&a)?(l=h._rejectionHandler0,v=n):0!=(16777216&a)?(l=h._fulfillmentHandler0,v=t,h._unsetRejectionIsUnhandled()):(p=h._settlePromiseLateCancellationObserver,l=new nt("late cancellation observer"),h._attachExtraTrace(l),v=t),o.invoke(p,h,{handler:r.contextBind(y,v),promise:c,receiver:e,value:l})):h._addCallbacks(n,t,c,e,y),c},i.prototype._length=function(){return 65535&this._bitField},i.prototype._isFateSealed=function(){return 0!=(117506048&this._bitField)},i.prototype._isFollowing=function(){return 67108864==(67108864&this._bitField)},i.prototype._setLength=function(n){this._bitField=-65536&this._bitField|65535&n},i.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField;this._fireEvent("promiseFulfilled",this)},i.prototype._setRejected=function(){this._bitField=16777216|this._bitField;this._fireEvent("promiseRejected",this)},i.prototype._setFollowing=function(){this._bitField=67108864|this._bitField;this._fireEvent("promiseResolved",this)},i.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},i.prototype._isFinal=function(){return(4194304&this._bitField)>0},i.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},i.prototype._setCancelled=function(){this._bitField=65536|this._bitField;this._fireEvent("promiseCancelled",this)},i.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},i.prototype._setAsyncGuaranteed=function(){if(!o.hasCustomScheduler()){var n=this._bitField;this._bitField=n|(536870912&n)>>2^134217728}},i.prototype._setNoAsyncGuarantee=function(){this._bitField=-134217729&(536870912|this._bitField)},i.prototype._receiverAt=function(n){var t=0===n?this._receiver0:this[4*n-1];if(t!==d)return void 0===t&&this._isBound()?this._boundValue():t},i.prototype._promiseAt=function(n){return this[4*n-2]},i.prototype._fulfillmentHandlerAt=function(n){return this[4*n-4]},i.prototype._rejectionHandlerAt=function(n){return this[4*n-3]},i.prototype._boundValue=function(){},i.prototype._migrateCallback0=function(n){var i=(n._bitField,n._fulfillmentHandler0),r=n._rejectionHandler0,u=n._promise0,t=n._receiverAt(0);void 0===t&&(t=d);this._addCallbacks(i,r,u,t,null)},i.prototype._migrateCallbackAt=function(n,t){var r=n._fulfillmentHandlerAt(t),u=n._rejectionHandlerAt(t),f=n._promiseAt(t),i=n._receiverAt(t);void 0===i&&(i=d);this._addCallbacks(r,u,f,i,null)},i.prototype._addCallbacks=function(n,t,i,u,f){var e=this._length(),o;return(e>=65531&&(e=0,this._setLength(0)),0===e)?(this._promise0=i,this._receiver0=u,"function"==typeof n&&(this._fulfillmentHandler0=r.contextBind(f,n)),"function"==typeof t&&(this._rejectionHandler0=r.contextBind(f,t))):(o=4*e-4,this[o+2]=i,this[o+3]=u,"function"==typeof n&&(this[o+0]=r.contextBind(f,n)),"function"==typeof t&&(this[o+1]=r.contextBind(f,t))),this._setLength(e+1),e},i.prototype._proxy=function(n,t){this._addCallbacks(void 0,void 0,t,n,null)},i.prototype._resolveCallback=function(n,t){var u,r,f,o,e,s;if(0==(117506048&this._bitField)){if(n===this)return this._rejectCallback(p(),!1);if(u=c(n,this),!(u instanceof i))return this._fulfill(n);if(t&&this._propagateFrom(u,2),r=u._target(),r===this)return void this._reject(p());if(f=r._bitField,0==(50397184&f)){for(o=this._length(),o>0&&r._migrateCallback0(this),e=1;o>e;++e)r._migrateCallbackAt(this,e);this._setFollowing();this._setLength(0);this._setFollowee(u)}else 0!=(33554432&f)?this._fulfill(r._value()):0!=(16777216&f)?this._reject(r._reason()):(s=new nt("late cancellation observer"),r._attachExtraTrace(s),this._reject(s))}},i.prototype._rejectCallback=function(n,t,i){var u=r.ensureErrorObject(n),e=u===n,o;e||i||!f.warnings()||(o="a promise was rejected with a non-error: "+r.classString(n),this._warn(o,!0));this._attachExtraTrace(u,t?e:!1);this._reject(n)},i.prototype._resolveFromExecutor=function(n){var t,i,r;n!==u&&(t=this,this._captureStackTrace(),this._pushContext(),i=!0,r=this._execute(n,function(n){t._resolveCallback(n)},function(n){t._rejectCallback(n,i)}),i=!1,this._popContext(),void 0!==r&&t._rejectCallback(r,!0))},i.prototype._settlePromiseFromHandler=function(n,t,i,u){var o=u._bitField,e,s;0==(65536&o)&&(u._pushContext(),t===et?i&&"number"==typeof i.length?e=b(n).apply(this._boundValue(),i):(e=y,e.e=new h("cannot .spread() a non-array: "+r.classString(i))):e=b(n).call(t,i),s=u._popContext(),o=u._bitField,0==(65536&o)&&(e===tt?u._reject(i):e===y?u._rejectCallback(e.e,!1):(f.checkForgottenReturns(e,s,"",u,this),u._resolveCallback(e))))},i.prototype._target=function(){for(var n=this;n._isFollowing();)n=n._followee();return n},i.prototype._followee=function(){return this._rejectionHandler0},i.prototype._setFollowee=function(n){this._rejectionHandler0=n},i.prototype._settlePromise=function(n,t,r,u){var f=n instanceof i,e=this._bitField,o=0!=(134217728&e);0!=(65536&e)?(f&&n._invokeInternalOnCancel(),r instanceof pt&&r.isFinallyHandler()?(r.cancelPromise=n,b(t).call(r,u)===y&&n._reject(y.e)):t===l?n._fulfill(l.call(r)):r instanceof k?r._promiseCancelled(n):f||n instanceof v?n._cancel():r.cancel()):"function"==typeof t?f?(o&&n._setAsyncGuaranteed(),this._settlePromiseFromHandler(t,r,u,n)):t.call(r,u,n):r instanceof k?r._isResolved()||(0!=(33554432&e)?r._promiseFulfilled(u,n):r._promiseRejected(u,n)):f&&(o&&n._setAsyncGuaranteed(),0!=(33554432&e)?n._fulfill(u):n._reject(u))},i.prototype._settlePromiseLateCancellationObserver=function(n){var r=n.handler,t=n.promise,f=n.receiver,u=n.value;"function"==typeof r?t instanceof i?this._settlePromiseFromHandler(r,f,u,t):r.call(f,u,t):t instanceof i&&t._reject(u)},i.prototype._settlePromiseCtx=function(n){this._settlePromise(n.promise,n.handler,n.receiver,n.value)},i.prototype._settlePromise0=function(n,t){var i=this._promise0,r=this._receiverAt(0);this._promise0=void 0;this._receiver0=void 0;this._settlePromise(i,n,r,t)},i.prototype._clearCallbackDataAtIndex=function(n){var t=4*n-4;this[t+2]=this[t+3]=this[t+0]=this[t+1]=void 0},i.prototype._fulfill=function(n){var t=this._bitField,i;if(!((117506048&t)>>>16)){if(n===this)return i=p(),this._attachExtraTrace(i),this._reject(i);this._setFulfilled();this._rejectionHandler0=n;(65535&t)>0&&(0!=(134217728&t)?this._settlePromises():o.settlePromises(this),this._dereferenceTrace())}},i.prototype._reject=function(n){var t=this._bitField;if(!((117506048&t)>>>16))return this._setRejected(),this._fulfillmentHandler0=n,this._isFinal()?o.fatalError(n,r.isNode):void((65535&t)>0?o.settlePromises(this):this._ensurePossibleRejectionHandled())},i.prototype._fulfillPromises=function(n,t){for(var i=1;n>i;i++){var r=this._fulfillmentHandlerAt(i),u=this._promiseAt(i),f=this._receiverAt(i);this._clearCallbackDataAtIndex(i);this._settlePromise(u,r,f,t)}},i.prototype._rejectPromises=function(n,t){for(var i=1;n>i;i++){var r=this._rejectionHandlerAt(i),u=this._promiseAt(i),f=this._receiverAt(i);this._clearCallbackDataAtIndex(i);this._settlePromise(u,r,f,t)}},i.prototype._settlePromises=function(){var n=this._bitField,t=65535&n,i,r;t>0&&(0!=(16842752&n)?(i=this._fulfillmentHandler0,this._settlePromise0(this._rejectionHandler0,i,n),this._rejectPromises(t,i)):(r=this._rejectionHandler0,this._settlePromise0(this._fulfillmentHandler0,r,n),this._fulfillPromises(t,r)),this._setLength(0));this._clearCancellationData()},i.prototype._settledValue=function(){var n=this._bitField;return 0!=(33554432&n)?this._rejectionHandler0:0!=(16777216&n)?this._fulfillmentHandler0:void 0},"undefined"!=typeof Symbol&&Symbol.toStringTag&&ut.defineProperty(i.prototype,Symbol.toStringTag,{get:function(){return"Object"}}),i.defer=i.pending=function(){f.deprecated("Promise.defer","new Promise");var n=new i(u);return{promise:n,resolve:ht,reject:ct}},r.notEnumerableProp(i,"_makeSelfResolutionError",p),n("./method")(i,u,c,a,f),n("./bind")(i,u,c,f),n("./cancel")(i,v,a,f),n("./direct_resolve")(i),n("./synchronous_inspection")(i),n("./join")(i,v,c,u,o),i.Promise=i,i.version="3.7.2",r.toFastProperties(i),r.toFastProperties(i.prototype),e({a:1}),e({b:2}),e({c:3}),e(1),e(function(){}),e(void 0),e(!1),e(new i(u)),f.setBounds(ft.firstLineError,r.lastLineError),i}},{"./async":1,"./bind":2,"./cancel":4,"./catch_filter":5,"./context":6,"./debuggability":7,"./direct_resolve":8,"./errors":9,"./es5":10,"./finally":11,"./join":12,"./method":13,"./nodeback":14,"./promise_array":16,"./synchronous_inspection":19,"./thenables":20,"./util":21,async_hooks:void 0}],16:[function(n,t){t.exports=function(t,i,r,u,f){function s(n){switch(n){case-2:return[];case-3:return{};case-6:return new Map}}function e(n){var r=this._promise=new t(i);n instanceof t&&(r._propagateFrom(n,3),n.suppressUnhandledRejections());r._setOnCancel(this);this._values=n;this._length=0;this._totalResolved=0;this._init(void 0,-2)}var o=n("./util");return o.isArray,o.inherits(e,f),e.prototype.length=function(){return this._length},e.prototype.promise=function(){return this._promise},e.prototype._init=function h(n,i){var f=r(this._values,this._promise),e,c;if(f instanceof t){if(f=f._target(),e=f._bitField,this._values=f,0==(50397184&e))return this._promise._setAsyncGuaranteed(),f._then(h,this._reject,void 0,this,i);if(0==(33554432&e))return 0!=(16777216&e)?this._reject(f._reason()):this._cancel();f=f._value()}return(f=o.asArray(f),null===f)?(c=u("expecting an array or an iterable object but got "+o.classString(f)).reason(),void this._promise._rejectCallback(c,!1)):0===f.length?void(-5===i?this._resolveEmptyArray():this._resolve(s(i))):void this._iterate(f)},e.prototype._iterate=function(n){var o=this.getActualLength(n.length),i;this._length=o;this._values=this.shouldCopyValues()?new Array(o):this._values;for(var s=this._promise,e=!1,f=null,u=0;o>u;++u)i=r(n[u],s),i instanceof t?(i=i._target(),f=i._bitField):f=null,e?null!==f&&i.suppressUnhandledRejections():null!==f?0==(50397184&f)?(i._proxy(this,u),this._values[u]=i):e=0!=(33554432&f)?this._promiseFulfilled(i._value(),u):0!=(16777216&f)?this._promiseRejected(i._reason(),u):this._promiseCancelled(u):e=this._promiseFulfilled(i,u);e||s._setAsyncGuaranteed()},e.prototype._isResolved=function(){return null===this._values},e.prototype._resolve=function(n){this._values=null;this._promise._fulfill(n)},e.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},e.prototype._reject=function(n){this._values=null;this._promise._rejectCallback(n,!1)},e.prototype._promiseFulfilled=function(n,t){this._values[t]=n;var i=++this._totalResolved;return i>=this._length?(this._resolve(this._values),!0):!1},e.prototype._promiseCancelled=function(){return this._cancel(),!0},e.prototype._promiseRejected=function(n){return this._totalResolved++,this._reject(n),!0},e.prototype._resultCancelled=function(){var n,i;if(!this._isResolved())if(n=this._values,this._cancel(),n instanceof t)n.cancel();else for(i=0;i<n.length;++i)n[i]instanceof t&&n[i].cancel()},e.prototype.shouldCopyValues=function(){return!0},e.prototype.getActualLength=function(n){return n},e}},{"./util":21}],17:[function(n,t){function r(n,t,i,r,u){for(var f=0;u>f;++f)i[f+r]=n[f+t],n[f+t]=void 0}function i(n){this._capacity=n;this._length=0;this._front=0}i.prototype._willBeOverCapacity=function(n){return this._capacity<n};i.prototype._pushOne=function(n){var t=this.length(),i;this._checkCapacity(t+1);i=this._front+t&this._capacity-1;this[i]=n;this._length=t+1};i.prototype.push=function(n,t,i){var r=this.length()+3,u,f;if(this._willBeOverCapacity(r))return this._pushOne(n),this._pushOne(t),void this._pushOne(i);u=this._front+r-3;this._checkCapacity(r);f=this._capacity-1;this[u+0&f]=n;this[u+1&f]=t;this[u+2&f]=i;this._length=r};i.prototype.shift=function(){var n=this._front,t=this[n];return this[n]=void 0,this._front=n+1&this._capacity-1,this._length--,t};i.prototype.length=function(){return this._length};i.prototype._checkCapacity=function(n){this._capacity<n&&this._resizeTo(this._capacity<<1)};i.prototype._resizeTo=function(n){var t=this._capacity;this._capacity=n;var i=this._front,u=this._length,f=i+u&t-1;r(this,0,this,t,f)};t.exports=i},{}],18:[function(n,t){var i,r=n("./util"),s=function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n");},u=r.getNativePromise(),f,e,o;r.isNode&&"undefined"==typeof MutationObserver?(f=global.setImmediate,e=process.nextTick,i=r.isRecentNode?function(n){f.call(global,n)}:function(n){e.call(process,n)}):"function"==typeof u&&"function"==typeof u.resolve?(o=u.resolve(),i=function(n){o.then(n)}):i="undefined"!=typeof MutationObserver&&("undefined"==typeof window||!window.navigator||!window.navigator.standalone&&!window.cordova)&&"classList"in document.documentElement?function(){var t=document.createElement("div"),i={attributes:!0},n=!1,r=document.createElement("div"),f=new MutationObserver(function(){t.classList.toggle("foo");n=!1}),u;return f.observe(r,i),u=function(){n||(n=!0,r.classList.toggle("foo"))},function(n){var r=new MutationObserver(function(){r.disconnect();n()});r.observe(t,i);u()}}():"undefined"!=typeof setImmediate?function(n){setImmediate(n)}:"undefined"!=typeof setTimeout?function(n){setTimeout(n,0)}:s;t.exports=i},{"./util":21}],19:[function(n,t){t.exports=function(n){function t(n){void 0!==n?(n=n._target(),this._bitField=n._bitField,this._settledValueField=n._isFateSealed()?n._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}t.prototype._settledValue=function(){return this._settledValueField};var i=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},r=t.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},u=t.prototype.isFulfilled=function(){return 0!=(33554432&this._bitField)},f=t.prototype.isRejected=function(){return 0!=(16777216&this._bitField)},e=t.prototype.isPending=function(){return 0==(50397184&this._bitField)},o=t.prototype.isResolved=function(){return 0!=(50331648&this._bitField)};t.prototype.isCancelled=function(){return 0!=(8454144&this._bitField)};n.prototype.__isCancelled=function(){return 65536==(65536&this._bitField)};n.prototype._isCancelled=function(){return this._target().__isCancelled()};n.prototype.isCancelled=function(){return 0!=(8454144&this._target()._bitField)};n.prototype.isPending=function(){return e.call(this._target())};n.prototype.isRejected=function(){return f.call(this._target())};n.prototype.isFulfilled=function(){return u.call(this._target())};n.prototype.isResolved=function(){return o.call(this._target())};n.prototype.value=function(){return i.call(this._target())};n.prototype.reason=function(){var n=this._target();return n._unsetRejectionIsUnhandled(),r.call(n)};n.prototype._value=function(){return this._settledValue()};n.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()};n.PromiseInspection=t}},{}],20:[function(n,t){t.exports=function(t,i){function f(n,u){var e,f;if(c(n)){if(n instanceof t)return n;if(e=o(n),e===r)return u&&u._pushContext(),f=t.reject(e.e),u&&u._popContext(),f;if("function"==typeof e)return s(n)?(f=new t(i),n._then(f._fulfill,f._reject,void 0,f,null),f):h(n,e,u)}return n}function e(n){return n.then}function o(n){try{return e(n)}catch(t){return r.e=t,r}}function s(n){try{return l.call(n,"_promise0")}catch(t){return!1}}function h(n,f,e){function c(n){o&&(o._resolveCallback(n),o=null)}function l(n){o&&(o._rejectCallback(n,s,!0),o=null)}var o=new t(i),a=o,s,h;return e&&e._pushContext(),o._captureStackTrace(),e&&e._popContext(),s=!0,h=u.tryCatch(f).call(n,c,l),s=!1,o&&h===r&&(o._rejectCallback(h.e,!0,!0),o=null),a}var u=n("./util"),r=u.errorObj,c=u.isObject,l={}.hasOwnProperty;return f}},{"./util":21}],21:[function(n,t){function w(){try{var n=h;return h=null,n.apply(this,arguments)}catch(t){return s.e=t,s}}function b(n){return h=n,w}function f(n){return null==n||n===!0||n===!1||"string"==typeof n||"number"==typeof n}function k(n){return"function"==typeof n||"object"==typeof n&&null!==n}function d(n){return f(n)?new Error(u(n)):n}function g(n,t){for(var u=n.length,r=new Array(u+1),i=0;u>i;++i)r[i]=n[i];return r[i]=t,r}function nt(n,t,r){if(!i.isES5)return{}.hasOwnProperty.call(n,t)?n[t]:void 0;var u=Object.getOwnPropertyDescriptor(n,t);if(null!=u)return null==u.get&&null==u.set?u.value:r}function c(n,t,r){if(f(n))return n;var u={value:r,configurable:!0,enumerable:!1,writable:!0};return i.defineProperty(n,t,u),n}function tt(n){throw n;}function it(n){try{if("function"==typeof n){var t=i.names(n.prototype),r=i.isES5&&t.length>1,u=t.length>0&&!(1===t.length&&"constructor"===t[0]),f=wt.test(n+"")&&i.names(n).length>0;if(r||u||f)return!0}return!1}catch(e){return!1}}function rt(n){function t(){}function i(){return typeof r.foo}t.prototype=n;var r=new t;return i(),i(),n}function ut(n){return bt.test(n)}function ft(n,t,i){for(var u=new Array(n),r=0;n>r;++r)u[r]=t+r+i;return u}function u(n){try{return n+""}catch(t){return"[no string representation]"}}function l(n){return n instanceof Error||null!==n&&"object"==typeof n&&"string"==typeof n.message&&"string"==typeof n.name}function et(n){try{c(n,"isOperational",!0)}catch(t){}}function ot(n){return null==n?!1:n instanceof Error.__BluebirdErrorTypes__.OperationalError||n.isOperational===!0}function e(n){return l(n)&&i.propertyIsWritable(n,"stack")}function o(n){return{}.toString.call(n)}function st(n,t,r){for(var f,e=i.names(n),u=0;u<e.length;++u)if(f=e[u],r(f))try{i.defineProperty(t,f,i.getDescriptor(n,f))}catch(o){}}function ht(n){if(y)return process.env[n]}function ct(){if("function"==typeof Promise)try{var n=new Promise(function(){});if("[object Promise]"===o(n))return Promise}catch(t){}}function lt(n,t){var i,r;return null===n||"function"!=typeof t||t===p?t:(null!==n.domain&&(t=n.domain.bind(t)),i=n.async,null!==i&&(r=t,t=function(){var n=new Array(2).concat([].slice.call(arguments));return n[0]=r,n[1]=this,i.runInAsyncScope.apply(i,n)}),t)}var i=n("./es5"),at="undefined"==typeof navigator,s={e:{}},h,vt="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0!==this?this:null,yt=function(n,t){function i(){this.constructor=n;this.constructor$=t;for(var i in t.prototype)r.call(t.prototype,i)&&"$"!==i.charAt(i.length-1)&&(this[i+"$"]=t.prototype[i])}var r={}.hasOwnProperty;return i.prototype=t.prototype,n.prototype=new i,n.prototype},pt=function(){var n=[Array.prototype,Object.prototype,Function.prototype],r=function(t){for(var i=0;i<n.length;++i)if(n[i]===t)return!0;return!1},u,t;return i.isES5?(u=Object.getOwnPropertyNames,function(n){for(var h,e,t,o,f=[],s=Object.create(null);null!=n&&!r(n);){try{h=u(n)}catch(c){return f}for(e=0;e<h.length;++e)t=h[e],s[t]||(s[t]=!0,o=Object.getOwnPropertyDescriptor(n,t),null!=o&&null==o.get&&null==o.set&&f.push(t));n=i.getPrototypeOf(n)}return f}):(t={}.hasOwnProperty,function(i){var f,u,e;if(r(i))return[];f=[];n:for(u in i)if(t.call(i,u))f.push(u);else{for(e=0;e<n.length;++e)if(t.call(n[e],u))continue n;f.push(u)}return f})}(),wt=/this\s*\.\s*\S+\s*=/,bt=/^[a-z$_][a-z$_0-9]*$/i,kt=function(){return"stack"in new Error?function(n){return e(n)?n:new Error(u(n))}:function(n){if(e(n))return n;try{throw new Error(u(n));}catch(t){return t}}}(),a=function(n){return i.isArray(n)?n:null},v;"undefined"!=typeof Symbol&&Symbol.iterator&&(v="function"==typeof Array.from?function(n){return Array.from(n)}:function(n){for(var t,i=[],r=n[Symbol.iterator]();!(t=r.next()).done;)i.push(t.value);return i},a=function(n){return i.isArray(n)?n:null!=n&&"function"==typeof n[Symbol.iterator]?v(n):null});var dt="undefined"!=typeof process&&"[object process]"===o(process).toLowerCase(),y="undefined"!=typeof process&&"undefined"!=typeof process.env,p,r={setReflectHandler:function(n){p=n},isClass:it,isIdentifier:ut,inheritedDataKeys:pt,getDataPropertyOrDefault:nt,thrower:tt,isArray:i.isArray,asArray:a,notEnumerableProp:c,isPrimitive:f,isObject:k,isError:l,canEvaluate:at,errorObj:s,tryCatch:b,inherits:yt,withAppended:g,maybeWrapAsError:d,toFastProperties:rt,filledRange:ft,toString:u,canAttachTrace:e,ensureErrorObject:kt,originatesFromRejection:ot,markAsOriginatingFromRejection:et,classString:o,copyDescriptors:st,isNode:dt,hasEnvVariables:y,env:ht,global:vt,getNativePromise:ct,contextBind:lt};r.isRecentNode=r.isNode&&function(){var n;return process.versions&&process.versions.node?n=process.versions.node.split(".").map(Number):process.version&&(n=process.version.split(".").map(Number)),0===n[0]&&n[1]>10||n[0]>0}();r.nodeSupportsAsyncResource=r.isNode&&function(){var t=!1,i;try{i=n("async_hooks").AsyncResource;t="function"==typeof i.prototype.runInAsyncScope}catch(r){t=!1}return t}();r.isNode&&r.toFastProperties(process);try{throw new Error;}catch(gt){r.lastLineError=gt}t.exports=r},{"./es5":10,async_hooks:void 0}]},{},[3])(3)});"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise);t.Promise=Promise;t.nativePromise||(t.nativePromise=t.Promise)}}(Dynamsoft),function(n){var t=20200717;n._navInfo_ver&&n.isNumber(n._navInfo_ver)&&n._navInfo_ver>=t||(n._navInfo_ver=t,n.getNavInfoSync=function(){var f=n.win,l=n.doc,i=l.location.protocol,a=i==="https:",v=i!=="https:"&&i!=="http:",r=!1,e=!1,o=!0,s=!0,u=!1,h=0,c=0,y=f.JSON,t;return n.getNavInfo(),"userAgentData"in navigator?u=navigator.userAgentData.mobile:(t=Dynamsoft.navInfo,r=t.bIE,e=t.bEdge,s=t.bGecko,u=t.bMobile||t.bPad||t.bChromeOS,r&&(h=t.strBrowserVersion,c=t.IEMode),o=t.bHTML5Edition),{host:f,bSSL:a,bFileSystem:v,bIE:r,bEdge:e,bGecko:s,bMobile:u,IEVersion:h,IEMode:c,bHTML5Edition:o,nodejs:!1}},n.getNavInfoByUserAgent=function(t,i){var h=!1,s=!0,ti=n.win,l=n.doc,yt=l&&l.documentElement,r,u=t.toLowerCase(),p=i.toLowerCase(),pt=/cros/.test(u),wt=/android/g.test(u),d=/iphone/g.test(u)||/iphone/g.test(p),ii=/macintosh/.test(u),g=/ipad/g.test(u)||(ii||p=="macintel")&&navigator.maxTouchPoints&&navigator.maxTouchPoints>1,w=/ucweb|ucbrowser/g.test(u),nt=!w&&/nexus/g.test(u)&&/version\/[\d.]+.*safari\//g.test(u),tt=/playbook/g.test(u),ri=/hp-tablet/g.test(u),it=/blackberry|bb10/g.test(u),bt=/symbian/g.test(u),kt=/windows phone/g.test(u),ot=tt||g||ri,st=d||nt||it||bt||kt||wt,ht=!st&&!ot&&!pt,rt=ht&&/win32|win64|windows/.test(p),ui=rt&&/win64|x64/.test(u),dt=ht&&/mac68k|macppc|macintosh|macintel/.test(u),fi=ht&&/linux/.test(p),ei=p=="win64"||/wow64|x86_64|win64|x64/.test(u),oi=/wow64/g.test(u),ct=u.indexOf("msie "),lt=u.indexOf("trident"),at=u.indexOf("rv:"),vt=h,ut=/opera|opr/g.test(u),si=/360se/g.test(u),hi=/maxthon/g.test(u),ci=/tencenttraveler|qqbrowser/g.test(u),li=/the world/g.test(u),ai=/metasr/g.test(u),vi=/avant/g.test(u),b=/firefox|fxios/g.test(u),a=!b&&/edge\/|edga\/|edgios\/|edg\//g.test(u),ft=!(it||tt||w||ut||a)&&/chrome|crios/g.test(u),c=rt&&!b&&!a&&!ft&&(ct!=-1||lt!=-1||at!=-1),k="",et=0,yi=/gecko/g.test(u),o=st||ot,f="",gt=h,ni=ti.JSON,e,v,y;return!(dt||d||g||rt||it||tt||nt)||w||ut||a||c||b||(r=u.match(/version\/([\d.]+).*safari\//),r&&(it||tt||nt||(vt=s,ft=h),f=r[1])),a?(e=u.indexOf("edge/"),e>-1?e+=5:(e=u.indexOf("edg/"),e>-1?e+=4:(e=u.indexOf("edga/"),e>-1?e+=5:(e=u.indexOf("edgios/"),e>-1&&(e+=7)))),e>-1&&(f=u.slice(e),r=f.indexOf(" "),r>-1&&(f=f.slice(0,r))),o=s):b?(r=u.indexOf("firefox/"),o=s,r>-1?(r=u.slice(r+8),v=r.indexOf(" "),v>-1&&(r=r.slice(0,v)),f=r,v=r.indexOf("."),v>-1&&(r=f.slice(0,v)),r<27&&(o=h)):(d||g)&&(r=u.indexOf("fxios/"),r>-1&&(r=u.slice(r+6),r=r.slice(0,r.indexOf(" ")),f=r))):c?(ct!=-1?(r=u.slice(ct+5),r=r.slice(0,r.indexOf(";")),k=r):at!=-1?(r=u.slice(at+3),r=r.slice(0,r.indexOf(";")),r=r.slice(0,r.indexOf(")")),k=r):lt!=-1&&(r=u.slice(lt+7),r=r.slice(0,r.indexOf(";")),k=r),(k===""||k>8)&&(o=s),f=r):vt?(r=f.indexOf("."),o=s,r>-1&&(r=f.slice(0,r),r<7&&(o=h))):w?(r=u.indexOf("ucweb"),r>-1?f=u.slice(r+5):(r=u.indexOf("ucbrowser/"),r>-1&&(f=u.slice(r+10),r=f.indexOf(" "),r>-1&&(f=f.slice(0,r)))),o=s):ut?(r=u.indexOf("version/"),r>-1?f=u.slice(r+8):(r=u.indexOf("opr/"),r>-1&&(f=u.slice(r+4))),o=s):bt?(r=u.indexOf("browserng/"),r>-1&&(f=u.slice(r+10)),o=s):kt?(r=u.indexOf("iemobile/"),r>-1&&(f=u.slice(r+9)),o=s):ft&&(y=u.indexOf("chrome/"),y>-1?(f=u.slice(y+7),r=f.indexOf(" "),r>-1&&(f=f.slice(0,r))):(y=u.indexOf("crios/"),y>-1&&(f=u.slice(y+6),r=f.indexOf(" "),r>-1&&(f=f.slice(0,r)))),o=s,r=f.indexOf("."),r>-1&&(r=f.slice(0,r),r<27&&(o=h))),(a||c)&&(l.documentMode?et=l.documentMode:(et=5,l.compatMode&&l.compatMode=="CSS1Compat"&&(et=7))),yt&&yt.querySelector&&(!c||c&&f>8)&&(gt=s),c&&f<9&&(ni=null),{bWin:rt,bMac:dt,bLinux:fi,bMobile:st,bPad:ot,bChromeOS:pt,bAndroid:wt,biPhone:d,biPad:g,bWin64:ui,bWOW64:oi,bOSx64:ei,bIE:c,bEdge:a,bChrome:ft,bFirefox:b,bSafari:vt,bOpera:ut,bNexus:nt,bUC:w,b360SE:si,bMaxthon:hi,bTencentTraveler:ci,bTheWorld:li,bMetaSr:ai,bAvant:vi,bGecko:yi,bHTML5Edition:o,strBrowserVersion:f,IEMode:et,bQuerySelectorSupported:gt,nativeJson:ni,scrollBarWidth:h}},n.getNavInfoByUAData=function(t){var i=function(t){var i=navigator.userAgentData,c=i.mobile,s,r,u=t.platform.toLowerCase(),l=t.platformVersion,f=t.architecture.toLowerCase(),e=!1,h=u.indexOf("mac")>=0,o;return"brands"in i&&n.isArray(i.brands)?(s=i.brands[0].brand.toLowerCase(),r=i.brands[0].version):"uaList"in i&&n.isArray(i.uaList)&&(s=i.uaList[0].brand.toLowerCase(),r=i.uaList[0].version),h?(o=l.split("_"),o.length>0&&o[0]>=15&&(e=!0)):(f.indexOf("win64")>=0||f.indexOf("x86_64")>=0||f.indexOf("x64")>=0)&&(e=!0),{bWin:u=="windows",bMac:h,bLinux:u=="linux",bAndroid:!1,bMobile:c,bPad:!1,bChromeOS:!1,bOSx64:e,bIE:!1,bEdge:!1,bChrome:!0,bFirefox:!1,bSafari:!1,bOpera:!1,bGecko:!0,bHTML5Edition:!0,strBrowserVersion:r,IEMode:!1,bQuerySelectorSupported:!0,nativeJson:!0,scrollBarWidth:!1}};return t?Promise.resolve(function(){return i(t)}):navigator.userAgentData.getHighEntropyValues(["platform","platformVersion","architecture"]).then(i)},n.asyncGetNavInfo=function(){if(Dynamsoft.navInfo)return Promise.resolve(Dynamsoft.navInfo);if("userAgentData"in navigator)return n.getNavInfoByUAData().then(function(n){return Dynamsoft.navInfo=n,n});var t=navigator;return Dynamsoft.navInfo=n.getNavInfoByUserAgent(t.userAgent,t.platform),Promise.resolve(Dynamsoft.navInfo)},n.getNavInfo=function(){if(Dynamsoft.navInfo)return Dynamsoft.navInfo;if("userAgentData"in navigator)return n.getNavInfoByUAData().then(function(n){Dynamsoft.navInfo=n}),!1;var t=navigator;return Dynamsoft.navInfo=n.getNavInfoByUserAgent(t.userAgent,t.platform),Dynamsoft.navInfo},Dynamsoft.navInfoSync=n.getNavInfoSync())}(Dynamsoft.Lib),function(n){var i=n.Lib,r=n.navInfoSync,f=20200521,u,t;if(!i._ls_ver||!i.isNumber(i._ls_ver)||!(i._ls_ver>=f)){if(i._ls_ver=f,u=!1,t=!1,(!r.bEdge||!r.bFileSystem)&&(!r.bIE||!(r.IEVersion<8)))try{t=window.localStorage;u=t?!0:!1}catch(e){t=!1}i.LS={isSupportLS:function(){return u},item:function(n,i,r){var u=null;return this.isSupportLS()?(i?(t.setItem(n,i),u=i):u=t.getItem(n),u===null)?r:u:r},removeItem:function(n){if(this.isSupportLS())t.removeItem(n);else return!1;return!0}}}}(Dynamsoft),function(n){function b(){for(var t=0;t<f.length;t++)try{f[t](n)}catch(i){n.log(i.stack||i,"error");setTimeout(function(){throw i;},0)}}function k(){var r,u,f,h,y,w;if(!t||t.readyState===v){n.checkDomReady();return}if(o(i,a,n.checkDomReady),e)r=function(){s(t,c,r);n.checkDomReady()},o(t,c,r);else{u=function(){t.readyState===v&&(s(t,l,u),n.checkDomReady())};o(t,l,u);h=t&&t.documentElement;y=h&&h.doScroll;try{f=i.frameElement===null}catch(b){f=!1}y&&f&&(w=function(){try{y("left");setTimeout(n.checkDomReady,30)}catch(t){setTimeout(w,p)}},w())}}var h=20200708;if(!n._utilities_ver||!(n._utilities_ver>=h)){n._utilities_ver=h;var r=Array.prototype,i=n.win,t=n.doc,y=Dynamsoft.navInfoSync,d=n.mix,g=r.indexOf,nt=r.lastIndexOf,tt=r.filter,it=r.every,rt=r.some,ut=r.map,ft=n.getLogger(),et=i.location,u=0,f=[],p=40,w=/\S/,e=!!(t&&t.addEventListener),c="DOMContentLoaded",l="readystatechange",a="load",v="complete",o=e?function(n,t,i){n.addEventListener(t,i,!1)}:function(n,t,i){n.attachEvent("on"+t,i)},s=e?function(n,t,i){n.removeEventListener(t,i,!1)}:function(n,t,i){n.detachEvent("on"+t,i)};if(n.mix(n,{isWindow:function(n){return n!=null&&n==n.window},globalEval:function(n){n&&w.test(n)&&(i.execScript?i.execScript(n):function(n){i.eval.call(i,n)}(n))},domReady:function(t){if(u)try{t(n)}catch(i){n.log(i.stack||i,"error");setTimeout(function(){throw i;},0)}else f.push(t);return this}}),n.ready=n.domReady,n.checkDomReady=function(){u||(u=1,n.asyncGetNavInfo().then(function(){t&&!y.nodejs&&s(i,a,n.checkDomReady);b()}))},k(),Dynamsoft.navInfoSync.bIE)try{t.execCommand("BackgroundImageCache",!1,!0)}catch(ot){}}}(Dynamsoft.Lib),function(n){var r=20200521,i,t;n._domUtil_ver&&n._domUtil_ver>=r||(n._domUtil_ver=r,i="",t="none",n.mix(n,{get:function(t){return n.doc.getElementById(t)},hide:function(i){var r=n.isString(i)?n.get(i):i;r&&(r.style.display=t)},show:function(t){var r=n.isString(t)?n.get(t):t;r&&(r.style.display=i)},toggle:function(r){var u=n.isString(r)?n.get(r):r;u&&(u.style.display=u.style.display===t?i:t)},empty:function(n){if(n)while(n.firstChild)n.removeChild(n.firstChild)}}))}(Dynamsoft.Lib),function(n){var t=n.Lib,i=20200521;t._color_ver&&t.isNumber(t._color_ver)&&t._color_ver>=i||(t._color_ver=i,t.colorStrToInt=function(n){var r="0x",t,i,u;if(/^(rgb|RGB)/.test(n)){for(u=n.replace(/[^\d,.]/g,"").split(","),i=0;i<3;++i)t=Number(u[i]).toString(16),t.length==1&&(t="0"+t),r+=t;u.length==4?(t=Math.round(Number(u[i])*255).toString(16),t.length==1&&(t="0"+t),r+=t):r+="ff"}else if(n=="transparent")r+="00000000";else if(/^#[0-9a-fA-f]{6}$/.test(n))r+=n.replace(/#/,"")+"ff";else if(/^#[0-9a-fA-f]{3}$/.test(n)){for(i=0;i<3;++i)r+=n[i]+n[i];r+="ff"}else r="-1";return Number(r)},t.IntToColorStr=function(n){if(n>4294967295||n<0)return null;var t;if(Dynamsoft.navInfoSync.bHTML5Edition)t="rgba("+Math.floor(n/16777216)+","+Math.floor(n/65536)%256+","+Math.floor(n/256)%256+","+n%256/255+")";else if(n%256==0)t="transparent";else{for(t=Math.floor(n/256).toString(16);t.length!=6;)t="0"+t;t="#"+t}return t})}(Dynamsoft),function(n,t){var i=n.Lib,r=20200716;i._ajax_ver&&i.isNumber(i._ajax_ver)&&i._ajax_ver>=r||(i._ajax_ver=r,i.asyncGetNavInfo().then(function(n){function k(){}function v(n){if(!n||!i.isString(n.url)){i.log("the url is error.");return}var t=new k;return t.sendInternal(n),t}var u=n.bIE&&parseInt(n.strBrowserVersion)<=9,rt=n.bIE&&parseInt(n.strBrowserVersion)<=10,r=i.win,f=i.each,s=1,h=2,d=3,c=200,ut=300,g=304,ft=500,et="open error: ",ot="send error: ",l=new i.Uri(location.href),nt=l&&/^(?:about|app|app\-storage|.+\-extension|file|widget)$/.test(l.getScheme()),a=!1,y=function(){try{return new r.XMLHttpRequest}catch(n){}},tt=function(){try{var n=!1;return f(["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.3.0","Msxml3.XMLHTTP"],function(t){try{return n=new r.ActiveXObject(t)}catch(u){i.error("new xhr error: "+u.message)}}),n}catch(t){}},it=!nt&&r.XMLHttpRequest?"withCredentials"in(y()||[]):!1,st=r.ActiveXObject?function(n){return u?tt():!it&&n&&a?new a:!nt&&y()||tt()}:y,p=function(n){return a&&n instanceof a},ht=/^(?:GET|HEAD)$/,ct=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,w={xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},e=t,b,o;b=self&&self.fetch?self.fetch:r.fetch;rt&&(e=i.noop);i.mix(k.prototype,{url:!1,onSuccess:!1,onError:!1,onComplete:!1,method:"GET","async":!0,xhrFields:!1,mimeType:!1,username:!1,password:!1,data:!1,dataType:"text",headers:!1,contentType:"application/x-www-form-urlencoded; charset=UTF-8",beforeSend:!1,afterSend:!1,timeout:0,cache:!0,crossDomain:!1,retry:0,setRequestHeader:function(n,t){var i=this;return i.headers[n]=t,i},getAllResponseHeaders:function(){var n=this;return n.state===h?n.responseHeadersString:null},getNativeXhr:function(){var n=this;return n.nativeXhr},getResponseHeader:function(n){var t,i=this,r;if(n=n.toLowerCase(),i.state===h){if(!(r=i.responseHeaders))for(r=i.responseHeaders={};t=ct.exec(i.responseHeadersString);)r[t[1].toLowerCase()]=t[2];t=r[n]}return t===undefined?null:t},overrideMimeType:function(n){var t=this;return t.state||(t.mimeType=n),t},abort:function(n){var t=this;return n=n||"abort",t.state=d,t.status=0,t.statusText=n,t.nativeXhr&&t.nativeXhr.abort(),t._callback(),t},_ioReady:function(n,t){var r=this,u=!1;if(r.state!==h&&r.state!==d){r.state===s&&(r.state=h);r.readyState=4;n>=c&&n<ut||n===g?n===g?(t="not modified",u=!0):(t="success",u=!0):n<0&&(n=0);try{n>=c&&r.handleResponseData()}catch(f){i.error(f.stack||f,"error");t=f.message||"parser error"}if((n<c||!u)&&r.retry>0){r.retry=r.retry-1;setTimeout(function(){r.sendInternal()},200);return}r.status=n;r.statusText=t;r._callback(u)}},_callback:function(n){var t=this,r=t.timeoutTimer;r&&(clearTimeout(r),t.timeoutTimer=0);f([n?t.onSuccess:t.onError,t.onComplete],function(n){i.isFunction(n)&&n.apply(t.context,[t.responseData,t.statusText,t])});t.responseData=null},handleResponseData:function(){var e=this,t,o=e.dataType,n=e.nativeXhr,f,s,h,c;if(o==="blob"||o==="arraybuffer")if(u){if("responseBody"in n)f=n.responseBody,s=dsVbsBinGetLength(f),t=new VBArray(dsVbsBinGetBytes(f,0,s)).toArray();else for(t=[],f=n.responseText,s=f.length,h=0;h<s;++h)t.push(f.charCodeAt(h)&255);f=null}else t=r.Blob?n.response:"responseBody"in n?n.responseBody:n.responseText;else if(o=="json")t=n.responseType&&n.responseType.toLowerCase()=="json"?n.response:n.responseText?(r.JSON&&r.JSON.parse?r.JSON.parse:i.parse)(n.responseText):{};else if(o==="user-defined")t=n.response!==undefined?n.response:n.responseText;else{e.responseText=t=n.responseText||"";try{c=n.responseXML;c&&c.documentElement&&(e.responseXML=c)}catch(l){}}e.responseData=t},sendInternal:function(t){var o=this,r,l,v,h,tt,e,y,g,b,nt,k,rt,ut;if((r=o._setup(t),l=r.method,i.isString(l)&&(l=l.toUpperCase()),tt=l=="POST"?r.contentType:!1,v=r.url,h=r.dataType,g=r.mimeType,i.isString(v))&&(o.nativeXhr=e=st(r.crossDomain),e)){try{if(o.state=s,r.username?e.open(l,v,r.async,r.username,r.password):e.open(l,v,r.async),(r.async||n.bIE)&&h&&h!="user-defined"&&"responseType"in e)try{e.responseType=h}catch(d){}}catch(a){o.state<2?(i.error(a.stack||a,"error"),o._ioReady(-1,et+(i.isNumber(a.number)?"("+a.number+")":"")+(a.message||""))):i.error(a);return}y=r.xhrFields||{};"withCredentials"in y&&(it||delete y.withCredentials);f(y,function(n,t){try{e[t]=n}catch(r){i.error(r)}});g&&e.overrideMimeType&&e.overrideMimeType(g);b=r.headers||{};rt=b["X-Requested-With"];rt===!1&&delete b["X-Requested-With"];"setRequestHeader"in e&&(tt&&e.setRequestHeader("Content-Type",r.contentType),e.setRequestHeader("Accept",h&&w[h]?w[h]+(h==="*"?"":", */*; q=0.01"):w["*"]),f(b,function(n,t){e.setRequestHeader(t,n)}));r.cache||(e.setRequestHeader("If-Modified-Since","0"),e.setRequestHeader("Cache-Control","no-cache"));nt=!ht.test(r.method);k=nt&&r.data||null;nt&&u&&(k=r.data);r.async&&r.timeout>0&&(r.timeout<300&&(r.timeout=300),o.timeoutTimer=setTimeout(function(){o.abort("timeout")},r.timeout));try{if(o.state=s,i.isFunction(o.beforeSend)&&(ut=o.beforeSend(e,o),ut===!1)){o.abort("cancel");return}e.send(k);k=null;r.data=null;i.isFunction(o.afterSend)&&o.afterSend(o)}catch(d){o.state<2?(i.error(d.stack||d,"error"),o._ioReady(-1,ot+(d.message||""))):i.error(d)}r.async&&e.readyState!==4?p(e)?(e.onload=function(){e.readyState=4;e.status=c;o._xhrCallback()},e.onerror=function(){e.readyState=4;e.status=ft;o._xhrCallback()}):e.onreadystatechange=function(){o._xhrCallback()}:o._xhrCallback()}},_xhrCallback:function(n,t){var u=this,r=u.nativeXhr,s,o;try{if(r.readyState===4||t)if(p(r)?(r.onerror=e,r.onload=e):r.onreadystatechange=e,t)r.readyState!==4&&r.abort();else{p(r)||(u.responseHeadersString=r.getAllResponseHeaders());s=r.status;try{o=r.statusText}catch(f){i.error("xhr statusText error: ");i.error(f);o=""}u._ioReady(s,o)}}catch(f){i.error(f.stack||f,"error");r.onreadystatechange=e;t||u._ioReady(-1,f.message||"process error")}},_setup:function(n){var r=this,o,f,u,t,e;if(n){r.context=n.context;delete n.context;n instanceof k&&(n=n.config);r.config=n;t=n.url;i.startsWith(t,"http://")||i.startsWith(t,"https://")?e=new i.Uri(t):(i.startsWith(t,"//")&&(n.url=t="http:"+t),e=l.resolve(t));o=n.dataType?n.dataType.toLowerCase():"text";n.dataType=o;n.method=n.method?n.method.toUpperCase():"GET";"crossDomain"in n||(n.crossDomain=!e.isSameOriginAs(l));u=n.headers;for(f in u)i.isUndefined(u[f])&&delete u[f];i.mix(r,n)}return r.state=s,r}});i.mix(i,{ajax:v,io:{get:function(n,t,i,r){return v({method:"GET",url:n,onSuccess:t,onError:i,dataType:r})},post:function(n,t,i,r,u){return v({method:"POST",data:t,url:n,onSuccess:i,onError:r,dataType:u})},put:function(n,t,i,r,u){return v({method:"PUT",data:t,url:n,onSuccess:i,onError:r,dataType:u})}}});n.bChrome||n.bFirefox||b?i.fetch=function(n,t){var u="text",r,f;return t&&t&&t.dataType&&(u=t.dataType),r=b(n,t),Promise!=i.nativePromise&&(f=Promise,Promise=i.nativePromise,r=r.then(function(n){if(Promise=f,n.ok)return n;throw{httpCode:n.status,errorString:n.statusText};})),u=="blob"?r.then(function(n){return n.blob()}):u=="json"?r.then(function(n){return n.json()}):u=="arraybuffer"?r.then(function(n){return n.arrayBuffer()}):r.then(function(n){return n.text()})}:(u&&i.addVBS("Function dsVbsBinGetAt(strBinary,iOffset)\r\n dsVbsBinGetAt=AscB(MidB(strBinary,iOffset+1,1))\r\nEnd Function\r\nFunction dsVbsBinGetBytes(strBinary,iOffset,iLength)\r\n Dim aBytes()\r\n ReDim aBytes(iLength-1)\r\n For i=0 To iLength-1\r\n  aBytes(i)=dsVbsBinGetAt(strBinary,iOffset+i)\r\n Next\r\n dsVbsBinGetBytes=aBytes\r\nEnd Function\r\nFunction dsVbsBinGetLength(strBinary)\r\n dsVbsBinGetLength=LenB(strBinary)\r\nEnd Function"),Promise!=i.nativePromise&&(o=Promise,Promise=i.nativePromise),i.fetch=function(n,t){return new Promise(function(r,e){var c=function(n){o&&(Promise=o);r(n)},l=function(n,t,i){o&&(Promise=o);e({httpCode:i.status,errorString:t})},s={url:n,onSuccess:c,onError:l,dataType:"text"},h=!1;t&&(t.method&&(s.method=t.method),t.body&&(s.data=t.body),t.headers&&f(t.headers,function(n,t){t.toLowerCase()=="content-type"&&(h=!0);s.headers[t]=n}),t.dataType&&(s.dataType=t.dataType));h&&(s.contentType=!1);s.dataType=="blob"&&u&&(s.mimeType="text/plain; charset=x-user-defined");i.ajax(s)})})}))}(Dynamsoft),function(n){var t=20200521,i;n._customEvt_ver&&n.isNumber(n._customEvt_ver)&&n._customEvt_ver>=t||(n._customEvt_ver=t,i={fire:function(t){var i=this,r;i.exec=i.exec||{};t=t.toLowerCase();r=Array.prototype.slice.call(arguments,1);n.each(i.exec[t]||[],function(t){var u=t.f,f=t.c||i;try{u.apply(f,r)}catch(e){n.log(e)}})},on:function(n,t,i){var r=this;r.exec=r.exec||{};n=n.toLowerCase();r.exec[n]=r.exec[n]||[];r.exec[n].push({f:t,c:i})},off:function(n,t){var f=this,u=f.exec,r,i;if(u){if(!n){f.exec=null;return}if(n=n.toLowerCase(),!t){u[n]=null;return}for(r=u[n]||[],i=r.length-1;i>=0;i--)r[i]===t&&r.splice(i,1)}}},n.obj={customEvent:i})}(Dynamsoft.Lib),function(n){var t=n.Lib,u=!0,i=t.win.document,r,f=20200521;t._evtBase_ver&&t.isNumber(t._evtBase_ver)&&t._evtBase_ver>=f||(t._evtBase_ver=f,r=function(n){return Dynamsoft.navInfoSync.bGecko&&"mousewheel"===n?"DOMMouseScroll":n},t.mix(t,{addEventListener:i.addEventListener?function(n,t,i){var u=r(t);n&&n.addEventListener(u,i,!1)}:function(n,t,i){var u=r(t);n&&n.attachEvent("on"+u,i)},removeEventListener:i.removeEventListener?function(n,t,i){var u=r(t);n&&n.removeEventListener(u,i,!1)}:function(n,t,i){var u=r(t);n&&n.detachEvent("on"+u,i)},stopPropagation:function(n){var t=n||window.event;t.preventDefault&&t.preventDefault();t.stopPropagation&&t.stopPropagation();t.returnValue=!1;t.cancelBubble=!0},fireEvent:function(n,t){var r;i.createEvent?(r=i.createEvent("HTMLEvents"),r.initEvent(n,u,u),t.dispatchEvent&&t.dispatchEvent(r)):i.createEventObject?(r=i.createEventObject(),r.bubbles=u,r.cancelable=u,t.fireEvent(n,r)):(r=new Event(n),t.dispatchEvent&&t.dispatchEvent(r))}}))}(Dynamsoft),function(n){function r(n){this.message=n}var u=20200716,t,i;n._loadbase64_ver&&n._loadbase64_ver>=u||(n._loadbase64_ver=u,t={encodeChars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",decodeChars:[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1]},n.base64={UTF16ToUTF8:function(n){for(var t,e,i=[],o=n.length,r,u,f=0;f<o;f++)t=n.charCodeAt(f),t>0&&t<=127?i.push(n.charAt(f)):t>=128&&t<=2047?(r=192|t>>6&31,u=128|t&63,i.push(String.fromCharCode(r),String.fromCharCode(u))):t>=2048&&t<=65535?(r=224|t>>12&15,u=128|t>>6&63,e=128|t&63,i.push(String.fromCharCode(r),String.fromCharCode(u),String.fromCharCode(e))):t>=65536&&t<=2097151||t>=2097152&&t<=67108863;return i.join("")},UTF8ToUTF16:function(n){for(var u=[],h=n.length,f,e,i,r,s,o,t=0;t<h;t++)i=n.charCodeAt(t),(i>>7&255)==0?u.push(n.charAt(t)):(i>>5&255)==6?(r=n.charCodeAt(++t),f=(i&31)<<6,e=r&63,o=f|e,u.push(String.fromCharCode(o))):(i>>4&255)==14?(r=n.charCodeAt(++t),s=n.charCodeAt(++t),f=i<<4|r>>2&15,e=(r&3)<<6|s&63,o=(f&255)<<8|e,u.push(String.fromCharCode(o))):(i>>3&255)==30||(i>>2&255)==62;return u.join("")},encode:function(n){for(var e=this.UTF16ToUTF8(n),i=[],u=0,o=e.length,r,f,s;u<o;){if(r=e.charCodeAt(u++)&255,u==o){i.push(t.encodeChars.charAt(r>>2));i.push(t.encodeChars.charAt((r&3)<<4));i.push("==");break}if(f=e.charCodeAt(u++),u==o){i.push(t.encodeChars.charAt(r>>2));i.push(t.encodeChars.charAt((r&3)<<4|(f&240)>>4));i.push(t.encodeChars.charAt((f&15)<<2));i.push("=");break}s=e.charCodeAt(u++);i.push(t.encodeChars.charAt(r>>2));i.push(t.encodeChars.charAt((r&3)<<4|(f&240)>>4));i.push(t.encodeChars.charAt((f&15)<<2|(s&192)>>6));i.push(t.encodeChars.charAt(s&63))}return i.join("")},encodeArray:function(n){for(var i=[],u=0,e=n.length,r,f,o;u<e;){if(r=n[u++]&255,u==e){i.push(t.encodeChars.charAt(r>>2));i.push(t.encodeChars.charAt((r&3)<<4));i.push("==");break}if(f=n[u++]&255,u==e){i.push(t.encodeChars.charAt(r>>2));i.push(t.encodeChars.charAt((r&3)<<4|(f&240)>>4));i.push(t.encodeChars.charAt((f&15)<<2));i.push("=");break}o=n[u++]&255;i.push(t.encodeChars.charAt(r>>2));i.push(t.encodeChars.charAt((r&3)<<4|(f&240)>>4));i.push(t.encodeChars.charAt((f&15)<<2|(o&192)>>6));i.push(t.encodeChars.charAt(o&63))}return i.join("")},decode:function(n){for(var h=this,f=[],i=0,e=n.length,s,o,r,u;i<e;){do s=t.decodeChars[n.charCodeAt(i++)&255];while(i<e&&s==-1);if(s==-1)break;do o=t.decodeChars[n.charCodeAt(i++)&255];while(i<e&&o==-1);if(o==-1)break;f.push(String.fromCharCode(s<<2|(o&48)>>4));do{if(r=n.charCodeAt(i++)&255,r==61)return h.UTF8ToUTF16(f.join(""));r=t.decodeChars[r]}while(i<e&&r==-1);if(r==-1)break;f.push(String.fromCharCode((o&15)<<4|(r&60)>>2));do{if(u=n.charCodeAt(i++)&255,u==61)return h.UTF8ToUTF16(f.join(""));u=t.decodeChars[u]}while(i<e&&u==-1);if(u==-1)break;f.push(String.fromCharCode((r&3)<<6|u))}return h.UTF8ToUTF16(f.join(""))}},n.utf8={fromUTF16:function(n){for(var i=[],r=0,u=n.length,t;r<u;)t=n.charCodeAt(r),t>=1&&t<=127?i.push(n.charAt(r)):t>2047?(i.push(String.fromCharCode(224|t>>12&15)),i.push(String.fromCharCode(128|t>>6&63)),i.push(String.fromCharCode(128|t>>0&63))):(i.push(String.fromCharCode(192|t>>6&31)),i.push(String.fromCharCode(128|t>>0&63))),r++;return i.join("")},toUTF16:function(n){for(var i=[],t=0,e=n.length,r,u,f;t<e;){r=n.charCodeAt(t++);switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:i.push(n.charAt(t-1));break;case 12:case 13:u=n.charCodeAt(t++);i.push(String.fromCharCode((r&31)<<6|u&63));break;case 14:u=n.charCodeAt(t++);f=n.charCodeAt(t++);i.push(String.fromCharCode((r&15)<<12|(u&63)<<6|(f&63)<<0))}}return i.join("")}},i=typeof exports!="undefined"?exports:typeof self!="undefined"?self:$.global,r.prototype=new Error,r.prototype.name="InvalidCharacterError",n.btoa=i.btoa?function(n){return i.btoa(n)}:function(n){for(var e=String(n),u,f,i=0,o=t.encodeChars,s="";e.charAt(i|0)||(o="=",i%1);s+=o.charAt(63&u>>8-i%1*8)){if(f=e.charCodeAt(i+=3/4),f>255)throw new r("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");u=u<<8|f}return s},n.atob=i.atob?function(n){return i.atob(n)}:function(n){var e=String(n).replace(/[=]+$/,"");if(e.length%4==1)throw new r("'atob' failed: The string to be decoded is not correctly encoded.");for(var u=0,f,i,s=0,o="";i=e.charAt(s++);~i&&(f=u%4?f*64+i:i,u++%4)?o+=String.fromCharCode(255&f>>(-2*u&6)):0)i=t.encodeChars.indexOf(i);return o})}(Dynamsoft.Lib),function(n){var u=20200721;if(!n._loadjs_ver||!(n._loadjs_ver>=u)){n._loadjs_ver=u;var r="",f=!0,t=n.doc,o=t&&t.documentElement,i=t.getElementsByTagName("head")[0]||o,e=t.createElement("script").readyState?function(n,t){var i=n.onreadystatechange;n.onreadystatechange=function(){var r=n.readyState;r==="loaded"||r==="complete"?(n.onreadystatechange=null,i&&i(),t.call(this,!0)):r==="loading"||t.call(this,!1)}}:function(n,t){var i=!1;n.addEventListener("load",t,i);n.addEventListener("error",t,i)};n.getScript=function(u,o,s){var h,c;if(n.isFunction(s)||(s=function(){}),!n.isString(u)||u==r){s();return}return h=t.createElement("script"),c=["",u].join(r),h.src=c,o&&(h.async=f),h.charset="utf-8",e(h,s),i.insertBefore(h,i.firstChild),h};n.getScripts=function(t,i,r){if(!n.isArray(t)){r();return}var u=t.length,f=function(n){n?u--:r();u<=0&&r("ok")};n.each(t,function(t){n.getScript(t,i,f)})};n.getCss=function(u,o){var s,h=o;if(n.isFunction(h)||(h=!1),!n.isString(u)||u==r){h&&h();return}return s=t.createElement("link"),s.href=u,s.rel="stylesheet",s.async=f,h&&e(s,h),i.insertBefore(s,i.firstChild),s};n.getAllCss=function(t,i){if(!n.isArray(t)){i();return}var r=t.length,u=function(n){n?r--:i();r<=0&&i("ok")};n.each(t,function(t){n.getCss(t,u)})};n.addScript=function(u){var f,e;(e=u.body,n.isString(e)&&e!=r)&&(f=t.createElement("script"),f.charset="utf-8",Dynamsoft.navInfoSync.bIE?f.text=e:f.appendChild(t.createTextNode(e)),f.language=u.language?u.language:"javascript",f.type=u.type?u.type:"text/javascript",i.insertBefore(f,i.firstChild))};n.addJS=function(t){n.addScript({body:t})};n.addVBS=function(t){n.addScript({body:t,language:"vbscript",type:"text/vbscript"})}}}(Dynamsoft.Lib),function(n){var i=n.Lib,r=20200521,t;i._asyncQueue_ver&&i.isNumber(i._asyncQueue_ver)&&i._asyncQueue_ver>=r||(i._asyncQueue_ver=r,t={queue:[],doNextStarted:!1,timer:!1,pushToDo:function(n,i,r){t.queue.push({obj:n,method:i,args:r})},doNext:function(){var e,o;if(!t.doNextStarted){clearTimeout(t.timer);t.timer=!1;return}if(t.queue.length==0){t.timer=setTimeout(t.doNext,500);return}var u=t.queue[0],r=u.obj,f=u.method,n=u.args;if(t.queue.splice(0,1),i.isFunction(r[f])){n.length>2&&(e=n[n.length-2],o=n[n.length-1],n[n.length-2]=function(){try{e.apply(r,arguments)}catch(n){}t.timer=setTimeout(t.doNext,0)},n[n.length-1]=function(){try{o.apply(r,arguments)}catch(n){}t.timer=setTimeout(t.doNext,0)});try{r[f].apply(r,n)}catch(s){}return}i.log("not invoke a function: "+f);t.timer=setTimeout(t.doNext,0)},start:function(){t.doNextStarted||(t.doNextStarted=!0,t.timer=setTimeout(t.doNext,0))},stop:function(){clearTimeout(t.timer);t.doNextStarted=!1;t.queue=[]}},i.asyncQueue=t)}(Dynamsoft),function(n){function f(n,t){if("_".repeat)return n.repeat(t);for(var i=0,r=[];i<t;i++)r.push(n);return r.join("")}function e(n,r){for(var p=1,w=n.length,u,c="",s,e,l,a,v,y,h,o=0;o<w;o++)if(typeof n[o]=="string")c+=n[o];else if(typeof n[o]=="object"){if(e=n[o],e.keys)for(u=r[p],s=0;s<e.keys.length;s++){if(u==undefined)throw new Error(i('[sprintf] Cannot access property "%s" of undefined value "%s"',e.keys[s],e.keys[s-1]));u=u[e.keys[s]]}else u=e.param_no?r[e.param_no]:r[p++];if(t.not_type.test(e.type)&&t.not_primitive.test(e.type)&&u instanceof Function&&(u=u()),t.numeric_arg.test(e.type)&&typeof u!="number"&&isNaN(u))throw new TypeError(i("[sprintf] expecting number but found %T",u));t.number.test(e.type)&&(y=u>=0);switch(e.type){case"b":u=parseInt(u,10).toString(2);break;case"c":u=String.fromCharCode(parseInt(u,10));break;case"d":case"i":u=parseInt(u,10);break;case"j":u=JSON.stringify(u,null,e.width?parseInt(e.width):0);break;case"e":u=e.precision?parseFloat(u).toExponential(e.precision):parseFloat(u).toExponential();break;case"f":u=e.precision?parseFloat(u).toFixed(e.precision):parseFloat(u);break;case"g":u=e.precision?String(Number(u.toPrecision(e.precision))):parseFloat(u);break;case"o":u=(parseInt(u,10)>>>0).toString(8);break;case"s":u=String(u);u=e.precision?u.substring(0,e.precision):u;break;case"t":u=String(!!u);u=e.precision?u.substring(0,e.precision):u;break;case"T":u=Object.prototype.toString.call(u).slice(8,-1).toLowerCase();u=e.precision?u.substring(0,e.precision):u;break;case"u":u=parseInt(u,10)>>>0;break;case"v":u=u.valueOf();u=e.precision?u.substring(0,e.precision):u;break;case"x":u=(parseInt(u,10)>>>0).toString(16);break;case"X":u=(parseInt(u,10)>>>0).toString(16).toUpperCase()}t.json.test(e.type)?c+=u:(t.number.test(e.type)&&(!y||e.sign)?(h=y?"+":"-",u=u.toString().replace(t.sign,"")):h="",a=e.pad_char?e.pad_char==="0"?"0":e.pad_char.charAt(1):" ",v=e.width-(h+u).length,l=e.width?v>0?f(a,v):"":"",c+=e.align?h+u+l:a==="0"?h+l+u:l+h+u)}return c}function o(n){if(r[n])return r[n];for(var f=n,i,e=[],h=0;f;){if((i=t.text.exec(f))!==null)e.push(i[0]);else if((i=t.modulo.exec(f))!==null)e.push("%");else if((i=t.placeholder.exec(f))!==null){if(i[2]){h|=1;var s=[],o=i[2],u=[];if((u=t.key.exec(o))!==null)for(s.push(u[1]);(o=o.substring(u[0].length))!=="";)if((u=t.key_access.exec(o))!==null)s.push(u[1]);else if((u=t.index_access.exec(o))!==null)s.push(u[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");i[2]=s}else h|=2;if(h===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");e.push({placeholder:i[0],param_no:i[1],keys:i[2],sign:i[3],pad_char:i[4],align:i[5],width:i[6],precision:i[7],type:i[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");f=f.substring(i[0].length)}return r[n]=e,e}function s(n,t){return i.apply(null,[n].concat(t||[]))}var u=20200521,i,t,r;n._sprintf_ver&&n._sprintf_ver>=u||(n._sprintf_ver=u,t={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/},r=Object.create?Object.create(null):{},i=function(n){return e(o(n),arguments)},n.sprintf=i,n.vsprintf=s)}(Dynamsoft.Lib),function(n,t){var u=Dynamsoft.managerEnv,f=n.LS,h=Dynamsoft.navInfoSync.host,i,r,e=20200522,s=function(){if(Dynamsoft.dcp){var t=Dynamsoft.dcp.dcpJSVer;if(n.isNumber(t))return t>=e}return!1},o,c;if(u||(Dynamsoft.managerEnv={},u=Dynamsoft.managerEnv),u.resourcesPath=u.resourcesPath||"Resources",u.IfUpdateService=u.IfUpdateService?!0:!1,s()){s=t;e=t;return}r={dcpStatus:0,bConnected:!1,connectedResult:"",curPortIndex:0,bConnectNumLimited:!0,IMAXCONNECTCOUNT:3,EnumDCP_DetectStatus:{Init:0,Connected:1,DownloadingZip:2,DownloadedZip:3,DownloadFailed:4,CheckingManagerVer:15,CheckingServiceVer:16,NotInstalled:17,CheckedService:5,VerifyingZip:6,VerifiedZip:7,UpdatingService:8,UpdateSucceed:9,UpdateFailed:10,UpdateSkipped:11}};o=[];c=0;Dynamsoft.dcp=i={host:"127.0.0.1",ports:[[18625,18626]],win64Port:[18627,18628],ifCheck64bitServiceFirst:!1,dcpJSVer:e,oldDWASMVerStr:"dwasm_13000404",oldDWASMVer:[13,0,0,"0404"],DWASMVer14:[14,3,1,"0115"],managerVersion:[16,0,0,"0428"],managerVersionMac:[16,0,0,"0428"],managerVersionLinux:[16,0,0,"0428"],serviceVersion:[1,5,3,"0107"],serviceVersionMac:[1,5,3,"0107"],serviceVersionLinux:[1,5,3,"0107"],detect:r,strSID:"",bEnhancedMode:!1,b64bit:!1,onReadys:[],getManagerVersion:function(){var n=Dynamsoft.Lib.getNavInfo();if(!n.bWin&&!n.bWin64){if(n.bMac)return i.managerVersionMac;if(n.bLinux)return i.managerVersionLinux}return i.managerVersion},getServiceVersion:function(){var n=Dynamsoft.Lib.getNavInfo();if(!n.bWin&&!n.bWin64){if(n.bMac)return i.serviceVersionMac;if(n.bLinux)return i.serviceVersionLinux}return i.serviceVersion},versionInfo:function(t,u){var f=0,e=function(u){var e;if(n.isArray(u)&&u.length>0&&u[0]&&(r.curPort=i.ports[f%i.ports.length],e=u[0],n.isString(e)&&i._compareVersion(e.split(","),i.oldDWASMVer))){var c=n.isString(u[1])&&u[1].toLowerCase(),o="",s=!1,h=!1;return u.length>4&&(o=n.isString(u[2])?u[2]:"",s=n.isString(u[3])&&u[3]==="true",h=n.isString(u[4])&&u[4]==="64"),i.strSID=o,i.bEnhancedMode=s,i.b64bit=h,r.bConnected=!0,r.dcpStatus=r.EnumDCP_DetectStatus.Connected,i._sendStatusEvent(!1,e),n.isFunction(t)&&setTimeout(function(){t(o,s)},0),!0}return!1},o=function(n,u,e){return(++f,r.curPortIndex=f%i.ports.length,r.bConnected=!1,r.bConnectNumLimited&&f>=r.IMAXCONNECTCOUNT)?(setTimeout(function(){t(n,u,e)},0),!0):!1};r.dcpStatus=r.EnumDCP_DetectStatus.CheckingManagerVer;this._postBase("VersionInfo",!0,u,e,o)},_checkOldManagerVersion:function(n,i){r.dcpStatus=r.EnumDCP_DetectStatus.CheckingManagerVer;this._postBase("VersionInfo",!0,t,n,i)},_checkManagerVersion:function(n,t,i){r.dcpStatus=r.EnumDCP_DetectStatus.CheckingManagerVer;this._postBase("VersionInfo",!1,n,t,i)},_checkService:function(n,i){r.dcpStatus=r.EnumDCP_DetectStatus.CheckingServiceVer;this._postBase("DSVersion",!1,t,n,i)},_checkUpdateFile:function(n,i){this._postBase("CheckUpdateFile",!1,t,n,i)},_updateService:function(n,i){this._postBase("UpdateService",!1,t,n,i)},_postBase:function(t,r,u,f,e){var s,o,h,c;if(s=r?i.oldDWASMVerStr:"dwasm2_"+i._getModuleVer(),o={id:"1",method:t,version:s,parameter:[]},u)if(n.startsWith(u,"http://")||n.startsWith(u,"https://")){if(Dynamsoft.managerEnv.ifCheckRemoteProductKey)return h=this,c=u,n.ajax({method:"GET",url:c,onSuccess:function(n){o.productKey=n;h._postBaseV2(t,r,o,f,e)},onError:e}),!0}else o.productKey=u;return this._postBaseV2(t,r,o,f,e),!0},_postBaseV2:function(t,r,u,e,s){var a,p,d=n.stringify(u),h,c,l,v,w,y,b,k;if(n.isFunction(e)&&n.isFunction(s)){if(i.detect.bConnected&&t=="VersionInfo"){e(i.detect.connectedResult);return}if(a=function(n,t,i){c--;c==0&&s(n,t,i)},p=function(n,t,r){var u=i._getJSON(n);if(u&&"result"in u){if(c=-1,i.detect.bConnected)return;if(i.detect.bConnected=!0,i.detect.connectedResult=u.result,i.detect.dcpStatus=i.detect.EnumDCP_DetectStatus.Connected,i.detect.curPort=i.ports[r.index],i.ports=[i.detect.curPort],i.detect.curPortIndex=0,f.isSupportLS()&&f.item("DCP_port",i.detect.curPort[1]),e(u.result))return}a(n,t,r)},c=i.ports.length,c>1&&f.isSupportLS()&&(l=f.item("DCP_port"),n.isString(l)&&l!==""))for(h=1;h<c;h++){v=i.ports[h];w=v[0];y=v[1];y==l&&(i.ports[h][0]=i.ports[0][0],i.ports[h][1]=i.ports[0][1],i.ports[0][0]=w,i.ports[0][1]=y);break}for(i.detect.bConnected&&(c=1),o=[],i.detect.bConnected=!1,h=0;h<c;h++)b=[i._getPreUrl(h),r?"dcp/":i._getModuleName(),r?i.oldDWASMVerStr:i._getModuleVer(),"/",t,"?type=1&dsver=",i.getServiceVersion().join(""),"&ts=",n.now()].join(""),o.push({method:"POST",url:b,timeout:200,data:d,onSuccess:p,onError:a});for(h=0;h<c;h++)k=n.ajax(o[h]),k.index=h}},loadZip:function(t,u,f,e){var s,o=u,h=f;o===100&&(o=0,h=function(t){n.isString(t)&&(t=t.replace('"result" : [ 0,','"result" : [ 100,'));f(t)});s=Dynamsoft.managerEnv.IfUpdateService?[i._getPreUrl(r.curPortIndex),i._getModuleName(),i._getModuleVer(),"/LoadZipFromBytes?type=",o,"&dsver=",i.getServiceVersion().join(""),"&ts=",n.now()].join(""):[i._getPreUrl(r.curPortIndex),"dcp/",i.oldDWASMVerStr,"/LoadZipFromBytes?type=0","&dsver=",i.getServiceVersion().join(""),"&ts=",n.now()].join("");n.ajax({method:"POST",url:s,"async":!0,data:t,onSuccess:h,onError:e})},oldLoadZip:function(t,u,f,e){var o=[i._getPreUrl(r.curPortIndex),"dcp/",i.oldDWASMVerStr,"/LoadZipFromBytes?type=0","&dsver=",i.getServiceVersion().join(""),"&ts=",n.now()].join("");n.ajax({method:"POST",url:o,"async":!0,data:t,onSuccess:f,onError:e})},_getPreUrl:function(n){var t,r;return Dynamsoft.navInfoSync.bSSL?(r="https://",t=i.ports[n][1]):(r="http://",t=i.ports[n][0]),[r,i.host,":",t,"/"].join("")},_getJSON:function(t){return t?n.parse(t):!1},_getModuleName:function(){return"dcp/dwasm2_"},_getModuleVer:function(){return i.getManagerVersion().join("")},_compareVersion:function(t,i){return n.isArray(t)&&t.length==4&&n.isArray(i)&&i.length>=4?t[0]>i[0]||t[0]==i[0]&&t[1]>i[1]||t[0]==i[0]&&t[1]==i[1]&&t[2]>i[2]||t[0]==i[0]&&t[1]==i[1]&&t[2]==i[2]&&parseInt(t[3])>=parseInt(i[3]):n.isArray(t)&&t.length==1&&n.isArray(i)&&i.length>=1?parseInt(t[0])>=parseInt(i[0]):!1},_getDSUpdateZipUrl:function(){var r=Dynamsoft.Lib.getNavInfo(),t,u,f="";return t="Win",r.bMac?t="Mac":r.bLinux&&(t="Linux"),u=Dynamsoft.navInfoSync.bFileSystem?"":"?t="+n.now(),r.bWin&&i.b64bit&&(f="_x64"),[Dynamsoft.managerEnv.resourcesPath,"/dist/serviceupdate/",t,"DSUpdate_",i.getManagerVersion().join("."),f,".zip",u].join("")},getPorts:function(n,t,r){var u="GetPorts",f="dwasm2_"+i._getModuleVer(),e={id:"1",method:u,version:f,parameter:[n]};this._postBaseV2(u,!1,e,t,r)},checkDcpForUpdate:function(t,u,f,e,o,s,h,c){var w=!1,a=!0,v=3,l=0,y=function(u){var v,l,y;if(!(n.isArray(u)&&u.length>0&&u[0]))return!1;if(v=u[0].split(","),l=!1,u.length>4&&(l=n.isString(u[4])&&u[4]==="64"),i.b64bit=l,Dynamsoft.managerEnv.IfUpdateService)if(i._compareVersion(v,i.oldDWASMVer)){y=i._getDSUpdateZipUrl();w=!0;var p=function(n){r.dcpStatus=r.EnumDCP_DetectStatus.DownloadedZip;i._sendStatusEvent();i.oldLoadZip(n,0,function(){setTimeout(function(){i._checkManagerVersion(c,b,k)},5e3)},d)},d=function(n,t,r){i._funUpdateFailed(o,s,n,r.status);setTimeout(h,0)},g=function(n,t,u){r.dcpStatus=r.EnumDCP_DetectStatus.DownloadFailed;o&&o();var e=u.status,f;f=e==200?n:"The update package can't be downloaded. The error code is "+e+".";s&&s(!0,f);i._sendStatusEvent(!0,f);setTimeout(h,0)};f&&f();e&&e();r.dcpStatus=r.EnumDCP_DetectStatus.DownloadingZip;i._sendStatusEvent();n.ajax({method:"GET",url:y,"async":!0,dataType:"blob",onSuccess:p,onError:g})}else a&&(r.dcpStatus=r.EnumDCP_DetectStatus.NotInstalled,f&&f(),t&&t(),i._sendStatusEvent(),a=!1);else r.bConnected=!0,r.dcpStatus=r.EnumDCP_DetectStatus.UpdateSkipped,i._sendStatusEvent(),setTimeout(h,0);return!0},p=function(){return++l,r.curPortIndex=l%i.ports.length,r.bConnected=!1,r.bConnectNumLimited&&l>=r.IMAXCONNECTCOUNT?(r.dcpStatus=r.EnumDCP_DetectStatus.NotInstalled,i._sendStatusEvent()):setTimeout(function(){i._checkOldManagerVersion(y,p)},1e3),!0},b=function(t){if(!(n.isArray(t)&&t.length>0&&t[0]))return!1;var u=t[0].split(",");return i._compareVersion(u,i.getManagerVersion())?(Dynamsoft.managerEnv.IfUpdateService?w?setTimeout(function(){i._checkUpdateZip(e,o,s,h)},0):setTimeout(function(){i._checkService(d,g)},0):(r.dcpStatus=r.EnumDCP_DetectStatus.UpdateSkipped,i._sendStatusEvent(),setTimeout(h,0)),!0):!1},k=function(){var n=1e3;return v<3&&(n=500),v--,v<0?(i._funShowUpgradeDialogWhenUpdateFailed(o,s),setTimeout(h,0)):setTimeout(function(){i._checkManagerVersion(c,b,k)},n),!0},d=function(t){if(!(n.isArray(t)&&t.length>0&&t[0]))return f&&f(),!1;var u=t[0].split(",");return i._compareVersion(u,i.getServiceVersion())?(r.bConnected=!0,o&&o(),r.dcpStatus=r.EnumDCP_DetectStatus.CheckedService,i._sendStatusEvent(!1,t[0]),r.dcpStatus=r.EnumDCP_DetectStatus.UpdateSucceed,i._sendStatusEvent(),setTimeout(h,0)):setTimeout(function(){i._checkUpdateZip(e,o,s,h)},0),!0},g=function(n,t,r){return i._funUpdateFailed(o,s,n,r.status),setTimeout(h,0),!0},it=!1,nt=function(u){var e;if(!(n.isArray(u)&&u.length>0&&u[0]))return!1;if(e=u[0],n.isString(e)&&i._compareVersion(e.split(","),i.oldDWASMVer)){var v=n.isString(u[1])&&u[1].toLowerCase(),o="",s=!1,c=!1;u.length>4&&(it=!0,o=n.isString(u[2])?u[2]:"",s=n.isString(u[3])&&u[3]==="true",c=n.isString(u[4])&&u[4]==="64");i.strSID=o;i.bEnhancedMode=s;i.b64bit=c;r.curPort=i.ports[l%i.ports.length];Dynamsoft.managerEnv.IfUpdateService?setTimeout(function(){i._checkService(d,g)},0):(r.dcpStatus=r.EnumDCP_DetectStatus.UpdateSkipped,i._sendStatusEvent(),setTimeout(h,0))}else l=0,r.curPortIndex=0,a&&(f&&f(),t&&t(),a=!1),setTimeout(function(){i._checkOldManagerVersion(y,p)},1e3);return!0},tt=function(n,u){return++l,r.curPortIndex=l%i.ports.length,r.bConnected=!1,a&&(f&&f(),t&&t(n,u),a=!1),r.bConnectNumLimited&&l>=r.IMAXCONNECTCOUNT?(l=0,r.curPortIndex=0,setTimeout(function(){i._checkOldManagerVersion(y,p)},1e3)):setTimeout(function(){i._checkManagerVersion(c,nt,tt)},1e3),!0};u&&u();i._checkManagerVersion(c,nt,tt)},_checkUpdateZip:function(t,u,f,e){var c=function(t,u,f){var e=-1,h;return(f&&(e=f.status),e==0)?(setTimeout(function(){i._checkService(o,s)},5e3),!0):(h=i._getDSUpdateZipUrl(),r.dcpStatus=r.EnumDCP_DetectStatus.DownloadingZip,i._sendStatusEvent(),n.ajax({method:"GET",url:h,"async":!0,dataType:"blob",onSuccess:v,onError:l}),!0)},l=function(n,t,o){r.dcpStatus=r.EnumDCP_DetectStatus.DownloadFailed;u&&u();var h=o.status,s;return s=h==200?n:"The update package can't be downloaded. The error code is "+h+".",f&&f(!0,s),i._sendStatusEvent(!0,s),setTimeout(e,0),!0},a=function(t){if(!(n.isArray(t)&&t.length>1))return!1;if(t[1]==!0)r.dcpStatus=r.EnumDCP_DetectStatus.VerifiedZip,i._sendStatusEvent(),r.dcpStatus=r.EnumDCP_DetectStatus.UpdatingService,i._sendStatusEvent(),setTimeout(function(){i._checkService(o,s)},5e3);else{var h=0;if("exception"in t&&(h=t.exception),h==-2373)return i._funUpdateFailed(u,f,t,200),setTimeout(e,0),!0;setTimeout(c,0)}return!0},v=function(t){Dynamsoft.dcp.loadZip(t,1,function(t){var r,h;try{n.isString(t)&&(h=n.parse(t.replace(/\0/g,"")),"result"in h&&(r=h.result))}catch(c){}if(n.isArray(r)&&r.length>2&&r[2]==!0){setTimeout(function(){i._checkService(o,s)},5e3);return}i._funUpdateFailed(u,f,t,200);setTimeout(e,0)},y)},y=function(n,t,r){var h=-1;return r&&(h=r.status),h==0?setTimeout(function(){i._checkService(o,s)},5e3):(i._funUpdateFailed(u,f,n,r.status),setTimeout(e,0)),!0},p=function(t){return(n.isArray(t)&&t.length>0)?(t[0]==!0?setTimeout(function(){i._checkService(o,s)},5e3):(i._funUpdateFailed(u,f,t,200),setTimeout(e,0)),!0):!1},h=3,o=function(t){if(!(n.isArray(t)&&t.length>0&&t[0]))return!1;var f=t[0].split(",");return i._compareVersion(f,i.getServiceVersion())?(r.bConnected=!0,u&&u(),r.dcpStatus=r.EnumDCP_DetectStatus.CheckedService,i._sendStatusEvent(!1,t[0]),r.dcpStatus=r.EnumDCP_DetectStatus.UpdateSucceed,i._sendStatusEvent(),setTimeout(e,0),!0):!1},s=function(){var n=1e3;return(h<3&&(n=500),h--,h<0)?(i._funShowUpgradeDialogWhenUpdateFailed(u,f),setTimeout(e,0),!0):(setTimeout(function(){i._checkService(o,s)},n),!0)};t&&t();r.dcpStatus=r.EnumDCP_DetectStatus.VerifyingZip;i._sendStatusEvent();i._checkUpdateFile(a,c)},_getStatusString:function(n,t){var i,u,f="";return n==r.EnumDCP_DetectStatus.Init?"Getting manager version":n==r.EnumDCP_DetectStatus.Connected?(t&&(f=t),"Getting manager version succeeded and the version is "+f):n==r.EnumDCP_DetectStatus.DownloadingZip?"Downloading the update package":n==r.EnumDCP_DetectStatus.DownloadedZip?"Update package downloaded":n==r.EnumDCP_DetectStatus.DownloadFailed?(u=".",t&&t.length>0?(t.slice(t.length-1)=="."&&(u=""),i=" with the error: "+t):i="","Update package failed to download"+i+u):n==r.EnumDCP_DetectStatus.CheckingManagerVer?"Getting manager version":n==r.EnumDCP_DetectStatus.CheckingServiceVer?"Getting service version":n==r.EnumDCP_DetectStatus.NotInstalled?"Dynamsoft Service Not Installed":n==r.EnumDCP_DetectStatus.UpdateSkipped?"Update skipped":n==r.EnumDCP_DetectStatus.CheckedService?(t&&(f=t),"Getting service version succeeded and the version is "+f):n==r.EnumDCP_DetectStatus.VerifyingZip?"Verifying the update package":n==r.EnumDCP_DetectStatus.VerifiedZip?"Update package verified":n==r.EnumDCP_DetectStatus.UpdatingService?"Updating the service":n==r.EnumDCP_DetectStatus.UpdateSucceed?"Update succeeded":n==r.EnumDCP_DetectStatus.UpdateFailed?(u=".",t&&t.length>0?(t.slice(t.length-1)=="."&&(u=""),i=" with the error: "+t):i="","The update failed"+i+u):""},_sendStatusEvent:function(t,u){var f=t?!0:!1;n.isFunction(h.OnGetServiceUpdateStatus)&&h.OnGetServiceUpdateStatus(f,r.dcpStatus,i._getStatusString(r.dcpStatus,u))},_getErr:function(t){var i,r="";try{n.isString(t)?(i=t.replace(/\0/g,""),i=n.parse(i)):t&&(i=t);"description"in i&&(r=i.description)}catch(u){}return r},_funShowUpgradeDialogWhenUpdateFailed:function(n,t){return r.bConnected=!0,r.dcpStatus=r.EnumDCP_DetectStatus.UpdateFailed,n&&n(),t&&t(),i._sendStatusEvent(!0),!0},_funUpdateFailed:function(n,t,u,f){r.bConnected=!0;r.dcpStatus=r.EnumDCP_DetectStatus.UpdateFailed;n&&n();var e,o;return f==200?(e="The update failed.",o=i._getStatusString(r.dcpStatus,i._getErr(u))):(e="The update failed. The error code is "+f,o=e),t&&t(!0,e),i._sendStatusEvent(!0,o),!0},getDSPath:function(n,t){var i=Dynamsoft.managerEnv.resourcesPath,r=t,u;return Dynamsoft.Lib.isString(i)&&i.length>0?i[i.length-1]!="/"&&(i=i+"/"):i="Resources/",r||(u=Dynamsoft.Lib.getNavInfo(),r=u.bMac?".pkg":u.bLinux?".deb":".msi"),[i,"dist/DynamsoftServiceSetup",r].join("")},getLinuxHTML5DebPath:function(){return Dynamsoft.dcp.getDSPath(!1,".deb")},getLinuxHTML5RpmPath:function(){return Dynamsoft.dcp.getDSPath(!1,".rpm")}};s=t;e=t;u=t;n.domReady(function(){i.onReadys.length>0&&n.each(i.onReadys,function(t){n.isFunction(t)&&t()})});Dynamsoft.Ready=function(t){return n.asyncGetNavInfo().then(function(){try{t(n)}catch(i){n.log(i.stack||i,"error");throw i;}})}}(Dynamsoft.Lib),function(n){var t=n.Lib,f=t.doc,r=20200521,u,i;t._evt_ver&&t.isNumber(t._evt_ver)&&t._evt_ver>=r||(t._evt_ver=r,t.Events={registedClass:[],registedObjs:[]},u=function(n){var r=n||window.event,i=!0;return t.each(t.Events.registedObjs,function(n){t.each(t.Events.registedClass,function(t){if(n instanceof t&&n.bFocus&&n.handlerKeyDown&&(i=n.handlerKeyDown(r),!i))return!1})}),i},t.ready(function(){t.addEventListener(f.documentElement,"keydown",u)}),t.mix(t,{getWheelDelta:function(n){n=n||window.event;var i,r=n.wheelDelta,t=n.detail;return r&&(i=r/120),t&&(i=-(t%3==0?t/3:t)),i}}),i={LEFT:0,MIDDLE:1,RIGHT:2},t.EnumMouseButton=i,t.detectButton=function(n){var t=n||window.event;return t.which==null?t.button<2?i.LEFT:t.button==4?i.MIDDLE:i.RIGHT:t.which<2?i.LEFT:t.which==2?i.MIDDLE:i.RIGHT})}(Dynamsoft),function(n){var t=20200521;n._ui_eventWhich_ver&&n.isNumber(n._ui_eventWhich_ver)&&n._ui_eventWhich_ver>=t||(n._ui_eventWhich_ver=t,n.switchEvent=function(n){return n=n||window.event,n.which=n.which==null?n.button<2?1:n.button==4?2:3:n.which<2?1:n.which==2?2:3,n})}(Dynamsoft.Lib),function(n){var t=20200521;n._ui_style_ver&&n.isNumber(n._ui_style_ver)&&n._ui_style_ver>=t||(n._ui_style_ver=t,n.currentStyle=function(t,i){var r=n.win,f=r.doc,u;return t.currentStyle?t.currentStyle[i]:r.getComputedStyle?(u=i.replace(/([A-Z])/g,"-$1"),u=i.toLowerCase(),f.defaultView.getComputedStyle(t,null)[i]):null})}(Dynamsoft.Lib),function(n,t){function u(n,t,r){var f=this;return(f instanceof u)?n?typeof n=="string"?(i.error("Err 4001."),f):i.isArray(n)||n.isNodeList?(Array.prototype.push.apply(f,i.makeArray(n)),f):(f[0]=n,f.length=1,f):f:new u(n,t,r)}function e(n){return v(n)&&(n=i.trim(n))&&n.length>=3&&i.startsWith(n,"<")&&i.endsWith(n,">")}function o(n){return(r+n+r).replace(p,r)}function s(n){return n.replace(p,"")}function d(n){var t=n.innerHTML,i,r,u;return document.all?(i=/(\s+\w+)\s*=\s*([^<>"\s]+)(?=[^<>]*\/>)/ig,r=/"'([^'"]*)'"/ig,t=t.replace(i,'$1="$2"').replace(r,'"$1"'),u=t.replace(/<(\/?)(\w+)([^>]*)>/g,function(n,t,i,r){return t?"<\/"+i.toLowerCase()+">":("<"+i.toLowerCase()+r+">").replace(/=(("[^"]*?")|('[^']*?')|([\w\-\.]+))([\s>])/g,function(n,t,i,r,u,f){return u?'="'+u+'"'+f:n})}),u.replace(/<\/?([^>]+)>/g,function(n){return n})):t}function h(n,t){var r=t;return(r&&r.isNodeList&&(r=r.getEL()),v(n))?(e(n)&&i.err("Err 4002."),new u(i.sizzle(n,r))):n.isNodeList?n:new u(n)}var b=Array.prototype,c=!0,l=!1,i=n.Lib,a=n.navInfoSync,v=i.isString,f=i.each,y=b.slice,r=" ",k=a.bIE&&a.IEMode<10,p=/[\n\t\r\.]/g,w=20200521;if(!i._ui_nodelist_ver||!i.isNumber(i._ui_nodelist_ver)||!(i._ui_nodelist_ver>=w)){i._ui_nodelist_ver=w;u.prototype={isNodeList:!0,length:0,item:function(n){var t=this;return i.isNumber(n)?n>=t.length?null:new u(t[n]):new u(n)},slice:function(){return new u(y.apply(this,arguments))},getDOMNodes:function(){return y.call(this)},each:function(n,t){var i=this;return f(i,function(r,f){return r=new u(r),n.call(t||r,r,f,i)}),i},getEL:function(){var n=this;return n.length>0?n[0]:t},all:function(n){var t=this;return t.length>0?i.all(n,t):new u},one:function(n){var i=this,t=i.all(n);return t.length?t.slice(0,1):t}};var g=function(n,t){var e=n.className,c,l=t.length,u,f,h;if(e){for(c=o(e),u=e,f=0;f<l;f++)h=s(t[f]),c.indexOf(r+h+r)<0&&(u+=r+h);u=i.trim(u)}else u=t.join(" ");n.className=u},nt=function(n,t){var h=n.className,u,c=t.length,f,e;if(h&&c){for(u=o(h),f=0;f<c;f++)for(e=r+s(t[f])+r;u.indexOf(e)>=0;)u=u.replace(e,r);n.className=i.trim(u)}},tt=function(n,t){var u=n.className,f,e=t.length,i,h;if(u&&e){for(f=o(u),i=0;i<e;i++)if(h=r+s(t[i])+r,f.indexOf(h)<0)return l;return c}return l};i.mix(u.prototype,{before:function(n){var t=this.getEL(),r=[n];t&&(e(n)&&(r=i.parseHTML(n)),f(r,function(n){t.insertBefore(n,t.childNodes[0])}))},append:function(n){var t=this.getEL(),r=[n];t&&(e(n)&&(r=i.parseHTML(n)),f(r,function(n){t.appendChild(n)}))},html:function(n){var t=this.getEL();if(t){if(i.isUndef(n))return d(t);t.innerHTML="";f(i.parseHTML(n),function(n){t.appendChild(n)})}},attr:function(n,t){var r=this.getEL();if(r){if(i.isUndef(t))return n==="readonly"?r.readOnly?"readonly":"":(n!=="style"&&k?r=r[n]:(r=r.attributes[n],r&&(r=r.value)),r);n=="class"?r.className=t:r[n]=t}},style:function(n,t){var r=this.getEL();if(r)return i.style(r,n,t)},css:function(n){f(this,function(t){f(n,function(n,r){i.style(t,r,n)})})},addClass:function(n){var t=this.getEL();t&&g(t,n.split(r))},removeClass:function(n){var t=this.getEL();t&&nt(t,n.split(r))},hasClass:function(n){var t=this.getEL();if(t)return tt(t,n.split(r))},parent:function(){var n=this.getEL();return n&&(n=n.parentNode),new u(n)},remove:function(){var n=this.getEL();n&&n.parentNode.removeChild(n)},offset:function(){var n=this.getEL();return i.DOM.getElDimensions(n,c)}});i.mix(i,{all:h,one:function(n,t){var i=h(n,t);return i.length?i.slice(0,1):i},isNodeList:function(n){return n instanceof u}});i.ready(function(){i.all=h})}}(Dynamsoft),function(n){var u=n.win,t=n.doc,i=isNaN,r=20200521;n._dom_ver&&n.isNumber(n._dom_ver)&&n._dom_ver>=r||(n._dom_ver=r,n.DOM={getOffset:function(n,r,f){n=n||u.event;for(var e=f||n.target,h=0,c=0,l=0,a=0,o,s,v=!1;e&&!i(e.offsetLeft)&&!i(e.offsetTop);)s=e.scrollLeft,o=e.scrollTop,e.tagName==="BODY"?v?(s=0,o=0):(s=s|t.documentElement.scrollLeft,o=o|t.documentElement.scrollTop):e.style.position==="fixed"&&(v=!0),h+=e.offsetLeft-s,c+=e.offsetTop-o,e=e.offsetParent;return r&&(l=r.Left,a=r.Top),h=n.clientX-h-l,c=n.clientY-c-a,{x:h,y:c}},getElDimensions:function(n,t){var i,r;return n?(i=n.style.display,n.style.display="",r=t?{offsetTop:n.offsetTop,offsetLeft:n.offsetLeft,offsetWidth:n.offsetWidth,offsetHeight:n.offsetHeight}:{clientTop:n.clientTop,clientLeft:n.clientLeft,clientWidth:n.clientWidth?n.clientWidth:parseInt(n.style.width)?parseInt(n.style.width):0,clientHeight:n.clientHeight?n.clientHeight:parseInt(n.style.height)?parseInt(n.style.height):0},n.style.display=i,r):{offsetTop:0,offsetLeft:0,offsetWidth:0,offsetHeight:0}}},n.getElDimensions=n.DOM.getElDimensions)}(Dynamsoft.Lib),function(n,t){function b(n){var t,i,u;t=r.body.scrollTop||r.documentElement.scrollTop;u=s.innerHeight?s.innerHeight:r.documentElement.clientHeight;i=t+(u-n.offsetHeight)/2;n.style.top=i+"px";n._dlgInfo.isTopOverridden=o}function k(n,t){for(var i=0;i<n.length;++i)if(n[i]==t)return o;return f}function d(n){for(var s,c,l,t=0;t<r.styleSheets.length;++t){var a=r.styleSheets[t],i=f,h=f,u,e;try{i=a.cssRules;h=r.querySelectorAll}catch(v){}if(i&&h)for(s=0;s<i.length;++s){u=i[s];e=f;try{e=h(u.selectorText)}catch(v){}if(e&&k(e,n)&&(c=u.style.getPropertyValue("top"),l=u.style.getPropertyValue("bottom"),c&&c!="auto"||l&&l!="auto"))return o}}return f}function g(n){var t=f;return(s.getComputedStyle?t=s.getComputedStyle(n):n.currentStyle&&(t=n.currentStyle),t&&t.position!="absolute")?f:n.style.top!="auto"&&n.style.top!=""||n.style.bottom!="auto"&&n.style.bottom!=""?f:!d(n)}function v(n){var t=r.createEvent("MouseEvents");return t.initMouseEvent(n.type,n.bubbles,n.cancelable,s,n.detail,n.screenX,n.screenY,n.clientX,n.clientY,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.button,n.relatedTarget),t}function y(n){r.body.dispatchEvent(v(n))}function nt(){e=r.createElement("div");u=e.style;u.position="fixed";u.display="block";u.left=u.top=u.margin=u.padding=0;u.backgroundColor="#000";u.filter="alpha(opacity=30)";u.opacity=u.MozOpacity=.3;u.zIndex=a;u.width=u.height="100%";r.createEvent&&i.addEventListener(e,"click",y)}function tt(){e===t&&nt();r.body.contains(e)||r.body.appendChild(e)}function it(){e!==t&&(i.removeEventListener(e,"click",y),r.body.removeChild(e),e=t)}function p(n,t){var r=this;if(r.open){i.error("showDialog called on open dialog.");return}r.open=o;r.removeAttribute("closed");r.setAttribute("open","open");g(r)&&b(r);n&&(r._dlgInfo.modal=o,h.pushDialog(r,t))}function rt(n){var t=this;return t.open||i.error("closeDialog called on closed dialog."),t.open=f,t.removeAttribute("open"),t.setAttribute("closed","closed"),typeof n!="undefined"&&(t.returnValue=n),t._dlgInfo.isTopOverridden&&(t.style.top="auto"),t._dlgInfo.modal&&h.removeDialog(t),t.returnValue}var c=20200521,i=n.Lib,l,h;if(!i._dialog_ver||!i.isNumber(i._dialog_ver)||!(i._dialog_ver>=c)){i._dialog_ver=c;l="data:image/gif;base64,R0lGODlhzAETAPf/AK/a/sfn/qnW/aLV/bPb/pnP/KnZ/9Ds/6jZ/8/s/6fY/57S/aTW/qHU/s3r/5XM/Mbn/sLk/bzh/Mrp/rje/K3b/6/d/6va/7nh/szq/8vq/8rp/8Xn/7Tf/8np/7Le/6rZ/6za/8Pm/6bX/sjp/7fe/J/T/bPe/6ra/7/k/5vQ/Lbg/sLm/8zr/7ri/rHd/77k/5rP/KjY/6zb/8Tm/rrg/Mjo/8bo/87r/8Tn/8bn/8Dl/6XW/s3q/8Ll/qPV/r/j/rfg/sXm/sfo/6LV/rbe/MLl/7Lc/bXf/s7s/67d/73j/5jO/Mrq/7zi/rrh/pfN/Ljh/rvh/MDj/ZbN/LTd/KjY/rnf/Kza/r7i/aLU/qHU/cjo/rvg/KXV/Ljf/bni/sDk/6fX/8np/sPl/qrY/cfo/sXn/qnY/sHj/bHb/pbM/KTV/b/j/arZ/rPf/6fX/rPe/aHS/LXe/M/r/8Hk/bjg/r7j/7Da/Z7S/KvZ/a7Z/b3j/pnO/Lvh/qvb/6fV/abW/p/S/LXg/sno/rTe/ZzR/L3i/cDk/rbf/rng/qHT/Lvi/qvZ/sHk/qvY/bvg/bzj/63a/qTU/LLd/p3R/ZzR/bDe/7Te/77j/rDZ/bXd/szq/sHl/6DU/rzh/a7b/prQ/b3i/sro/pjN/J/R/JXM+7bf/ZvQ/bbd/KjX/K3b/ZTM/K3d/6rY/rDb/pvP/JTL+53R/K3Y/aXX/rPc/bXd/K7b/7rg/cno/7jf/KfY/qna/6DT/aDU/aTV/sbm/rnf/Z7T/afX/aPU/KrX/JrQ/Lzj/sTm/7Hd/rbe/aTW/aXW/J3Q/KbV/KbW/bzi/6rX/ZrO/K/Z/anZ/r3h/b/l/7Lb/rfh/qjX/qvX/bvj/qbW/KzZ/bvi/73k/7ff/rHa/qLT/KDS/K7Y/bXe/bHa/cTl/anY/bbd+6LU/aXW/bfg/bjg/aTV/Lrf/LPd/p/T/MTl/q/b/anX/JXN/MPm/qnY/77i/q/Y/ZfO/LPc+7Tc/ZnO+63Y/AAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QjAwMjY2NzMzQTQyMTFFODlFMUQ4ODdDOEJCNjY0RkEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QjAwMjY2NzQzQTQyMTFFODlFMUQ4ODdDOEJCNjY0RkEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpCMDAyNjY3MTNBNDIxMUU4OUUxRDg4N0M4QkI2NjRGQSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCMDAyNjY3MjNBNDIxMUU4OUUxRDg4N0M4QkI2NjRGQSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgH//v38+/r5+Pf29fTz8vHw7+7t7Ovq6ejn5uXk4+Lh4N/e3dzb2tnY19bV1NPS0dDPzs3My8rJyMfGxcTDwsHAv769vLu6ubi3trW0s7KxsK+urayrqqmop6alpKOioaCfnp2cm5qZmJeWlZSTkpGQj46NjIuKiYiHhoWEg4KBgH9+fXx7enl4d3Z1dHNycXBvbm1sa2ppaGdmZWRjYmFgX15dXFtaWVhXVlVUU1JRUE9OTUxLSklIR0ZFRENCQUA/Pj08Ozo5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K9cHYMOKfeC17NizZb2eHZu261qxbb++BRuXwly6ce+SzXu3rl6/ffnOBTxY8FvChw2vRbxYMVrHbCHDlRyW8eO2ekuUSOevgMICD6AwYVJAgunTp4GiXq16deqfrl/7jG26dWzbrnGzhk1bN2rfsnvSlgC8Nu/bx3Mn3z279/Lfz4PzHF6ceHTjPZl0qUHBc8KboSxV/1qwIIL58+fJq19PHr179vDdo4fPXn56+urtm8efXz//9v79p18E/5UXIH8DFpiggAfityCCDdL3oIMRxldhfReuN6GEGfZnn4IdVmJJFsR9hsoCJjSgYgMQtOiiiyvGGOOLNMpoI40v2igjjjDquCKPLfr4I5BCqggkBEWySGSRRybZJJNLCvmklFH6OKWVVep4pZZZ3tjljl/OGOaQPDo5pgkLtOGdTQt4QgQDcMI5wZx00hnnnXfWqSeefOpZJ594+mknoHEKOiehhRqKqJyKLmroBIsy8GikkzraKKKVYnopoZlyuimgnYL6aZ+jBlpqnqcmKiilpxLhyQJrHv9UgAlvjiCGArgq4MCuvPKa66+/9iossMQK2yuxwBrrK7K5Krsrs806Cy2uzjowra7STlvttdtqmy203YL7LbPhkjsusuWie26x6ybbbrDvRqsst+eKMQIDRJgQq0EFNMDACArIgMDAAydg8MEHE6ywwgg3vPDDDSP88MIRJzwxwRUbfDHGGW9ccMceZ5yAxwiITLLJIYO8Mcorq3wxyy+7PDHMM8sMsc0U48ywzhxXfLLLMihwbwP7FtQvA2LIYMDSTBtwwNNQQ9301EtHbTXVU1sdNdZNay0111V7fQDYYXtNttNiny322GSvrXbabcMNtttxm1231m/bPbfcXNP/vbfeffONtd+BAz443zKIwQDRn0HAgAIIFI733VdTvrXlX/89ueaVc36555lL3rnon5Me+uGGU0046pub/nTerbM+uuyl03666oLjnnrWciOgwOJFE1QABBMkDfrrmCN/PNvLwz677rFD/zzvu3edO/XRYz+99dUzvbr0tYN/u/bhkz8+99mjv73316tfvvtfJw78Z8GMwgnkLfucsv75R/wz/zEDYM0EeDMC5syAO0Ngz/y3Pwb2z2ENhOADJRZBCk7QYhfUWAUxGEAHdlCCH7RgCA8WtHvpqypTSaEKV8jCFrrwhTCMoQxnqJSa2PCGOMyhDnfIwx768IdADKIQDYdIxCIa8YhITOIPAwIAOw==";var s=i.win,r=i.doc,o=!0,f=!1,e,u,a=5e5,w=1e3;h={pendingDialogStack:[],_updateStacking:function(n){var u=this,r,t;if(r=u.pendingDialogStack,r.length==0){it();return}n!=!0&&tt();t=a;i.each(r,function(n){t++;n._dlgInfo.mask.style.zIndex=t++;n.style.zIndex=t})},pushDialog:function(n,t){var e=this,u,f=n.getBoundingClientRect();if(e.pendingDialogStack.length>=w){i.error("Too many modal dialogs.");return}u=r.createElement("div");u.className="dynamsoft-backdrop";t==!0&&(u.style.left=(f.x|f.left)+"px",u.style.top=(f.y|f.top)+"px",u.style.width=f.width+"px",u.style.height=f.height+"px");r.createEvent&&i.addEventListener(u,"click",function(t){if(n.dispatchEvent){var i=v(t);n.dispatchEvent(i)}});n.parentNode.insertBefore(u,n.nextSibling);n._dlgInfo.mask=u;e.pendingDialogStack.push(n);e._updateStacking(t)},removeDialog:function(n){var t=this,r,u;(r=i.isArray(t.pendingDialogStack)?i.indexOf(n,t.pendingDialogStack):-1,r!=-1)&&(t.pendingDialogStack.splice(r,1),u=n._dlgInfo.mask,u.parentNode.removeChild(u),n._dlgInfo.mask=null,t._updateStacking())}};i.dialog={setup:function(n,t){n.show=p.bind(n,f,t);n.showModal=p.bind(n,o,t);n.close=rt.bind(n);n._dlgInfo={}}};i.mask={container:!1,bConfined:!1,dlgMask:!1,preOnresize:!1,preOnscroll:!1};i.showMask=function(){var f,r,n,u,s;if(!i.mask.dlgMask){if(f=i.mask.bConfined,r=i.mask.container,r)for(n=r.getBoundingClientRect(),u=r.firstChild;u;){if(i.isFunction(u.getBoundingClientRect)){n=u.getBoundingClientRect();break}u=u.nextSibling}var t=document.createElement("div"),e="460px",o="300px";t.className="dynamsoft-dialog-wrap";i.mask.preOnresize=window.onresize?window.onresize:!1;i.mask.preOnscroll=window.onscroll?window.onscroll:!1;f&&n&&(window.onresize=window.onscroll=function(){n=r.getBoundingClientRect();for(var u=r.firstChild;u;){if(i.isFunction(u.getBoundingClientRect)){n=u.getBoundingClientRect();break}u=u.nextSibling}t.style.left=(n.x|n.left)+"px";t.style.top=(n.y|n.top)+"px";t.style.width=n.width+"px";n.width<470&&(e=n.width-10+"px");t.style.height=o=n.height+"px";i.mask.dlgMask&&(i.mask.dlgMask.close(),i.mask.dlgMask.showModal())},window.onscroll());s=['<div style="margin:0 auto; width:',e,";line-height:",o,'"><img src="',l,'" style="margin:0 auto; width:',e,'" /><\/div>'].join("");t.innerHTML=s;document.body.appendChild(t);i.mask.dlgMask=t;i.dialog.setup(i.mask.dlgMask,f);i.mask.dlgMask.showModal()}};i.hideMask=function(){var n=i.mask.dlgMask;n&&(n.close(),document.body.removeChild(n),i.mask.dlgMask=!1);window.onresize=i.mask.preOnresize?i.mask.preOnresize:null;i.mask.preOnresize=!1;window.onscroll=i.mask.preOnscroll?i.mask.preOnscroll:null;i.mask.preOnscroll=!1}}}(Dynamsoft),function(n){function et(){function n(i,r){return t.push(i+" ")>f.cacheLength&&delete n[t.shift()],n[i+" "]=r}var t=[];return n}function yt(n){for(var t=0,r=n.length,i="";t<r;t++)i+=n[t].value;return i}function u(n,r,u,f){var s,d,c,w,l,b,g,v=r&&r.ownerDocument,p=r?r.nodeType:9;if(u=u||[],typeof n!="string"||!n||p!==1&&p!==9&&p!==11)return u;if(!f){if((r?r.ownerDocument||r:h)!==t&&y(r),r=r||t,p!==11)if(l=di.exec(n))if(s=l[1]){if(p===9)if(c=r.getElementById(s)){if(c.id===s)return u.push(c),u}else return u;else if(v&&(c=v.getElementById(s))&&k(r,c)&&c.id===s)return u.push(c),u}else{if(l[2])return a.apply(u,r.getElementsByTagName(n)),u;if((s=l[3])&&i.getElementsByClassName&&r.getElementsByClassName)return a.apply(u,r.getElementsByClassName(s)),u}else(l=gi.exec(n))&&((s=l[1])?(p===9?(c=r.getElementById(s))&&c.id===s&&(r=c):v&&(c=v.getElementById(s))&&k(r,c)&&c.id===s&&(r=c),s="#"+s+" "):(s=l[2])?(a.apply(u,r.getElementsByTagName(n)),r=u[0],s=s+" "):(s=l[3])&&i.getElementsByClassName&&r.getElementsByClassName&&(a.apply(u,r.getElementsByClassName(s)),r=u[0],s=s+" "),n=n.replace(s,""));if(i.qsa&&!tt[n+" "]&&(!e||!e.test(n))){if(p!==1)v=r,g=n;else if(r.nodeName.toLowerCase()!=="object"){for((w=r.getAttribute("id"))?w=w.replace(ei,oi):r.setAttribute("id",w=o),b=rt(n),d=b.length;d--;)b[d]="#"+w+" "+yt(b[d]);g=b.join(",");v=r}if(g)try{return a.apply(u,v.querySelectorAll(g)),u}catch(nt){tt(n,!0)}finally{w===o&&r.removeAttribute("id")}}}return ti(n.replace(vt,"$1"),r,u,f)}function hi(n){return n[o]=!0,n}function l(n){var i=t.createElement("fieldset");try{return!!n(i)}catch(r){return!1}finally{i.parentNode&&i.parentNode.removeChild(i);i=null}}function pt(){}function ci(n,t){var i=t&&n,r=i&&n.nodeType===1&&t.nodeType===1&&n.sourceIndex-t.sourceIndex;if(r)return r;if(i)while(i=i.nextSibling)if(i===t)return-1;return n?1:-1}function li(){}function wt(n,t,i){var r=t.dir,u=t.next,f=u||r,e=i&&f==="parentNode",s=ai++;return t.first?function(t,i,u){while(t=t[r])if(t.nodeType===1||e)return n(t,i,u);return!1}:function(t,i,h){var c,l,a,v=[nt,s];if(h){while(t=t[r])if((t.nodeType===1||e)&&n(t,i,h))return!0}else while(t=t[r])if(t.nodeType===1||e)if(a=t[o]||(t[o]={}),l=a[t.uniqueID]||(a[t.uniqueID]={}),u&&u===t.nodeName.toLowerCase())t=t[r]||t;else{if((c=l[f])&&c[0]===nt&&c[1]===s)return v[2]=c[2];if(l[f]=v,v[2]=n(t,i,h))return!0}return!1}}function bt(n){return n.length>1?function(t,i,r){for(var u=n.length;u--;)if(!n[u](t,i,r))return!1;return!0}:n[0]}function tr(n,t,i){for(var r=0,f=t.length;r<f;r++)u(n,t[r],i);return i}function ot(n,t,i,r,u){for(var e,o=[],f=0,s=n.length,h=t!=null;f<s;f++)(e=n[f])&&(!i||i(e,r,u))&&(o.push(e),h&&t.push(f));return o}function kt(n,t,i,r,u,f){return r&&!r[o]&&(r=kt(r)),u&&!u[o]&&(u=kt(u,f)),hi(function(f,e,o,s){var l,c,v,w=[],p=[],b=e.length,k=f||tr(t||"*",o.nodeType?[o]:o,[]),y=n&&(f||!t)?ot(k,w,n,o,s):k,h=i?u||(f?n:b||r)?[]:e:y;if(i&&i(y,h,o,s),r)for(l=ot(h,p),r(l,[],o,s),c=l.length;c--;)(v=l[c])&&(h[p[c]]=!(y[p[c]]=v));if(f){if(u||n){if(u){for(l=[],c=h.length;c--;)(v=h[c])&&l.push(y[c]=v);u(null,h=[],l,s)}for(c=h.length;c--;)(v=h[c])&&(l=u?d(f,v):w[c])>-1&&(f[l]=!(e[l]=v))}}else h=ot(h===e?h.splice(b,h.length):h),u?u(null,e,h,s):a.apply(e,h)})}function dt(n){for(var e,r,i,s=n.length,h=f.relative[n[0].type],c=h||f.relative[" "],t=h?1:0,l=wt(function(n){return n===e},c,!0),a=wt(function(n){return d(e,n)>-1},c,!0),u=[function(n,t,i){var r=!h&&(i||t!==ut)||((e=t).nodeType?l(n,t,i):a(n,t,i));return e=null,r}];t<s;t++)if(r=f.relative[n[t].type])u=[wt(bt(u),r)];else{if(r=f.filter[n[t].type].apply(null,n[t].matches),r[o]){for(i=++t;i<s;i++)if(f.relative[n[i].type])break;return kt(t>1&&bt(u),t>1&&yt(n.slice(0,t-1).concat({value:n[t-2].type===" "?"*":""})).replace(vt,"$1"),r,t<i&&dt(n.slice(t,i)),i<s&&dt(n=n.slice(i)),i<s&&yt(n))}u.push(r)}return bt(u)}function ir(n,i){var r=i.length>0,e=n.length>0,o=function(o,s,h,c,l){var v,d,b,k=0,p="0",g=o&&[],w=[],tt=ut,it=o||e&&f.find.TAG("*",l),rt=nt+=tt==null?1:Math.random()||.1,ft=it.length;for(l&&(ut=s===t||s||l);p!==ft&&(v=it[p])!=null;p++){if(e&&v){for(d=0,s||v.ownerDocument===t||(y(v),h=!ii);b=n[d++];)if(b(v,s||t,h)){c.push(v);break}l&&(nt=rt)}r&&((v=!b&&v)&&k--,o&&g.push(v))}if(k+=p,r&&p!==k){for(d=0;b=i[d++];)b(g,w,s,h);if(o){if(k>0)while(p--)g[p]||w[p]||(w[p]=vi.call(c));w=ot(w)}a.apply(c,w);l&&!o&&w.length>0&&k+i.length>1&&u.uniqueSort(c)}return l&&(nt=rt,ut=tt),g};return r?hi(o):o}var gt=20200521,nr;if(!n._sizzle_ver||!n.isNumber(n._sizzle_ver)||!(n._sizzle_ver>=gt)){n._sizzle_ver=gt;var s=RegExp,i,f,st,rt,ni,ti,ut,v,w,y,t,c,ii=!0,e,b,ft,k,o="dws_"+1*new Date,h=window.document,nt=0,ai=0,ht,ct,lt,tt,at=function(n,t){return n===t&&(w=!0),0},p=[],vi=p.pop,yi=p.push,a=p.push,ri=p.slice,d=function(n,t){for(var i=0,r=n.length;i<r;i++)if(n[i]===t)return i;return-1},ui="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",r="[\\x20\\t\\r\\n\\f]",g="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",pi=["\\[",r,"*(",g,")(?:",r,"*([*^$|!~]?=)",r,"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(",g,"))|)",r,"*\\]"].join(""),wi=new s(r+"+","g"),vt=new s(["^",r,"+|((?:^|[^\\\\])(?:\\\\.)*)",r,"+$"].join(""),"g"),bi=new s(["^",r,"*,",r,"*"].join("")),ki=new s(["^",r,"*([>+~]|",r,")",r,"*"].join("")),rr=new s("^"+g+"$"),fi={ID:new s("^#("+g+")"),CLASS:new s("^\\.("+g+")"),TAG:new s("^("+g+"|[*])"),ATTR:new s("^"+pi),needsContext:new s(["^",r,"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(",r,"*((?:-\\d)?\\d*)",r,"*\\)|)(?=[^-]|$)"].join(""),"i")},it=/^[^{]+\{\s*\[native \w/,di=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,gi=/^(?:#([\w-]+)|(\w+)|\.([\w-]+)) .*$/,ei=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,oi=function(n,t){return t?n==="\0"?"":n.slice(0,-1)+"\\"+n.charCodeAt(n.length-1).toString(16)+" ":"\\"+n},si=function(){y()};ht=et();ct=et();lt=et();tt=et();try{a.apply(p=ri.call(h.childNodes),h.childNodes);nr=p[h.childNodes.length].nodeType}catch(ur){a={apply:p.length?function(n,t){yi.apply(n,ri.call(t))}:function(n,t){for(var i=n.length,r=0;n[i++]=t[r++];);n.length=i-1}}}i=u.support={};y=u.setDocument=function(n){var y,u,a=n?n.ownerDocument||n:h;return a===t||a.nodeType!==9||!a.documentElement?t:(t=a,c=t.documentElement,h!==t&&(u=t.defaultView)&&u.top!==u&&(u.addEventListener?u.addEventListener("unload",si,!1):u.attachEvent&&u.attachEvent("onunload",si)),i.attributes=l(function(n){return n.className="i",!n.getAttribute("className")}),i.getElementsByTagName=l(function(n){return n.appendChild(t.createComment("")),!n.getElementsByTagName("*").length}),i.getElementsByClassName=it.test(t.getElementsByClassName),i.getById=l(function(n){return c.appendChild(n).id=o,!t.getElementsByName||!t.getElementsByName(o).length}),f.filter.ID=i.getById?function(n){var t=n;return function(n){return n.getAttribute("id")===t}}:function(n){var t=new s(["^",n,"$"].join(""),"g");return function(n){var i=typeof n.getAttributeNode!="undefined"&&n.getAttributeNode("id");return i&&t.test(i.value)}},f.find.TAG=i.getElementsByTagName?function(n,t){return typeof t.getElementsByTagName!="undefined"?t.getElementsByTagName(n):i.qsa?t.querySelectorAll(n):void 0}:function(n,t){var i,r=[],f=0,u=t.getElementsByTagName(n);if(n==="*"){while(i=u[f++])i.nodeType===1&&r.push(i);return r}return u},f.find.CLASS=i.getElementsByClassName&&function(n,t){if(typeof t.getElementsByClassName!="undefined")return t.getElementsByClassName(n)},b=[],e=[],(i.qsa=it.test(t.querySelectorAll))&&(l(function(n){c.appendChild(n).innerHTML="<a id='"+o+"'><\/a><select id='"+o+"-\r\\' msallowcapture=''><option selected=''><\/option><\/select>";n.querySelectorAll("[msallowcapture^='']").length&&e.push("[*^$]="+r+"*(?:''|\"\")");n.querySelectorAll("[selected]").length||e.push("\\["+r+"*(?:value|"+ui+")");n.querySelectorAll("[id~="+o+"-]").length||e.push("~=");n.querySelectorAll(":checked").length||e.push(":checked");n.querySelectorAll("a#"+o+"+*").length||e.push(".#.+[+~]")}),l(function(n){n.innerHTML="<a href='' disabled='disabled'><\/a><select disabled='disabled'><option/><\/select>";var i=t.createElement("input");i.setAttribute("type","hidden");n.appendChild(i).setAttribute("name","D");n.querySelectorAll("[name=d]").length&&e.push("name"+r+"*[*^$|!~]?=");n.querySelectorAll(":enabled").length!==2&&e.push(":enabled",":disabled");c.appendChild(n).disabled=!0;n.querySelectorAll(":disabled").length!==2&&e.push(":enabled",":disabled");n.querySelectorAll("*,:x");e.push(",.*:")})),(i.matchesSelector=it.test(ft=c.matches||c.webkitMatchesSelector||c.mozMatchesSelector||c.oMatchesSelector||c.msMatchesSelector))&&l(function(n){i.disconnectedMatch=ft.call(n,"*");ft.call(n,"[s!='']:x")}),e=e.length&&new s(e.join("|")),b=b.length&&new s(b.join("|")),y=it.test(c.compareDocumentPosition),k=y||it.test(c.contains)?function(n,t){var r=n.nodeType===9?n.documentElement:n,i=t&&t.parentNode;return n===i||!!(i&&i.nodeType===1&&(r.contains?r.contains(i):n.compareDocumentPosition&&n.compareDocumentPosition(i)&16))}:function(n,t){if(t)while(t=t.parentNode)if(t===n)return!0;return!1},at=y?function(n,r){if(n===r)return w=!0,0;var u=!n.compareDocumentPosition-!r.compareDocumentPosition;return u?u:(u=(n.ownerDocument||n)===(r.ownerDocument||r)?n.compareDocumentPosition(r):1,u&1||!i.sortDetached&&r.compareDocumentPosition(n)===u)?n===t||n.ownerDocument===h&&k(h,n)?-1:r===t||r.ownerDocument===h&&k(h,r)?1:v?d(v,n)-d(v,r):0:u&4?-1:1}:function(n,i){if(n===i)return w=!0,0;var r,u=0,o=n.parentNode,s=i.parentNode,f=[n],e=[i];if(o&&s){if(o===s)return ci(n,i)}else return n===t?-1:i===t?1:o?-1:s?1:v?d(v,n)-d(v,i):0;for(r=n;r=r.parentNode;)f.unshift(r);for(r=i;r=r.parentNode;)e.unshift(r);while(f[u]===e[u])u++;return u?ci(f[u],e[u]):f[u]===h?-1:e[u]===h?1:0},t)};u.matches=function(n,t){return u(n,null,null,t)};u.matchesSelector=function(n,r){if((n.ownerDocument||n)!==t&&y(n),i.matchesSelector&&!tt[r+" "]&&(!b||!b.test(r))&&(!e||!e.test(r)))try{var f=ft.call(n,r);if(f||i.disconnectedMatch||n.document&&n.document.nodeType!==11)return f}catch(o){tt(r,!0)}return u(r,t,null,[n]).length>0};u.contains=function(n,i){return(n.ownerDocument||n)!==t&&y(n),k(n,i)};u.escape=function(n){return(n+"").replace(ei,oi)};u.error=function(n){throw new Error("Syntax error: "+n);};u.uniqueSort=function(n){var u,f=[],t=0,r=0;if(w=!i.detectDuplicates,v=!i.sortStable&&n.slice(0),n.sort(at),w){while(u=n[r++])u===n[r]&&(t=f.push(r));while(t--)n.splice(f[t],1)}return v=null,n};st=u.getText=function(n){var r,i="",u=0,t=n.nodeType;if(t){if(t===1||t===9||t===11){if(typeof n.textContent=="string")return n.textContent;for(n=n.firstChild;n;n=n.nextSibling)i+=st(n)}else if(t===3||t===4)return n.nodeValue}else while(r=n[u++])i+=st(r);return i};f=u.selectors={cacheLength:50,match:fi,find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(n){return n[3]=n[3]||n[4]||n[5]||"",n[2]==="~="&&(n[3]=" "+n[3]+" "),n.slice(0,4)}},filter:{TAG:function(n){var t=n.toLowerCase();return n==="*"?function(){return!0}:function(n){return n.nodeName&&n.nodeName.toLowerCase()===t}},CLASS:function(n){var t=ht[n+" "];return t||(t=new s("(^|"+r+")"+n+"("+r+"|$)"))&&ht(n,function(n){return t.test(typeof n.className=="string"&&n.className||typeof n.getAttribute!="undefined"&&n.getAttribute("class")||"")})},ATTR:function(n,t,i){return function(r){var f=u.attr(r,n);return f==null?t==="!=":t?(f+="",t==="="?f===i:t==="!="?f!==i:t==="^="?i&&f.indexOf(i)===0:t==="*="?i&&f.indexOf(i)>-1:t==="$="?i&&f.slice(-i.length)===i:t==="~="?(" "+f.replace(wi," ")+" ").indexOf(i)>-1:t==="|="?f===i||f.slice(0,i.length+1)===i+"-":!1):!0}}}};li.prototype=f.filters=f.pseudos;f.setFilters=new li;rt=u.tokenize=function(n,t){var e,r,s=[],o,i,h,c,l=ct[n+" "];if(l)return t?0:l.slice(0);for(i=n,h=[],c=f.preFilter;i;){(!e||(r=bi.exec(i)))&&(r&&(i=i.slice(r[0].length)||i),h.push(s=[]));e=!1;(r=ki.exec(i))&&(e=r.shift(),s.push({value:e,type:r[0].replace(vt," ")}),i=i.slice(e.length));for(o in f.filter)(r=fi[o].exec(i))&&(!c[o]||(r=c[o](r)))&&(e=r.shift(),s.push({value:e,type:o,matches:r}),i=i.slice(e.length));if(!e)break}return t?i.length:i?u.error(n):ct(n,h).slice(0)};ni=u.compile=function(n,t){var r,u=[],f=[],i=lt[n+" "];if(!i){for(t||(t=rt(n)),r=t.length;r--;)i=dt(t[r]),i[o]?u.push(i):f.push(i);i=lt(n,ir(f,u));i.selector=n}return i};ti=u.select=function(n,t,i,r){var u=typeof n=="function"&&n,f=!r&&rt(n=u.selector||n);return i=i||[],(u||ni(n,f))(r,t,!ii,i,!t||t),i};i.sortStable=o.split("").sort(at).join("")===o;i.detectDuplicates=!!w;y();i.sortDetached=l(function(n){return n.compareDocumentPosition(t.createElement("fieldset"))&1});l(function(n){return n.innerHTML="<a href='#'><\/a>",n.firstChild.getAttribute("href")==="#"})||pt("type|href|height|width",function(n,t){return n.getAttribute(t,t.toLowerCase()==="type"?1:2)});i.attributes&&l(function(n){return n.innerHTML="<input/>",n.firstChild.setAttribute("value",""),n.firstChild.getAttribute("value")===""})||pt("value",function(n){if(n.nodeName.toLowerCase()==="input")return n.defaultValue});l(function(n){return n.getAttribute("disabled")==null})||pt(ui,function(n,t){var i;return n[t]===!0?t.toLowerCase():(i=n.getAttributeNode(t))&&i.specified?i.value:null});n.support=i;n.sizzle=u}}(Dynamsoft.Lib),function(n){function e(){var n,i;v.appendChild(s);t.style.cssText="-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%";u=p=b=!1;y=w=!0;window.getComputedStyle&&(i=window.getComputedStyle(t),u=(i||{}).top!=="1%",b=(i||{}).marginLeft==="2px",p=(i||{width:"4px"}).width==="4px",t.style.marginRight="50%",y=(i||{marginRight:"4px"}).marginRight==="4px",n=t.appendChild(document.createElement("div")),n.style.cssText=t.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",n.style.marginRight=n.style.width="0",t.style.width="1px",w=!parseFloat((window.getComputedStyle(n)||{}).marginRight),t.removeChild(n));t.style.display="none";f=t.getClientRects().length===0;f&&(t.style.display="",t.innerHTML="<table><tr><td><\/td><td>t<\/td><\/tr><\/table>",t.childNodes[0].style.borderCollapse="separate",n=t.getElementsByTagName("td"),n[0].style.cssText="margin:0;border:0;padding:0;display:none",f=n[0].offsetHeight===0,f&&(n[0].style.display="",n[1].style.display="none",f=n[0].offsetHeight===0));v.removeChild(s)}function ht(n){if(n in g)return n;for(var i=n.charAt(0).toUpperCase()+n.slice(1),t=ot.length;t--;)if(n=ot[t]+i,n in g)return n}function oi(n){var i=fi.split("|"),t=n.createDocumentFragment();if(t.createElement)while(i.length)t.createElement(i.pop());return t}function si(t,u){for(var o,f,y,e,a,v,s,p=t.length,h=oi(u),c=[],l=0;l<p;l++)if(f=t[l],f||f===0)if(n.type(f)==="object")i.merge(c,f.nodeType?[f]:f);else if(gt.test(f)){for(e=e||h.appendChild(u.createElement("div")),a=(dt.exec(f)||["",""])[1].toLowerCase(),s=et[a]||et._default,e.innerHTML=s[1]+i.htmlPrefilter(f)+s[2],o=s[0];o--;)e=e.lastChild;if(!r.leadingWhitespace&&rt.test(f)&&c.push(u.createTextNode(rt.exec(f)[0])),!r.tbody)for(f=a==="table"&&!ut.test(f)?e.firstChild:s[1]==="<table>"&&!ut.test(f)?e:0,o=f&&f.childNodes.length;o--;)i.nodeName(v=f.childNodes[o],"tbody")&&!v.childNodes.length&&f.removeChild(v);for(i.merge(c,e.childNodes),e.textContent="";e.firstChild;)e.removeChild(e.firstChild);e=h.lastChild}else c.push(u.createTextNode(f));for(e&&h.removeChild(e),l=0;f=c[l++];)f.tagName!=="SCRIPT"&&(y=it.contains(f.ownerDocument,f),h.appendChild(f));return e=null,h}function lt(t,i,r,u,f){for(var e=r===(u?"border":"content")?4:i==="width"?1:0,o=0;e<4;e+=2)r==="margin"&&(o+=n.css(t,r+h[e],!0,f)),u?(r==="content"&&(o-=n.css(t,"padding"+h[e],!0,f)),r!=="margin"&&(o-=n.css(t,"border"+h[e]+"Width",!0,f))):(o+=n.css(t,"padding"+h[e],!0,f),r!=="padding"&&(o+=n.css(t,"border"+h[e]+"Width",!0,f)));return o}function at(t,i,u){var s=!0,f=i==="width"?t.offsetWidth:t.offsetHeight,e=o(t),h=r.boxSizing&&n.css(t,"boxSizing",!1,e)==="border-box";if(f<=0||f==null){if(f=c(t,i,e),(f<0||f==null)&&(f=t.style[i]),d.test(f))return f;s=h&&(r.boxSizingReliable()||f===t.style[i]);f=parseFloat(f)||0}return f+lt(t,i,u||(h?"border":"content"),s,e)}function vt(n){var t=new RegExp("^(?:([+-])=|)("+k+")([a-z%]*)$","i");return t.exec(n)}function hi(n,t,i){var r=bt.exec(t);return r?Math.max(0,r[1]-(i||0))+(r[2]||"px"):t}function ci(t,r,u,f){var c,o=1,a=20,l=f?function(){return f.cur()}:function(){return n.css(t,r,"")},h=l(),s=u&&u[3]||(i.cssNumber[r]?"":"px"),e=(i.cssNumber[r]||s!=="px"&&+h)&&vt(n.css(t,r));if(e&&e[3]!==s){s=s||e[3];u=u||[];e=+h||1;do o=o||".5",e=e/o,n.style(t,r,e+s);while(o!==(o=l()/h)&&o!==1&&--a)}return u&&(e=+e||+h||0,c=u[1]?e+(u[1]+1)*u[2]:+u[2],f&&(f.unit=s,f.start=e,f.end=c)),c}var yt=Array.prototype,li=yt.slice,l=n.doc,a=n.each,v=l.documentElement,tt=20200521,st,i,ct;if(!n._ui_nodelistExt_ver||!n.isNumber(n._ui_nodelistExt_ver)||!(n._ui_nodelistExt_ver>=tt)){n._ui_nodelistExt_ver=tt;var r=n.support,it=n.sizzle,u,y,p,f,w,b,s=l.createElement("div"),t=l.createElement("div");if(t.style){t.style.cssText="float:left;opacity:.5";r.opacity=t.style.opacity==="0.5";r.cssFloat=!!t.style.cssFloat;t.style.backgroundClip="content-box";t.cloneNode(!0).style.backgroundClip="";r.clearCloneStyle=t.style.backgroundClip==="content-box";s=document.createElement("div");s.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute";t.innerHTML="";s.appendChild(t);r.boxSizing=t.style.boxSizing===""||t.style.MozBoxSizing===""||t.style.WebkitBoxSizing==="";n.mix(r,{reliableHiddenOffsets:function(){return u==null&&e(),f},boxSizingReliable:function(){return u==null&&e(),p},pixelMarginRight:function(){return u==null&&e(),y},pixelPosition:function(){return u==null&&e(),u},reliableMarginRight:function(){return u==null&&e(),w},reliableMarginLeft:function(){return u==null&&e(),b}});var o,c,pt=/^margin/,wt=/^(top|right|bottom|left)$/,k=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,d=new RegExp("^("+k+")(?!px)[a-z%]+$","i"),bt=new RegExp("^("+k+")(.*)$","i");window.getComputedStyle?(o=function(t){var r,i;return r=n.isFunction(t.getEL)?t.getEL():t,i=r.ownerDocument.defaultView,i&&i.opener||(i=window),i.getComputedStyle(r)},c=function(t,i,u){var s,h,c,f,e=t.style;return u=u||o(t),f=u?u.getPropertyValue(i)||u[i]:undefined,f!==""&&f!==undefined||it.contains(t.ownerDocument,t)||(f=n.style(t,i)),u&&!r.pixelMarginRight()&&d.test(f)&&pt.test(i)&&(s=e.width,h=e.minWidth,c=e.maxWidth,e.minWidth=e.maxWidth=e.width=f,f=u.width,e.width=s,e.minWidth=h,e.maxWidth=c),f===undefined?f:f+""}):v.currentStyle&&(o=function(n){return n.currentStyle},c=function(n,t,i){var s,f,e,r,u=n.style;return i=i||o(n),r=i?i[t]:undefined,r==null&&u&&u[t]&&(r=u[t]),d.test(r)&&!wt.test(t)&&(s=u.left,f=n.runtimeStyle,e=f&&f.left,e&&(f.left=n.currentStyle.left),u.left=t==="fontSize"?"1em":r,r=u.pixelLeft+"px",u.left=s,e&&(f.left=e)),r===undefined?r:r+""||"auto"});var kt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,dt=/<([\w:-]+)/,rt=/^\s+/,gt=/<|&#?\w+;/,ut=/<tbody/i,ni=/^-ms-/,ti=/-([\da-z])/gi,ii=/^(none|table(?!-c[ea]).+)/,ri=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,ui={position:"absolute",visibility:"hidden",display:"block"},ft={letterSpacing:"0",fontWeight:"400"},h=["Top","Right","Bottom","Left"],et={option:[1,"<select multiple='multiple'>","<\/select>"],legend:[1,"<fieldset>","<\/fieldset>"],area:[1,"<map>","<\/map>"],param:[1,"<object>","<\/object>"],thead:[1,"<table>","<\/table>"],tr:[2,"<table><tbody>","<\/tbody><\/table>"],col:[2,"<table><tbody><\/tbody><colgroup>","<\/colgroup><\/table>"],td:[3,"<table><tbody><tr>","<\/tr><\/tbody><\/table>"],_default:r.htmlSerialize?[0,"",""]:[1,"X<div>","<\/div>"]},g,ot=["Webkit","O","Moz","ms"],fi="abbr|article|aside|audio|bdi|canvas|data|datalist|details|dialog|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|picture|progress|section|summary|template|time|video",nt=document.createElement("div");nt.style&&(g=nt.style,r.cssFloat=!!nt.style.cssFloat,st=function(n,t){return t.toUpperCase()},i={type:n.type,cssHooks:{},htmlPrefilter:function(n){return n.replace(kt,"<$1><\/$2>")},nodeName:function(n,t){return n.nodeName&&n.nodeName.toLowerCase()===t.toLowerCase()},merge:function(n,t){for(var r=+t.length,i=0,u=n.length;i<r;)n[u++]=t[i++];if(r!==r)while(t[i]!==undefined)n[u++]=t[i++];return n.length=u,n},camelCase:function(n){return n.replace(ni,"ms-").replace(ti,st)},cssProps:{float:r.cssFloat?"cssFloat":"styleFloat"},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0}},ct=function(n,t,i,r){var u,f={};return a(t,function(i,r){f[r]=n.style[r];n.style[r]=t[r]}),u=i.apply(n,r||[]),a(t,function(t,i){n.style[i]=f[i]}),u},a(["height","width"],function(t){i.cssHooks[t]={get:function(i,r,u){if(r)return ii.test(n.css(i,"display"))&&i.offsetWidth===0?ct(i,ui,function(){return at(i,t,u)}):at(i,t,u)},set:function(i,u,f){var e=f&&o(i);return hi(i,u,f?lt(i,t,f,r.boxSizing&&n.css(i,"boxSizing",!1,e)==="border-box",e):0)}}}),n.style=function(n,t,u,f){if(n&&n.nodeType!==3&&n.nodeType!==8&&n.style){var e,h,o,s=i.camelCase(t),c=n.style;if(t=i.cssProps[s]||(i.cssProps[s]=ht(s)||s),o=i.cssHooks[t]||i.cssHooks[s],u!==undefined){if(h=typeof u,h==="string"&&(e=vt(u))&&e[1]&&(u=ci(n,t,e),h="number"),u==null||u!==u)return;h==="number"&&(u+=e&&e[3]||(i.cssNumber[s]?"":"px"));r.clearCloneStyle||u!==""||t.indexOf("background")!==0||(c[t]="inherit");o&&"set"in o&&(u=o.set(n,u,f))===undefined||(c[t]=u)}else return o&&"get"in o&&(e=o.get(n,!1,f))!==undefined?e:c[t]+""}},n.css=function(n,t,r,u){var s,f,o,e=i.camelCase(t);return(t=i.cssProps[e]||(i.cssProps[e]=ht(e)||e),o=i.cssHooks[t]||i.cssHooks[e],o&&"get"in o&&(f=o.get(n,!0,r)),f===undefined&&(f=c(n,t,u)),f==="normal"&&t in ft&&(f=ft[t]),r===""||r)?(s=parseFloat(f),r===!0||isFinite(s)?s||0:f):f},n.parseHTML=function(n,t){if(!n||typeof n!="string")return[];typeof t=="boolean"&&(t=!1);t=t||document;var r=ri.exec(n);return r?[t.createElement(r[1])]:(r=si([n],t),i.merge([],r.childNodes))})}}}(Dynamsoft.Lib);Dynamsoft.Ready(function(n){function t(t){var r=this;r.__attrs={};n.mix(r.__attrs,{action:u,data:{},bChunkedSendData:f,blockSize:0,ajaxConfig:{value:{},type:"post",processData:i,cache:i,dataType:"text","async":f,contentType:i,retry:0,headers:{"X-Requested-With":i}},ajax:u,formData:u,CORS:i,bOnlyEmptyIsOK:f});n.mix(r.__attrs,t);r._setWithCredentials()}function r(t){var r=this;r.__attrs={};n.mix(r.__attrs,{action:u,retry:0,timeout:0,CORS:i,"async":f,dataType:"text",fileStatus:u,uploadType:i,data:{},bOnlyEmptyIsOK:f});n.mix(r.__attrs,t);r._init()}var u="",e="[bio]: ",f=!0,i=!1,s=n.win,o=s&&s.FormData;n.mix(t,{event:{SUCCESS:"success",ERROR:"error",PROGRESS:"progress"},status:{SUCCESS:"success",ERROR:"error"}});n.mix(t.prototype,n.obj.customEvent);n.mix(t.prototype,{get:function(n){var t=this;return n in t.__attrs?t.__attrs[n]:""},set:function(n,t){var i=this;n in i.__attrs&&(i.__attrs[n]=t)},_setWithCredentials:function(){var t=this,r=t.get("CORS"),i=t.get("ajaxConfig");return n.mix(i,{xhrFields:{withCredentials:!1}}),i},uploadToServer:function(n){var t=this,i=t.get("blockSize");return i>0&&n&&n.size>0?t._chunkedUpload(n):t._fullUpload(n)},uploadFilesToServer:function(n){return this._fullUploadFiles(n)},_fullUpload:function(i){var r=this,u=r.get("ajaxConfig"),f=!0,o=function(i){var u="";i&&(i&&n.isArray(i)&&i.length>1?u=i[0]:n.isString(i)&&(u=i));u=r._processResponse(u);r.fire(t.event.SUCCESS,u)},s=function(t,u,e){var o,s;f=!1;t&&n.isArray(t)&&t.length>2?(o=t[1],s=t[2]):(o=u,s=e);r._errorHandler(s,o,i)},e;return r._setFormData(),i&&i.size>0&&(r._addFileData(i),r.name=n.isString(i.name)&&i.name!=""?i.name:i.fileName),n.mix(u,{data:r.get("formData"),url:r.get("action"),beforeSend:function(n){n.upload.addEventListener("progress",function(n){r.fire(t.event.PROGRESS,{loaded:n.loaded,total:n.total,name:r.name})},!1)}}),n.mix(u,{method:"POST",onSuccess:o,onError:s}),e=n.ajax(u),r.set("formData",null),u.async?(r.set("ajax",e),!0):(r.set("ajax",!1),f)},_fullUploadFiles:function(i){var r=this,f=r.get("ajaxConfig"),e=!0,u=[],s=function(i){var f="";u=[];i&&(i&&n.isArray(i)&&i.length>1?f=i[0]:n.isString(i)&&(f=i));f=r._processResponse(f);r.fire(t.event.SUCCESS,f)},h=function(t,f,o){var s,h;e=!1;u=[];t&&n.isArray(t)&&t.length>2?(s=t[1],h=t[2]):(s=f,h=o);r._errorHandler(h,s,i)},o;return r._setFormData(),n.each(i,function(t){t&&t.size>0?(r._addFileData(t),n.isString(t.name)&&t.name!=""?u.push(t.name):u.push(t.fileName)):u.push("")}),n.mix(f,{data:r.get("formData"),url:r.get("action"),beforeSend:function(n){n.upload.addEventListener("progress",function(n){r.fire(t.event.PROGRESS,{loaded:n.loaded,total:n.total,name:""})},!1)}}),n.mix(f,{method:"POST",onSuccess:s,onError:h}),r.name="",o=n.ajax(f),r.set("formData",null),f.async?(r.set("ajax",o),!0):(r.set("ajax",!1),e)},_chunkedUpload:function(i){function o(a){var y=l.call(i,u,u+c,i.type),p=y.size,v=i.name;r._setContentRange(u,p,e);r._setFormData();a&&r.set("data",[]);n.isString(v)&&v!=""||(v=i.fileName);y.name=v;r.name=v;r._addFileData(y);n.mix(f,{data:r.get("formData")});n.mix(f,{method:"POST",onSuccess:function(n,i,f){u=r._getUploadedBytes(f)||u+p;r.fire(t.event.PROGRESS,{loaded:u,total:e,name:r.name});u<e?o(!1):s(n)},onError:h});n.ajax(f);r.set("formData",null)}var r=this,f=r.get("ajaxConfig"),s=function(i){var u="";i&&(i&&n.isArray(i)&&i.length>1?u=i[0]:n.isString(i)&&(u=i));u=r._processResponse(u);r.fire(t.event.SUCCESS,u)},h=function(t,u,f){var e,o;t&&n.isArray(t)&&t.length>2?(e=t[1],o=t[2]):(e=u,o=f);r._errorHandler(o,e,i)};n.mix(f,{url:r.get("action")});var e=i.size,u=0,c=r.get("blockSize")||e,l=i.slice||i.webkitSlice||i.mozSlice;o(!0)},abort:function(){var t=this,i=t.get("ajax");return n.isObject(i)?(i.abort(),t.set("ajax",!1),t):(n.log(e+"abort(), the value of io invalid!"),t)},_setFormData:function(){var t=this,i=t.get("data"),r;if(!o){n.log(e+"the browser does not support ajax.");return}if(i instanceof o)t.set("formData",i);else{r=new o;try{n.each(i,function(n,t){r.append(t,n)});t.set("formData",r)}catch(u){n.log(e+"something error when reset FormData.")}}},setRequestHeader:function(n,t){var i=this,r=i.get("ajaxConfig");return r.headers[n]=t,i.set("ajaxConfig",r),t},_addFileData:function(t){if(!n.isObject(t))return n.log(e+"_addFileData(), file parameter invalid!"),!1;var u=this,i=u.get("formData"),f=t.name,r=t.remoteFilename;return r||(r="RemoteFile"),i.append(r,t,f),u.set("formData",i),i},_errorHandler:function(n,i){var u=this,f=t.status.ERROR,e=u.name,r={status:f,msg:i,response:!1,name:e};n&&(r.httpStatus=n.status,r.response=n.responseText);u.fire(f,r)},_getUploadedBytes:function(n){var i=n.getResponseHeader("Range"),t=i&&i.split("-"),r=t&&t.length>1&&parseInt(t[1],10);return r&&r+1},_setContentRange:function(n,t,i){var r="bytes "+n+"-"+(n+t-1)+"/"+i,u=this,f=u.get("ajaxConfig"),e=f.headers;return e["Content-Range"]=r,r},_processResponse:function(i){var l=this,f,e,u,s=!1,r=l.name,o=t.status.SUCCESS,a=t.event.ERROR,h,c;if(n.log("Response from server: "+i),!l.get("bOnlyEmptyIsOK"))return{status:o,msg:!1,json:!1,response:i,name:r};if(n.isUndefined(i)||i==="")f={status:o,msg:!1,json:!1,response:"",name:r};else if(n.isString(i)){try{for(e=0;e<i.length;e++){if(e>10)break;if(u=i[e],u=="{"){s=!0;break}else if(u!=" "&&u!="\r"&&u!="\n"&&u!="\t")break}s&&(h=n.parse(i),f=h.status==1?{status:o,msg:!1,json:h,response:i,name:r}:{status:a,msg:!1,json:h,response:i,name:r})}catch(v){s=!1;n.log(v)}s||(c=String(i),c=c.replace(/( |\t|\r|\n)/g,""),f=c==""?{status:o,msg:!1,json:!1,response:i,name:r}:{status:a,msg:!1,json:!1,response:i,name:r})}else f={status:o,msg:!1,json:!1,response:"",name:r};return f}});n.mix(r,{event:{SUCCESS:"success",ERROR:"error",PROGRESS:"progress"}});n.mix(r.prototype,n.obj.customEvent);n.mix(r.prototype,{get:function(n){var t=this;return n in t.__attrs?t.__attrs[n]:""},set:function(n,t){var i=this;n in i.__attrs&&(i.__attrs[n]=t)},upload:function(t){var u=this,r=u.get("uploadType"),f,i;if(t){if(n.isArray(t))return f=t,r.uploadFilesToServer(f);if(n.isObject(t))return i=t,i.size?(i.id||(i.id=n.guid("file-")),i.size&&(i.textSize=u._convertByteSize(i.size))):i.size=0,r.uploadToServer(i)}return r.uploadToServer(t)},abort:function(){var n=this,t=n.get("uploadType");return t.abort(),!0},setRequestHeader:function(n,t){var i=this,r=i.get("uploadType");r.setRequestHeader(n,t)},_convertByteSize:function(n){var t=-1;do n=n/1024,t++;while(n>99&&t<4);return Math.max(n,.1).toFixed(1)+["KB","MB","GB","TB"][t]},_init:function(){var n=this,u={action:n.get("action"),data:n.get("data"),CORS:n.get("CORS"),bOnlyEmptyIsOK:n.get("bOnlyEmptyIsOK")},i=new t(u),r=i.get("ajaxConfig");r&&(r.dataType=n.get("dataType"),r.async=n.get("async"),r.retry=n.get("retry"));i.on(t.event.SUCCESS,n._uploadCompleteHandler,n);i.on(t.event.ERROR,n._uploadCompleteHandler,n);i.on(t.event.PROGRESS,n._uploadProgressHandler,n);return n.set("uploadType",i),i},_uploadProgressHandler:function(n){var t=this;t.fire(r.event.PROGRESS,n)},_uploadCompleteHandler:function(t){var i=this,f=t.status,u=t.msg,e=i.get("file");n.mix(t,{file:e});f==="success"?i.fire(r.event.SUCCESS,t):(u===!1||(u==="abort"?n.mix(t,{canceled:!0}):u==="timeout"&&n.mix(t,{timeout:!0})),i.fire(r.event.ERROR,t))}});n.BIO=r}),function(n){n.DWT={defaultEnv:{JSVersion:"16,1,0,0728",ServerVersionInfo:"16,1,0,0728",ServerLinuxVersionInfo:"16,1,0,0728",ServerMacVersionInfo:"16,1,0,0728",ActiveXVersion:"16,1,0,0728",PluginVersion:"11,1,0,0",PdfVersion:"11.0.0.0428",ProductName:"Dynamic Web TWAIN 16.1",Containers:[],ContainerMap:{},DynamicContainers:[],DynamicDWTMap:{},Trial:!1,ResourcesPath:"Resources",Debug:!1,IfUpdateService:!1,AutoLoad:!0,OnWebTwainReady:!1,UseDefaultInstallUI:!0,OnWebTwainNotFound:!1,OnWebTwainOldPluginNotAllowed:!1,OnWebTwainNeedUpgrade:!1,OnWebTwainNeedUpgradeWebJavascript:!1,OnWebTwainInitMessage:!1,IfUseViewer:!0,ViewerJSIntegerited:!0,ActiveXIntegerited:!0,ActiveXInstallWithCAB:!1,IfUseActiveXForIE10Plus:!1,IfCheck64bitServiceFirst:!1,IfDownload64bitService:!1,IfInstallDWTModuleWithZIP:!1,IfUseEmbeddedDownloadNoticeForActiveX:!1,IfCheckDCP:!1,IfCheckDWT:!0,IfDisableDefaultSettings:!1,OnWebTwainWillInit:!1,IfAddMD5InUploadHeader:!1,IfConfineMaskWithinTheViewer:!1,CustomizableDisplayInfo:{errorMessages:{ERR_MODULE_NOT_INSTALLED:"Error: The Dynamic Web TWAIN module is not installed.",ERR_BROWSER_NOT_SUPPORT:"Error: This browser is currently not supported.",ERR_CreateID_MustNotInContainers:"Error: Duplicate ContainerId detected for creating Dynamic Web TWAIN objects, please check and modify.",ERR_CreateID_NotContainer:"Error: The ID of the DIV for creating the new DWT object is invalid.",ERR_DWT_NOT_DOWNLOADED:"Error: Failed to download the Dynamic Web TWAIN module.",limitReachedForZoomIn:"Error: You have reached the limit for zooming in",limitReachedForZoomOut:"Error: You have reached the limit for zooming out",insufficientParas:"Error: Not enough parameters.",invalidAngle:"Error: The angle you entered is invalid.",invalidIndex:"Error: The index you entered is invalid.",invalidHeightOrWidth:"Error: The height or width you entered is invalid.",imageNotChanged:"Error: You have not changed the current image."},generalMessages:{checkingDWTVersion:"Checking WebTwain version ...",updatingDService:"Dynamsoft Service is updating ...",downloadingDWTModule:"Downloading the Dynamic Web TWAIN module.",refreshNeeded:"Please REFRESH your browser.",downloadNeeded:"Please download and install the Dynamic Web TWAIN.",DWTmoduleLoaded:"The Dynamic Web TWAIN module is loaded."},customProgressText:{upload:"Uploading...",download:"Downloading...",load:"Loading...",decode:"Decoding...",decodeTIFF:"Decoding tiff...",decodePDF:"Decoding pdf...",encode:"Encoding...",encodeTIFF:"Encoding tiff...",encodePDF:"Encoding pdf...",canvasLoading:"Loading ..."},buttons:{titles:{previous:"Previous Image",next:"Next Image",print:"Print Image",scan:"Acquire new Images",load:"Load local Images",rotateleft:"Rotate Left",rotate:"Rotate",rotateright:"Rotate Right",deskew:"Deskew",crop:"Crop Selected Area",erase:"Erase Selected Area",changeimagesize:"Change Image Size",flip:"Flip Image",mirror:"Mirror Image",zoomin:"Zoom In",originalsize:"Show Original Size",zoomout:"Zoom Out",stretch:"Stretch Mode",fit:"Fit Window",fitw:"Fit Horizontally",fith:"Fit Vertically",hand:"Hand Mode",rectselect:"Select Mode",zoom:"Click to Zoom In",restore:"Restore Orginal Image",save:"Save Changes",close:"Close the Editor",removeall:"Remove All Images",removeselected:"Remove All Selected Images"},bShowAllButtons:!0,visibility:{scan:!0,load:!0,print:!0,removeall:!0,removeselected:!0,rotateleft:!0,rotate:!0,rotateright:!0,deskew:!0,crop:!0,erase:!0,changeimagesize:!0,flip:!0,mirror:!0,zoomin:!0,originalsize:!0,zoomout:!0,stretch:!0,fit:!0,fitw:!0,fith:!0,hand:!0,rectselect:!0,zoom:!0}},dialogText:{dlgRotateAnyAngle:["Angle :","Interpolation:","Keep size","  OK  ","Cancel"],dlgChangeImageSize:["New Height :","New Width :","Interpolation method:","  OK  ","Cancel"],saveChangedImage:["You have changed the image. Do you want to keep the change(s)?","  Yes  ","  No  "],selectSource:["Select Source:","Select","Cancel","There is no source available!"]}}}};n.MSG={Loading:"Loading...",LoadingTiff:"Loading tiff...",LoadingPdf:"Loading pdf...",Encoding:"Encoding...",ConvertingToBlob:"Converting to blob...",ConvertingToBase64:"Converting to base64...",SavingPdf:"Saving pdf...",SavingTiff:"Saving tiff...",Downloading:"Downloading...",Uploading:"Uploading...",Wasm_Initializing:"Initializing...",Init_LookingLicense:"Looking for license...",Init_LoadingViewerJs:"Loading the viewer script...",Init_AllJsLoaded:"All scripts loaded.",Init_FireBeforeInitEvt:"OnWebTwainWillInit triggered.",Init_InitActiveX:"Initializing the ActiveX...",Init_InitH5:"Initializing...",Init_InitWasm:"Initializing WebAssembly mode...",Init_DownloadingWasm:"Downloading WebAssembly code...",Init_CompilingWasm:"Compiling WebAssembly code...",Init_InitDynamsoftService:"Initializing the Service mode...",Init_CheckDWT:"Looking for the service module...",Init_CheckDWTVersion:"Checking the service module...",Init_CreatingDWT:"Creating a WebTwain instance...",Init_ConfiguringDWT:"Configuring the WebTwain instance...",Init_SetLicenseForDWT:"Activating the WebTwain instance...",Init_GetLicenseInfoForDWT:"Decoding the license...",Init_CheckingLicense:"Checking the license...",Err_BrowserNotSupportWasm:"It looks like your browser doesn't support the WebAssembly technology which is required to use the library."}}(Dynamsoft);var OnWebTwainNotFoundOnWindowsCallback=OnWebTwainNotFoundOnWindowsCallback||!1,OnWebTwainNotFoundOnMacCallback=OnWebTwainNotFoundOnMacCallback||!1,OnWebTwainNotFoundOnLinuxCallback=OnWebTwainNotFoundOnLinuxCallback||!1,OnWebTwainOldPluginNotAllowedCallback=OnWebTwainOldPluginNotAllowedCallback||!1,OnWebTwainNeedUpgradeCallback=OnWebTwainNeedUpgradeCallback||!1,OnWebTwainPreExecuteCallback=OnWebTwainPreExecuteCallback||!1,OnWebTwainPostExecuteCallback=OnWebTwainPostExecuteCallback||!1,OnWebTwainShowUpdatingDialog=OnWebTwainShowUpdatingDialog||!1,OnWebTwainCloseUpdatingDialog=OnWebTwainCloseUpdatingDialog||!1,OnRemoteWebTwainNotFoundCallback=OnRemoteWebTwainNotFoundCallback||!1,OnRemoteWebTwainNeedUpgradeCallback=OnRemoteWebTwainNeedUpgradeCallback||!1,OnWebTWAINDllDownloadSuccessful=OnWebTWAINDllDownloadSuccessful||!1,OnWebTWAINDllDownloadFailure=OnWebTWAINDllDownloadFailure||!1,OnWebTWAINModuleDownloadManually=OnWebTWAINModuleDownloadManually||!1,Dynamsoft_ChangeConfig=Dynamsoft_ChangeConfig||!1,Dynamsoft_OnLoad=Dynamsoft_OnLoad||!1,Dynamsoft_OnNotReady=Dynamsoft_OnNotReady||!1,Dynamsoft_OnReady=Dynamsoft_OnReady||!1;(function(n){var t={},i=Dynamsoft.dcp;n.mix(t,Dynamsoft.DWT.defaultEnv);n.mix(t,Dynamsoft.WebTwainEnv);t.RegisterEvent=function(t,i){return(t==="OnWebTwainReady"||!Dynamsoft.WebTwainEnv.UseDefaultInstallUI)&&n.isFunction(i)?Dynamsoft.WebTwainEnv[t]=i:t==="OnWebTwainInitMessage"&&n.isFunction(i)&&(Dynamsoft.WebTwainEnv[t]=i),!0};Dynamsoft.WebTwainEnv=t;i.onReadys.push(function(){i.ifCheck64bitServiceFirst=Dynamsoft.WebTwainEnv.IfCheck64bitServiceFirst})})(Dynamsoft.Lib),function(n){var f=!0,t=!1,d=document.location.protocol,a=location.hostname,u=Dynamsoft.navInfoSync,v=u.bSSL,s=u.bHTML5Edition,y=t,p=t,w=t,h=0,r=location.pathname,l=0,i;i={config:{debug:t,devMode:t,usingMainMode:t,bDiscardBlankImage:t,msg:[],msgPrefix:'<span style="color:#cE5E04"><b>',msgSuffix:"<\/b><\/span><br />"},detect:{ssl:v,dcpStatus:0,dcpCallbackType:0,arySTwains:[],arySTwainsByIP:[],aryReconnectSTwains:[],bFirst:f,bOK:t,__dialog:t,scriptLoaded:t,wasmScriptLoaded:t,cssLoaded:t,viewerScriptLoaded:t,bNoControlEvent:t,bNeedUpgradeEvent:t,StartWSTimeoutId:t,StartWSByIPTimeoutId:t,bPromptJSOrServerOutdated:t,detectType:v?1:d==="http:"||a===""?0:-1,tryTimes:0,ports:[{port:18623,ssl:f},{port:18622,ssl:t}],win64Ports:[{port:18621,ssl:f},{port:18620,ssl:t}],cUrlIndex:0,urls:[],onNoControl:t,needUpgrade:t,onNotAllowedForChrome:t,OnDetectNext:t,OnCreatWS:t},page:{bUnload:t,OnUnload:t},tmp:{IfAllowLocalCache:f,EmptyFunction:function(){}}};i.appendMessage=function(n){typeof n=="string"?i.config.msg.push(n):Object.prototype.toString.call(n)==="[object Array]"&&Dynamsoft.Lib.each(n,function(n){i.appendMessage(n)})};i.appendRichMessage=function(n){i.appendMessage([i.config.msgPrefix,n,i.config.msgSuffix])};i.clearMessage=function(){var n=Dynamsoft.navInfoSync;return n.bIE&&n.IEVersion==8?i.config.msg.splice(0,i.config.msg.length):i.config.msg.splice(0),f};i.getRealPath=function(n){return n===undefined?"":i.env.pathType==1?i.env.basePath+n:i.env.basePath+n.replace(new RegExp("/","g"),"\\\\")};i.getHex=function(n){var t;return t=Number(n).toString(16).toUpperCase(),t.length==1&&(t=["0",t].join("")),t};i.getColor=function(n){var t,r,u;return u=n>>16,r=(n&65280)>>8,t=n&255,["#",i.getHex(u),i.getHex(r),i.getHex(t)].join("")};i.RGB2BGR=function(n){var t,i,r;return r=n>>16,i=n&65280,t=n&255,t<<16|i|r};i.BGR2RGB=i.RGB2BGR;i.isLocalIP=function(n){return n&&(n==="127.0.0.1"||n==="localhost"||n==="local.dynamsoft.com")};var b=navigator,e=b.userAgent.toLowerCase(),g=b.platform.toLowerCase(),k=!u.bMobile&&/win32|win64|windows/.test(g),nt=k&&/win64|x64/.test(e),c="",o="";e.indexOf("mac os x")>-1&&(c=e.match(/mac os x [\d._]*/gi),c=(c+"").replace(/[^0-9|_.]/ig,"").replace(/_/ig,"."));e.indexOf("cpu os")>-1&&(o=e.match(/cpu os [\d._]*/gi),o=(o+"").replace(/[^0-9|_.]/ig,"").replace(/_/ig,"."));e.indexOf("cpu iphone os")>-1&&(o=e.match(/cpu os [\d._]*/gi),o=(o+"").replace(/[^0-9|_.]/ig,"").replace(/_/ig,"."));a===""?k&&r.lastIndexOf("\\")>1?r=r.substring(1,r.lastIndexOf("\\")).replace(/%20/g," "):(l=1,r=r.substring(1,r.lastIndexOf("/")).replace(/%20/g," ")):(l=1,r=r.substring(0,r.lastIndexOf("/")));u.bIE?(h=u.IEVersion,h===""||h>8?h>=10&&Dynamsoft.WebTwainEnv.IfUseActiveXForIE10Plus==!1?s=f:(s=t,w=f):p=f):s||(y=f);i.env={bIE:u.bIE,bEdge:u.bEdge,bWin64:nt,osVersion:o,macOSX:c,bFileSystem:u.bFileSystem,bMobile:u.bMobile,strIEVersion:u.IEVersion,basePath:r,pathType:l,isDesktopViewer:function(){return Dynamsoft.navInfo.bWin||Dynamsoft.navInfo.bLinux||Dynamsoft.navInfo.bMac},isPadViewer:function(){return Dynamsoft.navInfo.bPad||Dynamsoft.navInfo.bChromeOS},isMobileViewer:function(){return Dynamsoft.navInfo.bMobile}};i.product={name:"Dynamic Web TWAIN",bHTML5Edition:s,bPluginEdition:y||w,bActiveXEdition:p,host:Dynamsoft.dcp.host,wsProtocol:"dwt_command",_iImageCaptureDriverType:3,_iBrokerProcessType:1,getChromeEditionPath:Dynamsoft.dcp.getDSPath,getPKGPath:function(){return Dynamsoft.WebTwainEnv.ResourcesPath+"/dist/mac/DynamicWebTWAINMacEdition.pkg"},getMSIPath:function(){return Dynamsoft.WebTwainEnv.ResourcesPath+"/dist/win/DynamicWebTWAINPlugIn.msi"},getActiveXCABx86Path:function(){return Dynamsoft.WebTwainEnv.ResourcesPath+"/dist/win/ActiveX/DynamicWebTWAIN.cab"},getActiveXCABx64Path:function(){return Dynamsoft.WebTwainEnv.ResourcesPath+"/dist/win/ActiveX/DynamicWebTWAINx64.cab"},strMIMEType:"Application/DynamicWebTwain-Plugin",strFullClassID:"E7DA7F8D-27AB-4EE9-8FC0-3FEC9ECFE758",scripts:{},bChromeEdition:s};n.mix(n,i);n.Addon_Events=[];n.Addon_Sendback_Events=[]}(Dynamsoft.Lib);Dynamsoft.Ready(function(n){var t=n.getNavInfo(),f=Dynamsoft.navInfoSync,i=navigator.userAgent.toLowerCase(),y=document.location.protocol,p=location.hostname,w=f.bSSL,e=t.bMac,o=t.bLinux,s=t.bWin,h=t.bOSx64,c=t.bSafari,l=t.bFirefox,b=t.bEdge,a=t.bChrome,k=t.bIE,r=parseFloat(t.strBrowserVersion),v={getServerVersionInfo:function(i){var r=Dynamsoft.WebTwainEnv.ServerVersionInfo;return(t.bWin||t.bWin64||(t.bMac?r=Dynamsoft.WebTwainEnv.ServerMacVersionInfo:t.bLinux&&(r=Dynamsoft.WebTwainEnv.ServerLinuxVersionInfo)),i)?r:n.replaceAll(r,",","")},getDWTPrefix:function(){var n=Dynamsoft.WebTwainEnv;return n.CustomMode===!0?"dwtc_":"dwt_"}},u;n.mix(n.product,v);u={bChrome:a,bFirefox:l,bSafari:c,bWin:s,bWin64:i.indexOf("win64")!=-1||i.indexOf("x64")!=-1,bMac:e,bLinux:o,isX64:h,iPluginLength:t.bIE||t.bEdge?0:navigator.plugins.length,strChromeVersion:t.bChrome?r:"",strFirefoxVersion:t.bFirefox?r:""};n.mix(n.env,u)});Dynamsoft.Ready(function(n){var r=n.getNavInfo(),t=!0,i=!1,u={ActiveX:0,Plugin:1,HTML5:2,WinMacLinux:3,Barcode1D:4,Barcode2D:5,BarcodeWriter:6,OCR:7,Webcam:8,PDFRasterizer:9,OCRPro:10,QR:50,PDF417:51,DataMatrix:52};n.License={checkProductKey:function(u,f,e,o){var l,tt=Dynamsoft.WebTwainEnv,c=o,g,b,nt,ct,k;if(l=u.__licenseInfo,!n.isString(tt.ProductKey)||tt.ProductKey==""||tt.ProductKey=="******"||!l||!n.isArray(l.Detail)||l.Detail.length==0)return n.Errors.LicenseEmptyOrInvalid(u),n.License.ShowInvalidLicense("",!0),i;var it=0,ut=0,p=[],w=[],ft=i,rt=i,et=i,ot=i,st=i,ht=i,v,h,s,y;if(!this.isBindDomainOK(l.Domain))return n.Errors.LicenseBadDomain(u),c&&n.License.promptLicenseErr(u),i;for(l.Detail.length>0&&(s=l.Detail[0],g=s.Trial=="FALSE"?!1:!0),h=1;h<l.Detail.length;h++)if(s=l.Detail[h],s.Trial=="FALSE"&&g||s.Trial=="TRUE"&&!g)return n.Errors.LicenseTrialFullMixed(u),c&&n.License.promptLicenseErr(u),i;if(f.Core){for(h=0;h<l.Detail.length;h++)if(s=l.Detail[h],y=this.getEnumLicenseType(s.EnumLicenseType),y.Core)if(b=this.getLicenseType(s.LicenseType),n.product.bHTML5Edition){if(b.ActiveX&&!b.Html5)continue;w.push(s)}else{if(!b.ActiveX&&b.Html5)continue;w.push(s)}}else w=l.Detail;for(h=0;h<w.length;h++)nt=t,s=w[h],y=this.getEnumLicenseType(s.EnumLicenseType),(f.Core||this.isAllowLicenseType(y,f))&&(v=s.ExpireDate.replace(/-/g,"/"),ct=s.Trial!="FALSE",this.isExpiredOrFuture(v,ct)?p.push(v):y.Core&&parseInt(s.Version)>=15||!y.Core?f.Wasm?(k=!1,f.Core&&y.Core?k=!0:f.PDFRasterizer&&y.PDFRasterizer?k=!0:f.Webcam&&y.Webcam&&(k=!0),k&&(s.OS.toLowerCase().indexOf("wasm")>-1?this.isBrowserOK(s.Browser)||e?(it++,nt=i):rt=t:f.PDFRasterizer?st=t:f.Webcam?ht=t:ot=t)):this.isOSOK(s.OS)?this.isBrowserOK(s.Browser)||e?(it++,nt=i):rt=t:ft=t:et=t,nt&&ut++);if(it>0)return t;if(ut==0)return this.setNoAllowedLicenseTypeError(u,f),c&&n.License.promptLicenseErr(u),i;if(p.length>0){var lt=0,at=100000000000000000000,d="",vt=(new Date).getTime(),a;for(v="",h=0;h<p.length;h++)a=this.parseDateFromString(p[h]),a.getTime()<vt&&a.getTime()>lt?(lt=a.getTime(),v=p[h]):a.getTime()>vt&&a.getTime()<at&&(at=a.getTime(),d=p[h]);return v!=""?(a=this.parseDateFromString(v),v=this.getLicenseDateString(a),n.Errors.LicenseExpired(u,v),c=!1,n.License.ShowInvalidLicense(v,g)):d!=""?(a=this.parseDateFromString(d),d=this.getLicenseDateString(a),n.Errors.LicenseIsFuture(u,d)):(n.Errors.LicenseExpired(u,""),c=!1,n.License.ShowInvalidLicense()),c&&n.License.promptLicenseErr(u),i}return et?(n.Errors.LicenseLower(u),c&&n.License.promptLicenseErr(u),i):rt?(r.bEdge?n.Errors.LicenseNoEdge(u):r.bChrome?n.Errors.LicenseNoChrome(u):r.bFirefox?n.Errors.LicenseNoFirefox(u):r.bIE?n.Errors.LicenseNoIE(u):r.bSafari?n.Errors.LicenseNoSafari(u):n.Errors.LicenseNotSupportBorwser(u),c&&n.License.promptLicenseErr(u),i):ft?(r.bWin||r.bWin64?n.Errors.LicenseNotSupportWindows(u):r.bMac?n.Errors.LicenseNotSupportMAC(u):r.bLinux?n.Errors.LicenseNotSupportLinux(u):n.Errors.LicenseNotSupportOS(u),c&&n.License.promptLicenseErr(u),i):ot?(n.Errors.LicenseNotSupportWasm(u),c&&n.License.promptLicenseErr(u),i):st?(n.Errors.LicenseNotSupportPdfRWasm(u),c&&n.License.promptLicenseErr(u),i):ht?(n.Errors.LicenseNotSupportWasmWasm(u),c&&n.License.promptLicenseErr(u),i):(n.Errors.LicenseEmptyOrInvalid(u),c&&this.promptLicenseErr(u),i)},promptLicenseErr:function(n){if(n.ErrorCode<0){var t=['<div class="dynamsoft-dwt-dlg-tips" style="text-align:left">',n.ErrorString,"<\/div>",'<div style="padding-top:35px"><\/div>'];Dynamsoft.WebTwainEnv.ShowDialog(365,0,t.join(""))}},ShowInvalidLicense:function(t,i){if(!n.detect.needUpgrade){var r=[],u="is not valid";t&&t!=""&&(u=t.indexOf("on")==-1?"has expired on "+t:"has expired "+t);r.push('<div style="padding:30px;border:1px solid #CCCCCC;background:#FFFFFF">');r.push("You are seeing this dialog because the <strong>ProductKey<\/strong> ");r.push(u);i?(r.push(". Please follow the steps below <br />"),r.push("<ol><li>Request a <strong>Dynamic Web TWAIN<\/strong> trial license <strong><a class='dynamsoft-major-color' href='https://www.dynamsoft.com/CustomerPortal/Portal/TrialLicense.aspx?product=dwt' target='_blank'>here<\/a><\/strong><\/li>"),r.push("<li>Refer to this <strong><a class='dynamsoft-major-color' href='https://developer.dynamsoft.com/?page_id=18633' target='_blank'>article<\/a><\/strong> to update the ProductKey<\/li>"),r.push("<li>Do a <strong>hard refresh<\/strong> or clear cache in your browser to make sure the new ProductKey is used<\/li>"),r.push("<li>If the issue persists, please contact us at <a class='dynamsoft-major-color' href='mailto:support@dynamsoft.com'>support@dynamsoft.com<\/a><\/li>")):r.push(".<br />");r.push("<\/div>");n.ShowLicenseDialog(r.join(""),{width:680,height:0,bClose:!1,seconds:100})}},isBindDomainOK:function(r){var l,o,h,v,e,u,c,f;if(n.isUndefined(r)||r==null||r==""||r=="*"||r=="*.*"||(l=location.hostname,o=i,l==""))return t;var a=l.toLowerCase().split("."),s=a.length,y=r.toLowerCase().split(";");for(h=0;h<y.length;h++){if(v=y[h],v=="*.*"){o=t;break}if(e=v.split("."),u=e.length,u>0&&u-1<=s){for(c=t,f=u-1;f>0;f--){if(e[f].indexOf("*")>-1){o=t;break}if(f+s-u>=0){if(a[f+s-u]!=e[f]){c=i;break}}else if(e[f]!="*"){c=i;break}}if(c&&(e[0]=="*"||s>=u&&a[s-u]==e[0])){o=t;break}}}return o},isExpiredOrFuture:function(n,r){var u;if(n==""||!r&&(u=n.length,u>2&&n[u-2]=="/"&&n[u-1]=="0"))return i;var f=this.parseDateFromString(n),e=(new Date).getTime(),o=e+5184e6;return f.getTime()<e?t:r&&f.getTime()>o?t:i},isOSOK:function(u){return u==""||u=="0"?t:(u=u.toLowerCase(),u.indexOf("windows")>-1&&(r.bWin||r.bWin64))?t:u.indexOf("mac")>-1&&r.bMac||u.indexOf("linux")>-1&&r.bLinux||u.indexOf("mobile")>-1&&n.env.bMobile?t:i},isBrowserOK:function(u){if(n.isString(u)){if(u==""||u=="0")return t;u=u.toLowerCase();var e=u.split(";"),f=i;return n.each(e,function(i){n.trim(i)=="chrome"&&(r.bChrome||r.bSafari)?f=t:n.trim(i)=="ie"&&(r.bIE||r.bEdge)?f=t:n.trim(i)=="firefox"&&r.bFirefox&&(f=t)}),f}return i},parseDateFromString:function(n){var t,i=n;return i=i.replace(/-/g,"/"),t=Date.parse(i),isNaN(t)&&(t=0),new Date(t)},getEnumLicenseType:function(r){var f=i,e=i,o=i,s=i,h=i,c=i,l=i,a=i,v=i;return n.isString(r)&&n.each(r.split(";"),function(n){var i=n*1;i==u.HTML5||i==u.WinMacLinux||i==u.ActiveX||i==u.Plugin?f=t:i==u.Barcode1D?e=t:i==u.QR?o=t:i==u.PDF417?s=t:i==u.DataMatrix?h=t:i==u.OCR?c=t:i==u.Webcam?l=t:i==u.PDFRasterizer?a=t:i==u.OCRPro&&(v=t)}),{Core:f,PDFRasterizer:a,Webcam:l,barcode1D:e,QR:o,PDF417:s,DataMatrix:h,OCR:c,OCRPro:v}},getLicenseType:function(n){var r=i,f=i,u=i,e=i,o=i,s=i,h=i,c=i,l=i,a=i;return n&&n!=""&&(n=n.toLowerCase(),n=="html5;activex;oldie"?u=t:n=="html5"||n=="win=(aph) or mac=(ph) or linux(h)"?r=t:n=="html5;activex"?(r=t,u=t):n=="1d barcode reader"?f=t:n=="2d barcode reader(qrcode)"?e=t:n=="2d barcode reader(pdf417)"?o=t:n=="2d barcode reader(data matrix)"?s=t:n=="ocr"?h=t:n=="webcam"?c=t:n=="pdf rasterizer"?l=t:n=="proocr"&&(a=t)),{Html5:r,PDFRasterizer:l,Webcam:c,barcode1D:f,QR:e,PDF417:o,DataMatrix:s,OCR:h,OCRPro:a,ActiveX:u}},isAllowLicenseType:function(n,t){return t.Core?n.Core:t.PDFRasterizer?n.PDFRasterizer:t.Webcam?n.Webcam:t.barcode1D?n.barcode1D:t.QR?n.QR:t.PDF417?n.PDF417:t.DataMatrix?n.DataMatrix:t.OCR?n.OCR:t.OCRPro?n.OCRPro:n.Core},setNoAllowedLicenseTypeError:function(t,i){i.Core?i.Wasm?n.Errors.LicenseNotSupportWasm(t):n.Errors.LicenseNoCore(t):i.PDFRasterizer?i.Wasm?n.Errors.LicenseNotSupportPdfRWasm(t):n.Errors.LicenseNoPDF(t):i.Webcam?i.Wasm?n.Errors.LicenseNotSupportWebcamWasm(t):n.Errors.LicenseNoWebcam(t):i.barcode1D?n.Errors.LicenseNo1D(t):i.QR?n.Errors.LicenseNo2DQR(t):i.PDF417?n.Errors.LicenseNo2DPDF417(t):i.DataMatrix?n.Errors.LicenseNo2DDataMatrix(t):i.OCR?n.Errors.LicenseNoOCR(t):i.OCRPro?n.Errors.LicenseNoOCRPro(t):n.Errors.LicenseEmptyOrInvalid(t)},getLicenseDateString:function(n){var u=n.getFullYear(),t,i,r;return t=n.getMonth()+1,i=t>=10?""+t:"0"+t,r=n.getDate()>=10?""+n.getDate():"0"+n.getDate(),[i,"/",r,"/",u].join("")},hasPDFRProductKey:function(t){if(t._isMobileMode()){if(!n.License.checkProductKey(t,{PDFRasterizer:!0,Wasm:!0},!0))return t._resetErr(),!1}else if(!n.License.checkProductKey(t,{PDFRasterizer:!0},!0))return t._resetErr(),!1;return!0},checkPDFProductKeyWhenNeeds:function(i,r){if(r==EnumDWT_ImageType.IT_PDF||r==EnumDWT_ImageType.IT_MULTIPAGE_PDF){var u;if(n.product.bHTML5Edition?i.__addon&&i.__addon.PDF&&(u=i.__addon.PDF.GetConvertMode()):i.Addon&&i.Addon.PDF&&(u=i.Addon.PDF.GetConvertMode()),u==1)return n.isFunction(i._isMobileMode)&&i._isMobileMode()?this.checkProductKey(i,{PDFRasterizer:!0,Wasm:!0},!0):this.checkProductKey(i,{PDFRasterizer:!0},!0)}return t}}});Dynamsoft.Ready(function(n){var r=!0,i=!1,t={Errors:{FilePathSyntaxIncorrect:function(n){n._errorCode=-3123;n._errorString="The filename, directory name, or volume label syntax is incorrect."}},checkFilePath:function(t,u){return!n.isString(u)||u.length==0?(n.Errors.InvalidFile(t),i):n.startsWith(u,"http://")||n.startsWith(u,"https://")||n.startsWith(u,"ftp://")?(n.File.Errors.FilePathSyntaxIncorrect(t),i):r}};t.checkFolder=t.checkFilePath;n.File=t}),function(n,t){n.install={_divInstallBody:"dwt-InstallBody",_divDWTNonInstallContainerID:"dwt-NonInstallContainerID",_divDWTemessageContainer:"",_dlgInstall:!1};n.install._strDynamsoftWithClose='<div class="dynamsoft-dwt-dlg-header"><div class="dynamsoft-dialog-close"><\/div><\/div>';n.install._strDynamsoftWithoutClose='<div style="height:40px;"><\/div>';n.install._strNonInstallDIV=['<div style="text-align:center;" id="',n.install._divDWTNonInstallContainerID,'"><\/div>'].join("");t.CloseDialog=function(){var t=n.install._dlgInstall,i,r;t&&(i=n.all(".dynamsoft-dialog-close"),n.each(i,function(t){n.removeEventListener(t,"click",DCP_DWT_OnClickCloseInstall)}),t.open&&t.close(),n.install._dlgFromImageEditor?n.one(".D_ImageUIEditor")[0]?(r=n.one(".D_ImageUIEditor")[0].parentNode,r.removeChild(t)):document.body.removeChild(t):document.body.removeChild(t),n.install._dlgInstall=!1)};t.ShowDialog=function(t,i,r,u,f){var e=n.install,h,o,c,s,l,a,v;(n.get("dynamsoft_waiting")||(o=document.createElement("div"),o.className="dynamsoft-dialog-wrap",o.style.width="100%",h=['<div id="dynamsoft_waiting" style="border:0;position:relative;z-index:9999;background:transparent;margin:0 auto">','<iframe frameborder="0" marginheight="0" marginwidth="0" scrolling="no" src="javascript:\'\'"',' style="width:100%;height:100%;border:0;background:transparent;position:absolute;left:0;top:0;z-index:-1">',"<\/iframe>",'<div class="dynamsoft-dialog dynamsoft-dialog2" style="border:1px solid #CCCCCC;">','<div id="',e._divInstallBody,'"><\/div><\/div><\/div>'],o.innerHTML=h.join(""),u?n.one(".D_ImageUIEditor")[0]?(c=n.one(".D_ImageUIEditor")[0].parentNode,c.appendChild(o)):document.body.appendChild(o):document.body.appendChild(o),e._dlgFromImageEditor=u,e._dlgInstall=o,n.dialog.setup(e._dlgInstall)),r!==!1)&&(s=Dynamsoft.Lib.one(".dynamsoft-dialog"),s&&s.getEL()&&(s[0].style.width=t+"px",i&&i>0&&(s[0].style.height=i+"px")),u?n.get(e._divInstallBody).innerHTML=['<div class="dynamsoft-dwt-dialog-body">',r,"<\/div>"].join(""):(l=f?e._strDynamsoftWithoutClose:e._strDynamsoftWithClose,n.get(e._divInstallBody).innerHTML=['<div class="dynamsoft-dwt-dialog-body">',l,r,"<\/div>"].join("")),a=n.get("dynamsoft_waiting"),a.style.width=t,e._dlgInstall.open&&e._dlgInstall.close(),e._dlgInstall.showModal(),v=n.all(".dynamsoft-dialog-close"),n.each(v,function(t){n.addEventListener(t,"click",DCP_DWT_OnClickCloseInstall)}))};t.OnWebTwainPreExecute=function(){Dynamsoft.Lib.detect.OnWebTwainPreExecute(Dynamsoft.WebTwainEnv.IfConfineMaskWithinTheViewer)};t.OnWebTwainPostExecute=function(){Dynamsoft.Lib.detect.OnWebTwainPostExecute()}}(Dynamsoft.Lib,Dynamsoft.WebTwainEnv);DCP_DWT_OnClickCloseInstall=function(n){var t=Dynamsoft.Lib,f=t.install._dlgInstall,u,r,i;if(Dynamsoft.WebTwainEnv.CloseDialog(),u=t.get(t.install._divDWTNonInstallContainerID),u&&u.parentNode.removeChild(u),n&&t.isString(n))t.show(n);else{if(i=Dynamsoft.WebTwainEnv.Containers,i)for(r=0;r<i.length;r++)t.show(i[r].ContainerId);if(i=Dynamsoft.WebTwainEnv.DynamicContainers,i)for(r=0;r<i.length;r++)t.show(i[r]);i=null}t.install._divDWTemessageContainer!=""&&t.show(t.install._divDWTemessageContainer)},function(n){var t=n.win;t.DCP_DWT_OnClickCloseInstall=DCP_DWT_OnClickCloseInstall;n.detect.showMask=function(){Dynamsoft.WebTwainEnv.ScanDirectly||(n.isFunction(t.OnWebTwainPreExecuteCallback)?t.OnWebTwainPreExecuteCallback():n.detect.OnWebTwainPreExecute(Dynamsoft.WebTwainEnv.IfConfineMaskWithinTheViewer))};n.detect.OnWebTwainPreExecute=function(t){var u=t,r,i;Dynamsoft.WebTwainEnv.Containers.length>0&&(i=Dynamsoft.Lib.get(Dynamsoft.WebTwainEnv.Containers[0].ContainerId));i&&(r=i.getBoundingClientRect(),i.firstChild&&i.firstChild.getBoundingClientRect&&(r=i.firstChild.getBoundingClientRect()));(r==undefined||Dynamsoft.WebTwainEnv.Containers.length>1||Dynamsoft.WebTwainEnv.Containers.length==1&&(r.width==0||r.height==0))&&(u=!1);n.mask.bConfined=u;n.mask.container=i;n.showMask()};n.detect.hideMask=function(){Dynamsoft.WebTwainEnv.ScanDirectly||(n.isFunction(t.OnWebTwainPostExecuteCallback)?t.OnWebTwainPostExecuteCallback():n.detect.OnWebTwainPostExecute())};n.detect.OnWebTwainPostExecute=n.hideMask}(Dynamsoft.Lib),function(n){n.install._dlgLicense=!1;n._gb_xkz_dhk=function(){var t=n.install._dlgLicense,i;t&&(i=n.one(".dynamsoft-dialog-close",t),i.getEL()&&n.removeEventListener(i.getEL(),"click",n._gb_xkz_dhk),t.open&&t.close(),document.body.removeChild(t),n.install._dlgLicense=!1)};n._zdgb_xkz_dhk=function(){var r=n.install._dlgLicense,t,i;r&&(t=n.one(".dynamsoft-dialog-closeTimer",r),t.getEL()&&(i=parseInt(t.getEL().style.width),i-=1,i<=0?n._gb_xkz_dhk():(t.getEL().style.width=i+"%",setTimeout(n._zdgb_xkz_dhk,100))))};n.ShowLicenseDialog=function(t,i){var e=n.install,y="dynamsoft-dialog-license",p="ds-dwt-ui-dlg-license-wrap",l,o,a,v,s,f,c;if(i&&(l=i.width,o=i.height,a=i.seconds,v=i.bClose),l||(l=600),o||(o="100%"),a||(a=10),n.one("."+y).length==0){var h=document.createElement("div"),u=document.createElement("div"),r=document.createElement("iframe");h.className=y;h.style.width="100%";h.style.position="absolute";u.className=p;u.innerHTML=t;u.style.margin="auto";u.style.backgroundColor="white";u.style.zIndex="9999";u.style.position="relative";u.style.border="0";r.frameborder="0";r.marginheight="0";r.marginwidth="0";r.scrolling="no";r.style.border="0";r.style.backgroundColor="transparent";r.style.position="absolute";r.style.left=0;r.style.top=0;r.style.width="100%";r.style.height="100%";r.style.margin="auto";r.style.zIndex=-1;r.src='javascript:""';u.appendChild(r);v&&(s=document.createElement("div"),s.className="dynamsoft-dialog-close",u.insertBefore(s,u.firstChild),f=document.createElement("div"),f.className="dynamsoft-dialog-closeTimer",f.style.width="100%",f.style.height="2px",f.style.marginTop="-2px",f.style.backgroundColor="#fe8e14",u.insertBefore(f,u.firstChild));h.appendChild(u);document.body.appendChild(h);e._dlgLicense=h;n.dialog.setup(e._dlgLicense)}c=n.one("."+p);c&&c.getEL()&&(c[0].style.width=l+"px",c[0].style.height=n.isNumber(o)&&o>0?o+"px":"100%");e._dlgLicense.open&&e._dlgLicense.close();e._dlgLicense.showModal();v&&(s=n.one(".dynamsoft-dialog-close",e._dlgLicense),s.getEL()&&(n.addEventListener(s.getEL(),"click",n._gb_xkz_dhk),setTimeout(n._zdgb_xkz_dhk,100)))};n.openLoadingMsg=function(){var u,t,i,r;n.product.bHTML5Edition&&(u=Dynamsoft.WebTwainEnv.UseLocalService,(!n.isUndefined(u)||n.env.bMobile)&&u!=!0)&&(n.dlgLoading||(i=[],i.push('<dialog class="dynamsoft-loadingMsg" closed="closed" style="top:30%"><div style="margin:45px 0 25px 65px"><span class="loading-dwt"><\/span><\/div><h3 class="dynamsoft-loadingMsg-msg"> <\/h3>'),i.push('<p class="dynamsoft-loadingMsg-desc"> <\/p>'),i.push("<\/dialog>"),t=n.one(".dynamsoft-loadingMsg"),t&&t.getEL()&&t.remove(),r=n.parseHTML(i.join("")),r&&r.length>0&&document.body.appendChild(r[0]),t=n.one(".dynamsoft-loadingMsg"),t&&t.getEL()&&(n.dlgLoading=t[0],n.dialog.setup(n.dlgLoading))),n.dlgLoading.showModal(),n.dlgLoadingShowStatus=!0)};n.showLoadingMsg=function(t,i,r){if(n.dlgLoadingShowStatus!=!1){var e=n.one(".dynamsoft-loadingMsg"),u=n.one(".dynamsoft-loadingMsg-msg"),f=n.one(".dynamsoft-loadingMsg-desc");u&&u.getEL()&&u.html(i);f&&f.getEL()&&f.html(r)}};n.closeLoadingMsg=function(t){n.log("closeLoadingMsg:"+t);n.dlgLoadingShowStatus==!0&&(n.dlgLoading&&n.dlgLoading.close(),n.dlgLoadingShowStatus=!1)}}(Dynamsoft.Lib),function(n){n.domReady(function(){var n=document.createElement("style"),t='dialog{position:absolute;left:0;right:0;top:30%;margin:auto;padding:30px 35px;border:1px solid #ccc;border-radius:6px;box-shadow:0 1px 5px rgba(0,0,0,.05);background:white;color:black;width:-moz-fit-content;display:none;-webkit-box-sizing:content-box;box-sizing:content-box}dialog[open]{display:block}dialog[closed]{display:none}.dynamsoft-dwt-dialogProgress{width:300px}.dynamsoft-finalMessage{margin:0 0 15px 0;color:#3a3a3a;font:20px Arial,sans-serif}.dynamsoft-desc{margin:0 0 15px 0;color:#3a3a3a;font:14px Arial,sans-serif}.dynamsoft-status{color:#555;font:14px/22px Arial,sans-serif;margin-bottom:5px}.dynamsoft-progressBar{-webkit-appearance:none;width:300px;margin-bottom:20px;height:14px}.dynamsoft-progressBar,.dynamsoft-progressBar::-webkit-progress-bar{background-color:#e7e7e7;border-radius:7px}.dynamsoft-progressBar::-webkit-progress-value,.dynamsoft-progressBar::-moz-progress-bar{background-color:#50a8e1;border-radius:7px}.dynamsoft-loadingMsg{padding:6px;position:absolute;left:0;right:0;top:30%;width:240px;height:240px;margin:auto;border:1px solid #ccc;border-radius:6px;box-shadow:0 1px 5px rgba(0,0,0,.05);background:white;color:black;width:-moz-fit-content;display:none;-webkit-box-sizing:content-box;box-sizing:content-box}dialog[open]{display:block}dialog[closed]{display:none}.dynamsoft-loadingMsg-msg{margin:0 0 15px 25px;color:#3a3a3a;font:20px Arial,sans-serif}.dynamsoft-loadingMsg-desc{text-align:center;margin:0 0 15px 0;color:#3a3a3a;font:14px Arial,sans-serif}.loading-dwt{display:inline-block;width:100px;height:100px;background:url("data:image/gif;base64,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")}';n.type="text/css";try{n.appendChild(document.createTextNode(t))}catch(i){n.styleSheet.cssText=t}document.body.appendChild(n)})}(Dynamsoft.Lib);Dynamsoft.Ready(function(n){function t(i,r){var u=this,f=0,o,e;for(o=n.isString(i)?document.getElementById(i):i,u.isLoaded=!1,u.displayType=0,u.progress=0,u.progressPosition=0,u.borderWidth={left:0,right:0,top:0,bottom:0},u.orientation=r.orientation||t.Orientation.Horizontal,u.direction=r.direction||t.Direction.LeftToRight,u.creationType=r.creationType||t.CreationType.Replace,u.value=0,u.initialValue=r.value||0,u.minValue=r.minValue||0,u.maxValue=r.maxValue||100,u.showLabel=typeof r.showLabel=="undefined"?!0:r.showLabel,u.labelText=r.labelText||"",u.width=r.width||300,u.height=r.height||20,u.borderRadius=r.borderRadius||10,u.orientation==t.Orientation.Horizontal&&u.borderRadius>u.height/2&&(u.borderRadius=Math.round(u.height/2)),u.orientation==t.Orientation.Vertical&&u.borderRadius>u.width/2&&(u.borderRadius=Math.round(u.width/2)),u.backColor=r.backColor||"",u.color=r.color||"#50a8e1",u.animationStyle=0,u.animationInterval=r.animationInterval||100,e=["parent","background","wrapper","left","middle","right","horizontalText","verticalText","marker"],u.extraClassName={},f=0;f<e.length;f++)u.extraClassName[e[f]]=r.extraClassName?typeof r.extraClassName=="string"?r.extraClassName:r.extraClassName[e[f]]||"":"";u.onLoad=r.onLoad||null;u.onValueChanged=r.onValueChanged||null;u.onAnimate=r.onAnimate||null;u.creationType==t.CreationType.Replace?u.parentElement=o:(u.parentElement=document.createElement("DIV"),o.appendChild(u.parentElement));u.finishLoading()}t.Orientation={Horizontal:0,Vertical:1};t.Direction={LeftToRight:0,RightToLeft:1,TopToBottom:0,BottomToTop:1};t.CreationType={Replace:0,AppendChild:1};t.AnimationStyle={None:0,Static:1,StaticFull:2,Custom:3,CustomFull:4,Flickering1:10,Flickering2:11,Flickering3:12,LeftToRight1:20,LeftToRight2:21,RightToLeft1:22,RightToLeft2:23,TwoWay:24};t.prototype.finishLoading=function(){var n=this,i;n.wrapperElement=null;n.backgroundElement=null;n.valueElement=null;n.leftElement=null;n.middleElement=null;n.rightElement=null;n.backgroundElement=document.createElement("DIV");n.backgroundElement.className="progressbar_background"+(n.extraClassName.background?" ":"")+n.extraClassName.background;n.backgroundElement.style.cssText=n.backgroundElement.style.cssText+t._createBorderRadiusCss(n.borderRadius);n.parentElement.appendChild(n.backgroundElement);for(var f=["border-radius","border-bottom-right-radius","-moz-border-radius-bottomright","-webkit-border-bottom-right-radius","-khtml-border-radius-bottomright","-khtml-border-bottom-right-radius"],u=0,r="",u=0;u<f.length;u++)if(r=t._elementCurrentStyle(n.backgroundElement,f[u]),r||typeof r=="string")break;r!=""&&t._parseInt(r)!=n.borderRadius&&(n.borderRadius=t._parseInt(r));n.displayType=n.orientation==t.Orientation.Horizontal||n.orientation==t.Orientation.Vertical?0:1;n.parentElement.className=(n.parentElement.className!=""?" ":"")+"progressbar_parent dynamsoft-progressBar"+(n.extraClassName.parent?" ":"")+n.extraClassName.parent;n.displayType==0?(i=n.wrapperElement=document.createElement("DIV"),i.style.border="1px solid #A0A0A0",i.style.cssFloat="left",i.style.display="inline-block",i.style.width=n.width+"px",i.style.height=n.height+"px",i.style.left="0px",i.style.top=-n.height+"px",i.style.backgroundColor=n.backColor,i.style.backgroundRepeat="no-repeat",i.style.position="relative",i.style.cssText=i.style.cssText+t._createBorderRadiusCss(n.borderRadius),n.parentElement.appendChild(i),n.borderWidth={left:t._parseInt(t._elementCurrentStyle(i,"border-left-width")),right:t._parseInt(t._elementCurrentStyle(i,"border-right-width")),top:t._parseInt(t._elementCurrentStyle(i,"border-top-width")),bottom:t._parseInt(t._elementCurrentStyle(i,"border-bottom-width"))}):n.displayType==1&&(n.orientation==t.Orientation.Horizontal?n.borderRadius>n.width/2&&(n.borderRadius=n.width):n.orientation==t.Orientation.Vertical&&n.borderRadius>n.height/2&&(n.borderRadius=n.height),n.valueElement=document.createElement("DIV"),n.valueElement.className="",n.leftElement=document.createElement("DIV"),n.middleElement=document.createElement("DIV"),n.rightElement=document.createElement("DIV"),n.leftElement.style.border="1px solid #A0A0A0",n.leftElement.style.cssFloat="left",n.leftElement.style.display="inline-block",n.leftElement.style.backgroundColor=n.backColor,n.leftElement.style.backgroundRepeat="no-repeat",n.leftElement.style.position="relative",n.rightElement.style.border="1px solid #A0A0A0",n.rightElement.style.cssFloat="left",n.rightElement.style.display="inline-block",n.rightElement.style.backgroundColor=n.backColor,n.rightElement.style.backgroundRepeat="no-repeat",n.rightElement.style.position="relative",n.middleElement.style.border="1px solid #A0A0A0",n.middleElement.style.cssFloat="left",n.middleElement.style.display="inline-block",n.middleElement.style.overflow="hidden",n.middleElement.style.position="relative",n.valueElement.style.backgroundColor=n.backColor,n.valueElement.style.position="relative",n.orientation==t.Orientation.Horizontal?(n.leftElement.style.width=n.borderRadius+"px",n.leftElement.style.height=n.height+"px",n.leftElement.style.top=-n.height+"px",n.leftElement.style.left="0px",n.leftElement.style.borderRight="none",n.leftElement.style.cssText=n.leftElement.style.cssText+t._createBorderRadiusCss(n.borderRadius,0,0,n.borderRadius),n.rightElement.style.width=n.borderRadius+"px",n.rightElement.style.height=n.height+"px",n.rightElement.style.top=-n.height+"px",n.rightElement.style.borderLeft="none",n.rightElement.style.cssText=n.rightElement.style.cssText+t._createBorderRadiusCss(0,n.borderRadius,n.borderRadius,0),n.middleElement.style.width=n.width-n.borderRadius*2+"px",n.middleElement.style.height=n.height+"px",n.middleElement.style.top=-n.height+"px",n.middleElement.style.borderLeft="none",n.middleElement.style.borderRight="none",n.valueElement.style.width="0px",n.valueElement.style.height=n.height+"px"):n.orientation==t.Orientation.Vertical&&(n.leftElement.style.width=n.width+"px",n.leftElement.style.height=n.borderRadius+"px",n.leftElement.style.top=-n.height+"px",n.leftElement.style.left="0px",n.leftElement.style.borderBottom="none",n.leftElement.style.cssText=n.leftElement.style.cssText+t._createBorderRadiusCss(n.borderRadius,n.borderRadius,0,0),n.rightElement.style.width=n.width+"px",n.rightElement.style.height=n.borderRadius+"px",n.rightElement.style.top=-n.height+"px",n.rightElement.style.left="0px",n.rightElement.style.borderTop="none",n.rightElement.style.cssText=n.rightElement.style.cssText+t._createBorderRadiusCss(0,0,n.borderRadius,n.borderRadius),n.middleElement.style.width=n.width+"px",n.middleElement.style.height=n.height-n.borderRadius*2+"px",n.middleElement.style.top=-n.height+"px",n.middleElement.style.left="0px",n.middleElement.style.borderTop="none",n.middleElement.style.borderBottom="none",n.valueElement.style.width=n.width+"px",n.valueElement.style.height="0px"),n.middleElement.appendChild(n.valueElement),n.parentElement.appendChild(n.leftElement),n.parentElement.appendChild(n.middleElement),n.parentElement.appendChild(n.rightElement),n.orientation==t.Orientation.Horizontal?n.borderWidth={left:t._parseInt(t._elementCurrentStyle(n.leftElement,"border-left-width")),right:t._parseInt(t._elementCurrentStyle(n.rightElement,"border-right-width")),top:t._parseInt(t._elementCurrentStyle(n.middleElement,"border-top-width")),bottom:t._parseInt(t._elementCurrentStyle(n.middleElement,"border-bottom-width"))}:n.orientation==t.Orientation.Vertical&&(n.borderWidth={left:t._parseInt(t._elementCurrentStyle(n.middleElement,"border-left-width")),right:t._parseInt(t._elementCurrentStyle(n.middleElement,"border-right-width")),top:t._parseInt(t._elementCurrentStyle(n.leftElement,"border-top-width")),bottom:t._parseInt(t._elementCurrentStyle(n.rightElement,"border-bottom-width"))}));n.parentElement.style.width=n.width+n.borderWidth.left+n.borderWidth.right+"px";n.parentElement.style.height=n.height+n.borderWidth.top+n.borderWidth.bottom+"px";n.backgroundElement.style.cssFloat="left";n.backgroundElement.style.display="inline-block";n.backgroundElement.style.width=n.width+n.borderWidth.left+n.borderWidth.right+"px";n.backgroundElement.style.height=n.height+"px";n.backgroundElement.style.backgroundColor="#FFFFFF";n.backgroundElement.style.position="relative";n.displayType==0&&(n.backgroundElement.style.width=n.width+n.borderWidth.left+n.borderWidth.right+"px");n.backgroundElement.style.top=n.borderWidth.top+"px";n.markerElement=document.createElement("DIV");n.markerElement.style.display="inline-block";n.markerElement.style.zoom="1.0";n.markerElement.style.width=n.width+"px";n.markerElement.style.height=n.height+"px";n.markerElement.style.top=-n.height*2-n.borderWidth.top+"px";n.markerElement.style.left=n.borderWidth.left+"px";n.markerElement.style.backgroundColor=n.color;n.markerElement.style.lineHeight=n.height+"px";n.markerElement.style.position="relative";n.parentElement.appendChild(n.markerElement);n.isLoaded=!0;n.setValue(n.initialValue);n.onLoad!=null&&n.onLoad()};t.prototype.setValue=function(n){var i=this,r,u,s,f,a,o,e,l;if(n!==null&&n<i.minValue&&(n=i.minValue),n!==null&&n>i.maxValue&&(n=i.maxValue),n===null||(i.value=n),i.isLoaded){if(r=0,i.orientation==t.Orientation.Horizontal)if(r=i.value/i.maxValue*i.width,i.progressPosition=r,i.displayType==0?i.direction==t.Direction.LeftToRight:i.displayType==1&&(i.direction==t.Direction.LeftToRight?i.valueElement.style.width=r<=i.borderRadius?"0px":r>=i.width-i.borderRadius?i.middleElement.style.width:r-i.borderRadius+"px":r<=i.borderRadius?i.valueElement.style.width="0px":r>=i.width-i.borderRadius?(i.valueElement.style.left="0px",i.valueElement.style.width=i.middleElement.style.width):(i.valueElement.style.left=i.width-r-i.borderRadius+"px",i.valueElement.style.width=r-i.borderRadius+"px")),r>0?(i.markerElement.style.width=i.animationStyle!=t.AnimationStyle.StaticFull&&i.animationStyle!=t.AnimationStyle.CustomFull?r+"px":i.width+"px",i.markerElement.style.visibility="visible"):(i.markerElement.style.width=i.width+"px",i.animationStyle!=t.AnimationStyle.StaticFull&&i.animationStyle!=t.AnimationStyle.CustomFull&&(i.markerElement.style.visibility="hidden")),i.markerElement.style.left=i.animationStyle!=t.AnimationStyle.StaticFull&&i.animationStyle!=t.AnimationStyle.CustomFull?i.direction==t.Direction.LeftToRight?i.borderWidth.left+"px":i.width-r+i.borderWidth.left+"px":i.borderWidth.left+"px",s=-i.height*2-i.height-i.borderWidth.top,f=-i.height*2-i.borderWidth.top,r==0||i.width==r)i.markerElement.style.top=f+"px",i.markerElement.style.height=i.height+"px",i.markerElement.style.cssText=i.markerElement.style.cssText+t._createBorderRadiusCss(i.borderRadius);else if(r<i.borderRadius){var h=i.height-2.25*(i.borderRadius-Math.sqrt(Math.pow(i.borderRadius,2)-Math.pow(i.borderRadius-r,2))),c=f+i.height/2-h/2,v=s-2*(f-c);i.markerElement.style.top=c+"px";i.markerElement.style.height=h+"px";i.markerElement.style.cssText=i.direction==t.Direction.LeftToRight?i.markerElement.style.cssText+t._createBorderRadiusCss(i.borderRadius,0,0,i.borderRadius):i.markerElement.style.cssText+t._createBorderRadiusCss(0,i.borderRadius,i.borderRadius,0)}else i.width-r<i.borderRadius?(u=((i.borderRadius-(i.width-r))*2+(i.borderRadius-Math.sqrt(Math.pow(i.borderRadius,2)-Math.pow(i.borderRadius-(i.width-r),2))))/3,i.markerElement.style.cssText=i.direction==t.Direction.LeftToRight?i.markerElement.style.cssText+t._createBorderRadiusCss(i.borderRadius,u,u,i.borderRadius):i.markerElement.style.cssText+t._createBorderRadiusCss(u,i.borderRadius,i.borderRadius,u)):(i.markerElement.style.top=f+"px",i.markerElement.style.height=i.height+"px",i.markerElement.style.cssText=i.direction==t.Direction.LeftToRight?i.markerElement.style.cssText+t._createBorderRadiusCss(i.borderRadius,0,0,i.borderRadius):i.markerElement.style.cssText+t._createBorderRadiusCss(0,i.borderRadius,i.borderRadius,0));else i.orientation==t.Orientation.Vertical&&(r=i.value/i.maxValue*i.height,i.progressPosition=r,i.displayType==0?i.direction==t.Direction.TopToBottom:i.displayType==1&&(i.direction==t.Direction.TopToBottom?i.valueElement.style.height=r<=i.borderRadius?"0px":r>=i.height-i.borderRadius?i.middleElement.style.height:r-i.borderRadius+"px":r<=i.borderRadius?i.valueElement.style.height="0px":r>=i.height-i.borderRadius?(i.valueElement.style.top="0px",i.valueElement.style.height=i.middleElement.style.height):(i.valueElement.style.top=i.height-r-i.borderRadius+"px",i.valueElement.style.height=r+i.borderRadius*2+"px")),r>0?(i.animationStyle!=t.AnimationStyle.StaticFull&&i.animationStyle!=t.AnimationStyle.CustomFull?i.markerElement.style.height=r+"px":(i.markerElement.style.height=i.height+"px",i.markerElement.style.cssText=i.markerElement.style.cssText+t._createBorderRadiusCss(i.borderRadius)),i.markerElement.style.visibility="visible"):(i.markerElement.style.height="0px",i.animationStyle!=t.AnimationStyle.StaticFull&&i.animationStyle!=t.AnimationStyle.CustomFull&&(i.markerElement.style.visibility="hidden")),a=i.borderWidth.left,o=i.borderWidth.left,r==0||i.height==r?(i.markerElement.style.left=o+"px",i.markerElement.style.width=i.width+"px",i.markerElement.style.cssText=i.markerElement.style.cssText+t._createBorderRadiusCss(i.borderRadius)):r<i.borderRadius?(e=2.5*r,e>i.width&&(e=i.width),l=o+i.width/2-e/2,i.markerElement.style.left=l+"px",i.markerElement.style.width=e+"px",i.markerElement.style.cssText=i.direction==t.Direction.BottomToTop?i.markerElement.style.cssText+t._createBorderRadiusCss(0,0,i.borderRadius,i.borderRadius):i.markerElement.style.cssText+t._createBorderRadiusCss(i.borderRadius,i.borderRadius,0,0)):i.height-r<i.borderRadius?(u=((i.borderRadius-(i.height-r))*2+(i.borderRadius-Math.sqrt(Math.pow(i.borderRadius,2)-Math.pow(i.borderRadius-(i.height-r),2))))/3,i.markerElement.style.cssText=i.direction==t.Direction.BottomToTop?i.markerElement.style.cssText+t._createBorderRadiusCss(u,u,i.borderRadius,i.borderRadius):i.markerElement.style.cssText+t._createBorderRadiusCss(i.borderRadius,i.borderRadius,u,u)):(i.markerElement.style.left=o+"px",i.markerElement.style.width=i.width+"px",i.markerElement.style.cssText=i.direction==t.Direction.BottomToTop?i.markerElement.style.cssText+t._createBorderRadiusCss(0,0,i.borderRadius,i.borderRadius):i.markerElement.style.cssText+t._createBorderRadiusCss(i.borderRadius,i.borderRadius,0,0)),i.markerElement.style.top=i.animationStyle!=t.AnimationStyle.StaticFull&&i.animationStyle!=t.AnimationStyle.CustomFull?i.direction==t.Direction.TopToBottom?-i.height*2-i.borderWidth.top+"px":-i.height-r-i.borderWidth.top+"px":-i.height*2-i.borderWidth.top+"px");i.progress=i.value/i.maxValue}i.onValueChanged!=null&&i.onValueChanged()};t._elementCurrentStyle=function(n,t){if(n.currentStyle){for(var i=0,u="",r=!1,i=0;i<t.length;i++)t[i].toString()!="-"?(u+=r?t[i].toString().toUpperCase():t[i].toString(),r=!1):r=!0;return t=u,n.currentStyle[t]}return getComputedStyle(n,null).getPropertyValue(t)};t._parseInt=function(n){var t=parseInt(n);return isNaN(t)&&(t=0),t};t._createBorderRadiusCss=function(n,t,i,r){return n!=null&&t==null&&i==null&&r==null?"; -moz-border-radius: "+n+"px; -ms-border-radius: "+n+"px; -o-border-radius: "+n+"px; -webkit-border-radius: "+n+"px; -khtml-border-radius: "+n+"px; border-radius: "+n+"px;":(n=n||0,t=t||0,i=i||0,r=r||0,"; -moz-border-radius: "+n+"px "+t+"px "+i+"px "+r+"px; -ms-border-radius: "+n+"px "+t+"px "+i+"px "+r+"px; -o-border-radius: "+n+"px "+t+"px "+i+"px "+r+"px; -webkit-border-radius: "+n+"px "+t+"px "+i+"px "+r+"px; -khtml-border-radius: "+n+"px "+t+"px "+i+"px "+r+"px; border-radius: "+n+"px "+t+"px "+i+"px "+r+"px;")};n.ProgressBar=t}),function(n){for(var r=[n,Dynamsoft],i=0,t;i<2;i++)t=r[i],t.EnumDWT_PixelType={TWPT_BW:0,TWPT_GRAY:1,TWPT_RGB:2,TWPT_PALLETE:3,TWPT_CMY:4,TWPT_CMYK:5,TWPT_YUV:6,TWPT_YUVK:7,TWPT_CIEXYZ:8,TWPT_LAB:9,TWPT_SRGB:10,TWPT_SCRGB:11,TWPT_INFRARED:16},t.EnumDWT_BorderStyle={TWBS_NONE:0,TWBS_SINGLEFLAT:1,TWBS_SINGLE3D:2},t.EnumDWT_MessageType={TWQC_GET:1,TWQC_SET:2,TWQC_GETDEFAULT:4,TWQC_GETCURRENT:8,TWQC_RESET:16},t.EnumDWT_Cap={CAP_NONE:0,CAP_XFERCOUNT:1,ICAP_COMPRESSION:256,ICAP_PIXELTYPE:257,ICAP_UNITS:258,ICAP_XFERMECH:259,CAP_AUTHOR:4096,CAP_CAPTION:4097,CAP_FEEDERENABLED:4098,CAP_FEEDERLOADED:4099,CAP_TIMEDATE:4100,CAP_SUPPORTEDCAPS:4101,CAP_EXTENDEDCAPS:4102,CAP_AUTOFEED:4103,CAP_CLEARPAGE:4104,CAP_FEEDPAGE:4105,CAP_REWINDPAGE:4106,CAP_INDICATORS:4107,CAP_SUPPORTEDCAPSEXT:4108,CAP_PAPERDETECTABLE:4109,CAP_UICONTROLLABLE:4110,CAP_DEVICEONLINE:4111,CAP_AUTOSCAN:4112,CAP_THUMBNAILSENABLED:4113,CAP_DUPLEX:4114,CAP_DUPLEXENABLED:4115,CAP_ENABLEDSUIONLY:4116,CAP_CUSTOMDSDATA:4117,CAP_ENDORSER:4118,CAP_ALARMS:4120,CAP_ALARMVOLUME:4121,CAP_AUTOMATICCAPTURE:4122,CAP_TIMEBEFOREFIRSTCAPTURE:4123,CAP_TIMEBETWEENCAPTURES:4124,CAP_CLEARBUFFERS:4125,CAP_MAXBATCHBUFFERS:4126,CAP_DEVICETIMEDATE:4127,CAP_POWERSUPPLY:4128,CAP_CAMERAPREVIEWUI:4129,CAP_SERIALNUMBER:4132,CAP_PRINTER:4134,CAP_PRINTERENABLED:4135,CAP_PRINTERINDEX:4136,CAP_PRINTERMODE:4137,CAP_PRINTERSTRING:4138,CAP_PRINTERSUFFIX:4139,CAP_LANGUAGE:4140,CAP_FEEDERALIGNMENT:4141,CAP_FEEDERORDER:4142,CAP_REACQUIREALLOWED:4144,CAP_BATTERYMINUTES:4146,CAP_BATTERYPERCENTAGE:4147,CAP_CAMERASIDE:4148,CAP_SEGMENTED:4149,CAP_CAMERAENABLED:4150,CAP_CAMERAORDER:4151,CAP_MICRENABLED:4152,CAP_FEEDERPREP:4153,CAP_FEEDERPOCKET:4154,CAP_AUTOMATICSENSEMEDIUM:4155,CAP_CUSTOMINTERFACEGUID:4156,ICAP_AUTOBRIGHT:4352,ICAP_BRIGHTNESS:4353,ICAP_CONTRAST:4355,ICAP_CUSTHALFTONE:4356,ICAP_EXPOSURETIME:4357,ICAP_FILTER:4358,ICAP_FLASHUSED:4359,ICAP_GAMMA:4360,ICAP_HALFTONES:4361,ICAP_HIGHLIGHT:4362,ICAP_IMAGEFILEFORMAT:4364,ICAP_LAMPSTATE:4365,ICAP_LIGHTSOURCE:4366,ICAP_ORIENTATION:4368,ICAP_PHYSICALWIDTH:4369,ICAP_PHYSICALHEIGHT:4370,ICAP_SHADOW:4371,ICAP_FRAMES:4372,ICAP_XNATIVERESOLUTION:4374,ICAP_YNATIVERESOLUTION:4375,ICAP_XRESOLUTION:4376,ICAP_YRESOLUTION:4377,ICAP_MAXFRAMES:4378,ICAP_TILES:4379,ICAP_BITORDER:4380,ICAP_CCITTKFACTOR:4381,ICAP_LIGHTPATH:4382,ICAP_PIXELFLAVOR:4383,ICAP_PLANARCHUNKY:4384,ICAP_ROTATION:4385,ICAP_SUPPORTEDSIZES:4386,ICAP_THRESHOLD:4387,ICAP_XSCALING:4388,ICAP_YSCALING:4389,ICAP_BITORDERCODES:4390,ICAP_PIXELFLAVORCODES:4391,ICAP_JPEGPIXELTYPE:4392,ICAP_TIMEFILL:4394,ICAP_BITDEPTH:4395,ICAP_BITDEPTHREDUCTION:4396,ICAP_UNDEFINEDIMAGESIZE:4397,ICAP_EXTIMAGEINFO:4399,ICAP_MINIMUMHEIGHT:4400,ICAP_MINIMUMWIDTH:4401,ICAP_AUTODISCARDBLANKPAGES:4404,ICAP_FLIPROTATION:4406,ICAP_BARCODEDETECTIONENABLED:4407,ICAP_SUPPORTEDBARCODETYPES:4408,ICAP_BARCODEMAXSEARCHPRIORITIES:4409,ICAP_BARCODESEARCHPRIORITIES:4410,ICAP_BARCODESEARCHMODE:4411,ICAP_BARCODEMAXRETRIES:4412,ICAP_BARCODETIMEOUT:4413,ICAP_ZOOMFACTOR:4414,ICAP_PATCHCODEDETECTIONENABLED:4415,ICAP_SUPPORTEDPATCHCODETYPES:4416,ICAP_PATCHCODEMAXSEARCHPRIORITIES:4417,ICAP_PATCHCODESEARCHPRIORITIES:4418,ICAP_PATCHCODESEARCHMODE:4419,ICAP_PATCHCODEMAXRETRIES:4420,ICAP_PATCHCODETIMEOUT:4421,ICAP_FLASHUSED2:4422,ICAP_IMAGEFILTER:4423,ICAP_NOISEFILTER:4424,ICAP_OVERSCAN:4425,ICAP_AUTOMATICBORDERDETECTION:4432,ICAP_AUTOMATICDESKEW:4433,ICAP_AUTOMATICROTATE:4434,ICAP_JPEGQUALITY:4435,ICAP_FEEDERTYPE:4436,ICAP_ICCPROFILE:4437,ICAP_AUTOSIZE:4438,ICAP_AUTOMATICCROPUSESFRAME:4439,ICAP_AUTOMATICLENGTHDETECTION:4440,ICAP_AUTOMATICCOLORENABLED:4441,ICAP_AUTOMATICCOLORNONCOLORPIXELTYPE:4442,ICAP_COLORMANAGEMENTENABLED:4443,ICAP_IMAGEMERGE:4444,ICAP_IMAGEMERGEHEIGHTTHRESHOLD:4445,ICAP_SUPPORTEDEXTIMAGEINFO:4446},t.EnumDWT_CapType={TWON_NONE:0,TWON_ARRAY:3,TWON_ENUMERATION:4,TWON_ONEVALUE:5,TWON_RANGE:6},t.EnumDWT_TransferMode={TWSX_NATIVE:0,TWSX_FILE:1,TWSX_MEMORY:2},t.EnumDWT_FileFormat={TWFF_TIFF:0,TWFF_PICT:1,TWFF_BMP:2,TWFF_XBM:3,TWFF_JFIF:4,TWFF_FPX:5,TWFF_TIFFMULTI:6,TWFF_PNG:7,TWFF_SPIFF:8,TWFF_EXIF:9,TWFF_PDF:10,TWFF_JP2:11,TWFF_JPN:12,TWFF_JPX:13,TWFF_DEJAVU:14,TWFF_PDFA:15,TWFF_PDFA2:16},t.EnumDWT_TIFFCompressionType={TIFF_AUTO:0,TIFF_NONE:1,TIFF_RLE:2,TIFF_FAX3:3,TIFF_T4:3,TIFF_FAX4:4,TIFF_T6:4,TIFF_LZW:5,TIFF_JPEG:7,TIFF_PACKBITS:32773},t.EnumDWT_InterpolationMethod={IM_NEARESTNEIGHBOUR:1,IM_BILINEAR:2,IM_BICUBIC:3,IM_BESTQUALITY:5},t.EnumDWT_ImageType={IT_BMP:0,IT_JPG:1,IT_TIF:2,IT_PNG:3,IT_PDF:4,IT_ALL:5,IT_MULTIPAGE_PDF:7,IT_MULTIPAGE_TIF:8},t.EnumDWT_PDFCompressionType={PDF_AUTO:0,PDF_FAX4:2,PDF_LZW:3,PDF_JPEG:5,PDF_JP2000:6,PDF_JBIG2:7},t.EnumDWT_ShowMode={SW_ACTIVE:0,SW_MAX:1,SW_MIN:2,SW_CLOSE:3,SW_IFLIVE:4},t.EnumDWT_CapValueType={TWTY_INT8:0,TWTY_INT16:1,TWTY_INT32:2,TWTY_UINT8:3,TWTY_UINT16:4,TWTY_int:5,TWTY_BOOL:6,TWTY_FIX32:7,TWTY_FRAME:8,TWTY_STR32:9,TWTY_STR64:10,TWTY_STR128:11,TWTY_STR255:12},t.EnumDWT_UnitType={TWUN_INCHES:0,TWUN_CENTIMETERS:1,TWUN_PICAS:2,TWUN_POINTS:3,TWUN_TWIPS:4,TWUN_PIXELS:5,TWUN_MILLIMETERS:6},t.EnumDWT_DUPLEX={TWDX_NONE:0,TWDX_1EDMSDUPLEX:1,TWDX_2EDMSDUPLEX:2},t.EnumDWT_CapLanguage={TWLG_DAN:0,TWLG_DUT:1,TWLG_ENG:2,TWLG_FCF:3,TWLG_FIN:4,TWLG_FRN:5,TWLG_GER:6,TWLG_ICE:7,TWLG_ITN:8,TWLG_NOR:9,TWLG_POR:10,TWLG_SPA:11,TWLG_SWE:12,TWLG_USA:13,TWLG_USERLOCALE:-1,TWLG_AFRIKAANS:14,TWLG_ALBANIA:15,TWLG_ARABIC:16,TWLG_ARABIC_ALGERIA:17,TWLG_ARABIC_BAHRAIN:18,TWLG_ARABIC_EGYPT:19,TWLG_ARABIC_IRAQ:20,TWLG_ARABIC_JORDAN:21,TWLG_ARABIC_KUWAIT:22,TWLG_ARABIC_LEBANON:23,TWLG_ARABIC_LIBYA:24,TWLG_ARABIC_MOROCCO:25,TWLG_ARABIC_OMAN:26,TWLG_ARABIC_QATAR:27,TWLG_ARABIC_SAUDIARABIA:28,TWLG_ARABIC_SYRIA:29,TWLG_ARABIC_TUNISIA:30,TWLG_ARABIC_UAE:31,TWLG_ARABIC_YEMEN:32,TWLG_BASQUE:33,TWLG_BYELORUSSIAN:34,TWLG_BULGARIAN:35,TWLG_CATALAN:36,TWLG_CHINESE:37,TWLG_CHINESE_HONGKONG:38,TWLG_CHINESE_PRC:39,TWLG_CHINESE_SINGAPORE:40,TWLG_CHINESE_SIMPLIFIED:41,TWLG_CHINESE_TAIWAN:42,TWLG_CHINESE_TRADITIONAL:43,TWLG_CROATIA:44,TWLG_CZECH:45,TWLG_DANISH:0,TWLG_DUTCH:1,TWLG_DUTCH_BELGIAN:46,TWLG_ENGLISH:2,TWLG_ENGLISH_AUSTRALIAN:47,TWLG_ENGLISH_CANADIAN:48,TWLG_ENGLISH_IRELAND:49,TWLG_ENGLISH_NEWZEALAND:50,TWLG_ENGLISH_SOUTHAFRICA:51,TWLG_ENGLISH_UK:52,TWLG_ENGLISH_USA:13,TWLG_ESTONIAN:53,TWLG_FAEROESE:54,TWLG_FARSI:55,TWLG_FINNISH:4,TWLG_FRENCH:5,TWLG_FRENCH_BELGIAN:56,TWLG_FRENCH_CANADIAN:3,TWLG_FRENCH_LUXEMBOURG:57,TWLG_FRENCH_SWISS:58,TWLG_GERMAN:6,TWLG_GERMAN_AUSTRIAN:59,TWLG_GERMAN_LUXEMBOURG:60,TWLG_GERMAN_LIECHTENSTEIN:61,TWLG_GERMAN_SWISS:62,TWLG_GREEK:63,TWLG_HEBREW:64,TWLG_HUNGARIAN:65,TWLG_ICELANDIC:7,TWLG_INDONESIAN:66,TWLG_ITALIAN:8,TWLG_ITALIAN_SWISS:67,TWLG_JAPANESE:68,TWLG_KOREAN:69,TWLG_KOREAN_JOHAB:70,TWLG_LATVIAN:71,TWLG_LITHUANIAN:72,TWLG_NORWEGIAN:9,TWLG_NORWEGIAN_BOKMAL:73,TWLG_NORWEGIAN_NYNORSK:74,TWLG_POLISH:75,TWLG_PORTUGUESE:10,TWLG_PORTUGUESE_BRAZIL:76,TWLG_ROMANIAN:77,TWLG_RUSSIAN:78,TWLG_SERBIAN_LATIN:79,TWLG_SLOVAK:80,TWLG_SLOVENIAN:81,TWLG_SPANISH:11,TWLG_SPANISH_MEXICAN:82,TWLG_SPANISH_MODERN:83,TWLG_SWEDISH:12,TWLG_THAI:84,TWLG_TURKISH:85,TWLG_UKRANIAN:86,TWLG_ASSAMESE:87,TWLG_BENGALI:88,TWLG_BIHARI:89,TWLG_BODO:90,TWLG_DOGRI:91,TWLG_GUJARATI:92,TWLG_HARYANVI:93,TWLG_HINDI:94,TWLG_KANNADA:95,TWLG_KASHMIRI:96,TWLG_MALAYALAM:97,TWLG_MARATHI:98,TWLG_MARWARI:99,TWLG_MEGHALAYAN:100,TWLG_MIZO:101,TWLG_NAGA:102,TWLG_ORISSI:103,TWLG_PUNJABI:104,TWLG_PUSHTU:105,TWLG_SERBIAN_CYRILLIC:106,TWLG_SIKKIMI:107,TWLG_SWEDISH_FINLAND:108,TWLG_TAMIL:109,TWLG_TELUGU:110,TWLG_TRIPURI:111,TWLG_URDU:112,TWLG_VIETNAMESE:113},t.EnumDWT_CapSupportedSizes={TWSS_NONE:0,TWSS_A4LETTER:1,TWSS_B5LETTER:2,TWSS_USLETTER:3,TWSS_USLEGAL:4,TWSS_A5:5,TWSS_B4:6,TWSS_B6:7,TWSS_USLEDGER:9,TWSS_USEXECUTIVE:10,TWSS_A3:11,TWSS_B3:12,TWSS_A6:13,TWSS_C4:14,TWSS_C5:15,TWSS_C6:16,TWSS_4A0:17,TWSS_2A0:18,TWSS_A0:19,TWSS_A1:20,TWSS_A2:21,TWSS_A4:1,TWSS_A7:22,TWSS_A8:23,TWSS_A9:24,TWSS_A10:25,TWSS_ISOB0:26,TWSS_ISOB1:27,TWSS_ISOB2:28,TWSS_ISOB3:12,TWSS_ISOB4:6,TWSS_ISOB5:29,TWSS_ISOB6:7,TWSS_ISOB7:30,TWSS_ISOB8:31,TWSS_ISOB9:32,TWSS_ISOB10:33,TWSS_JISB0:34,TWSS_JISB1:35,TWSS_JISB2:36,TWSS_JISB3:37,TWSS_JISB4:38,TWSS_JISB5:2,TWSS_JISB6:39,TWSS_JISB7:40,TWSS_JISB8:41,TWSS_JISB9:42,TWSS_JISB10:43,TWSS_C0:44,TWSS_C1:45,TWSS_C2:46,TWSS_C3:47,TWSS_C7:48,TWSS_C8:49,TWSS_C9:50,TWSS_C10:51,TWSS_USSTATEMENT:52,TWSS_BUSINESSCARD:53,TWSS_MAXSIZE:54},t.EnumDWT_CapFeederAlignment={TWFA_NONE:0,TWFA_LEFT:1,TWFA_CENTER:2,TWFA_RIGHT:3},t.EnumDWT_CapFeederOrder={TWFO_FIRSTPAGEFIRST:0,TWFO_LASTPAGEFIRST:1},t.EnumDWT_CapPrinter={TWPR_IMPRINTERTOPBEFORE:0,TWPR_IMPRINTERTOPAFTER:1,TWPR_IMPRINTERBOTTOMBEFORE:2,TWPR_IMPRINTERBOTTOMAFTER:3,TWPR_ENDORSERTOPBEFORE:4,TWPR_ENDORSERTOPAFTER:5,TWPR_ENDORSERBOTTOMBEFORE:6,TWPR_ENDORSERBOTTOMAFTER:7},t.EnumDWT_CapPrinterMode={TWPM_SINGLESTRING:0,TWPM_MULTISTRING:1,TWPM_COMPOUNDSTRING:2},t.EnumDWT_CapBitdepthReduction={TWBR_THRESHOLD:0,TWBR_HALFTONE:1,TWBR_CUSTHALFTONE:2,TWBR_DIFFUSION:3},t.EnumDWT_CapBitOrder={TWBO_LSBFIRST:0,TWBO_MSBFIRST:1},t.EnumDWT_CapFilterType={TWFT_RED:0,TWFT_GREEN:1,TWFT_BLUE:2,TWFT_NONE:3,TWFT_WHITE:4,TWFT_CYAN:5,TWFT_MAGENTA:6,TWFT_YELLOW:7,TWFT_BLACK:8},t.EnumDWT_CapFlash={TWFL_NONE:0,TWFL_OFF:1,TWFL_ON:2,TWFL_AUTO:3,TWFL_REDEYE:4},t.EnumDWT_CapFlipRotation={TWFR_BOOK:0,TWFR_FANFOLD:1},t.EnumDWT_CapImageFilter={TWIF_NONE:0,TWIF_AUTO:1,TWIF_LOWEDMS:2,TWIF_BANDEDMS:3,TWIF_HIGHEDMS:4,TWIF_TEXT:3,TWIF_FINELINE:4},t.EnumDWT_CapLightPath={TWLP_REFLECTIVE:0,TWLP_TRANSMISSIVE:1},t.EnumDWT_CapLightSource={TWLS_RED:0,TWLS_GREEN:1,TWLS_BLUE:2,TWLS_NONE:3,TWLS_WHITE:4,TWLS_UV:5,TWLS_IR:6},t.EnumDWT_MagType={TWMD_MICR:0,TWMD_RAW:1,TWMD_INVALID:2},t.EnumDWT_CapNoiseFilter={TWNF_NONE:0,TWNF_AUTO:1,TWNF_LONEPIXEL:2,TWNF_MAJORITYRULE:3},t.EnumDWT_CapORientation={TWOR_ROT0:0,TWOR_ROT90:1,TWOR_ROT180:2,TWOR_ROT270:3,TWOR_PORTRAIT:0,TWOR_LANDSCAPE:3,TWOR_AUTO:4,TWOR_AUTOTEXT:5,TWOR_AUTOPICTURE:6},t.EnumDWT_CapOverscan={TWOV_NONE:0,TWOV_AUTO:1,TWOV_TOPBOTTOM:2,TWOV_LEFTRIGHT:3,TWOV_ALL:4},t.EnumDWT_CapPixelFlavor={TWPF_CHOCOLATE:0,TWPF_VANILLA:1},t.EnumDWT_CapPlanarChunky={TWPC_CHUNKY:0,TWPC_PLANAR:1},t.EnumDWT_DataSourceStatus={TWDSS_CLOSED:0,TWDSS_OPENED:1,TWDSS_ENABLED:2,TWDSS_ACQUIRING:3},t.EnumDWT_FitWindowType={enumFitWindow:0,enumFitWindowHeight:1,enumFitWindowWidth:2},t.EnumDWT_PlatformType={enumWindow:0,enumMac:1,enumLinux:2},t.EnumDWT_UploadDataFormat={Binary:0,Base64:1},t.EnumDWT_MouseShape={Default:0,Hand:1,Crosshair:2,Zoom:3,NWResize:4,EResize:5,NResize:6,Resize:7,Move:8},t.EnumDWT_Language={English:0,French:1,Arabic:2,Spanish:3,Portuguese:4,German:5,Italian:6,Russian:7,Chinese:8},t.EnumDWT_InitMsg={Info:1,Error:2,NotInstalledError:3,DownloadError:4,DownloadNotRestartError:5},t.EnumDWT_Driver={TWAIN:0,ICA:3,SANE:3,TWAIN_AND_ICA:4,TWAIN_AND_TWAIN64:4,TWAIN64:5},t.EnumDWT_CompressionType={TWCP_NONE:0,TWCP_PACKBITS:1,TWCP_GROUP31D:2,TWCP_GROUP31DEOL:3,TWCP_GROUP32D:4,TWCP_GROUP4:5,TWCP_JPEG:6,TWCP_LZW:7,TWCP_JBIG:8,TWCP_PNG:9,TWCP_RLE4:10,TWCP_RLE8:11,TWCP_BITFIELDS:12,TWCP_ZIP:13,TWCP_JPEG2000:14}}(window);EnumDWT_Error={ModuleNotExists:-2371},function(){function n(n){if(Dynamsoft.Lib.isString(n))return n;var t;return"errorMessage"in n&&(t=n.errorMessage),"message"in n&&(t=n.message),Dynamsoft.Lib.isString(t)||(t=""),"errorCode"in n&&t.indexOf("(")==-1&&(t+="("+n.errorCode+")"),"code"in n&&t.indexOf("(")==-1&&(t+="("+n.code+")"),t}Dynamsoft.Lib.Errors={OutOfRange:function(n){n._errorCode=-1010;n._errorString="Data parameter out of supported range."},InvalidIndex:function(n){n._errorCode=-1033;n._errorString="Invalid index."},InvalidValue:function(n){n._errorCode=-1034;n._errorString="Invalid value."},NoImage:function(n){n._errorCode=-1035;n._errorString="There is no image."},UnrecognizedExt:function(n){n._errorCode=-1110;n._errorString="Unrecognized file extension."},SourceHasNothingToCapture:function(n){n._errorCode=-1029;n._errorString="Source has nothing to capture."},Server_Restarted:function(n){n._errorCode=-2208;n._errorString="The connection with the local Dynamsoft Service encountered a problem and has been reset."},HTML5NotSupport:function(n){n._errorCode=-2209;n._errorString="The HTML5 edition does not support this method or property."},NoUINotSupport:function(n){n._errorCode=-2210;n._errorString="You are calling a UI-related method on a UI-less WebTwain instance."},HttpServerCannotEmpty:function(n){n._errorCode=-2300;n._errorString="Http upload error: the HTTP Server name/ip cannot be empty."},NetworkError:function(n){n._errorCode=-2301;n._errorString="Network error."},InvalidResultFormat:function(n){n._errorCode=-2302;n._errorString="The result format is invalid."},UploadError:function(n,t,i,r){t?(n._errorCode=-2303,n._errorString="Upload cancelled."):(n._errorCode=-2003,n._errorString=r&&r>0?"HTTP process error: "+r+".":"HTTP process error.",i&&(n._errorString+=" "+i))},HttpDownloadUrlError:function(n){n._errorCode=-2304;n._errorString="Http download error: the url is invalid."},HttpDownloadError:function(n,t,i,r){t?(n._errorCode=-2305,n._errorString="User cancelled the operation."):(n._errorCode=-2003,n._errorString=r&&r>0?"HTTP process error: "+r+".":"HTTP process error.",i&&(n._errorString+=" "+i))},UploadFileCannotEmpty:function(n){n._errorCode=-2306;n._errorString="Upload Error: the upload file cannot be empty."},InvalidWidthOrHeight:function(n){n._errorCode=-2307;n._errorString="The width or height you entered is invalid."},Server_Invalid:function(n){n._errorCode==0&&(n._errorCode=-2308,n._errorString="The local Dynamsoft Service has been stopped.")},InvalidLocalFilename:function(n,t){n._errorCode=-2309;n._errorString="The LocalFile is empty in the name "+t+" Function."},BarCode_InvalidIndex:function(n){n._errorCode=-2310;n._errorString="The index is out of range."},BarCode_InvalidRemoteFilename:function(n){n._errorCode=-2311;n._errorString="The RemoteFile field is empty in the Barcode Download Function."},ImageFileLengthCannotZero:function(n){n._errorCode=-2312;n._errorString="The file length is empty."},UploadExceededMaxSize:function(n){n._errorCode=-2313;n._errorString="The size of the images you are about to upload has exceeded the limit."},ParameterCannotEmpty:function(n){n._errorCode=-2314;n._errorString="The parameter cannot be empty."},Webcam_InvalidIndex:function(n){n._errorCode=-2315;n._errorString="The index is out of range."},Webcam_InvalidRemoteFilename:function(n){n._errorCode=-2316;n._errorString="The RemoteFile field is empty in the Webcam Download Function."},Pdf_InvalidRemoteFilename:function(n){n._errorCode=-2317;n._errorString="The RemoteFile field is empty in the Pdf Download Function."},InvalidDestination:function(n){n._errorCode=-2318;n._errorString="Invalid destination file."},InvalidSourceFile:function(n){n._errorCode=-2319;n._errorString="Invalid source file."},InvalidFile:function(n){n._errorCode=-2320;n._errorString="Invalid file."},hasLicenseError:function(n){return n._errorCode>=-2348&&n._errorCode<=-2325},OCR_InvalidIndex:function(n){n._errorCode=-2321;n._errorString="The index is out of range."},OCR_InvalidLeftOrTopOrRightOrBottom:function(n){n._errorCode=-2322;n._errorString="The left or top or right or bottom you entered is invalid."},OCR_InvalidOutputFormat:function(n){n._errorCode=-2323;n._errorString="The OCR output format is not supported."},OCR_InvalidPageSetMode:function(n){n._errorCode=-2324;n._errorString="The OCR page set mode is not supported."},LicenseEmptyOrInvalid:function(n){n._errorCode=-2325;n._errorString="The current product key is empty or invalid."},LicenseExpired:function(n,t){n._errorCode=-2326;var i="";t&&t!=""&&t.indexOf("on")==-1&&(i=" on "+t);n._errorString="The current product key has expired"+i+", please contact the site administrator."},LicenseNoChrome:function(n){n._errorCode=-2327;n._errorString="The current product key does not support Chrome, please contact the site administrator."},LicenseNoFirefox:function(n){n._errorCode=-2328;n._errorString="The current product key does not support Firefox, please contact the site administrator."},LicenseNoIE:function(n){n._errorCode=-2329;n._errorString="The current product key does not support IE, please contact the site administrator."},LicenseNoEdge:function(n){n._errorCode=-2330;n._errorString="The current product key does not support Edge, please contact the site administrator."},LicenseNoSafari:function(n){n._errorCode=-2392;n._errorString="The current product key does not support Safari, please contact the site administrator."},LicenseNoCore:function(n){n._errorCode=-2333;n._errorString="The current product key is missing the core license, please contact the site administrator."},LicenseNo1D:function(n){n._errorCode=-2334;n._errorString="The current product key does not include a license for reading 1D barcode, please contact the site administrator."},LicenseNo2DQR:function(n){n._errorCode=-2335;n._errorString="The current product key does not include a license for reading QRcode barcode, please contact the site administrator."},LicenseNo2DPDF417:function(n){n._errorCode=-2336;n._errorString="The current product key does not include a license for reading PDF417 barcode, please contact the site administrator."},LicenseNo2DDataMatrix:function(n){n._errorCode=-2337;n._errorString="The current product key does not include a license for reading DataMatrix barcode, please contact the site administrator."},LicenseNoWebcam:function(n){n._errorCode=-2338;n._errorString="The current product key does not support Webcam, please contact the site administrator."},LicenseNoPDF:function(n){n._errorCode=-2339;n._errorString="The current product key does not support pdf rasterizer, please contact the site administrator."},LicenseNoOCR:function(n){n._errorCode=-2340;n._errorString="The current product key does not support OCR, please contact the site administrator."},LicenseNoOCRPro:function(n){n._errorCode=-2341;n._errorString="The current product key does not support OCR pro, please contact the site administrator."},LicenseBadDomain:function(n){n._errorCode=-2342;n._errorString="The domain of your current site does not match the domain bound in the current product key, please contact the site administrator."},LicenseNotSupportBorwser:function(n){n._errorCode=-2343;n._errorString="The current product key does not support your browser, please contact the site administrator."},LicenseNotSupportWindows:function(n){n._errorCode=-2344;n._errorString="The current product key does not support Windows OS, please contact the site administrator."},LicenseNotSupportMAC:function(n){n._errorCode=-2345;n._errorString="The current product key does not support MAC OS, please contact the site administrator."},LicenseNotSupportLinux:function(n){n._errorCode=-2346;n._errorString="The current product key does not support Linux OS, please contact the site administrator."},LicenseNotSupportOS:function(n){n._errorCode=-2347;n._errorString="The current product key does not support your OS, please contact the site administrator."},LicenseLower:function(n){n._errorCode=-2348;n._errorString="The current product key is invalid because it's generated with the licenses of a different major version."},BarcodeLicenseEmpty:function(n){n._errorCode=-2349;n._errorString="The current product key does not include a license for reading barcode, please contact the site administrator."},IndicesCannotEmpty:function(n){n._errorCode=-2350;n._errorString="The indices cannot be empty."},UploadIndexMoreThanOne:function(n){n._errorCode=-2351;n._errorString="You cannot upload more than one image when the format is BMP, JPG or PNG"},IndicesOutOfRange:function(n){n._errorCode=-2352;n._errorString="The indices are out of range."},HttpHeaderNotAllowed:function(n){n._errorCode=-2353;n._errorString="The header name being used is a protected keyword and is not allowed."},HttpHeaderIsEmpty:function(n){n._errorCode=-2354;n._errorString="The header name cannot be empty."},HttpHeaderIsNull:function(n){n._errorCode=-2355;n._errorString="The header name cannot be null."},HttpHeaderIsUndefined:function(n){n._errorCode=-2356;n._errorString="The header name cannot be undefined."},HttpHeaderIsInvalid:function(n){n._errorCode=-2357;n._errorString="The header name you entered is invalid."},IndicesNotArray:function(n){n._errorCode=-2358;n._errorString="The type of the parameter indices must be an Array."},IndexOutOfRange:function(n){n._errorCode=-2359;n._errorString="The index is out of range."},IndexNullOrUndefined:function(n){n._errorCode=-2360;n._errorString="The index is null or undefined."},ConvertBase64IndexMoreThanOne:function(n){n._errorCode=-2361;n._errorString="You cannot convert more than one image to base64 string when the format is BMP, JPG or PNG."},InvalidImageType:function(n){n._errorCode=-2362;n._errorString="The image type is not supported."},InvalidDataFormat:function(n){n._errorCode=-2363;n._errorString="The data format is not supported."},InvalidUploadInSegments:function(n){n._errorCode=-2364;n._errorString="Please use a Boolean value for the parameter bUploadInSegments."},InvalidUrl:function(n){n._errorCode=-2365;n._errorString="The url is invalid."},ConvertBase64Failed:function(n){n._errorCode=-2366;n._errorString="Converting images to a base64 string failed."},InvalidSegmentUploadThreshold:function(n){n._errorCode=-2367;n._errorString="Invalid value for the parameter segmentUploadThreshold."},InvalidModuleSize:function(n){n._errorCode=-2368;n._errorString="Invalid value for the parameter moduleSize."},LicenseNotSupportWasm:function(n){n._errorCode=-2369;n._errorString="The current product key does not support Wasm, please contact the site administrator."},LicenseNotSupportPdfRWasm:function(n){n._errorCode=-2370;n._errorString="The current product key does not support Pdf Rasterizer Wasm, please contact the site administrator."},MustUpgradeService:function(n){n._errorCode=-2207;n._errorString="The Dynamsoft Service installed on your computer is outdated and no longer works with the JavaScript code on the website."},WebTwainModuleDownloadFailure:function(n){n._errorCode=-2369;n._errorString="The module for Dynamic Web TWAIN has failed to download."},LicenseIsFuture:function(n){n._errorCode=-2370;n._errorString="The current product key is invalid, please contact the site administrator."},WebTwainModuleNotExist:function(n){n._errorCode=EnumDWT_Error.ModuleNotExists;n._errorString="Dynamic Web TWAIN scanner module is not installed and it is also missing on the server, please contact the site administrator."},ConvertBinaryIndexMoreThanOne:function(n){n._errorCode=-2372;n._errorString="You cannot convert more than one image to binary when the format is BMP, JPG or PNG."},Overlay_InvalidLeftOrTopOrRightOrBottom:function(n){n._errorCode=-2375;n._errorString="The left or top or right or bottom you entered is invalid."},GenerateURL_InvalidRetFromServer:function(n){n._errorCode=-2376;n._errorString="The generate url failed."},ImageCaptureDriverTypeError:function(n){n._errorCode=-2377;n._errorString="Failed to set Image Capture Driver Type."},InvalidTiffTagError:function(n){n._errorCode=-2378;n._errorString="Invalid value for the tiff tag code."},OCR_InvalidRemoteFilename:function(n){n._errorCode=-2379;n._errorString="The RemoteFile field is empty in the OCR Download Function."},Uploader_ModuleError:function(n){n._errorCode=-2380;n._errorString="Please make sure the Uploader Module has been installed."},ScanUploader_InvalidScanSetup:function(n){n._errorCode=-2381;n._errorString="scanSetup is invalid."},ScanUploader_InvalidTransferMode:function(n){n._errorCode=-2382;n._errorString="Scanner setup error: Invalid Transfer Mode."},ScanUploader_InvalidFileXfer:function(n){n._errorCode=-2383;n._errorString="Scanner setup error: fileXfer is invalid."},ScanUploader_InvalidFileXferFilename:function(n){n._errorCode=-2384;n._errorString="Scanner setup error: Invalid fileName in fileXfer."},ScanUploader_InvalidFileXferFileFormat:function(n){n._errorCode=-2385;n._errorString="Scanner setup error: Invalid fileFormat in fileXfer."},ScanUploader_InvalidHttpParams:function(n){n._errorCode=-2386;n._errorString="Output setup error: Invalid httpParams in outputSetup."},ScanUploader_InvalidHttpType:function(n){n._errorCode=-2387;n._errorString="Output setup error: Invalid type in outputSetup."},ScanUploader_InvalidHttpUrl:function(n){n._errorCode=-2388;n._errorString="Output setup error: Invalid url in outputSetup.httpParams."},ScanUploader_InvalidHttpFilename:function(n){n._errorCode=-2389;n._errorString="Output setup error: Invalid fileName in outputSetup.httpParams."},ScanUploader_InvalidOutputFormat:function(n){n._errorCode=-2390;n._errorString="Output setup error: Invalid format in outputSetup."},InvalidImageID:function(n){n._errorCode=-1034;n._errorString="Invalid image ID."},InvalidEventName:function(n){n._errorCode=-2391;n._errorString="Invalid event name."},ConvertBlobIsEmpty:function(n){n._errorCode=-2393;n._errorString="Failed to convert the data to blob."},InvalidTagName:function(n){n._errorCode=-2394;n._errorString="Invalid tag name."},MobileNotSupport:function(n,t){n._errorCode=-2400;n._errorString=t+" doesn't work under current settings."},LoadImageFailed:function(t,i){t._errorCode=-2401;t._errorString="Failed to load image: "+n(i)},RotateFailed:function(t,i){t._errorCode=-2402;t._errorString="Failed to rotate image: "+n(i)},FlipFailed:function(t,i){t._errorCode=-2403;t._errorString="Failed to flip image: "+n(i)},MirrorFailed:function(t,i){t._errorCode=-2404;t._errorString="Failed to mirror image: "+n(i)},EraseFailed:function(t,i){t._errorCode=-2405;t._errorString="Failed to erase image: "+n(i)},InvertFailed:function(t,i){t._errorCode=-2406;t._errorString="Failed to invert image: "+n(i)},SaveImageFailed:function(t,i){t._errorCode=-2407;t._errorString="Failed to save image: "+n(i)},ChangeImageSizeFailed:function(t,i){t._errorCode=-2408;t._errorString="Failed to change image size: "+n(i)},CropFailed:function(t,i){t._errorCode=-2409;t._errorString="Failed to crop image: "+n(i)},SkewAngleFailed:function(t,i){t._errorCode=-2410;t._errorString="Failed to skew angle: "+n(i)},ConvertToGrayScaleFailed:function(t,i){t._errorCode=-2411;t._errorString="Failed to convert to gray scale: "+n(i)},ConvertToBWScaleFailed:function(t,i){t._errorCode=-2412;t._errorString="Failed to convert to black and white scale: "+n(i)},SetDPIFailed:function(t,i){t._errorCode=-2413;t._errorString="Failed to set dpi: "+n(i)},SetImageWidthFailed:function(t,i){t._errorCode=-2414;t._errorString="Failed to set image width: "+n(i)},GetLicenseInfoFailed:function(t,i){t._errorCode=-2415;t._errorString="Failed to get license info: "+n(i)},InvalidParameter:function(n){n._errorCode=-2416;n._errorString="Invalid parameter type."},MobileServer_InvalidLeftOrTopOrRightOrBottom:function(n){n._errorCode=-2417;n._errorString="The left or top or right or bottom you entered is invalid."},MobileServer_InvalidWidth:function(n){n._errorCode=-2418;n._errorString="The width you entered is invalid."},MobileServer_InvalidHeight:function(n){n._errorCode=-2419;n._errorString="The height you entered is invalid."},MobileServer_InvalidXResolution:function(n){n._errorCode=-2420;n._errorString="The x resolution you entered is invalid."},MobileServer_InvalidYResolution:function(n){n._errorCode=-2421;n._errorString="The y resolution you entered is invalid."},MobileServer_InvalidImage:function(n){n._errorCode=-2422;n._errorString="The image source is invalid."},MobileServer_InvalidIndex:function(n){n._errorCode=-2423;n._errorString="The index is invalid."},GetMD5Failed:function(t,i){t._errorCode=-2424;t._errorString="Failed to get MD5: "+n(i)},ConvertFromBase64Failed:function(n){n._errorCode=-2425;n._errorString="Converting image from a base64 string failed."},LicenseTrialFullMixed:function(n){n._errorCode=-2426;n._errorString="You have used a full license with a trial license which is not permitted. Please check and update Dynamsoft.WebTwainEnv.ProductKey."},BarcodeReaderError:function(n,t){n._errorCode=-2427;n._errorString=t},TiffTagCountExceedError:function(n){n._errorCode=-2428;n._errorString="Tiff tag count has exceeded the limit."},SelectSourceMustAsync:function(n){n._errorCode=-2429;n._errorString="The method SelectSource() must be invoked asynchronously (i.e. with callback functions) when ImageCaptureDriverType is set to TWAIN_AND_ICA or TWAIN_AND_TWAIN64."},HttpLicenseInvalid:function(n){n._errorCode=-2430;n._errorString="The current product key is invalid."},LicenseNotSupportWasmWasm:function(n){n._errorCode=-2431;n._errorString="The current product key does not support Webcam Wasm, please contact the site administrator."},InvalidParameterInCallback:function(n){n._errorCode=-2432;n._errorString="Invalid parameter."},ActiveXNotSupport:function(n){n._errorCode=-2433;n._errorString="The ActiveX edition does not support this method or property."},DetectCallbackErr:function(n){n._errorCode=-2434},PerspectiveCallback:function(n){n._errorCode=-2435},webtwain_id_not_string:function(){return'Error: The "WebTwainId" is not a string.'},container_id_not_string:function(){return'Error: The argument you passed to the parameter "conatinerId" is not a string.'},container_id_not_exist:function(n){return'Error: The element specified by the id "'+n+"\" doesn't exist."},WebviewerError:function(n,t,i){n._errorCode=i?i:-2500;n._errorString=t},ClearErrorInfo:function(n){n._errorCode=0;n._errorString=""},__last:!1}}();Dynamsoft.Ready(function(n){n.LS={isSupportLS:function(){var n=Dynamsoft.navInfoSync,t=!1;if(!n.bEdge||!n.bFileSystem)try{t=window.localStorage?!0:!1}catch(i){}return t},item:function(n,t,i){var r=null;return this.isSupportLS()?(t?(localStorage.setItem(n,t),r=t):r=localStorage.getItem(n),r===null)?i:r:i},removeItem:function(n){if(this.isSupportLS())localStorage.removeItem(n);else return!1;return!0}}});Dynamsoft.Ready(function(n){if(n.html5=n.html5||{},n.product.bHTML5Edition){var u=1,i,t=!1,r=!0,e=0,f=1,o=1,s=2,h=Dynamsoft.WebTwainEnv;i=n.html5.Funs={notSupportProperty:function(){},notSupportMethod:function(){},getRandom:function(){for(var t=(new Date).getTime()%1e4,n=[],r,i=0;i<5;i++){if(r=Math.floor(Math.random()*10),i==0&&r==0){i=-1;continue}n.push(r)}return t<10?n.push("000"):t<100?n.push("00"):t<1e3&&n.push("0"),n.push(t),n.join("")},generateCmdId:function(){return u++,u},cformat:function(t,i){if(n.isString(t)){var r=t.indexOf("<%"),u,f,o,s,e;if(r==-1)return t;if(f=t.substring(0,r),u=t.indexOf(">",f),r+2<u)o=t.substring(r+1,u);else return t;s=t.substring(u+1);try{e=n.sprintf(o,i)}catch(h){e=""}return[f,e,s].join("")}return""},sendData:function(i,u,f,e){var s,a,h,c,v,y,o,l;if(!e){try{i.send(u)}catch(p){n.log(p)}return t}for(c=new ArrayBuffer(12),a=f&&f.size?f.size:0,l=new Blob([u]),s=l.size,h=s+a,v=new DataView(c),o=0;o<8;o++)if(h)v.setUint8(o,h%256),h=parseInt(h/256);else break;for(o=0;o<4;o++)if(s)v.setUint8(8+o,s%256),s=parseInt(s/256);else break;return y=new Blob([c,l]),i.send(y),a>0&&i.send(f),c=null,l=null,y=null,r},__pushElement:function(u,f){if(n.isString(f))u.push('"'),u.push(f),u.push('"');else if(n.isArray(f)){var e=r;u.push("[");n.each(f,function(n){e?e=t:u.push(",");i.__pushElement(u,n)});u.push("]")}else f===undefined?u.push('""'):u.push(f)},makeParams:function(){var t=arguments,n,r,u;return t===undefined||t.length===0?undefined:(n=[],t.length===1?(r=t[0],n.push("["),i.__pushElement(n,r),n.push("]")):t.length===2?(r=t[0],u=t[1],n.push("["),i.__pushElement(n,r),n.push(","),i.__pushElement(n,u),n.push("]")):i.__pushElement(n,Array.prototype.slice.call(t)),n.join(""))},getJson:function(t,i,r,u){var f=[],o,e;return f.push("{"),f.push('"id":"'),f.push(t.clientId),f.push('"'),u&&(f.push(',"cmdId":"'),f.push(u),f.push('"')),f.push(',"method":"'),f.push(i),f.push('"'),f.push(',"module":"dwt","version":"'),o=Dynamsoft.WebTwainEnv,e=[n.product.getDWTPrefix(),n.product.getServerVersionInfo()].join(""),f.push(e),f.push('"'),r!==undefined&&r!==null&&(f.push(',"parameter":'),f.push(r)),f.push("}"),f.join("")},refreshImageAfterInvokeFun:function(n,t,i){return i==1},loadHttpBlob:function(i,u,f,e,o,s,h,c){var p,l,a=t,y,v,w;if(p=function(u,f,e){var h,o,c;u&&n.isArray(u)&&u.length>2?(h=u[1],o=u[2]):(h=f,o=e);o.state==2&&o.status==0?o.statusText==="abort"?(c=r,n.Errors.HttpDownloadError(i,c)):n.Errors.HttpDownloadUrlError(i):n.Errors.HttpDownloadError(i,t,h,o.status);n.isFunction(s)&&s()},l={method:u,url:f,"async":e,onSuccess:o,onError:p,headers:t,onComplete:function(){n.bio=t}},c&&(l.headers=c),i.HTTPUserName!=""&&(l.username=i.HTTPUserName,l.password=i.HTTPPassword),e?(l.dataType="blob",n.isFunction(h)&&(l.beforeSend=function(n){n.addEventListener("progress",function(n){delete n.totalSize;delete n.position;h(n)},t)}),a=r):(Dynamsoft.navInfoSync.bIE?(l.dataType="arraybuffer",l.onSuccess=function(n,t,u){var f,e;f=n||u.responseData;f&&(e=new Uint8Array(f));i._errorCode=0;i._errorString="";o(e);e=null;a=r}):(l.contentType="text/plain; charset=x-user-defined",l.mimeType="text/plain; charset=x-user-defined",l.onSuccess=function(n,t,u){var s,h,e,f;for(s=u.responseText,h=s.length,e=new Uint8Array(h),f=0;f<h;f++)e[f]=s.charCodeAt(f);i._errorCode=0;i._errorString="";o(e);e=null;a=r}),l.headers?n.mix(l.headers,{"X-Requested-With":t}):l.headers={"X-Requested-With":t}),u=="post"&&(y=i.httpFormFields,y))try{v=new FormData;n.each(y,function(n,t){if(n instanceof Blob){var i=n.name;v.append(t,n,i)}else v.append(t,n)});n.mix(l,{data:v,processData:t,contentType:t})}catch(b){}return w=n.ajax(l),e&&(n.bio=w),a},combineUrl:function(i,r,u){var e=[],f=r;return f===undefined||u===undefined?t:(n.isString(f)||(f=String(r)),f.indexOf("http://")==0?(f=f.replace("http://",""),e.push("http://")):f.indexOf("https://")==0?(f=f.replace("https://",""),e.push("https://")):(f.indexOf("//")==0&&(f=f.replace("//","")),i.IfSSL?e.push("https://"):e.push("http://")),e.push(f),f.indexOf(":")<0&&(i.HTTPPort==""&&(i.HTTPPort=n.detect.ssl?443:80),(!n.detect.ssl&&i.HTTPPort!=80||n.detect.ssl&&i.HTTPPort!=443)&&(e.push(":"),e.push(i.HTTPPort))),u.indexOf("/")!==0&&e.push("/"),e.push(u),e.join(""))},httpPostUpload:function(i,r,u,f,e,o,s,h,c,l,a,v){var g,p;if(!u||u.size<=0)return n.Errors.UploadFileCannotEmpty(i),n.isFunction(v)&&v(),t;var b=i.MaxUploadImageSize,k=u.size,w=u.type,y,d;return k>b&&b!=-1?(n.Errors.UploadExceededMaxSize(i),n.isFunction(v)&&v(),t):(w===""||w&&w!=i.HttpContentTypeFieldValue?(g=u.slice||u.webkitSlice||u.mozSlice,p=u.name,n.isString(p)&&p!=""||(p=u.fileName),y=g.call(u,0,k,i.HttpContentTypeFieldValue),y.name=p):y=u,u=null,y.remoteFilename=i.__remoteFilename,d=this.httpUploadByBIO(i,r,y,e,f,o,s,h,c,l,a,v),y=null,d)},httpPostUploadFiles:function(i,r,u,f,e,o,s,h,c,l,a){var k=i.MaxUploadImageSize,d=0,v,y,b,p,g,tt;if(!u||!n.isArray(u)||u.length<=0)return n.Errors.UploadFileCannotEmpty(i),n.isFunction(a)&&a(),t;for(v=0;v<u.length;v++){if(y=u[v],!y||y.size<=0)return n.Errors.UploadFileCannotEmpty(i),n.isFunction(a)&&a(),t;if(b=y.size,p=y.type,d+=b,p===""||p&&p!=i.HttpContentTypeFieldValue){var it=y.slice||y.webkitSlice||y.mozSlice,w=y.name,nt=it.call(y,0,b,i.HttpContentTypeFieldValue);n.isString(w)&&w!=""||(w=y.fileName);nt.name=this.cformat(w,v+1);u[v]=nt}u[v].remoteFilename=this.cformat(i.__remoteFilename,v+1);y=null}if(d>k&&k!=-1)return n.Errors.UploadExceededMaxSize(i),n.isFunction(a)&&a(),t;for(tt=!1,g=this.httpUploadByBIO(i,r,u,e,f,o,s,h,c,tt,l,a),v=0;v<u.length;v++)u[v]=null;return u=null,g},httpPostUploadString:function(i,u,f,e,o,s,h,c,l,a,v){var y,p,w,b,k;return f==""?(n.Errors.UploadFileCannotEmpty(i),n.isFunction(v)&&v(),t):(p=i.MaxUploadImageSize,w=f.length,w>p&&p!=-1)?(n.Errors.UploadExceededMaxSize(i),n.isFunction(v)&&v(),t):(y=new Blob([f],{type:"text/plain"}),y.name=e,k=!1,b=this.httpUploadByBIO(i,u,y,o,r,s,h,c,l,k,a,v),y=null,b)},httpUploadByBIO:function(i,r,u,f,e,o,s,h,c,l,a,v){var p,y,k,w,b;k=i.httpFormFields;w=new FormData;n.each(k,function(n,t){if(n instanceof Blob){var i=n.name;w.append(t,n,i)}else w.append(t,n)});n.bio=new n.BIO({action:r,data:w,"async":e,retry:h,bOnlyEmptyIsOK:c});p=n.bio.get("uploadType");p&&(y=p.get("ajaxConfig"),y&&y.headers&&o&&n.mix(y.headers,o),f>=0&&p.set("blockSize",f),i.__withCredentials&&n.mix(y.xhrFields,{withCredentials:!0}));i.__HTTPPostResponseString=t;n.bio.on(n.BIO.event.SUCCESS,function(r){if(n.bio=t,i.__HTTPPostResponseString=r&&n.isString(r.response)?r.response:"",n.isFunction(i.__OnHttpUploadStatus)){var f=r.name,u;u={fileName:f,percentage:100,statusCode:200,responseString:i.__HTTPPostResponseString};i.__OnHttpUploadStatus(u)}n.isFunction(a)&&a(i.__HTTPPostResponseString)});n.bio.on(n.BIO.event.ERROR,function(r){var f=r&&r.canceled,c=r&&r.timeout,e=t,u=0,o,s,h;n.bio=t;i.__HTTPPostResponseString=r&&n.isString(r.response)?r.response:"";f||(r&&r.msg&&(e=r.msg),r&&r.httpStatus&&(u=r.httpStatus));n.Errors.UploadError(i,f,e,u);n.isFunction(i.__OnHttpUploadStatus)&&(o=r.name,s=u,h={fileName:o,percentage:100,statusCode:s,responseString:i.__HTTPPostResponseString},i.__OnHttpUploadStatus(h));n.isFunction(v)&&v(i.__HTTPPostResponseString)});if(s||n.isFunction(i.__OnHttpUploadStatus)){n.bio.on(n.BIO.event.PROGRESS,function(t){var r,o,u,f,e;delete t.totalSize;delete t.position;r=t.total===0?100:Math.round(t.loaded*100/t.total);o=[t.loaded," / ",t.total].join("");n.isFunction(i.__OnHttpUploadStatus)&&(u=t.name,f=0,r>99&&(r=99),e={fileName:u,percentage:r,statusCode:f,responseString:""},i.__OnHttpUploadStatus(e));s&&i._OnPercentDone([0,r,"","http",t.name])});s&&i._OnPercentDone([0,-1,Dynamsoft.MSG.Uploading,"http"]);n.isFunction(i.__OnHttpUploadStatus)&&(b="",n.isArray(u)&&u.length>0||(u&&u.name&&u.name!=""?b=u.name:u&&u.fileName&&(b=u.fileName)),i.__OnHttpUploadStatus({fileName:b,percentage:0,statusCode:0,responseString:""}))}return l&&l.bCancel?(l.st=2,n.isFunction(v)&&v(!1),!1):n.bio.upload(u)},httpPutImage:function(i,u,f,e,o,s,h){var l=r,c={method:"PUT",url:u,hasContent:r,processData:t,"async":e,data:f,onSuccess:o,onError:function(){l=t;n.isFunction(s)&&s()},onComplete:function(){n.bio=t},beforeSend:function(i){n.isFunction(h)&&i.upload.addEventListener("progress",function(n){delete n.totalSize;delete n.position;h(n)},t)}};return i.HTTPUserName!=""&&(c.username=i.HTTPUserName,c.password=i.HTTPPassword),e||n.mix(c,{headers:{"X-Requested-With":t}}),n.bio=n.ajax(c),l},dialog:t,dialogRef:0,showMask:function(t){var i=this;n.log("showMask:"+t+"--"+i.dialogRef);i.dialogRef==0&&n.detect.showMask();i.dialogRef++},hideMask:function(i){var r=this;n.log("hideMask:"+i+"--"+r.dialogRef);r.dialogRef>1?r.dialogRef--:r.dialogRef<=1&&(n.detect.hideMask(),r.dialog=t,r.dialogRef=0)},setBtnCancelVisibleForProgress:function(t,i){var u=this;(n.cancelFrome==0&&t.__IfShowProgressBar==r||n.cancelFrome!=0&&t.__IfShowCancelDialogWhenImageTransfer==r)&&n.setBtnCancelVisibleForProgress(i)},EVENTS:["OnPostAllTransfers","OnPostTransfer","OnPostLoad","OnPreTransfer","OnPreAllTransfers","OnResult","OnTransferCancelled","OnTransferError","OnSourceUIClose","OnBitmapChanged","OnGetFilePath","OnPercentDone","OnPostTransferAsync","OnPreAllTransfersAsync"],SEND_BACK_EVENTS:["OnPreAllTransfers","OnPreTransfer","OnPostTransfer","OnGetFilePath","OnPostLoad"],handleEvent:function(u,f){var h=this,o=f.result[0],s=u._objWS,e=t;return n.each(i.EVENTS,function(i){if(f.event===i){var o=["_",i].join("");return e=r,n.isFunction(u[o])&&u[o](f.result,f),t}}),e?(n.log("handled event:"+f.event),n.each(i.SEND_BACK_EVENTS,function(e){return i.isServerInvalid(u)?t:f.event===e?(n.log("sendback event:"+f.event),i.sendData(s,i.getJson(u,f.event,i.makeParams(o),0),t,r),t):void 0})):(n.each(n.Addon_Events,function(i){if(f.event===i){var o=["_",i].join("");return e=r,n.isFunction(u[o])&&u[o](f.result),t}}),e&&(n.log("handled addon event:"+f.event),n.each(n.Addon_Sendback_Events,function(e){return i.isServerInvalid(u)?t:f.event===e?(n.log("sendback addon event:"+f.event),i.sendData(s,i.getJson(u,f.event,i.makeParams(o),0),t,r),t):void 0}))),e},getImageType:function(n){var r,i,t;return n===undefined?-1:(r=n.length,r<4)?-1:(i=n.lastIndexOf("."),i===-1)?-1:(t=n.slice(i).toLowerCase(),t===".bmp"||t===".dib")?EnumDWT_ImageType.IT_BMP:t===".jpg"||t===".jpe"||t===".jpeg"||t===".jfif"?EnumDWT_ImageType.IT_JPG:t===".tif"||t===".tiff"?EnumDWT_ImageType.IT_TIF:t===".png"?EnumDWT_ImageType.IT_PNG:t===".pdf"?EnumDWT_ImageType.IT_PDF:-1},addImageFileExt:function(n,t){var r,i=n.substring(n.lastIndexOf(".")).toLowerCase();return i==".bmp"||i==".dib"||i==".jpg"||i==".jpe"||i==".jpeg"||i==".jfif"||i==".tif"||i==".tiff"||i==".png"||i==".pdf"?n:(t==EnumDWT_ImageType.IT_BMP?r=[n,".bmp"].join(""):t==EnumDWT_ImageType.IT_JPG?r=[n,".jpg"].join(""):t==EnumDWT_ImageType.IT_PNG?r=[n,".png"].join(""):t==EnumDWT_ImageType.IT_TIF?r=[n,".tif"].join(""):t==EnumDWT_ImageType.IT_PDF&&(r=[n,".pdf"].join("")),r)},autoDiscardBlankImage:function(t,i){var r,u;n.config.bDiscardBlankImage&&(r=t._ImgManager.getCurrentImageIndex(),t.IsBlankImage(r)&&t.RemoveImage(r),u=["Blank Discard (",i,"): ",t.ErrorString].join(""),n.isFunction(t.__OnPrintMsg)&&t.__OnPrintMsg(u))},replaceLocalFilename:function(n){var t;return n===undefined?"":(n=String(n),t=n.replace(/\\/g,"\\\\"),Dynamsoft.navInfoSync.bFileSystem&&(t=decodeURI(t)),t)},GetImageInfo:function(t,r){var u=t._ImgManager.convertClientIndexToServerId(r);return u==-1?(n.Errors.IndexOutOfRange(t),!1):t._innerFun("GetImageInfo",i.makeParams(u))},isServerInvalid:function(t){var i=t,r,u;return r=!i.bReady||i._objWS===null,u=i.__bMustUpgradeService,r?n.Errors.Server_Invalid(i):u&&n.Errors.MustUpgradeService(i),r||u||i._errorCode==-2208},isHttpServerInvalid:function(t){var i=t,r,u;return r=!i.bReady||i.httpUrl===null,u=i.__bMustUpgradeService,r?n.Errors.Server_Invalid(i):u&&n.Errors.MustUpgradeService(i),r||u||i._errorCode==-2208},getBlobTypeByImageType:function(n){var t="application/octet-stream";switch(n){case 0:t="image/bmp";break;case 1:t="image/jpeg";break;case 2:t="image/tiff";break;case 3:t="image/png";break;case 4:t="application/pdf"}return t},DEF:function(r,u,h,c){var l;h!==e&&h!==f?l=h:(l={},h&&(l.set=c==o?function(f){var e=f*1;return!n.isNumber(e)||isNaN(e)?(n.Errors.InvalidValue(r),t):(r._resetErr(),r._innerFun(u,i.makeParams(e)))}:c==s?function(f){return n.isBoolean(f)?(r._resetErr(),r._innerFun(u,i.makeParams(f))):(n.Errors.InvalidValue(r),t)}:function(f){return n.isString(f)?(r._resetErr(),r._innerFun(u,i.makeParams(f))):(n.Errors.InvalidValue(r),t)}));l.get||(l.get=function(){return r._resetErr(),r._innerFun(u)});u in r||Object.defineProperty(r,u,l)},_DEF_NOT_SUPPORT_MOBILE_A:function(t,i,r){var u={get:function(){return t._mobileNotSupport(i)}};(r===f||n.isUndef(r))&&(u.set=u.get);i in t||Object.defineProperty(t,i,u)},DEF_NOT_SUPPORT_MOBILE:function(t,r,u){n.isArray(r)?n.each(r,function(n){i._DEF_NOT_SUPPORT_MOBILE_A(t,n,u)}):i._DEF_NOT_SUPPORT_MOBILE_A(t,r,u)},callbacks:[],pushCallback:function(n,t,r){var u={method:n,callback:t,ticks:r};i.callbacks(u)},RemoveNonPrintableChar:function(t){return n.isString(t)?t.replace(/[^\x20-\x7E]/g,""):t},refreshUIRef:0}}});Dynamsoft.Ready(function(n){function r(n){var t=n;i(t,"width",{get:function(){return this._parent._width},set:function(n){this.SetSize(n,!1)}});i(t,"height",{get:function(){return this._parent._height},set:function(n){this.SetSize(!1,n)}})}function u(i,r,u){var s=i,f=!1,e=!1,o;return s._bNoUI?!1:(n.isString(r)&&r.length>0&&r.charAt(r.length-1)==="%"&&(f=r),!f&&r&&(o=parseInt(r),o&&(f=o+"px")),n.isString(u)&&u.length>0&&u.charAt(u.length-1)==="%"&&(e=u),!e&&u&&(o=parseInt(u),o&&(e=o+"px")),f&&(s._width=f),e&&(s._height=e),t.changeImageUISize(s,f,e))}var f=Dynamsoft,t,i;n.product.bHTML5Edition&&(t=n.html5.Funs,i=t.DEF,n.html5.STwainStyle=function(n){var t=this;t._parent=n;r(t)},n.html5.STwainStyle.prototype.SetSize=function(n,t){u(this._parent,n,t)})});Dynamsoft.Ready(function(n){function t(){}if(n.product.bHTML5Edition){var i=239514e3;t.prototype.convertServerIdToGuid=function(n){var t=this;return 1*n+i};t.prototype.convertGuidToServerId=function(n){var t=this;return 1*n-i};n.Index=n.Index||{};n.Index.ImageIndexManager=t}});Dynamsoft.Ready(function(n){function e(n,t){var i=t||{};n.__OnAfterOperate=i.onAfterOperate||"";n.__OnBeforeOperate=i.onBeforeOperate||"";n.__OnOperateStatus=i.onOperateStatus||"";n.__OnBitmapChanged=i.onBitmapChanged||"";n.__OnGetFilePath=i.onGetFilePath||"";n.__OnPreAllTransfers=i.onPreAllTransfers||"";n.__OnPreTransfer=i.onPreTransfer||"";n.__OnPostLoad=i.onPostLoad||"";n.__OnPostTransfer=i.onPostTransfer||"";n.__OnPostAllTransfers=i.onPostAllTransfers||"";n.__OnSourceUIClose=i.onSourceUIClose||"";n.__OnTransferCancelled=i.onTransferCancelled||"";n.__OnTransferError=i.onTransferError||"";n.__OnInternetTransferPercentage=i.onInternetTransferPercentage||"";n.__OnInternetTransferPercentageEx=i.onInternetTransferPercentageEx||""}var o=Dynamsoft,i;if(n.product.bHTML5Edition){var u=n.html5.Funs,f=Dynamsoft.dcp,t=!1,r=!0;n.html5.STwain=function(i){var o=this,s=i||{},h=s.bNoUI,c=s.bLocalService;o.config=s;o.clientId=u.getRandom();o._id=s.id;o._containerID=s.containerID;o._bNoUI=h?r:t;o._bLocalService=c?r:t;o._customIP=t;o._ssl=n.detect.ssl;s.customIP?(o._customIP=r,o._host=s.host):o._host=n.product.host;(s.customIP||f.bEnhancedMode)&&(o._port=s.port);o.bReady=t;o.httpFormFields={};o._objWS=null;o.__wsRetry=0;o.curCommand=[];o.__OnInternetTransferPercentage=s.onInternetTransferPercentage||"";o.__OnInternetTransferPercentageEx=s.onInternetTransferPercentageEx||"";o.__OnReady=s.onReady||null;o.__OnWSReconnect=s.onWSReconnect||null;o.__OnWSClose=s.onWSClose||null;o.__OnWSMessage=s.onWSMessage||null;o.__OnWSError=s.onWSError||null;o.__OnPercentDone=s.onPercentDone||"";o.__OnPrintMsg=s.onPrintMsg||"";o.__OnResult=s.onResult||"";o.HTTPPassword=s.HTTPPassword||"";o.HTTPPort=s.HTTPPort||(n.detect.ssl?443:80);o.HTTPUserName=s.HTTPUserName||"";o.__HTTPPostResponseString="";o.__strHttpContentTypeFieldValue="application/octet-stream";o.__IfShowProgressBar=r;o.__IfShowCancelDialogWhenImageTransfer=r;o._errorCode=0;o._errorString="";o.__bLoadingImage=t;o.__backgroundColor=t;o.__addon={};o.__remoteFilename="RemoteFile";o.__sourceName=[];o.__defaultSourceName="";o.__sourceCount=0;o.__icaSourceCount=-1;o.__serverId="";o.__bConnecting=t;o.__bTrial=t;o.__licenseInfo=t;o.__httpHeaderMap=t;o.__bForceClose=t;o.__strProductName=o._bLocalService?"":Dynamsoft.WebTwainEnv.ProductName;o.__versionInfo=Dynamsoft.WebTwainEnv.JSVersion;o.__bMustUpgradeService=t;o.__withCredentials=t;o._moduleSize=1048576;o._segementUploadThreshold=Dynamsoft.dcp.b64bit?4294967296:524288e3;o._driverType=EnumDWT_Driver.TWAIN;o.__IfAppendImage=r;o.__maxImagesInBuffer=32767;o.__maxUploadImageSize=-1;o.__insertingIndex=-1;o.objImageIndexManager=new n.Index.ImageIndexManager(o.__maxImagesInBuffer);o._bServerPercentDone=r;o._aryBitmapCache=[];o._aryTiffTag=[];o._tiffCompressionType=EnumDWT_TIFFCompressionType.TIFF_AUTO;o._jpgQuality=80;o._pdfConvertMode=3;o._pdfRealConvertMode=3;o._pdfResolution=200;o._pdfPassword="";o._ifSSL=Dynamsoft.navInfoSync.bSSL;o._bRegistedLoad=!1;o._logLevel=0;o._scaleDownThreshold=0;o._pdfWriteSetting={};e(o,s)};i=n.html5.STwain.prototype;i.getInstance=function(){return this};i._isMobileMode=function(){return!this._bLocalService};i._isPC=function(){var n=Dynamsoft.navInfo;return n.bWin||n.bMac||n.bLinux};i._resetErr=function(){this._errorCode=0;this._errorString=""};i._isNoUI=function(){var n=this;return n._bNoUI};i._mobileNotSupport=function(t,i){var r=this;return n.Errors.MobileNotSupport(r,t),n.isFunction(i)&&i(r.ErrorCode,r.ErrorString),!1};i._mobileNotSupportAsync=function(t){var i=this;return n.Errors.MobileNotSupport(i,t),n.Promise.reject({code:i.ErrorCode,message:i.ErrorString})};i._nouiNotSupport=function(t,i){var r=this;return n.Errors.NoUINotSupport(r,t),n.isFunction(i)&&i(r.ErrorCode,r.ErrorString),!1};i._OnReady=function(t){var i=this,o,r,f,h,s,e;if(n.detect.starting=!1,n.detect.bOK=!0,i.bReady=!0,i.__wsRetry=0,i._bLocalService){if(f=i._objWS,i._customIP?r={host:i._host,ssl:i._ssl,port:i._port}:(r=n.detect.urls[n.detect.cUrlIndex],r.host=n.product.host),o=n.getHttpUrl(r),f===null)return;if(f.onopen=null,i.httpUrl=o,f.onmessage=function(t){var e=t.data,f,o,r,h,l,s,c,a;if(typeof e=="object"){e=null;t=null;return}if(i.__OnWSMessage&&i.__OnWSMessage(e),r=e.replace(/\0/g,""),r.indexOf("Exception:")>=0||r.indexOf("Error")==0){h=e;f=i.curCommand.pop()||{};o=!1;n.log(h+"@"+f.cmd);f.fFun&&(o=f.fFun(h));!o&&n.isFunction(i.__OnPrintMsg)&&i.__OnPrintMsg(h);return}try{r=n.parse(r)}catch(v){n.log(e)}if(r.event){u.handleEvent(i,r);return}if(r.cmdId){for(l=i.curCommand.length,c=-1,s=l-1;s>=0;s--)if(i.curCommand[s].cmdId==r.cmdId){c=s;f=i.curCommand.splice(c,1)[0];break}if(c<0)return}else f=i.curCommand.pop()||{};if(r.exception!==undefined&&r.description!==undefined?(i._errorCode=r.exception,i._errorString=r.description):r.method!="StartScan"&&r.method!="GetAddOnVersion"&&(i._errorCode=0,i._errorString=""),r.method=="ReadBarcode"||r.method=="OCRRecognize"||r.request&&r.request.method=="OCRProRecognize"){f.sFun&&f.sFun(r);return}if(r.method=="ActiveUI"||r.method=="VersionInfo"||r.method=="ConvertToBase64"||r.method=="SaveSelectedImagesToBase64Binary"||r.method=="ConvertToBlob"){if(f.sFun&&r.result.length>0){f.sFun(r.result);return}}else if(r.method=="ShowFileDialog"||r.method=="SplitTiff"||r.method=="SplitPDF"||r.method=="EncodeAsBase64"){if(f.sFun){f.sFun(r.result);return}}else if(r.method=="SetCapabilities"){if("exception"in r&&r.exception!="0"){r.result.errorCode&&r.result.errorString?(i._errorCode=r.result.errorCode,i._errorString=r.result.errorString):(i._errorCode=r.exception,i._errorString=r.description);f.fFun&&f.fFun(r.result);r=null;return}f.sFun&&f.sFun(r.result);r=null;return}if(r.result&&r.result.length&&r.result[0]=="1")f.sFun&&f.sFun();else if(r.exception)o=!1,f.fFun&&(o=f.fFun(i._errorString)),!o&&r.exception&&r.exception<0&&r.exception!=-2115&&n.isFunction(i.__OnPrintMsg)&&i.__OnPrintMsg(i._errorString);else{if(r.method=="LoadImage"||r.method=="LoadImageEx"||r.method=="LoadImageFromBytes"||r.method=="LoadImageFromBase64Binary"||r.method=="LoadDibFromClipboard"||r.method=="FTPDownload"||r.method=="FTPDownloadEx"){f.sFun&&f.sFun(r.result);r=null;return}a=["result:"];f.fFun&&f.fFun(u.__pushElement(a,r.result))}r=null},f.onclose=function(){i.bReady=!1;i.__wsRetry=0;n.Errors.Server_Invalid(i);i.__bForceClose||n.page.bUnload||n.detect.starting||(n.detect.aryReconnectSTwains.push(i),setTimeout(n._reconnect,1e3),n.detect.starting=!0);i.__OnWSClose&&i.__OnWSClose();u.hideMask(!0);n.detect.bOK=!1;i.__bForceClose=!1},f.onerror=function(t){i.bReady=!1;i.__wsRetry=0;n.Errors.Server_Invalid(i);n.detect.bOK=!1;n.page.bUnload||n.detect.starting||(n.detect.aryReconnectSTwains.push(i),setTimeout(n._reconnect,1e3),n.detect.starting=!0);t&&n.log("websocket error: "+t);i.__OnWSError&&i.__OnWSError();u.hideMask(!0)},t){i._ImgManager&&i._ImgManager.clear();i.clientId=u.getRandom();i._ImgManager.OnReady();i._innerActiveUI(function(t){var e=i.__serverId,u,r,f;t&&t.length>=3?(u=t[1],r=t[2],i.__strProductName=r):t&&t.length>=2?u=t[1]:n.log("ActiveUI return parameters error.");r&&(r=r.toLowerCase());i.__serverId=u;n.closeProgress("Reconnect");i.SetProductKeyAsync(Dynamsoft.WebTwainEnv.ProductKey);e!=u?(n.Errors.Server_Restarted(i),n.isFunction(i.__OnWSReconnect)&&(f=n.getWSUrl(i._host,i._port,i._ssl),i.__OnWSReconnect(f,o))):i._resetErr()});return}(i._host==="127.0.0.1"||i._host==="localhost")&&(n.LS.item("DWT_port",r.port),n.LS.item("DWT_ssl",r.ssl?"true":"false"))}n.attachProperty(i);n.html5.ui.init(i,i.config);n.html5.ui.addMethods(i);n.attachPropertyUI(i);i._ImgManager.OnReady();i._bNoUI||i.SetViewMode(1,1);i._bLocalService?i._innerActiveUI(function(t){var e,r,u=!1,s,o,f;t&&t.length>=3?(e=t[1],r=t[2],i.__strProductName=r):t&&t.length>=2?(e=t[1],u=!0):(u=!0,n.log("ActiveUI return parameters error."));n.attachAddon(i);r&&(r=r.toLowerCase());i.__serverId=e;i.__bMustUpgradeService=u;u?n.isFunction(i.__OnReady)&&i.__OnReady(i):(s=!0,n.showLoadingMsg(-1,"",Dynamsoft.MSG.Init_SetLicenseForDWT),f=Dynamsoft.WebTwainEnv.ProductKey,o=f==""||f=="******"?n.Promise.resolve(0):i.SetProductKeyAsync(f),o=o.then(function(){if(n.closeLoadingMsg(),n.isFunction(i.__OnReady)&&i.__OnReady(i),n.License.checkProductKey(i,{Core:!0})||n.License.checkProductKey(i,{Webcam:!0},!0))return i._setConvertModeAsync(i._pdfConvertMode)["catch"](function(){});n.License.checkProductKey(i,{Core:!0},!1,!0)},function(){n.closeLoadingMsg();n.License.checkProductKey(i,{Core:!0})||n.License.checkProductKey(i,{Webcam:!0},!0)||n.License.checkProductKey(i,{Core:!0},!1,!0)}))}):(h=!0,n.attachAddon(i),i.__serverId=1,i.__bMustUpgradeService=!1,n.showLoadingMsg(-1,"",Dynamsoft.MSG.Init_SetLicenseForDWT),e=Dynamsoft.WebTwainEnv.ProductKey,s=e==""||e=="******"?n.Promise.resolve(0):i.SetProductKeyAsync(e),s.then(function(){if(n.closeLoadingMsg(),i.ErrorCode<0){n.License.promptLicenseErr(i);return}n.isFunction(i.__OnReady)&&i.__OnReady(i);n.License.checkProductKey(i,{Core:!0})||n.License.checkProductKey(i,{Webcam:!0},!0)?n.License.checkProductKey(i,{Core:!0,Wasm:!0},!0,!0)&&(Dynamsoft.WasmEnv&&Dynamsoft.WasmEnv.setLoglevel(i._logLevel),i._setConvertMode(i._pdfConvertMode)):n.License.checkProductKey(i,{Core:!0},!1,!0)},function(){n.closeLoadingMsg();n.License.checkProductKey(i,{Core:!0})||n.License.checkProductKey(i,{Webcam:!0},!0)||n.License.checkProductKey(i,{Core:!0},!1,!0)}))};i.__unload=function(){var t=this,i;t._ImgManager&&t._ImgManager.clear();t.bReady&&(i=t._objWS,i&&(t.__bForceClose=!0,i.close(),t.curCommand.splice(0),delete t._objWS),t.bReady=!1);t.__addon&&t.__addon.Camera&&t.__addon.Camera.getStatus()!=""&&t.__addon.Camera.closeSource()["catch"](function(){});t._bNoUI||n.html5.ui.unLoad(t)}}});Dynamsoft.Ready(function(n){var ht=Dynamsoft;if(n.product.bHTML5Edition){var f=Dynamsoft.WebTwainEnv,ct=Dynamsoft.navInfo,lt=n.each,v=n.html5.STwain,e=v.prototype,u={Auto:0,G3:1,G4:2,LZW:3,ZIP:4,JPEG:5};n.MobileFuns={makeParams:function(){return arguments},_innerSaveLocal:function(n,t){var u=window,r=Dynamsoft.navInfo,o=u.requestFileSystem||u.webkitRequestFileSystem||u.mozRequestFileSystem,e,i,f;return(r.biPad||r.biPhone)&&!o&&(r.bSafari&&parseFloat(r.strBrowserVersion)<13||!r.bSafari)?(e=window.open(n,"","",!1),setTimeout(function(){e.document.title=t},100),!0):(i=document.createElementNS("http://www.w3.org/1999/xhtml","a"),i.href=n,i.download=t,i.target="_blank",document.body.appendChild(i),r.bEdge?i.click():(f=document.createEvent("MouseEvents"),f.initMouseEvent("click",!0,!1),i.dispatchEvent(f)),document.body.removeChild(i),!0)},saveLocal:function(t,i,r){n.isString(t)&&t.indexOf("blob:http://")>-1?n.MobileFuns._innerSaveLocal(t,i,r):t instanceof Blob?n.MobileFuns._innerSaveLocal(URL.createObjectURL(t),i,r):t instanceof ArrayBuffer?n.MobileFuns._innerSaveLocal(URL.createObjectURL(new Blob([t])),i,r):n.MobileFuns._innerSaveLocal(t,i,r)},dataURLtoBlob:function(n){var u=n.split(","),f=u[0].match(/:(.*?);/)[1],i,t,r;try{i=atob(u[1])}catch(e){return i="",!1}for(t=i.length,r=new Uint8Array(t);t--;)r[t]=i.charCodeAt(t);return new Blob([r],{type:f})},appendTiffPage:function(t,i,r){var f=t,u=i,s=r.context.bShowPercentProgress,e=f._aryTiffTag.length,o;if(e>0)for(r.context.tagIndex=0,e>32&&(e=32),o=0;o<e;o++)u=u.then(function(){var t=r.context.tagIndex,n=f._aryTiffTag[t];return r.addTag(n.tag,n.content,n.isBinary)}),u=u.then(function(){var n=r.context.tagIndex;r.context.tagIndex=n+1});return u=u.then(function(){var n=r.context.aryIndex,t=r.context.cIndex;return r.context.revokeUrl=!1,f._ImgManager.getWebViewer().GetImageData(f._ImgManager.getUidByIndex(n[t]))}),f._scaleDownThreshold<=0||(u=u.then(function(n){var t=n&&n.metaData?n.metaData:{};return Dynamsoft.ImageProcWrapper.resize(n.originalData,t.imageWidth,t.imageHeight,f._scaleDownThreshold)}),u=u.then(function(n){return r.context.revokeUrl=n.imageData,{originalData:n.imageData}})),u=u.then(function(n){var t=Dynamsoft.EnumDWT_ImageType.IT_ALL,i=r.context.tiffFormat;return r.appendImage(n.originalData,t,i,f._jpgQuality)}),u=u.then(function(t){return r.context.revokeUrl&&n.MobileFuns.revoke(r.context.revokeUrl),r.context.revokeUrl=!1,t}),s&&(u=u.then(function(){var i=r.context.aryIndex,n=i.length,u=r.context.cIndex,t=u+1,e=100*t/(1*n);f._OnPercentDone([0,e,t+"/"+n,""])})),u.then(function(){var n=r.context.cIndex;return r.context.cIndex=n+1,n+1})},isPDF:function(n){var t=n;return(n instanceof ArrayBuffer&&(t=new Uint8Array(n.slice(0,4))),t instanceof Uint8Array&&t[0]==37&&t[1]==80&&t[2]==68&&t[3]==70)?!0:!1},isTIFF:function(n){var t=n;return(n instanceof ArrayBuffer&&(t=new Uint8Array(n.slice(0,4))),t instanceof Uint8Array&&(t[0]==73&&t[1]==73&&t[2]==42&&t[3]==0||t[0]==77&&t[1]==77&&t[2]==0&&t[3]==42))?!0:!1},unloadWasm:function(){return(o&&(o.terminate(),o=null),n.detect.wasmScriptLoaded&&Dynamsoft.WasmEnv)?Dynamsoft.WasmEnv.unload():n.Promise.resolve()},loadCallback:function(t){var b,v;if(t&&t.customData){var e=t.customData,f=t.fPdfReader,i=t.imgCore,l=e.src,h=e.imgType,a=e.index,y=e.password,p=e.resolution,w=e.convertMode,u=!1,o,c=Dynamsoft.EnumDWT_ImageType;if(h==c.IT_PDF)return f||(f=s(),u=!0),o=function(){f.close();u&&f.terminate()},f.open(l,y).then(function(){return f.readPage(a,p,w,Dynamsoft.EnumDWT_ImageType.IT_JPG,!1,!1)},o).then(function(n){return f.close(),u&&f.terminate(),n.imageData},o);if(h==c.IT_TIF)return i||(i=r(),u=!0),b=0,o=function(){u&&i.terminate()},i.openTiff(l).then(function(){return i.readTiff(a,Dynamsoft.EnumDWT_ImageType.IT_JPG,!1)}).then(function(n){return u&&i.terminate(),n.imageData},o);if(h==c.IT_PNG||h==c.IT_JPG||h==c.IT_BMP)return i||(i=r()),u=!0,v=e.quality,o=function(){u&&i.terminate()},i.readImage(l,Dynamsoft.EnumDWT_ImageType.IT_JPG,v,!1).then(function(n){return u&&i.terminate(),n.imageData},o)}return n.Promise.resolve()},convertOutputType:function(n){return n},isBlobUrl:function(t){return n.isString(t)&&t.indexOf("blob:http://")>-1},revoke:function(t){return n.MobileFuns.isBlobUrl(t)?(window.URL||window.webkitURL).revokeObjectURL(t):!0}};e._innerSendToMobile=function(t,i,r,u,f){var e=this;return t=="GetLicenseInfo"?(n.showMask(),a(e,i).then(function(t){n.hideMask();n.isFunction(u)&&u(t)},function(t){n.hideMask();n.Errors.GetLicenseInfoFailed(e,t);f&&f(e._errorCode,e._errorString)})):n.License.checkProductKey(e,{Core:!0,Wasm:!0},!0)?(t=="SaveImage"?l(e,i).then(function(t){var i=t.blobUrl;u&&u(i,t.type);setTimeout(function(){n.MobileFuns.revoke(i)},1e3)},function(){n.isFunction(f)&&f(e._errorCode,e._errorString)}):e._innerSendToMobileV2(t,i).then(u,function(){n.isFunction(f)&&f(e._errorCode,e._errorString)}),!0):(f&&f(e._errorCode,e._errorString),!1)};e._innerSendToMobileV2=function(t,i){var r=this;return t=="GetLicenseInfo"?a(r,i):n.License.checkProductKey(r,{Core:!0,Wasm:!0},!0)?t=="LoadImageFromBinary"?w(r,i):t=="RotateEx"?b(r,i):t=="Flip"?d(r,i):t=="Mirror"?k(r,i):t=="Invert"?g(r,i):t=="SaveImage"?l(r,i):t=="Crop"?nt(r,i):t=="Erase"?tt(r,i):t=="ChangeImageSize"?it(r,i):t=="GetSkewAngle"?rt(r,i):t=="ConvertToGrayScale"?ut(r,i):t=="ConvertToBWScale"?ft(r,i):t=="SetDPI"?et(r,i):t=="SetImageWidth"?ot(r,i):t=="IsTextBasedPDF"?p(r,i):t=="GetMD5"?st(r,i):n.Promise.reject({code:-1e3,message:"invalid method: "+t}):n.Promise.reject({code:r._errorCode,message:r._errorString})};var t=0,o=null,r=function(){return new Dynamsoft.Imagecore(f.ProductKey,1)},i=function(){return new Dynamsoft.ImageProc(f.ProductKey,1)},s=function(){return new Dynamsoft.PdfReader(f.ProductKey,1)},y=function(){return new Dynamsoft.PdfWriter(f.ProductKey,1)},h=function(){return o||(o=new Dynamsoft.ImageProc(f.ProductKey,1)),o},p=function(t,i){var r=i[0],u,o,e=Dynamsoft.EnumDWT_ImageType,f;return r instanceof FileList?u=r[0]:r instanceof Blob?u=r:(r instanceof ArrayBuffer||r instanceof Uint8Array)&&(u=new Blob([r]),o=n.MobileFuns.isPDF(r)?e.IT_PDF:n.MobileFuns.isTIFF(r)?e.IT_TIF:e.IT_PNG),u.type&&u.type=="application/pdf"&&(o=e.IT_PDF),o==e.IT_PDF?(f=s(),n.showMask(),f.open(u,t._pdfPassword).then(function(t){return n.hideMask(),f.close(),setTimeout(function(){f.terminate()},30),t.isTextBased},function(i){n.hideMask();n.Errors.LoadImageFailed(t,i);f.close();setTimeout(function(){f.terminate()},30);throw{code:t._errorCode,message:t._errorString};})):(n.Errors.LoadImageFailed(t,"not pdf."),n.Promise.reject({code:t._errorCode,message:t._errorString}))},w=function(i,u){var l=u[0],e,a,v,o,c=!1,y=0,h=Dynamsoft.EnumDWT_ImageType,p,f,b,w;return(l instanceof FileList?e=l[0]:l instanceof Blob?e=l:l instanceof ArrayBuffer||l instanceof Uint8Array?(e=new Blob([l]),o=n.MobileFuns.isPDF(l)?h.IT_PDF:n.MobileFuns.isTIFF(l)?h.IT_TIF:h.IT_PNG):e=l,n.isUndefined(e))?(n.Errors.InvalidSourceFile(i),n.Promise.reject({code:i._errorCode,message:i._errorString})):(e.type&&(e.type=="application/pdf"?o=h.IT_PDF:e.type=="image/png"?o=h.IT_PNG:e.type=="image/jpeg"?o=h.IT_JPG:e.type=="image/bmp"?o=h.IT_BMP:e.type=="image/tiff"&&(o=h.IT_TIF)),a="",v=e.name,o==h.IT_JPG||o==h.IT_PNG||o==h.IT_BMP?(p=i._jpgQuality,c=r(),n.showMask(),c.readImage(e,h.IT_JPG,p,!1).then(function(r){var f={src:r.imageData,imgType:r.imageType,dataType:"url"},u;r&&(u={},u.imageWidth=r.imageWidth,u.imageHeight=r.imageHeight,u.imageBitDepth=r.imageBitDepth,u.imageXResolution=r.imageXResolution,u.imageYResolution=r.imageYResolution,f.metaData=u);t++;i._OnBitmapChanged(["10",""+t,1,i._ImgManager.getCurrentImageIndex(),i._ImgManager.count(),f]);n.hideMask();n.isFunction(i.__OnPostLoad)&&i.__OnPostLoad(a,v,o);setTimeout(function(){c.terminate()},30)},function(t){n.Errors.LoadImageFailed(i,t);n.hideMask();setTimeout(function(){c.terminate()},30);throw{code:i._errorCode,message:i._errorString};})):o==h.IT_PDF?(f=s(),f.context={},n.showProgress(i),i._OnPercentDone([0,-1,Dynamsoft.MSG.LoadingPdf,""]),f.open(e,i._pdfPassword).then(function(r){var e=r.PdfCount,u;for(i._OnPercentDone([0,0,"0/"+e,""]),u=n.Promise.resolve(0),f.context.cIndex=0,f.context.pdfCount=e,y=0;y<e;y++)u=u.then(function(){var n=f.context.cIndex;return f.readPage(n,i._pdfResolution,i._pdfRealConvertMode,Dynamsoft.EnumDWT_ImageType.IT_JPG,!1,!1)}),u=u.then(function(r){var o=f.context.cIndex,s=f.context.pdfCount,h=o+1,l=100*h/(1*s),u={},e,c;i._OnPercentDone([0,l,h+"/"+s,""]);n.isArray(r.imageInfos)&&r.imageInfos.length>0&&(e=r.imageInfos[0],u.imageWidth=e.imageWidth,u.imageHeight=e.imageHeight,u.imageBitDepth=e.imageBitDepth,u.imageXResolution=e.imageXResolution,u.imageYResolution=e.imageYResolution);t++;c={src:r.imageData,dataType:"url",imgType:Dynamsoft.EnumDWT_ImageType.IT_PDF,index:r.pageIndex,metaData:u,imageId:t};i._OnBitmapChanged(["10",""+t,1,i._ImgManager.getCurrentImageIndex(),i._ImgManager.count(),c]);f.context.cIndex=o+1});return u.then(function(){n.closeProgress();f.close();setTimeout(function(){f.terminate()},30);n.isFunction(i.__OnPostLoad)&&i.__OnPostLoad(a,v,o)},function(t){n.closeProgress();f.close();setTimeout(function(){f.terminate()},30);n.Errors.LoadImageFailed(i,t);throw{code:i._errorCode,message:i._errorString};})},function(t){n.closeProgress();f.close();setTimeout(function(){f.terminate()},30);n.Errors.LoadImageFailed(i,t);throw{code:i._errorCode,message:i._errorString};})):o==h.IT_TIF?(b=0,c=r(),n.showProgress(i),i._OnPercentDone([0,-1,Dynamsoft.MSG.LoadingTiff,""]),w=c.openTiff(e),w.then(function(r){var u=r.pageCount,s=r.imageInfos,f=n.Promise.resolve(0),e;for(i._OnPercentDone([0,0,"0/"+u,""]),e=0;e<u;e++)f=f.then(function(n){return c.readTiff(n,Dynamsoft.EnumDWT_ImageType.IT_JPG,!1).then(function(r){var f=n+1,o=100*f/(1*u),e;return i._OnPercentDone([0,o,f+"/"+u,""]),t++,e={src:r.imageData,dataType:"url",imgType:Dynamsoft.EnumDWT_ImageType.IT_TIF,index:n,metaData:s[n],imageId:t},i._OnBitmapChanged(["10",""+t,1,i._ImgManager.getCurrentImageIndex(),i._ImgManager.count(),e]),n+1})});return f.then(function(){n.closeProgress();c.closeTiff();setTimeout(function(){c.terminate()},30);n.isFunction(i.__OnPostLoad)&&i.__OnPostLoad(a,v,o)},function(t){n.closeProgress();c.closeTiff();setTimeout(function(){c.terminate()},30);n.Errors.LoadImageFailed(i,t);throw{code:i._errorCode,message:i._errorString};})},function(t){n.closeProgress();c.closeTiff();setTimeout(function(){c.terminate()},30);n.Errors.LoadImageFailed(i,t);throw{code:i._errorCode,message:i._errorString};})):(n.Errors.LoadImageFailed(i,"invalid image type."),n.Promise.reject({code:i._errorCode,message:i._errorString})))},at=function(i,u){var a=u[0],f,v,y,o,e=!1,l=0,h=Dynamsoft.EnumDWT_ImageType,p,c,b,w;return(a instanceof FileList?f=a[0]:a instanceof Blob?f=a:a instanceof ArrayBuffer||a instanceof Uint8Array?(f=new Blob([a]),o=n.MobileFuns.isPDF(a)?h.IT_PDF:n.MobileFuns.isTIFF(a)?h.IT_TIF:h.IT_PNG):f=a,n.isUndefined(f))?(n.Errors.InvalidSourceFile(i),n.Promise.reject({code:i._errorCode,message:i._errorString})):(f.type&&(f.type=="application/pdf"?o=h.IT_PDF:f.type=="image/png"?o=h.IT_PNG:f.type=="image/jpeg"?o=h.IT_JPG:f.type=="image/bmp"?o=h.IT_BMP:f.type=="image/tiff"&&(o=h.IT_TIF)),v="",y=f.name,i._registLoadCallback(n.MobileFuns.loadCallback),o==h.IT_JPG||o==h.IT_PNG||o==h.IT_BMP?(p=i._jpgQuality,e=r(),n.showMask(),e.readImageInfo(f).then(function(r){var u={src:f,srcId:Date.now(),dataType:"bin",imgType:o,quality:p,metaData:r};t++;i._OnBitmapChanged(["10",""+t,1,i._ImgManager.getCurrentImageIndex(),i._ImgManager.count(),u]);n.hideMask();n.isFunction(i.__OnPostLoad)&&i.__OnPostLoad(v,y,o);setTimeout(function(){e.terminate()},30)},function(t){n.Errors.LoadImageFailed(i,t);n.hideMask();setTimeout(function(){e.terminate()},30);throw{code:i._errorCode,message:i._errorString};})):o==h.IT_PDF?(c=s(),c.context={},n.showProgress(i),i._OnPercentDone([0,-1,Dynamsoft.MSG.LoadingPdf,""]),c.open(f,i._pdfPassword).then(function(r){var e=r.PdfCount,s,u;for(i._OnPercentDone([0,0,"0/"+e,""]),s={index:0,aryUpdateImageData:[],pdfCount:e},u=n.Promise.resolve(s),l=0;l<e;l++)u=u.then(function(r){return c.readPage(r.index,i._pdfResolution,i._pdfRealConvertMode,Dynamsoft.EnumDWT_ImageType.IT_JPG,!0,!1).then(function(u){var s=r.index+1,h=r.PdfCount,c=100*s/(1*h),e={},o;return i._OnPercentDone([0,c,s+"/"+h,""]),n.isArray(u.imageInfos)&&u.imageInfos.length>0&&(o=u.imageInfos[0],e.imageWidth=o.imageWidth,e.imageHeight=o.imageHeight,e.imageBitDepth=o.imageBitDepth,e.imageXResolution=o.imageXResolution,e.imageYResolution=o.imageYResolution),t++,r.index=r.index+1,r.aryUpdateImageData.push({src:f,srcId:Date.now(),dataType:"bin",imgType:Dynamsoft.EnumDWT_ImageType.IT_PDF,index:u.pageIndex,password:i._pdfPassword,quality:p,metaData:e,resolution:i._pdfResolution,convertMode:i._pdfRealConvertMode,outPutType:u.imageType,imageId:t}),r})});for(u=u.then(function(n){return c.close(),c.context.closed=!0,setTimeout(function(){c.terminate()},30),n.index=0,n}),l=0;l<e;l++)u=u.then(function(n){var t=n.aryUpdateImageData[n.index];return i._OnBitmapChanged(["10",""+t.imageId,1,i._ImgManager.getCurrentImageIndex(),i._ImgManager.count(),t]),n.index=n.index+1,n});return u.then(function(){n.isFunction(i.__OnPostLoad)&&i.__OnPostLoad(v,y,o);n.closeProgress()},function(t){n.Errors.LoadImageFailed(i,t);n.closeProgress();c.context.closed||(c.close(),setTimeout(function(){c.terminate()},30));throw{code:i._errorCode,message:i._errorString};})},function(t){n.Errors.LoadImageFailed(i,t);n.closeProgress();c.context.closed||(c.close(),setTimeout(function(){c.terminate()},30));throw{code:i._errorCode,message:i._errorString};})):o==h.IT_TIF?(b=0,e=r(),e.context={},n.showProgress(i),i._OnPercentDone([0,-1,Dynamsoft.MSG.LoadingTiff,""]),w=e.openTiff(f),w.then(function(r){var s=r.pageCount,h=r.imageInfos,u=n.Promise.resolve({index:0,aryUpdateImageData:[]});for(i._OnPercentDone([0,0,"0/"+s,""]),l=0;l<s;l++)u=u.then(function(n){var r=n.index+1,u=100*r/(1*s);return i._OnPercentDone([0,u,r+"/"+s,""]),t++,n.aryUpdateImageData.push({src:f,srcId:Date.now(),dataType:"bin",imgType:Dynamsoft.EnumDWT_ImageType.IT_TIF,index:n.index,metaData:h[n.index],imageId:t}),n.index=n.index+1,n});for(u=u.then(function(n){return e.closeTiff(),e.context.closed=!0,setTimeout(function(){e.terminate()},30),n.index=0,n}),l=0;l<s;l++)u=u.then(function(n){var t=n.aryUpdateImageData[n.index];return i._OnBitmapChanged(["10",""+t.imageId,1,i._ImgManager.getCurrentImageIndex(),i._ImgManager.count(),t]),n.index=n.index+1,n});return u.then(function(){n.isFunction(i.__OnPostLoad)&&i.__OnPostLoad(v,y,o);n.closeProgress()},function(t){n.Errors.LoadImageFailed(i,t);n.closeProgress();e.context.closed||(e.closeTiff(),e.context.closed=!0,setTimeout(function(){e.terminate()},30));throw{code:i._errorCode,message:i._errorString};})},function(t){n.Errors.LoadImageFailed(i,t);n.closeProgress();e.context.closed||(e.closeTiff(),e.context.closed=!0,setTimeout(function(){e.terminate()},30));throw{code:i._errorCode,message:i._errorString};})):(n.Errors.LoadImageFailed(i,"invalid image type."),n.Promise.reject({code:i._errorCode,message:i._errorString})))},b=function(t,r){var h=r[0],f=r[1],o=r[2],e=r[3],s=r[4],u,c;for(n.isUndefined(f)&&(f=0),n.isUndefined(o)&&(o=!0),(n.isUndefined(e)||e<1||e>3)&&(e=3),n.isUndefined(s)&&(s="FFFFFF");f<0;)f+=360;return n.showMask(),u=i(),c=t._ImgManager.convertClientIndexToServerId(h),u.context={},t._ImgManager.getWebViewer().GetImageData(t._ImgManager.getUidByIndex(h)).then(function(n){return u.context.metaData=n&&n.metaData?n.metaData:{},u.initImage(n.originalData)}).then(function(){return u.rotate(f,s,o,e)}).then(function(){return u.getImage()}).then(function(i){"width"in i&&(i.imageWidth=i.width);"height"in i&&(i.imageHeight=i.height);var r={src:i.imageData,imgType:n.MobileFuns.convertOutputType(i.imageType),dataType:"url",metaData:{imageWidth:i.imageWidth,imageHeight:i.imageHeight}};t._OnBitmapChanged(["10",""+c,4,t._ImgManager.getCurrentImageIndex(),t._ImgManager.count(),r]);n.hideMask();setTimeout(function(){u.terminate()},30)},function(i){n.Errors.RotateFailed(t,i);n.hideMask();setTimeout(function(){u.terminate()},30);throw{code:t._errorCode,message:t._errorString};})},c=function(t,r,u){var f=i(),e=t._ImgManager.convertClientIndexToServerId(r);return f.context={},n.showMask(),t._ImgManager.getWebViewer().GetImageData(t._ImgManager.getUidByIndex(r)).then(function(n){return f.context.metaData=n&&n.metaData?n.metaData:{},f.initImage(n.originalData)}).then(function(){return f.flip(u)}).then(function(){return f.getImage()}).then(function(i){var r={src:i.imageData,imgType:n.MobileFuns.convertOutputType(i.imageType),dataType:"url"};t._OnBitmapChanged(["10",""+e,4,t._ImgManager.getCurrentImageIndex(),t._ImgManager.count(),r])}).then(function(){n.hideMask();setTimeout(function(){f.terminate()},30)},function(i){n.hideMask();u==-1?n.Errors.MirrorFailed(t,i):n.Errors.FlipFailed(t,i);setTimeout(function(){f.terminate()},30);throw{code:t._errorCode,message:t._errorString};})},k=function(n,t){var i=t[0];return c(n,i,-1)},d=function(n,t){var i=t[0];return c(n,i,1)},g=function(t,r){var f=r[0],u=i(),e=t._ImgManager.convertClientIndexToServerId(f);return u.context={},n.showMask(),t._ImgManager.getWebViewer().GetImageData(t._ImgManager.getUidByIndex(f)).then(function(n){return u.context.metaData=n&&n.metaData?n.metaData:{},u.initImage(n.originalData)}).then(function(){return u.invert()}).then(function(){return u.getImage()}).then(function(i){var r={src:i.imageData,imgType:n.MobileFuns.convertOutputType(i.imageType),dataType:"url"};t._OnBitmapChanged(["10",""+e,4,t._ImgManager.getCurrentImageIndex(),t._ImgManager.count(),r])}).then(function(){n.hideMask();setTimeout(function(){u.terminate()},30)},function(i){n.hideMask();n.Errors.InvertFailed(t,i);setTimeout(function(){u.terminate()},30);throw{code:t._errorCode,message:t._errorString};})},nt=function(t,r){var f=r[0],e=r[1],o=r[2],s=r[3],h=r[4],u,c;return!n.isNumber(e)||!n.isNumber(o)||!n.isNumber(s)||!n.isNumber(h)?(n.Errors.MobileServer_InvalidLeftOrTopOrRightOrBottom(t),n.Promise.reject({code:t._errorCode,message:t._errorString})):(u=i(),c=t._ImgManager.convertClientIndexToServerId(f),u.context={},n.showMask(),t._ImgManager.getWebViewer().GetImageData(t._ImgManager.getUidByIndex(f)).then(function(n){return u.context.metaData=n&&n.metaData?n.metaData:{},u.initImage(n.originalData)}).then(function(){return u.crop(e,o,s,h)}).then(function(){return u.getImage()}).then(function(i){var r={src:i.imageData,imgType:n.MobileFuns.convertOutputType(i.imageType),dataType:"url",metaData:{imageData:i.imageData,imageWidth:i.imageWidth,imageHeight:i.imageHeight}};t._OnBitmapChanged(["10",""+c,4,t._ImgManager.getCurrentImageIndex(),t._ImgManager.count(),r])}).then(function(){n.hideMask();setTimeout(function(){u.terminate()},30)},function(i){n.hideMask();n.Errors.CropFailed(t,i);setTimeout(function(){u.terminate()},30);throw{code:t._errorCode,message:t._errorString};}))},tt=function(t,r){var e=r[0],o=r[1],s=r[2],h=r[3],c=r[4],f=r[5],u,l;return!n.isNumber(o)||!n.isNumber(s)||!n.isNumber(h)||!n.isNumber(c)?(n.Errors.MobileServer_InvalidLeftOrTopOrRightOrBottom(t),n.Promise.reject({code:t._errorCode,message:t._errorString})):(n.isUndefined(f)&&(f="FFFFFF"),u=i(),l=t._ImgManager.convertClientIndexToServerId(e),u.context={},n.showMask(),t._ImgManager.getWebViewer().GetImageData(t._ImgManager.getUidByIndex(e)).then(function(n){return u.context.metaData=n&&n.metaData?n.metaData:{},u.initImage(n.originalData)}).then(function(){return u.erase(o,s,h,c,f)}).then(function(){return u.getImage()}).then(function(i){var r={src:i.imageData,imgType:n.MobileFuns.convertOutputType(i.imageType),dataType:"url",metaData:{imageData:i.imageData,imageWidth:i.imageWidth,imageHeight:i.imageHeight}};t._OnBitmapChanged(["10",""+l,4,t._ImgManager.getCurrentImageIndex(),t._ImgManager.count(),r])}).then(function(){n.hideMask();setTimeout(function(){u.terminate()},30)},function(i){n.hideMask();n.Errors.EraseFailed(t,i);setTimeout(function(){u.terminate()},30);throw{code:t._errorCode,message:t._errorString};}))},it=function(t,r){var e=r[0],o=r[1],s=r[2],f=r[3],u,h;return n.isNumber(o)?n.isNumber(s)?(n.isUndefined(f)&&(f=5),u=i(),h=t._ImgManager.convertClientIndexToServerId(e),u.context={},n.showMask(),t._ImgManager.getWebViewer().GetImageData(t._ImgManager.getUidByIndex(e)).then(function(n){return u.context.metaData=n&&n.metaData?n.metaData:{},u.initImage(n.originalData)}).then(function(){return u.resize(o,s,f)}).then(function(){return u.getImage()}).then(function(i){var r={src:i.imageData,imgType:n.MobileFuns.convertOutputType(i.imageType),dataType:"url",metaData:{imageData:i.imageData,imageWidth:i.imageWidth,imageHeight:i.imageHeight}};t._OnBitmapChanged(["10",""+h,4,t._ImgManager.getCurrentImageIndex(),t._ImgManager.count(),r])}).then(function(){n.hideMask();setTimeout(function(){u.terminate()},30)},function(i){n.hideMask();n.Errors.ChangeImageSizeFailed(t,i);setTimeout(function(){u.terminate()},30);throw{code:t._errorCode,message:t._errorString};})):(n.Errors.MobileServer_InvalidHeight(t),n.Promise.reject({code:t._errorCode,message:t._errorString})):(n.Errors.MobileServer_InvalidWidth(t),n.Promise.reject({code:t._errorCode,message:t._errorString}))},rt=function(t,r){var f=r[0],u=i(),e=t._ImgManager.convertClientIndexToServerId(f);return u.context={},n.showMask(),t._ImgManager.getWebViewer().GetImageData(t._ImgManager.getUidByIndex(f)).then(function(n){return u.context.metaData=n&&n.metaData?n.metaData:{},u.initImage(n.originalData)}).then(function(){return u.getSkewAngle()}).then(function(n){return u.context.angle=n,u.getImage()}).then(function(i){var r={src:i.imageData,imgType:n.MobileFuns.convertOutputType(i.imageType),dataType:"url",metaData:{imageData:i.imageData,imageWidth:i.imageWidth,imageHeight:i.imageHeight}};t._OnBitmapChanged(["10",""+e,4,t._ImgManager.getCurrentImageIndex(),t._ImgManager.count(),r])}).then(function(){var t=u.context.angle;return n.hideMask(),delete u.context,setTimeout(function(){u.terminate()},30),t},function(i){n.hideMask();n.Errors.SkewAngleFailed(t,i);setTimeout(function(){u.terminate()},30);throw{code:t._errorCode,message:t._errorString};})},ut=function(t,r){var f=r[0],u=i(),e=t._ImgManager.convertClientIndexToServerId(f);return u.context={},n.showMask(),t._ImgManager.getWebViewer().GetImageData(t._ImgManager.getUidByIndex(f)).then(function(n){return u.context.metaData=n&&n.metaData?n.metaData:{},u.initImage(n.originalData)}).then(function(){return u.toGrayscale(0,25)}).then(function(){return u.getImage()}).then(function(i){var r={src:i.imageData,imgType:n.MobileFuns.convertOutputType(i.imageType),dataType:"url",metaData:{imageData:i.imageData,imageWidth:i.imageWidth,imageHeight:i.imageHeight,imageBitDepth:8}};t._OnBitmapChanged(["10",""+e,4,t._ImgManager.getCurrentImageIndex(),t._ImgManager.count(),r])}).then(function(){n.hideMask();setTimeout(function(){u.terminate()},30)},function(i){n.hideMask();n.Errors.ConvertToGrayScaleFailed(t,i);setTimeout(function(){u.terminate()},30);throw{code:t._errorCode,message:t._errorString};})},ft=function(t,r){var f=r[0],u=i(),e=t._ImgManager.convertClientIndexToServerId(f);return u.context={},n.showMask(),t._ImgManager.getWebViewer().GetImageData(t._ImgManager.getUidByIndex(f)).then(function(n){return u.context.metaData=n&&n.metaData?n.metaData:{},u.initImage(n.originalData)}).then(function(){return u.toBinary(28,25,10)}).then(function(){return u.getImage()}).then(function(i){var r={src:i.imageData,imgType:n.MobileFuns.convertOutputType(i.imageType),dataType:"url",metaData:{imageData:i.imageData,imageWidth:i.imageWidth,imageHeight:i.imageHeight,imageBitDepth:1}};t._OnBitmapChanged(["10",""+e,4,t._ImgManager.getCurrentImageIndex(),t._ImgManager.count(),r])}).then(function(){n.hideMask();setTimeout(function(){u.terminate()},30)},function(i){n.hideMask();n.Errors.ConvertToBWScaleFailed(t,i);setTimeout(function(){u.terminate()},30);throw{code:t._errorCode,message:t._errorString};})},et=function(t,r){var f=r[0],e=r[1],o=r[2],v=r[3],s=r[4],u,c,h,l,a;return n.isNumber(e)?n.isNumber(o)?(n.isUndefined(s)&&(s=Dynamsoft.EnumDWT_InterpolationMethod.IM_BICUBIC),u=i(),c=t._ImgManager.convertClientIndexToServerId(f),u.context={},h=t._ImgManager._UIView.GetMetaDataByIndex(f),l=h.imageXResolution,a=h.imageYResolution,n.showMask(),t._ImgManager.getWebViewer().GetImageData(t._ImgManager.getUidByIndex(f)).then(function(n){return u.context.metaData=n&&n.metaData?n.metaData:{},u.initImage(n.originalData)}).then(function(){return u.setDPI(l,a,e,o,v,s)}).then(function(){return u.getImage()}).then(function(i){var r={src:i.imageData,imgType:n.MobileFuns.convertOutputType(i.imageType),dataType:"url",metaData:{imageData:i.imageData,imageWidth:i.imageWidth,imageHeight:i.imageHeight,imageXResolution:e,imageYResolution:o}};t._OnBitmapChanged(["10",""+c,4,t._ImgManager.getCurrentImageIndex(),t._ImgManager.count(),r])}).then(function(){n.hideMask();setTimeout(function(){u.terminate()},30)},function(i){n.hideMask();n.Errors.SetDPIFailed(t,i);setTimeout(function(){u.terminate()},30);throw{code:t._errorCode,message:t._errorString};})):(n.Errors.MobileServer_InvalidYResolution(t),n.Promise.reject({code:t._errorCode,message:t._errorString})):(n.Errors.MobileServer_InvalidXResolution(t),n.Promise.reject({code:t._errorCode,message:t._errorString}))},ot=function(t,r){var f=r[0],e=r[1],u,o;return n.isNumber(e)?(u=i(),o=t._ImgManager.convertClientIndexToServerId(f),u.context={},n.showMask(),t._ImgManager.getWebViewer().GetImageData(t._ImgManager.getUidByIndex(f)).then(function(n){return u.context.metaData=n&&n.metaData?n.metaData:{},u.initImage(n.originalData)}).then(function(){return u.setImageWidth(e)}).then(function(){return u.getImage()}).then(function(i){var r={src:i.imageData,imgType:n.MobileFuns.convertOutputType(i.imageType),dataType:"url",metaData:{imageData:i.imageData,imageWidth:i.imageWidth,imageHeight:i.imageHeight}};t._OnBitmapChanged(["10",""+o,4,t._ImgManager.getCurrentImageIndex(),t._ImgManager.count(),r])}).then(function(){n.hideMask();setTimeout(function(){u.terminate()},30)},function(i){n.hideMask();n.Errors.SetImageWidthFailed(t,i);setTimeout(function(){u.terminate()},30);throw{code:t._errorCode,message:t._errorString};})):(n.Errors.MobileServer_InvalidWidth(t),n.Promise.reject({code:t._errorCode,message:t._errorString}))},l=function(t,f){var d=f[0],w=f[1],l=f[2],h=f[3],g=f[4],s=!1,e=!1,nt=Dynamsoft.EnumDWT_ImageType,a,o,b,ut,c,p,ft,k,v;if(n.isUndefined(d))return n.Errors.MobileServer_InvalidImage(t),n.Promise.reject({code:t._errorCode,message:t._errorString});if(!n.isArray(w))return n.Errors.MobileServer_InvalidIndex(t),n.Promise.reject({code:t._errorCode,message:t._errorString});if(n.isUndefined(l)&&(l="jpg"),n.isString(d)&&d!=""||(d="img."+l),l=="png"||l=="jpg"||l=="bmp"){var et=t._ImgManager.convertClientIndexToServerId(it),tt,it=w[0],rt=t._jpgQuality;return h==1&&n.showMask(),tt=l=="png"?nt.IT_PNG:l=="bmp"?nt.IT_BMP:nt.IT_JPG,a=t._ImgManager.getWebViewer().GetImageData(t._ImgManager.getUidByIndex(it)),e=r(),e.context={},e.context.bSaveAsBinary=g,t._scaleDownThreshold<=0?a=a.then(function(n){var t=e.context.bSaveAsBinary;return e.saveImage(n.originalData,tt,rt,!1,t)}):(a=a.then(function(n){var i=n&&n.metaData?n.metaData:{};return Dynamsoft.ImageProcWrapper.resize(n.originalData,i.imageWidth,i.imageHeight,t._scaleDownThreshold)}),a=a.then(function(n){var t=e.context.bSaveAsBinary;return e.context.revokeUrl=n.imageData,e.saveImage(n.imageData,tt,rt,!1,t)}),a=a.then(function(t){return n.MobileFuns.revoke(e.context.revokeUrl),e.context.revokeUrl=!1,t})),a.then(function(t){return h==1&&n.hideMask(),e&&setTimeout(function(){e.terminate()},30),s&&setTimeout(function(){s.terminate()},30),{blobUrl:t.imageData,type:l}},function(i){h==1&&n.hideMask();n.Errors.SaveImageFailed(t,i);e&&setTimeout(function(){e.terminate()},30);s&&setTimeout(function(){s.terminate()},30);throw{code:t._errorCode,message:t._errorString};})}if(l=="pdf"){for(o=y(),ut=w.length,o.context={},h&&(n.showProgress(t),h==2?t._OnPercentDone([0,-1,Dynamsoft.MSG.ConvertingToBlob,""]):h==3?t._OnPercentDone([0,-1,Dynamsoft.MSG.ConvertingToBase64,""]):h==4?t._OnPercentDone([0,-1,Dynamsoft.MSG.Encoding,""]):t._OnPercentDone([0,-1,Dynamsoft.MSG.SavingPdf,""])),c=o.initPdfSetting(t._pdfWriteSetting),t._scaleDownThreshold>0&&(s=i(),s.context={}),o.context.cIndex=0,o.context.aryIndex=w,o.context.bSaveAsBinary=g,b=0;b<ut;b++)c=c.then(function(){var n=o.context.cIndex,i=o.context.aryIndex;return t._ImgManager.getWebViewer().GetImageData(t._ImgManager.getUidByIndex(i[n]))}),t._scaleDownThreshold<=0?c=c.then(function(n){return o.appendPage(n.originalData)}):(c=c.then(function(n){var i=n&&n.metaData?n.metaData:{};return Dynamsoft.ImageProcWrapper.resize(n.originalData,i.imageWidth,i.imageHeight,t._scaleDownThreshold)}),c=c.then(function(n){return o.context.revokeUrl=n.imageData,o.appendPage(n.imageData)}),c=c.then(function(t){return o.context.revokeUrl&&n.MobileFuns.revoke(o.context.revokeUrl),o.context.revokeUrl=!1,t})),c=c.then(function(){var i=o.context.cIndex,f=o.context.aryIndex,r=f.length,n,u;h&&(n=i+1,u=100*n/(1*r),t._OnPercentDone([0,u,n+"/"+r,""]));o.context.cIndex=i+1});return c.then(function(){var n=o.context.bSaveAsBinary;return o.writePdf(n)}).then(function(t){return h&&n.closeProgress(),setTimeout(function(){o.terminate()},30),s&&setTimeout(function(){s.terminate()},30),{blobUrl:t.pdfData,type:"pdf"}},function(i){h&&n.closeProgress();n.Errors.SaveImageFailed(t,i);setTimeout(function(){o.terminate()},30);s&&setTimeout(function(){s.terminate()},30);throw{code:t._errorCode,message:t._errorString};})}if(l=="tiff"){for(ft=w.length,e=r(),e.context={},e.context.bSaveAsBinary=g,t._scaleDownThreshold>0&&(s=i(),s.context={}),h&&(e.context.bShowPercentProgress=!0,n.showProgress(t),h==2?t._OnPercentDone([0,-1,Dynamsoft.MSG.ConvertingToBlob,""]):h==3?t._OnPercentDone([0,-1,Dynamsoft.MSG.ConvertingToBase64,""]):h==4?t._OnPercentDone([0,-1,Dynamsoft.MSG.Encoding,""]):t._OnPercentDone([0,-1,Dynamsoft.MSG.SavingTiff,""])),k=e.createTiff(),v=Dynamsoft.EnumDWT_TIFFCompressionType,e.context.cIndex=0,p=u.Auto,t._tiffCompressionType==v.TIFF_AUTO?p=u.Auto:t._tiffCompressionType==v.TIFF_FAX3||t._tiffCompressionType==v.TIFF_T4?p=u.G3:t._tiffCompressionType==v.TIFF_FAX4||t._tiffCompressionType==v.TIFF_T6?p=u.G4:t._tiffCompressionType==v.TIFF_LZW?p=u.LZW:t._tiffCompressionType==v.TIFF_JPEG?p=u.JPEG:t._tiffCompressionType==v.TIFF_PACKBITS&&(p=u.ZIP),e.context.tiffFormat=p,e.context.aryIndex=w,b=0;b<ft;b++)k=n.MobileFuns.appendTiffPage(t,k,e,s);return k=k.then(function(){var n=e.context.bSaveAsBinary;return e.getTiff(n)}),k.then(function(t){var i=e.context.bShowPercentProgress;return i&&n.closeProgress(),e.closeTiff(),setTimeout(function(){e.terminate()},30),s&&setTimeout(function(){s.terminate()},30),{blobUrl:t.imageData,type:"tiff"}},function(i){var r=e.context.bShowPercentProgress;r&&n.closeProgress();n.Errors.SaveImageFailed(t,i);e.closeTiff();setTimeout(function(){e.terminate()},30);s&&setTimeout(function(){s.terminate()},30);throw{code:t._errorCode,message:t._errorString};})}return n.Errors.InvalidImageType(t),n.Promise.reject({code:t._errorCode,message:t._errorString})},a=function(t,i){var r;return r=i.length>0?i[0]:f.ProductKey,Dynamsoft.WasmEnv.getLicenseInfo(r).then(function(i){if(i&&i.Detail)return i;n.Errors.LicenseEmptyOrInvalid(t);throw{code:t._errorCode,message:t._errorString};},function(i){n.Errors.GetLicenseInfoFailed(t,i);throw{code:t._errorCode,message:t._errorString};})},st=function(t,i){var e=u,u=i[0],f;return u instanceof FileList?e=u[0]:(u instanceof ArrayBuffer||u instanceof Uint8Array)&&(e=new Blob([u])),f=r(),f.getMD5(e).then(function(n){return setTimeout(function(){f.terminate()},30),n},function(i){n.Errors.GetMD5Failed(t,i);setTimeout(function(){f.terminate()},30);throw{code:t._errorCode,message:t._errorString};})};e._areaDetectCallback=function(t,i,r){var u=h();return n.openLoadingMsg(),n.showLoadingMsg(-1,"",Dynamsoft.MSG.Wasm_Initializing),u.ready().then(function(){return n.closeLoadingMsg(),u.initImage(t,!0,i,r)}).then(function(){return u.detectDocument()}).then(function(n){return n.cornerPoints},function(t){n.closeLoadingMsg();var i={_errorString:t};n.Errors.DetectCallbackErr(i);throw{code:i._errorCode,message:i._errorString};})};e._saveImageCallback=function(t){var i=this,r=t,u;if(r instanceof Blob||r instanceof ArrayBuffer)u=n.Promise.resolve(r);else if(n.isString(t))u=n.fetch(t,{mode:"cors",dataType:"blob"});else return n.Errors.InvalidSourceFile(i),n.Promise.reject({code:i._errorCode,message:i._errorString});return u.then(function(t){return new n.Promise(function(n,r){i.LoadImageFromBinary(t,n,r)})})};e._perspectiveCallback=function(t,i,r,u){var f=h(),e;return!n.isArray(i)||i.length!=8?(e={},n.Errors.InvalidParameterInCallback(e),n.Promise.reject({code:e._errorCode,message:e._errorString})):(n.openLoadingMsg(),n.showLoadingMsg(-1,"",Dynamsoft.MSG.Wasm_Initializing),f.ready().then(function(){return n.closeLoadingMsg(),f.initImage(t,!0,r,u)}).then(function(){return f.perspective(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7])}).then(function(){return f.getImage(85,!0,!0)}).then(function(n){return n.imageData},function(t){n.closeLoadingMsg();var i={_errorString:t};n.Errors.PerspectiveCallback(i);throw{code:i._errorCode,message:i._errorString};}))};e._checkWebcamWasmLicense=function(){var t=this;return n.License.checkProductKey(t,{Webcam:!0},!0)?n.License.checkProductKey(t,{Webcam:!0,Wasm:!0},!0)?{errorCode:0}:{code:t._errorCode,message:t._errorString}:{code:t._errorCode,message:t._errorString}}}});Dynamsoft.Ready(function(n){var b=Dynamsoft;if(n.product.bHTML5Edition){var f=Dynamsoft.navInfo,i=n.html5.Funs,o=!0,r=!1,c=0,e=1,l=1,s=2,t=i.DEF,u=i.DEF_NOT_SUPPORT_MOBILE,h=i.RemoveNonPrintableChar,a=function(i,r,u){u==s&&n.each(r,function(n){t(i,n,{get:function(){return i._resetErr(),o},set:function(){return i._resetErr(),o}})})},v=function(i,r){n.each(r,function(n){t(i,n,e,s)})},y=function(i,r){n.each(r,function(n){t(i,n,e,l)})},p=function(i,r){n.each(r,function(n){t(i,n,c)})},w=function(i,r){n.each(r,function(n){t(i,n,e)})};n.DynamicLoadAddonFuns=[];n.attachAddon=function(t){n.each(n.DynamicLoadAddonFuns,function(i){n.isFunction(i)&&i(t)})};n.attachProperty=function(b){var k=b,d,g,nt,tt,it;t(k,"ErrorCode",{get:function(){return k._errorCode}});t(k,"ErrorString",{get:function(){return(k._errorCode==-2207&&k.__bMustUpgradeService&&n.Errors.MustUpgradeService(k),k._errorCode!=0)?k._errorString:"Successful."}});t(k,"ProductKey",{get:function(){return k._resetErr(),Dynamsoft.WebTwainEnv.ProductKey},set:function(t){return n.isString(t)?(k._resetErr(),k._setProductKey(t,!1)):(n.Errors.InvalidValue(k),r)}});t(k,"ProductName",{get:function(){return k._resetErr(),k.__strProductName},set:function(t){return n.isString(t)?(k._resetErr(),k.__strProductName=t,o):(n.Errors.InvalidValue(k),r)}});t(k,"VersionInfo",{get:function(){return k._resetErr(),k.__versionInfo}});k._isMobileMode()?u(k,"DefaultSourceName",c):t(k,"DefaultSourceName",{get:function(){return k._resetErr(),k.__defaultSourceName}});k._isMobileMode()?u(k,["ImageCaptureDriverType","IfShowCancelDialogWhenImageTransfer"]):(t(k,"IfShowCancelDialogWhenImageTransfer",{get:function(){return k._resetErr(),k.__IfShowCancelDialogWhenImageTransfer},set:function(t){return n.isBoolean(t)?(k._resetErr(),k.__IfShowCancelDialogWhenImageTransfer=t):(n.Errors.InvalidValue(k),r)}}),t(k,"ImageCaptureDriverType",{get:function(){return k._resetErr(),k._driverType},set:function(t){var s=k._driverType,u,e;if(k._resetErr(),t!==""){if(u=t*1,u<Dynamsoft.EnumDWT_Driver.TWAIN||u>Dynamsoft.EnumDWT_Driver.TWAIN64)return n.Errors.ImageCaptureDriverTypeError(k),r;if(f.bWin){if(u===Dynamsoft.EnumDWT_Driver.TWAIN_AND_TWAIN64){if(Dynamsoft.dcp.b64bit)return k._driverType=u,k.__icaSourceCount=-1,o}else if(u!=Dynamsoft.EnumDWT_Driver.TWAIN&&u!=Dynamsoft.EnumDWT_Driver.TWAIN64)return n.Errors.ImageCaptureDriverTypeError(k),r;Dynamsoft.dcp.b64bit?k._driverType=u:(u=Dynamsoft.EnumDWT_Driver.TWAIN,k._driverType=u)}else{if(f.bLinux)return u=Dynamsoft.EnumDWT_Driver.SANE,k._driverType=u,u===Dynamsoft.EnumDWT_Driver.SANE?o:(n.Errors.ImageCaptureDriverTypeError(k),r);if(f.bMac){if(u===Dynamsoft.EnumDWT_Driver.TWAIN_AND_ICA)return k._driverType=u,k.__icaSourceCount=-1,o;if(u!=Dynamsoft.EnumDWT_Driver.ICA&&u!=Dynamsoft.EnumDWT_Driver.TWAIN&&u!=Dynamsoft.EnumDWT_Driver.TWAIN64)return n.Errors.ImageCaptureDriverTypeError(k),r;k._driverType=u}}return k.__icaSourceCount=0,k.CloseSourceManager(),e=k._innerFun("ImageCaptureDriverType",i.makeParams(u)),k.OpenSourceManager(),e}return n.Errors.ImageCaptureDriverTypeError(k),r}}));k._isMobileMode()?u(k,"SourceCount",c):t(k,"SourceCount",{get:function(){var v,s,u,t,c,r,o=[],l,a,e,y,p,w;if(k._resetErr(),k._resetSources(),k.__icaSourceCount=0,f.bMac&&k._driverType===Dynamsoft.EnumDWT_Driver.TWAIN_AND_ICA){if((s=[],k.CloseSourceManager(),k._innerFun("ImageCaptureDriverType",i.makeParams(Dynamsoft.EnumDWT_Driver.ICA)),k.OpenSourceManager(),k._errorCode!=0&&k._errorCode!=-3032)||(p=k._innerFunRaw("GetSourceNames"),k._errorCode!=0))return 0;for(l=p!=""?JSON.parse(h(p[0])):[],r=0;r<l.length;r++)t=l[r].ProductName,n.isString(t)&&(t=n.trim(t),t!==""&&(l[r].IsDefaultSource==="true"&&(u=t),l[r].DriverType==="ICA"?o.push("ICA-"+t):o.push(t),s.push(l[r])));if((u===undefined&&l.length>0&&(t=l[0].ProductName,n.isString(t)&&(t=n.trim(t),t!==""&&(u=l[0].DriverType==="ICA"?"ICA-"+t:t))),k.CloseSourceManager(),k._innerFun("ImageCaptureDriverType",i.makeParams(Dynamsoft.EnumDWT_Driver.TWAIN)),k.OpenSourceManager(),k._errorCode!=0&&k._errorCode!=-3032)||(y=k._innerFunRaw("GetSourceNames"),k._errorCode!=0))return 0;for(e=y!=""?JSON.parse(h(y[0])):[],r=0;r<e.length;r++)t=e[r].ProductName,n.isString(t)&&(t=n.trim(t),t!==""&&(e[r].IsDefaultSource==="true"&&(u=t),e[r].DriverType==="ICA"?o.push("ICA-"+t):o.push(t),s.push(e[r])));u===undefined&&e.length>0&&(t=e[0].ProductName,n.isString(t)&&(t=n.trim(t),t!==""&&(u=e[0].DriverType==="ICA"?"ICA-"+t:t)));v=s.length;k.__defaultSourceName=u;k.__icaSourceCount=l.length;k.__sourceCount=v;k.__sourceName=o;k.__sourceDetails=s}else if(f.bWin&&Dynamsoft.dcp.b64bit&&k._driverType===Dynamsoft.EnumDWT_Driver.TWAIN_AND_TWAIN64){if((s=[],k.CloseSourceManager(),k._innerFun("ImageCaptureDriverType",i.makeParams(Dynamsoft.EnumDWT_Driver.TWAIN)),k.OpenSourceManager(),k._errorCode!=0&&k._errorCode!=-3032)||(y=k._innerFunRaw("GetSourceNames"),k._errorCode!=0))return 0;for(e=y!=""?JSON.parse(h(y[0])):[],r=0;r<e.length;r++)t=e[r].ProductName,n.isString(t)&&(t=n.trim(t),t!==""&&(e[r].IsDefaultSource==="true"&&(u=t),o.push(t),s.push(e[r])));if(u===undefined&&e.length>0&&(t=e[0].ProductName,n.isString(t)&&(t=n.trim(t),t!==""&&(u=t))),Dynamsoft.dcp.b64bit){if((k.CloseSourceManager(),k._innerFun("ImageCaptureDriverType",i.makeParams(Dynamsoft.EnumDWT_Driver.TWAIN64)),k.OpenSourceManager(),k._errorCode!=0&&k._errorCode!=-3032)||(w=k._innerFunRaw("GetSourceNames"),k._errorCode!=0))return 0;for(a=w!=""?JSON.parse(h(w[0])):[],r=0;r<a.length;r++)t=a[r].ProductName,n.isString(t)&&(t=n.trim(t),t!==""&&(a[r].IsDefaultSource==="true"&&(u=t),a[r].DriverType==="TWAIN(64Bit)"?o.push("Twain64-"+t):o.push(t),s.push(a[r])));u===undefined&&a.length>0&&(t=a[0].ProductName,n.isString(t)&&(t=n.trim(t),t!==""&&(u=a[0].DriverType==="TWAIN(64Bit)"?"Twain64-"+t:t)))}else a=[];v=s.length;k.__defaultSourceName=u;k.__icaSourceCount=e.length;k.__sourceCount=v;k.__sourceName=o;k.__sourceDetails=s}else{if(s=k._innerFunRaw("GetSourceNames"),k._errorCode!=0)return 0;if(s!=""&&(c=JSON.parse(h(s[0]))),k.__defaultSourceName="",c&&c.length>=1){for(r=0;r<c.length;r++)t=c[r].ProductName,n.isString(t)&&(t=n.trim(t),t!==""&&(c[r].IsDefaultSource==="true"&&(u=t),o.push(t)));n.isString(u)?k.__defaultSourceName=u:(t=c[0].ProductName,n.isString(t)&&(t=n.trim(t),t!==""&&(k.__defaultSourceName=c[0].DriverType==="ICA"?"ICA-"+t:t)))}else c=[],o=[];v=c.length;k.__sourceCount=v;k._driverType===Dynamsoft.EnumDWT_Driver.ICA&&f.bMac&&v>0&&(n.each(o,function(t,i){if(n.isString(t)){var r=n.trim(t);r!==""&&(o[i]="ICA-"+r)}}),k.__defaultSourceName!==""&&(k.__defaultSourceName="ICA-"+k.__defaultSourceName));k.__sourceName=o;k.__sourceDetails=c}return v<=0?(s=[],o=[],k.__sourceName=[],k.__sourceDetails=[],k.__defaultSourceName="",k.__sourceCount=0,0):v}});t(k,"HowManyImagesInBuffer",{get:function(){return k._ImgManager.count()}});t(k,"HTTPPostResponseString",{get:function(){return k._resetErr(),k.__HTTPPostResponseString?k.__HTTPPostResponseString:""}});k._isMobileMode()?u(k,["FTPPort","IfShowProgressBar","IfAppendImage"]):(t(k,"FTPPort",{get:function(){return k._resetErr(),k._innerFun("FTPPort")},set:function(n){if(k._resetErr(),n!==""){var t=n*1;return k._innerFun("FTPPort",i.makeParams(t))}}}),t(k,"IfShowProgressBar",{get:function(){return k._resetErr(),k.__IfShowProgressBar},set:function(t){return n.isBoolean(t)?(k._resetErr(),k.__IfShowProgressBar=t):(n.Errors.InvalidValue(k),r)}}),t(k,"IfAppendImage",{get:function(){return k._resetErr(),k.__IfAppendImage},set:function(t){return n.isBoolean(t)?(k._resetErr(),k.__IfAppendImage=t):(n.Errors.InvalidValue(k),r)}}));k._isMobileMode()?t(k,"JPEGQuality",{get:function(){return k._resetErr(),k._jpgQuality},set:function(n){var t=n*1;return t>=100?t=100:t<0&&(t=0),k._resetErr(),k._jpgQuality=t,!0}}):t(k,"JPEGQuality",{get:function(){return k._resetErr(),k._innerFun("JPEGQuality")},set:function(n){var t=n*1;return t>=100?t=100:t<0&&(t=0),k._resetErr(),k._innerFun("JPEGQuality",i.makeParams(t))}});k._isMobileMode()?t(k,"TIFFCompressionType",{get:function(){return k._resetErr(),k._tiffCompressionType},set:function(n){return k._resetErr(),k._tiffCompressionType=n,!0}}):t(k,"TIFFCompressionType",e,l);k._isMobileMode()?t(k,"BufferMemoryLimit",{get:function(){return 0},set:function(){return!1}}):t(k,"BufferMemoryLimit",e,l);k._isMobileMode()?t(k,"LogLevel",{get:function(){return k._resetErr(),k._logLevel},set:function(n){k._resetErr();var t=n*1;return t>=14?t=14:t<0&&(t=0),Dynamsoft.WasmEnv&&Dynamsoft.WasmEnv.setLoglevel(k._logLevel),k._logLevel=t,!0}}):t(k,"LogLevel",e,l);t(k,"HttpContentTypeFieldValue",{get:function(){return k._resetErr(),k.__strHttpContentTypeFieldValue},set:function(n){return k._resetErr(),k.__strHttpContentTypeFieldValue=n,n}});t(k,"BrokerProcessType",{get:function(){return k._resetErr(),1},set:function(){return k._resetErr(),!0}});t(k,"BorderStyle",{get:function(){return k._resetErr(),0},set:function(){return k._resetErr(),!1}});t(k,"HttpFieldNameOfUploadedImage",{get:function(){return k._resetErr(),k.__remoteFilename},set:function(n){return k._resetErr(),k.__remoteFilename=n}});t(k,"style",{get:function(){return k.__style}});t(k,"Addon",{get:function(){return k.__addon}});t(k,"HTTPRequestswithCredentials",{get:function(){return k._resetErr(),k.__withCredentials},set:function(n){return k._resetErr(),k.__withCredentials=n}});t(k,"ScaleDownThreshold",{get:function(){return k._resetErr(),k._scaleDownThreshold},set:function(n){return k._resetErr(),k._scaleDownThreshold=n}});t(k,"CurrentImageIndexInBuffer",{get:function(){return k._ImgManager.getCurrentImageIndex()},set:function(n){var t=n*1;return k._resetErr(),t>=0&&t<k._ImgManager.count()&&(k._ImgManager.Go(t),k._bNoUI||i.__innerRefreshFromUIView(k,k._ImgManager.getCurrentImageIndex())),!0}});t(k,"SelectedImagesCount",{get:function(){return(k._resetErr(),k._ImgManager.count()<=0)?0:k._ImgManager.GetSelectedImageCount()==0?1:k._ImgManager.GetSelectedImageCount()},set:function(n){var t=n*1;return k._resetErr(),k._ImgManager.count()<=0?t=0:t<1&&(t=1),k._ImgManager.SetSelectedImageCount(t),k._ImgManager.GetSelectedImageCount()}});t(k,"SelectedImagesIndices",{get:function(){return(k._resetErr(),k._ImgManager.count()<=0)?[]:k._ImgManager.getSelectedClientIndexArray()}});t(k,"MaxImagesInBuffer",{get:function(){return k._resetErr(),k.__maxImagesInBuffer},set:function(t){var i=t*1;return k._resetErr(),i>0&&i<32768?k.__maxImagesInBuffer=i:n.Errors.OutOfRange(k),k.__maxImagesInBuffer}});t(k,"MaxUploadImageSize",{get:function(){return k._resetErr(),k.__maxUploadImageSize},set:function(n){var t=n*1;return k._resetErr(),k.__maxUploadImageSize=t,k._isMobileMode()||k._innerFun("MaxUploadImageSize",i.makeParams(t)),k.__maxUploadImageSize}});k._isMobileMode()?t(k,"IfSSL",{get:function(){return k._ifSSL},set:function(n){return k._ifSSL=n,!0}}):t(k,"IfSSL",e,s);k._isMobileMode()?t(k,"IfAllowLocalCache",{get:function(){return!1},set:function(){return!1}}):t(k,"IfAllowLocalCache",e,s);t(k,"UseLocalService",{get:function(){return!k._isMobileMode()}});t(k,"PDFCompressionType",{get:function(){return(k._resetErr(),k._isMobileMode())?k._mobileNotSupport("PDFCompressionType"):k._innerFun("PDFCompressionType")},set:function(n){var t=n*1;return(t==EnumDWT_PDFCompressionType.PDF_FAX3&&(t=EnumDWT_PDFCompressionType.PDF_FAX4),k._resetErr(),k._isMobileMode())?k._mobileNotSupport("PDFCompressionType"):k._innerFun("PDFCompressionType",i.makeParams(t))}});k._getPdfDllname=function(){return f.bMac?Dynamsoft.dcp.b64bit?"libDynamicPdfCorex64_"+Dynamsoft.WebTwainEnv.PdfVersion+".dylib":"libDynamicPdfCore_"+Dynamsoft.WebTwainEnv.PdfVersion+".dylib":f.bLinux?"libDynamicPdfCore_"+Dynamsoft.WebTwainEnv.PdfVersion+".so":Dynamsoft.dcp.b64bit?"DynamicPdfCorex64_"+Dynamsoft.WebTwainEnv.PdfVersion+".dll":"DynamicPdfCore_"+Dynamsoft.WebTwainEnv.PdfVersion+".dll"};k._setConvertModeInner=function(t){if(!n.License.checkProductKey(k,{Core:!0}))return!1;var i=t*1,r=2;return(k._resetErr(),isNaN(i))?(n.Errors.ParameterCannotEmpty(k),!1):i!=1&&i!=r&&i!=3?(n.Errors.InvalidValue(k),!1):(k._pdfConvertMode=i,k._pdfRealConvertMode=i==r||n.License.hasPDFRProductKey(k)?i:r,!0)};k._setConvertMode=function(t){var u=k._setConvertModeInner(t),r;return u?(k._isMobileMode()||(r=k._getPdfDllname(),k._innerFun("SetPDFConvertMode",i.makeParams(k._pdfRealConvertMode,r))),k._pdfRealConvertMode==2&&k._pdfConvertMode==1)?(n.Errors.LicenseNoPDF(k),!1):!0:!1};k._setConvertModeAsync=function(t){var r=1,u=2,e=k._setConvertModeInner(t),o=n.Promise.resolve(!0),f;return e?k._isMobileMode()?k._pdfRealConvertMode==u&&k._pdfConvertMode==r?(n.Errors.LicenseNoPDF(k),n.Promise.reject({code:k._errorCode,message:k._errorString})):n.Promise.resolve(!0):(f=k._getPdfDllname(),k._innerFunV2("SetPDFConvertMode",i.makeParams(k._pdfRealConvertMode,f)).then(function(){if(k._pdfRealConvertMode==u&&k._pdfConvertMode==r){n.Errors.LicenseNoPDF(k);throw{code:k._errorCode,message:k._errorString};}return!0})):n.Promise.reject({code:k._errorCode,message:k._errorString})};k._setProductKey=function(t,r,u,f){var s=!0,e=t,c=Dynamsoft.WebTwainEnv,o=function(t){t||(k.__licenseInfo=!1);var i=!0;return f||(i=n.License.checkProductKey(k,{Core:!0})),n.isFunction(u)&&u(),i},h;if(k._resetErr(),n.isString(e)&&e!="******"||(e=""),c.ProductKey=e,e=="")s=!1,o();else{if(k._isMobileMode())return n.showProgressMsg(-1,"",Dynamsoft.MSG.Init_GetLicenseInfoForDWT),k.GetLicenseInfo(function(){Dynamsoft.WasmEnv&&Dynamsoft.WasmEnv.setLoglevel(k._logLevel);k._setConvertMode(k._pdfConvertMode);k._resetErr();o(!0)},o),!0;h=function(t){k._innerFunRaw("ProductKey",i.makeParams(t),r,!1,!1,function(t){var i=!1;i=n.isArray(t)?t[0]:t;n.isArray(t)&&t.length>=3&&t[1]==="1"&&n.isFunction(n.ShowLicenseDialog)&&n.ShowLicenseDialog(t[2],{width:510,height:272,bClose:!0,seconds:10});r||(s=i);n.showProgressMsg(-1,"",Dynamsoft.MSG.Init_GetLicenseInfoForDWT);k.GetLicenseInfo(function(){k._setConvertMode(k._pdfConvertMode);o(!0)},o)},function(){r||(s=!1);o()})};n.startsWith(e,"http://")||n.startsWith(e,"https://")?n.ajax({method:"GET",url:e,onSuccess:function(n){h(n)}}):h(e)}return s};w(k,["ProxyServer"]);d=["CapValueString","CapDescription","FTPPassword","FTPUserName","Manufacturer","ProductFamily","PDFAuthor","PDFCreationDate","PDFCreator","PDFKeywords","PDFModifiedDate","PDFProducer","PDFSubject","PDFTitle","PDFVersion"];k._isMobileMode()?u(k,d):w(k,d);p(k,["ImageBitsPerPixel","ImageLength","ImageWidth","ImageXResolution","ImageYResolution"]);g=["BlankImageCurrentStdDev","CapDefaultIndex","CapDefaultValue","DataSourceStatus","Duplex","PendingXfers","ImageLayoutDocumentNumber","ImageLayoutFrameBottom","ImageLayoutFrameLeft","ImageLayoutFrameNumber","ImageLayoutFrameRight","ImageLayoutFrameTop","ImageLayoutPageNumber","ImagePixelType","MagData","MagType","IfFeederLoaded","IfPaperDetectable","IfUIControllable"];k._isMobileMode()?u(k,g,c):p(k,g);v(k,["AllowPluginAuthentication","IfModalUI","IfScanInNewThread","_AutoCropMethod"]);nt=["CurrentSourceName","IfDisableSourceAfterAcquire","IfDuplexEnabled","IfFeederEnabled","IfShowFileDialog","IfShowUI","IfPASVMode","IfAutoBright","IfAutoDiscardBlankpages","IfAutoFeed","IfAutomaticBorderDetection","IfAutomaticDeskew","IfAutoScan","IfShowIndicator","IfUseTwainDSM","IfTiffMultiPage"];k._isMobileMode()?u(k,nt):v(k,nt);y(k,["MaxInternetTransferThreads"]);tt=["BlankImageMaxStdDev","BlankImageThreshold","BitDepth","Brightness","PageSize","PixelType","Resolution","Capability","CapCurrentIndex","CapCurrentValue","CapMaxValue","CapMinValue","CapNumItems","CapStepSize","CapType","CapValue","CapValueType","Contrast","PixelFlavor","TransferMode","Unit","XferCount"];k._isMobileMode()?u(k,tt):y(k,tt);a(k,["AsyncMode","EnableInteractiveZoom","IfThrowException","ImageEditorIfEnableEnumerator","ImageEditorIfReadonly","ImageEditorIfModal","ImageEditorWindowTitle","IfShowPrintUI","VScrollBar"],s);it=["IfOpenImageWithGDIPlus"];k._isMobileMode()?u(k,it):a(k,it)};n.attachPropertyUI||(n.attachPropertyUI=function(){})}});Dynamsoft.Ready(function(n){var f=Dynamsoft;if(n.product.bHTML5Edition){var r=Dynamsoft.navInfoSync,u=n.html5.STwain,i=u.prototype,t=n.html5.Funs;i.__innerLoadImage=function(t,i,r,u,f,e){var o=this;return n.License.checkProductKey(o,{Core:!0})?n.License.checkPDFProductKeyWhenNeeds(o,r)?n.isFunction(f)?o.__innerAcquireImage(t,i,u,f,e):o.__innerLoadImageFun(t,i):(n.isFunction(e)&&e(o._errorCode,o._errorString),!1):(n.isFunction(e)&&e(o._errorCode,o._errorString),!1)};i.__innerLoadImageFun=function(i,r){var f=this,u,e;if(t.isHttpServerInvalid(f))return!1;if(u=f._innerFunRaw(i,r,!1,!1,!1),n.isArray(u)){if(u.length===0||u.length===1&&(e=u[0],e<=0))return!1;f._OnBitmapChanged(["0",u.join(","),1,f._ImgManager.getCurrentImageIndex(),f._ImgManager.count()]);u=!0}return u};i.__innerAcquireImage=function(i,r,u,f,e){var o=this,s=i=="LoadImage"||i=="LoadImageEx"||i=="GenerateURLForUploadData",h=function(r){o.__bLoadingImage=!1;var u=o._ImgManager.getCurrentImageIndex();return u>=0&&o.OnRefreshUI(u),n.isFunction(e)&&e(o.ErrorCode,o.ErrorString),s?Dynamsoft.Lib.closeProgress(i):t.hideMask(i),r&&Dynamsoft.Lib.log(r),!1};return t.isServerInvalid(o)?(h(),!1):(s?Dynamsoft.Lib.showProgress(o,i,!1):t.showMask(i),o._innerSend(i,r,!0,function(){if(o.__bLoadingImage=!1,s){if(Dynamsoft.Lib.closeProgress(i),!o._bNoUI){var r=o._ImgManager.getCurrentImageIndex();r>=0&&o.OnRefreshUI(r)}}else t.hideMask(i);n.isFunction(f)&&f()},h),!0)};i.__innerSaveImage=function(n,t,i,r){var u=this;return u._OnPercentDone([0,-1,Dynamsoft.MSG.Encoding]),u.__innerProgressFunction(n,t,!1,i,r)};i.__innerFTPDownloadDirectly=function(t,i,r,u,f){var e=this;return n.License.checkProductKey(e,{Core:!0})?n.License.checkPDFProductKeyWhenNeeds(e,r)?(n.cancelFrome=4,e.__innerProgressFunction(t,i,!0,u,f)):(n.isFunction(f)&&f(e._errorCode,e._errorString),!1):(n.isFunction(f)&&f(e._errorCode,e._errorString),!1)};i.__innerFTPDownload=function(t,i,r,u,f){var e=this,s,o;return n.License.checkProductKey(e,{Core:!0})?n.License.checkPDFProductKeyWhenNeeds(e,r)?(n.cancelFrome=4,n.isFunction(f)?e.__innerProgressFunction(t,i,!0,function(){var t=e._ImgManager.getCurrentImageIndex();t>=0&&e.OnRefreshUI(t);n.isFunction(u)&&u()},f):(s=e.__innerLoadImageFun(t,i),o=e._ImgManager.getCurrentImageIndex(),o>=0&&e.OnRefreshUI(o),s)):(n.isFunction(f)&&f(e._errorCode,e._errorString),!1):(n.isFunction(f)&&f(e._errorCode,e._errorString),!1)};i.__innerFTPUpload=function(n,t,i,r){return Dynamsoft.Lib.cancelFrome=3,this.__innerProgressFunction(n,t,!0,i,r)};i.__innerProgressFunction=function(t,i,r,u,f){var e=this,o;return n.isFunction(f)?(o=function(i){return n.isFunction(f)&&f(e.ErrorCode,e.ErrorString),Dynamsoft.Lib.closeProgress(t),i&&Dynamsoft.Lib.log(i),!0},Dynamsoft.Lib.showProgress(e,t,r),this._innerSend(t,i,!0,function(){Dynamsoft.Lib.closeProgress(t);n.isFunction(u)&&u()},o)):this._innerFun(t,i)};i.__innerGetBarcodeResultAsyncFunction=function(n){var t=Dynamsoft.Lib.NewBarcodeResult();return n&&(t._errorCode=n.exception,t._errorString=n.description,t._resultlist=n.result,t._Count=n.result.length),t};i.__innerGetOCRResultAsyncFunction=function(n){var t=Dynamsoft.Lib.NewOCRResult(this);return n&&(t._errorCode=n.exception,t._errorString=n.description,t._resultlist=n.result),t};i._innerSendCmd=function(n,i){var r=this;if(t.isHttpServerInvalid(r))return!1;r._innerFunRaw(n,i,!0,!1,!0)};i._innerFun=function(n,i){var u=this,r;return t.isHttpServerInvalid(u)?!1:(r=u._innerFunRaw(n,i,!1,!1,!1),Dynamsoft.Lib.isArray(r))?r[0]:r};i._innerFunRawV2=function(i,r,u){var f=this,e;return t.isHttpServerInvalid(f)?n.Promise.reject({code:f._errorCode,message:f._errorString}):(f._resetErr(),e={method:"post",body:t.getJson(f,i,r,0),dataType:u},n.fetch([f.httpUrl,"fa/",i,"?",t.getRandom()].join(""),e).then(function(t){var i=!1;try{i=n.isString(t)?n.parse(t):t}catch(r){}if(i){if(i instanceof Blob||i instanceof ArrayBuffer)return i;if(i.exception!==undefined&&i.description!==undefined)f._errorCode=i.exception,f._errorString=i.description;else return f._resetErr(),i}else Dynamsoft.Lib.Errors.InvalidResultFormat(f);throw{code:f._errorCode,message:f._errorString};},function(n){Dynamsoft.Lib.Errors.NetworkError(f);n&&(f._errorString=[f._errorString," ",n.errorString," (",n.httpCode,")"].join(""));throw{code:f._errorCode,message:f._errorString};}))};i._innerFunV2=function(i,r){var u=this;return t.isHttpServerInvalid(u)?n.Promise.reject({code:u._errorCode,message:u._errorString}):u._innerFunRawV2(i,r,"text").then(function(n){return n&&Dynamsoft.Lib.isArray(n.result)&&n.result.length>0?n.result[0]:n})};i._innerFunRaw=function(i,u,f,e,o,s,h){var c=this,y,p,a,w="f/",l,v=!1;return t.isHttpServerInvalid(c)?!1:(c._resetErr(),f&&(v=!0,w="fa/"),y=[c.httpUrl,w,i,"?",t.getRandom()].join(""),p=t.getJson(c,i,u,0),a={method:"POST",url:y,data:p,"async":v,onSuccess:function(t,i,r){var u=!1;try{u=n.isString(t)&&r.getResponseHeader("content-type")==="text/json"?n.parse(t):t}catch(f){}u?(u.exception!==undefined&&u.description!==undefined?(c._errorCode=u.exception,c._errorString=u.description):c._resetErr(),l=o?u:u.result):(Dynamsoft.Lib.Errors.InvalidResultFormat(c),l="");n.isFunction(s)&&s(l)},onError:function(){Dynamsoft.Lib.Errors.NetworkError(c);l="";n.isFunction(h)&&h()}},!v&&e?r.bIE?(a.dataType="arraybuffer",a.onSuccess=function(t,i,r){var u,s,f=!1,h,e,a,o;if(r.responseHeadersString&&(h=r.responseHeadersString,h.indexOf("text/json")!=-1&&(f=!0)),u=r.responseData,c._resetErr(),l=!1,u&&(s=new Uint8Array(u),f?u=String.fromCharCode.apply(null,s):l=new Blob([s],{type:c.__strHttpContentTypeFieldValue})),(!u||f)&&(o=!1,e=f?u:r.responseText,a=e.length,a>0)){if(e.charAt(0)=="{")try{o=n.parse(e);f=!0}catch(v){Dynamsoft.Lib.log(e)}f?o.exception!==undefined&&o.description!==undefined?(c._errorCode=o.exception,c._errorString=o.description,l=!1):l=!0:(s=new Uint8Array(e),l=new Blob([s],{type:c.__strHttpContentTypeFieldValue}))}}):(v||(a.contentType="text/plain; charset=x-user-defined",a.mimeType="text/plain; charset=x-user-defined"),a.onSuccess=function(t,i,r){var u,o,s,h,f,e;if(u=r.responseText,o=u.length,c._resetErr(),o>0){if(h=!1,u.charAt(0)=="{")try{f=n.parse(u);h=!0}catch(a){Dynamsoft.Lib.log(u)}if(h)f.exception!==undefined&&f.description!==undefined?(c._errorCode=f.exception,c._errorString=f.description,l=!1):l=!0;else{for(s=new Uint8Array(o),e=0;e<o;e++)s[e]=u.charCodeAt(e);l=new Blob([s],{type:c.__strHttpContentTypeFieldValue})}}else l=""}):v&&e&&(a.dataType="blob",a.onSuccess=function(t,i,r){if(r.responseHeadersString.indexOf("image/png")>=0)c._resetErr(),n.isFunction(s)&&s(t);else{var u=new FileReader;u.onload=function(){var i=u.result,t;try{t=n.parse(i);t.exception!==undefined&&t.description!==undefined?(c._errorCode=t.exception,c._errorString=t.description,n.isFunction(h)&&h()):n.isFunction(s)&&s(t.result)}catch(r){Dynamsoft.Lib.log(i);n.isFunction(s)&&s(i)}};u.readAsText(t)}}),v||n.mix(a,{headers:{"X-Requested-With":!1}}),r.bFileSystem&&(a.crossDomain=!1),n.ajax(a),v)?!0:l};i._innerSend=function(i,r,u,f,e){var o=this,y=o._objWS,h=!1,c=!1,a=!1,v=!0,s,l;if(i=="ActiveUI"?v=!1:a=t.isServerInvalid(o),a)return n.isFunction(e)&&e(),!0;if(n.isFunction(f)&&(c=f),n.isFunction(e)&&(h=e),s=t.generateCmdId(),i=="SaveSelectedImagesToBytes"||i=="ConvertToBlob"){var p=t.getJson(o,i,r,s);o._innerFunRaw(i,p,!0,!0,!0,c,h);l=!0}else o.curCommand.push({cmd:i,cmdId:s,sFun:c,fFun:h}),l=t.sendData(y,t.getJson(o,i,r,s),!1,v);return l};i.__innerConvertToBlob=function(t,i,r,u,f,e,o,s){var h=this,l,y;if(h._isMobileMode())return h.__innerConvertToBlobByMobile(t,i,r,f,e,o,s);var c=r,a=!0,v=",";return n.isString(c)&&c!=""||(c="",v=""),l=["[",t,',"',i.join(","),'"',v,c,"]"].join(""),u?h._innerFunRaw("ConvertToBlob",l,!0,a,!0,function(t){n.isFunction(e)&&e(t,s)},o):(y=h._innerFunRaw("ConvertToBlob",l,!1,a,!1),h.ErrorCode==0?e(y,s):(o(),!1))};i.__innerConvertToBlobByMobile=function(t,i,r,u,f,e,o){var h=this,a=function(t,i){fetch(t,{mode:"cors"}).then(function(n){return n.arrayBuffer()}).then(function(t){var r="image/"+i,u;i=="pdf"&&(r="application/pdf");u=new Blob([t],{type:r});n.isFunction(f)&&f(u,o)})["catch"](function(t){n.isFunction(e)&&e(t)})},l=[],c,s;if(t==EnumDWT_ImageType.IT_BMP)return c="bmp",h._mobileNotSupport("Convert to bmp",e);for(c=t==EnumDWT_ImageType.IT_JPG?"jpg":t==EnumDWT_ImageType.IT_PNG?"png":t==EnumDWT_ImageType.IT_TIF?"tiff":t==EnumDWT_ImageType.IT_PDF?"pdf":"png",s=0;s<i.length;s++)l.push(h._ImgManager.convertServerIdToClientIndex(i[s]));return h._innerSendToMobile("SaveImage",Dynamsoft.Lib.MobileFuns.makeParams("",l,c,u,!1),0,a,e)};i.__innerConvertToBase64ByMobile=function(t,i,r,u,f){var e=this,c=function(t,i){fetch(t,{mode:"cors"}).then(function(n){return n.arrayBuffer()}).then(function(t){var r=new FileReader,o;r.onload=function(t){var i=t.target.result,r=n.isString(i)?i.split(","):[];r.length>=2&&(i=r[1]);n.isFunction(u)&&u({result:[i,i.length,this.md5]})};o="image/"+i;i=="pdf"&&(o="application/pdf");e._innerSendToMobile("GetMD5",Dynamsoft.Lib.MobileFuns.makeParams(t),0,function(n){r.md5=n;r.readAsDataURL(new Blob([t],{type:o}))},f)},function(t){n.isFunction(f)&&f(t)})},h=[],s,o;if(i==EnumDWT_ImageType.IT_BMP)return s="bmp",e._mobileNotSupport("Convert to bmp",f);for(s=i==EnumDWT_ImageType.IT_JPG?"jpg":i==EnumDWT_ImageType.IT_PNG?"png":i==EnumDWT_ImageType.IT_TIF?"tiff":i==EnumDWT_ImageType.IT_PDF?"pdf":"png",o=0;o<t.length;o++)h.push(e._ImgManager.convertServerIdToClientIndex(t[o]));return e._innerSendToMobile("SaveImage",Dynamsoft.Lib.MobileFuns.makeParams("",h,s,r,!1),0,c,f)};i.__SaveLocalFileToBytes=function(n,i,r,u,f){var e=this,o=!0,s;return i?(e._innerFunRaw("SaveSelectedImagesToBytes",t.makeParams(0,0,n,r),i,o,!0,u,f),!0):(s=e._innerFunRaw("SaveSelectedImagesToBytes",t.makeParams(0,0,n,r),i,o,!1),e.ErrorCode==0?u(s):(f(),!1))};i.__LoadImageFromBytes=function(i,r,u,f,e,o,s,h){var c=this,v="LoadImageFromBytes",k=r||3,y=i.size||i.length,p=i.name||"unknown",w,d=t.isServerInvalid(c),a=!0,b=0,l;return(!isNaN(s)&&s>=0&&!isNaN(h)&&h>0||(s=0,h=0),b=c.__GetLoadEventsNum(),w=["[",y,",",0,",",k,',"',u,'",',s,",",h,",",b,"]"].join(""),l=function(){if(Dynamsoft.Lib.closeProgress(v),c.__bLoadingImage=!1,a){var t=c._ImgManager.getCurrentImageIndex();t>=0&&c.OnRefreshUI(t)}return n.isFunction(o)&&o(c._errorCode,c._errorString,p),!1},d)?(a=!1,l()):!n.License.checkProductKey(c,{Core:!0})&&!n.License.checkProductKey(c,{Webcam:!0},!0)?(a=!1,l()):n.License.checkPDFProductKeyWhenNeeds(c,r)?y===0?(Dynamsoft.Lib.Errors.ImageFileLengthCannotZero(c),a=!1,l()):(t.setBtnCancelVisibleForProgress(c,!1),this._innerSendBlob(v,w,i,f,function(){if((s+y==h||h<=0||isNaN(h))&&Dynamsoft.Lib.closeProgress(v),c.__bLoadingImage=!1,!c._bNoUI){var t=c._ImgManager.getCurrentImageIndex();f&&t>=0&&c.OnRefreshUI(t)}return n.isFunction(e)&&setTimeout(function(){e(p)},30),!0},l)):(a=!1,l())};i._innerSendBlob=function(i,u,f,e,o,s){var h=this,k=h._objWS,l=!1,a=!1,p,c,w,v,y,b;if(t.isServerInvalid(h))return n.isFunction(s)&&s(),!1;if(l=function(t){n.isArray(t)&&t.length>0&&t[0]>0&&h._OnBitmapChanged(["0",t.join(","),1,h._ImgManager.getCurrentImageIndex(),h._ImgManager.count()]);n.isFunction(o)&&o()},n.isFunction(s)&&(a=s),e)p=t.generateCmdId(),h.curCommand.push({cmd:i,cmdId:p,sFun:l,fFun:a}),t.sendData(k,t.getJson(h,i,u,p),f,!0);else return(b="f/",t.isHttpServerInvalid(h))?!1:(h._resetErr(),w=[h.httpUrl,b,i,"?",t.getRandom()].join(""),v=t.getJson(h,i,u,0),v+="\r\n\r\n",v+=Dynamsoft.Lib.base64.encodeArray(f),y={method:"post",url:w,processData:!1,data:v,"async":!1,onSuccess:function(t,i,r){var u=!1;try{u=n.isString(t)&&r.getResponseHeader("content-type")==="text/json"?n.parse(t):t}catch(f){}u!==undefined&&u!==null?(u.exception!==undefined&&u.description!==undefined?(h._errorCode=u.exception,h._errorString=u.description):h._resetErr(),c=u.result):(Dynamsoft.Lib.Errors.InvalidResultFormat(h),c="")},onError:function(){Dynamsoft.Lib.Errors.NetworkError(h);c=""}},n.mix(y,{headers:{"X-Requested-With":!1}}),r.bFileSystem&&(y.crossDomain=!1),n.ajax(y),h._errorCode==0?n.isFunction(l)&&l(c):n.isFunction(a)&&a(),c)};i._innerActiveUI=function(n,i){this._innerSend("ActiveUI",t.makeParams(Dynamsoft.Lib.env.WSVersion,Dynamsoft.Lib.env.WSSession,1),!1,n,i)}}});Dynamsoft.Ready(function(n){var s=Dynamsoft;if(n.product.bHTML5Edition){var r=Dynamsoft.navInfo,o=n.html5.STwain,t=o.prototype,i=n.html5.Funs,u=i.RemoveNonPrintableChar,f=Dynamsoft.WebTwainEnv,e=["OnPreAllTransfers","OnPreTransfer","OnPostTransfer","OnPostTransferAsync"];t.LoadDibFromClipboard=function(n,t){var r=this,f,u;return(r._resetErr(),r._isMobileMode())?r._mobileNotSupport("LoadDibFromClipboard",t):(f=-1,u=0,u=r.__GetLoadEventsNum(),r.__innerLoadImage("LoadDibFromClipboard",i.makeParams(u),f,!0,n,t))};t.LoadImage=function(t,r,u){var f=this;if(f._resetErr(),f._isMobileMode())return f._mobileNotSupport("LoadImage",u);var e=i.replaceLocalFilename(t),c=n.html5.Funs.getImageType(e),o=0,s,h;return r&&n.isFunction(r)&&(s=function(){r()}),u&&n.isFunction(u)&&(h=function(){u(f.ErrorCode,f.ErrorString)}),o=f.__GetLoadEventsNum(),f.__innerLoadImage("LoadImage",i.makeParams(e,o),c,!0,s,h)};t.LoadImageEx=function(t,r,u,f){var s=this,o,e;if(s._resetErr(),s._isMobileMode())return o=n.one(".d-loadImage"),o.length==0?(e=document.createElement("input"),e.setAttribute("type","file"),e.style="position:absolute;top:-2px;left:-2px;width:1px;height:1px;",e.className="d-loadImage",r==Dynamsoft.EnumDWT_ImageType.IT_BMP?e.setAttribute("accept","image/bmp"):r==Dynamsoft.EnumDWT_ImageType.IT_JPG?e.setAttribute("accept","image/jpeg"):r==Dynamsoft.EnumDWT_ImageType.IT_TIF?e.setAttribute("accept","image/tiff"):r==Dynamsoft.EnumDWT_ImageType.IT_PNG?e.setAttribute("accept","image/png"):r==Dynamsoft.EnumDWT_ImageType.IT_PDF?e.setAttribute("accept",".pdf"):n.env.bMobile?e.setAttribute("accept","image/jpeg,image/png,image/tiff"):e.setAttribute("accept","image/*,.pdf"),e.onchange=function(){e.files.length>0&&s.LoadImageFromBinary(e.files,u,f)},document.body.appendChild(e),e.click()):(r==Dynamsoft.EnumDWT_ImageType.IT_BMP?o[0].setAttribute("accept","image/bmp"):r==Dynamsoft.EnumDWT_ImageType.IT_JPG?o[0].setAttribute("accept","image/jpeg"):r==Dynamsoft.EnumDWT_ImageType.IT_TIF?o[0].setAttribute("accept","image/tiff"):r==Dynamsoft.EnumDWT_ImageType.IT_PNG?o[0].setAttribute("accept","image/png"):r==Dynamsoft.EnumDWT_ImageType.IT_PDF?o[0].setAttribute("accept",".pdf"):n.env.bMobile?o[0].setAttribute("accept","image/jpeg,image/png,image/tiff"):o[0].setAttribute("accept","image/*,.pdf"),o[0].value="",o[0].click()),!0;var v=i.replaceLocalFilename(t),h=r,c=0,l,a;return u&&n.isFunction(u)&&(l=function(){u()}),f&&n.isFunction(f)&&(a=function(){f(s.ErrorCode,s.ErrorString)}),h==EnumDWT_ImageType.IT_ALL&&(h=-1),c=s.__GetLoadEventsNum(),s.__innerLoadImage("LoadImageEx",i.makeParams(v,h,c),h,!0,l,a)};t.EnableSource=function(n,t,i){var r=this;return(r._resetErr(),r._isMobileMode())?r._mobileNotSupport("EnableSource",i):r.AcquireImage(n,t,i)};t.AcquireImage=function(t,r,u){var f=this,l=null,o=null,a,s,c,h,v;if(f._resetErr(),n.isUndefined(u)&&(n.isFunction(t)&&n.isFunction(r)||n.isFunction(t)&&n.isUndefined(r)||n.isFunction(t)&&r==null||t==null&&n.isFunction(r))?(s={},n.isFunction(t)&&(l=t),n.isFunction(r)&&(o=r)):(s=n.isUndefined(t)||t==null?{}:t,n.isFunction(r)&&(l=function(){r(s)}),n.isFunction(u)&&(o=function(){u(s,f._errorCode,f._errorString)})),!n.License.checkProductKey(f,{Core:!0}))return n.isFunction(o)&&o(f.ErrorCode,f.ErrorString),!1;if(f._isMobileMode())return f._mobileNotSupport("AcquireImage",o);if(i.isServerInvalid(f))return n.isFunction(o)&&o(f.ErrorCode,f.ErrorString),!1;for(c=0,h=0;h<e.length;h++)v=["__",e[h]].join(""),n.isFunction(f[v])&&(c=c|1<<h);return s.EnableEvents=c,a=["[",n.stringify(s),"]"].join(""),f.__innerAcquireImage("AcquireImage",a,!1,l,o)};t._startScan=function(t,r,u){var f=this,l=null,h=null,a,o,c,s,v;if((o=n.isUndefined(t)||t==null?{}:t,n.isFunction(r)&&(l=function(){r(o)}),n.isFunction(u)&&(h=function(n,t){u(n,t,o)}),i.isServerInvalid(f))||!n.License.checkProductKey(f,{Core:!0}))return n.isFunction(h)&&h(f._errorCode,f._errorString),!1;for(c=0,s=0;s<e.length;s++)v=["__",e[s]].join(""),n.isFunction(f[v])&&(c=c|1<<s);return o.EnableEvents=c,a=["[",n.stringify(o),"]"].join(""),f.__innerAcquireImage("StartScan",a,!1,l,h)};t.CancelAllPendingTransfers=function(){var n=this;return(n._resetErr(),n._isMobileMode())?n._mobileNotSupport("CancelAllPendingTransfers"):this._innerFun("CancelAllPendingTransfers")};t.CloseSource=function(){var n=this;return(n._resetErr(),n._isMobileMode())?n._mobileNotSupport("CloseSource"):n._innerFun("CloseSource")};t.CloseSourceManager=function(){var n=this;return(n._resetErr(),n._isMobileMode())?n._mobileNotSupport("CloseSourceManager"):n._innerFun("CloseSourceManager")};t.CloseSourceAsync=function(){var n=this;return(n._resetErr(),n._isMobileMode())?n._mobileNotSupportAsync("CloseSource"):n._innerFunV2("CloseSource")};t.CloseSourceManagerAsync=function(){var n=this;return(n._resetErr(),n._isMobileMode())?n._mobileNotSupportAsync("CloseSourceManager"):n._innerFunV2("CloseSourceManager")};t.DisableSource=function(){var n=this;return(n._resetErr(),n._isMobileMode())?n._mobileNotSupport("DisableSource"):n._innerFun("DisableSource")};t.FeedPage=function(){var n=this;return(n._resetErr(),n._isMobileMode())?n._mobileNotSupport("FeedPage"):n._innerFun("FeedPage")};t.GetDeviceType=function(){var n=this;return(n._resetErr(),n._isMobileMode())?n._mobileNotSupport("GetDeviceType"):n._innerFun("GetDeviceType")};t.GetSourceNameItems=function(n){var t=this;return(t._resetErr(),t._isMobileMode())?t._mobileNotSupport("GetSourceNameItems"):(t.__sourceCount<0&&(t.SourceCount=0),n<t.__sourceCount&&n>=0?t.__sourceName[n]:"")};t.SourceNameItems=function(n){var t=this;return(t._resetErr(),t._isMobileMode())?t._mobileNotSupport("SourceNameItems"):t.GetSourceNameItems(n)};t.GetSourceNames=function(n){var t=this,i=t.SourceCount;return i<=0&&(i=0),n?t.__sourceDetails:t.__sourceName};t._resetSources=function(){var n=this;n.__defaultSourceName="";n.__sourceCount=0;n.__icaSourceCount=-1;n.__sourceName=[];n.__sourceDetails=[]};t.getSourceCount=function(){var t=this,f;return t._resetErr(),t._resetSources(),n.showMask(),r.bMac&&t._driverType===Dynamsoft.EnumDWT_Driver.TWAIN_AND_ICA?f=t.CloseSourceManagerAsync().then(function(){return t._innerFunV2("ImageCaptureDriverType",i.makeParams(Dynamsoft.EnumDWT_Driver.ICA))}).then(function(){return t.OpenSourceManagerAsync()}).then(function(){if(t._errorCode!=0&&t._errorCode!=-3032)throw 0;return t._innerFunV2("GetSourceNames")}).then(function(n){if(t._errorCode!=0)throw 0;var i=[];return n!=""&&(i=JSON.parse(u(n))),i}).then(function(i){for(var r,u,f=0;f<i.length;f++)u=i[f],r=u.ProductName,n.isString(r)&&(r=n.trim(r),r!==""&&(u.DriverType==="ICA"&&(r="ICA-"+r),u.IsDefaultSource==="true"&&(t.__defaultSourceName=r),t.__sourceName.push(r),t.__sourceDetails.push(u)));t.__icaSourceCount=t.__sourceDetails.length}).then(function(){return t.CloseSourceManagerAsync()}).then(function(){return t._innerFunV2("ImageCaptureDriverType",i.makeParams(Dynamsoft.EnumDWT_Driver.TWAIN))}).then(function(){return t.OpenSourceManagerAsync()}).then(function(){if(t._errorCode!=0&&t._errorCode!=-3032)throw 0;return t._innerFunV2("GetSourceNames")}).then(function(n){if(t._errorCode!=0)throw 0;var i=[];return n!=""&&(i=JSON.parse(u(n))),i}).then(function(i){for(var r,u,f=0;f<i.length;f++)u=i[f],r=u.ProductName,n.isString(r)&&(r=n.trim(r),r!==""&&(u.DriverType==="ICA"&&(r="ICA-"+r),u.IsDefaultSource==="true"&&(t.__defaultSourceName=r),t.__sourceName.push(r),t.__sourceDetails.push(u)))}).then(function(){var i=t.__sourceDetails.length;return t.__sourceCount=i,t.__defaultSourceName===""&&t.__sourceName.length>0&&(t.__defaultSourceName=t.__sourceName[0]),n.hideMask(),i},function(){return t._resetSources(),t.__icaSourceCount=0,n.hideMask(),0}):r.bWin&&Dynamsoft.dcp.b64bit&&t._driverType===Dynamsoft.EnumDWT_Driver.TWAIN_AND_TWAIN64?(f=t.CloseSourceManagerAsync().then(function(){return t._innerFunV2("ImageCaptureDriverType",i.makeParams(Dynamsoft.EnumDWT_Driver.TWAIN))}).then(function(){return t.OpenSourceManagerAsync()}).then(function(){if(t._errorCode!=0&&t._errorCode!=-3032)throw 0;return t._innerFunV2("GetSourceNames")}).then(function(n){if(t._errorCode!=0)throw 0;var i=[];return n!=""&&(i=JSON.parse(u(n))),i}).then(function(i){for(var r,u,f=0;f<i.length;f++)u=i[f],r=u.ProductName,n.isString(r)&&(r=n.trim(r),r!==""&&(u.IsDefaultSource==="true"&&(t.__defaultSourceName=r),t.__sourceName.push(r),t.__sourceDetails.push(u)));t.__icaSourceCount=t.__sourceDetails.length}),Dynamsoft.dcp.b64bit&&(f=f.then(function(){return t.CloseSourceManagerAsync()}).then(function(){return t._innerFunV2("ImageCaptureDriverType",i.makeParams(Dynamsoft.EnumDWT_Driver.TWAIN64))}).then(function(){return t.OpenSourceManagerAsync()}).then(function(){if(t._errorCode!=0&&t._errorCode!=-3032)throw 0;return t._innerFunV2("GetSourceNames")}).then(function(n){if(t._errorCode!=0)throw 0;var i=[];return n!=""&&(i=JSON.parse(u(n))),i}).then(function(i){for(var r,u,f=0;f<i.length;f++)u=i[f],r=u.ProductName,n.isString(r)&&(r=n.trim(r),r!==""&&(u.DriverType==="TWAIN(64Bit)"&&(r="Twain64-"+r),u.IsDefaultSource==="true"&&(t.__defaultSourceName=r),t.__sourceName.push(r),t.__sourceDetails.push(u)))})),f=f.then(function(){var i=t.__sourceDetails.length;return t.__sourceCount=i,t.__defaultSourceName===""&&t.__sourceName.length>0&&(t.__defaultSourceName=t.__sourceName[0]),n.hideMask(),i},function(){return t._resetSources(),t.__icaSourceCount=0,n.hideMask(),0})):f=t._innerFunV2("GetSourceNames").then(function(n){if(t._errorCode!=0)return 0;var i=[];return n!=""&&(i=JSON.parse(u(n))),i}).then(function(i){for(var r,u,f=0;f<i.length;f++)u=i[f],r=u.ProductName,n.isString(r)&&(r=n.trim(r),r!==""&&(u.DriverType==="ICA"&&(r="ICA-"+r),u.IsDefaultSource==="true"&&(t.__defaultSourceName=r),t.__sourceName.push(r),t.__sourceDetails.push(u)))}).then(function(){var i=t.__sourceDetails.length;return t.__sourceCount=i,t.__defaultSourceName===""&&t.__sourceName.length>0&&(t.__defaultSourceName=t.__sourceName[0]),t.__icaSourceCount=0,n.hideMask(),i},function(){return t._resetSources(),t.__icaSourceCount=0,n.hideMask(),0}),f};t.GetSourceNamesAsync=function(n){var t=this,i;return t._isMobileMode()?t._mobileNotSupportAsync("GetSourceNames"):(i=t.getSourceCount(),n?i.then(function(){return t.__sourceDetails}):i.then(function(){return t.__sourceName}))};t.GetSourceType=function(n){var t=this,f=n*1,u=0;return r.bMac&&t._driverType===Dynamsoft.EnumDWT_Driver.TWAIN_AND_ICA?(t.__icaSourceCount==-1&&(u=t.SourceCount,u<=0&&(u=0)),f>=t.__icaSourceCount?(f-=t.__icaSourceCount,t.CloseSourceManager(),t._innerFun("ImageCaptureDriverType",i.makeParams(Dynamsoft.EnumDWT_Driver.TWAIN)),t.OpenSourceManager()):(t.CloseSourceManager(),t._innerFun("ImageCaptureDriverType",i.makeParams(Dynamsoft.EnumDWT_Driver.ICA)),t.OpenSourceManager())):r.bWin&&Dynamsoft.dcp.b64bit&&t._driverType===Dynamsoft.EnumDWT_Driver.TWAIN_AND_TWAIN64&&(t.__icaSourceCount==-1&&(u=t.SourceCount,u<=0&&(u=0)),f>=t.__icaSourceCount?(f-=t.__icaSourceCount,t.CloseSourceManager(),t._innerFun("ImageCaptureDriverType",i.makeParams(Dynamsoft.EnumDWT_Driver.TWAIN64)),t.OpenSourceManager()):(t.CloseSourceManager(),t._innerFun("ImageCaptureDriverType",i.makeParams(Dynamsoft.EnumDWT_Driver.TWAIN)),t.OpenSourceManager())),t._innerFun("GetSourceType",i.makeParams(f))};t.OpenSource=function(){var n=this;return(n._resetErr(),n._isMobileMode())?n._mobileNotSupport("OpenSource"):n._innerFun("OpenSource")};t.OpenSourceManager=function(){var n=this;return(n._resetErr(),n._isMobileMode())?n._mobileNotSupport("OpenSourceManager"):n._innerFun("OpenSourceManager")};t.OpenSourceAsync=function(){var n=this;return(n._resetErr(),n._isMobileMode())?n._mobileNotSupportAsync("OpenSource"):n._innerFunV2("OpenSource")};t.OpenSourceManagerAsync=function(){var n=this;return(n._resetErr(),n._isMobileMode())?n._mobileNotSupportAsync("OpenSourceManager"):n._innerFunV2("OpenSourceManager")};t.ResetImageLayout=function(){var n=this;return(n._resetErr(),n._isMobileMode())?n._mobileNotSupport("ResetImageLayout"):n._innerFun("ResetImageLayout")};t.RewindPage=function(){var n=this;return(n._resetErr(),n._isMobileMode())?n._mobileNotSupport("RewindPage"):n._innerFun("RewindPage")};t.SelectSource=function(t,i){var r=this;return(r._resetErr(),r._isMobileMode())?r._mobileNotSupport("SelectSource",i):n.isUndefined(t)?r._driverType==Dynamsoft.EnumDWT_Driver.TWAIN_AND_TWAIN64?(n.Errors.SelectSourceMustAsync(r),!1):r._innerFun("SelectSource"):(r.SelectSourceAsync().then(t,function(){n.isFunction(i)&&i(r.ErrorCode,r.ErrorString)}),!0)};t.SelectSourceAsync=function(t){var u=this;return(u._resetErr(),u._isMobileMode())?u._mobileNotSupportAsync("SelectSource"):t?u._innerFunV2("SelectSource",i.makeParams(t)):u.getSourceCount().then(function(t){var i,s,e,o,h,c,l;if(t<=0)return s=f.CustomizableDisplayInfo.dialogText.selectSource[3],alert(s),n.Promise.reject(s);if(!n.dialog.selectsourcedlg){for(e=document.createElement("dialog"),h=-1,e.className="dynamsoft-dialog-selectsource",e.style.top="20%",(r.bIE||r.bEdge)&&(e.style.width="300px"),e.setAttribute("closed","closed"),o=[],o.push('<ul id="dynamsoft-dialog-selectsource-sourcelist-ul">'),i=0;i<u.__sourceCount;i++)c="",(u.__defaultSourceName==""&&i==0||u.__defaultSourceName==u.__sourceName[i])&&(c='class="dynamsoft-dialog-selectsource-sourcelist-li-selected"',h=i),o.push("<li "+c+' onclick="Dynamsoft.dialog_selectsource_li_click(this);" sourceindex='+i+">"+u.__sourceName[i]+"<\/li>");o.push("<\/ul>");o=o.join("");l=["<p>",f.CustomizableDisplayInfo.dialogText.selectSource[0],"<\/p>",'<div id="dynamsoft-dialog-selectsource-sourcelist">',o,"<\/div>",'<div id="dynamsoft-dialog-selectsource-buttons"><input type="button" value="',f.CustomizableDisplayInfo.dialogText.selectSource[1],'" onclick="Dynamsoft.dialog_selectsource_select()">','<input type="button" value="',f.CustomizableDisplayInfo.dialogText.selectSource[2],'" onclick="Dynamsoft.dialog_selectsource_cancel()"><\/div>'].join("");e.innerHTML=l;n.dialog.selectsourcedlg=e;document.body.appendChild(n.dialog.selectsourcedlg);n.get("dynamsoft-dialog-selectsource-sourcelist-ul").setAttribute("selectedSourceIndex",h.toString());n.dialog.setup(n.dialog.selectsourcedlg)}return n.dialog.selectsourcedlg.showModal(),window.Dynamsoft.dialog_selectsource_li_click=function(t){for(var u=t.attributes.sourceindex.value,r=t.parentElement.children,i=0;i<r.length;i++)r[i].className="";t.className="dynamsoft-dialog-selectsource-sourcelist-li-selected";n.get("dynamsoft-dialog-selectsource-sourcelist-ul").setAttribute("selectedSourceIndex",u)},new n.Promise(function(t,i){window.Dynamsoft.dialog_selectsource_select=function(){var i=parseInt(Dynamsoft.Lib.get("dynamsoft-dialog-selectsource-sourcelist-ul").attributes.selectedSourceIndex.value);u.SelectSourceByIndexAsync(i).then(function(){n.dialog.selectsourcedlg.close();document.body.removeChild(n.dialog.selectsourcedlg);n.dialog.selectsourcedlg=!1;t(i)})};window.Dynamsoft.dialog_selectsource_cancel=function(){n.dialog.selectsourcedlg.close();document.body.removeChild(n.dialog.selectsourcedlg);n.dialog.selectsourcedlg=!1;i({code:-1032,message:"User cancelled the operation."})}})})};t.SelectSourceByIndex=function(n){var t=this,f=n*1,u=0;return(t._resetErr(),t._isMobileMode())?t._mobileNotSupport("SelectSourceByIndex"):(r.bMac&&t._driverType===Dynamsoft.EnumDWT_Driver.TWAIN_AND_ICA?(t.__icaSourceCount==-1&&(u=t.SourceCount,u<=0&&(u=0)),f>=t.__icaSourceCount?(f-=t.__icaSourceCount,t.CloseSourceManager(),t._innerFun("ImageCaptureDriverType",i.makeParams(Dynamsoft.EnumDWT_Driver.TWAIN)),t.OpenSourceManager()):(t.CloseSourceManager(),t._innerFun("ImageCaptureDriverType",i.makeParams(Dynamsoft.EnumDWT_Driver.ICA)),t.OpenSourceManager())):r.bWin&&Dynamsoft.dcp.b64bit&&t._driverType===Dynamsoft.EnumDWT_Driver.TWAIN_AND_TWAIN64&&(t.__icaSourceCount==-1&&(u=t.SourceCount,u<=0&&(u=0)),f>=t.__icaSourceCount?(f-=t.__icaSourceCount,t.CloseSourceManager(),t._innerFun("ImageCaptureDriverType",i.makeParams(Dynamsoft.EnumDWT_Driver.TWAIN64)),t.OpenSourceManager()):(t.CloseSourceManager(),t._innerFun("ImageCaptureDriverType",i.makeParams(Dynamsoft.EnumDWT_Driver.TWAIN)),t.OpenSourceManager())),t._innerFun("SelectSourceByIndex",i.makeParams(f)))};t._resetImageCaptureDriverType=function(t){var u=this,f,e=t;return r.bMac&&u._driverType===Dynamsoft.EnumDWT_Driver.TWAIN_AND_ICA?(f=u.__icaSourceCount==-1?u.getSourceCount():n.Promise.resolve(u.__sourceCount),f=f.then(function(){return u.CloseSourceManagerAsync()}),t>=u.__icaSourceCount?(e-=u.__icaSourceCount,f=f.then(function(){return u._innerFunV2("ImageCaptureDriverType",i.makeParams(Dynamsoft.EnumDWT_Driver.TWAIN))})):f=f.then(function(){return u._innerFunV2("ImageCaptureDriverType",i.makeParams(Dynamsoft.EnumDWT_Driver.ICA))}),f=f.then(function(){return u.OpenSourceManagerAsync()})):r.bWin&&Dynamsoft.dcp.b64bit&&u._driverType===Dynamsoft.EnumDWT_Driver.TWAIN_AND_TWAIN64?(f=u.__icaSourceCount==-1?u.getSourceCount():n.Promise.resolve(u.__sourceCount),f=f.then(function(){return u.CloseSourceManagerAsync()}),t>=u.__icaSourceCount?(e-=u.__icaSourceCount,f=f.then(function(){return u._innerFunV2("ImageCaptureDriverType",i.makeParams(Dynamsoft.EnumDWT_Driver.TWAIN64))})):f=f.then(function(){return u._innerFunV2("ImageCaptureDriverType",i.makeParams(Dynamsoft.EnumDWT_Driver.TWAIN))}),f=f.then(function(){return u.OpenSourceManagerAsync()})):f=n.Promise.resolve(0),f.then(function(){return e})};t.GetSourceTypeAsync=function(n){var t=this,r=n*1;return(t._resetErr(),t._isMobileMode())?t._mobileNotSupportAsync("GetSourceType"):t._resetImageCaptureDriverType(r).then(function(n){return t._innerFunV2("GetSourceType",i.makeParams(n))})};t.SelectSourceByIndexAsync=function(n){var t=this,r=n*1;return(t._resetErr(),t._isMobileMode())?t._mobileNotSupportAsync("SelectSourceByIndex"):t._resetImageCaptureDriverType(r).then(function(n){return t._innerFunV2("SelectSourceByIndex",i.makeParams(n))})};t.SetFileXferInfo=function(n,t){var r=this,u,f;return(r._resetErr(),r._isMobileMode())?r._mobileNotSupport("SetFileXferInfo"):(u=Dynamsoft.navInfoSync.bFileSystem?n.replace(/<%/g,"<%25"):n,f=i.replaceLocalFilename(u),r._innerFun("SetFileXferInfo",i.makeParams(f,t)))};t.SetImageLayout=function(n,t,r,u){var f=this;return(f._resetErr(),f._isMobileMode())?f._mobileNotSupport("SetImageLayout"):f._innerFun("SetImageLayout",i.makeParams(n,t,r,u))};t.CapGet=function(){var n=this;return(n._resetErr(),n._isMobileMode())?n._mobileNotSupport("CapGet"):this._innerFun("CapGet")};t.CapGetCurrent=function(){var n=this;return(n._resetErr(),n._isMobileMode())?n._mobileNotSupport("CapGetCurrent"):this._innerFun("CapGetCurrent")};t.CapGetDefault=function(){var n=this;return(n._resetErr(),n._isMobileMode())?n._mobileNotSupport("CapGetDefault"):this._innerFun("CapGetDefault")};t.CapGetFrameBottom=function(n){var t=this;return(t._resetErr(),t._isMobileMode())?t._mobileNotSupport("CapGetFrameBottom"):this._innerFun("CapGetFrameBottom",i.makeParams(n))};t.CapGetFrameLeft=function(n){var t=this;return(t._resetErr(),t._isMobileMode())?t._mobileNotSupport("CapGetFrameLeft"):this._innerFun("CapGetFrameLeft",i.makeParams(n))};t.CapGetFrameRight=function(n){var t=this;return(t._resetErr(),t._isMobileMode())?t._mobileNotSupport("CapGetFrameRight"):this._innerFun("CapGetFrameRight",i.makeParams(n))};t.CapGetFrameTop=function(n){var t=this;return(t._resetErr(),t._isMobileMode())?t._mobileNotSupport("CapGetFrameTop"):this._innerFun("CapGetFrameTop",i.makeParams(n))};t.CapGetHelp=function(){var n=this;return(n._resetErr(),n._isMobileMode())?n._mobileNotSupport("CapGetHelp"):this._innerFun("CapGetHelp")};t.CapGetLabel=function(){var n=this;return(n._resetErr(),n._isMobileMode())?n._mobileNotSupport("CapGetLabel"):this._innerFun("CapGetLabel")};t.CapGetLabels=function(){var n=this;return(n._resetErr(),n._isMobileMode())?n._mobileNotSupport("CapGetLabels"):this._innerFun("CapGetLabels")};t.CapIfSupported=function(n){var t=this;return(t._resetErr(),t._isMobileMode())?t._mobileNotSupport("CapIfSupported"):this._innerFun("CapIfSupported",i.makeParams(n))};t.CapReset=function(){var n=this;return(n._resetErr(),n._isMobileMode())?n._mobileNotSupport("CapReset"):this._innerFun("CapReset")};t.CapSet=function(){var n=this;return(n._resetErr(),n._isMobileMode())?n._mobileNotSupport("CapSet"):this._innerFun("CapSet")};t.CapSetFrame=function(n,t,r,u,f){var e=this;return(e._resetErr(),e._isMobileMode())?e._mobileNotSupport("CapSetFrame"):this._innerFun("CapSetFrame",i.makeParams(n,t,r,u,f))};t.GetCapItems=function(n){var t=this;return(t._resetErr(),t._isMobileMode())?t._mobileNotSupport("GetCapItems"):this._innerFun("GetCapItems",i.makeParams(n))};t.GetCapItemsString=function(n){var t=this;return(t._resetErr(),t._isMobileMode())?t._mobileNotSupport("GetCapItemsString"):this._innerFun("GetCapItemsString",i.makeParams(n))};t.SetCapItems=function(n,t){var r=this;return(r._resetErr(),r._isMobileMode())?r._mobileNotSupport("SetCapItems"):this._innerFun("SetCapItems",i.makeParams(n,t))};t.SetCapItemsString=function(n,t){var r=this;return(r._resetErr(),r._isMobileMode())?r._mobileNotSupport("SetCapItemsString"):this._innerFun("SetCapItemsString",i.makeParams(n,t))};t.GenerateURLForUploadData=function(t,i,r,u,f){var e=this,o=[],c,s,h,a,l;if(i==EnumDWT_ImageType.IT_BMP||i==EnumDWT_ImageType.IT_JPG||i==EnumDWT_ImageType.IT_PNG){if(!n.isArray(t))return n.Errors.IndicesNotArray(e),n.isFunction(u)&&u(e.ErrorCode,e.ErrorString,"",t,i),"";if(t.length>1)return n.Errors.UploadIndexMoreThanOne(e),n.isFunction(u)&&u(e.ErrorCode,e.ErrorString,"",t,i),"";if(!e._checkIndices(t))return u(e.ErrorCode,e.ErrorString,"",t,i),!1;c=e._ImgManager.convertClientIndexToServerId(t[0]);c!=-1&&o.push(c)}else if(i==EnumDWT_ImageType.IT_TIF||i==EnumDWT_ImageType.IT_PDF){if(n.isArray(t)){if(!e._checkIndices(t))return u(e.ErrorCode,e.ErrorString,"",t,i),!1;s=t}else if(t==-1)for(s=[],h=0;h<e._ImgManager.count();h++)s.push(h);else return n.Errors.IndicesNotArray(e),n.isFunction(u)&&u(e.ErrorCode,e.ErrorString,e.__HTTPPostResponseString,t,i),"";n.each(s,function(n){var t=e._ImgManager.convertClientIndexToServerId(n);t!=-1&&o.push(t)})}else return n.isArray(t)?n.Errors.InvalidImageType(e):n.Errors.IndicesNotArray(e),n.isFunction(u)&&u(e.ErrorCode,e.ErrorString,e.__HTTPPostResponseString,t,i),"";return n.isFunction(r)&&n.isFunction(u)?(a=function(n,t){r(n,t,i)},l=function(n){u(e.ErrorCode,e.ErrorString,e.__HTTPPostResponseString,n,i)},e._asyncGenerateURLForUploadData(o,i,f,r,l),!0):this._syncGenerateURLForUploadData(o,i,f)};t._syncGenerateURLForUploadData=function(t,i,r){var o=this,u,e=!1,s=Dynamsoft.dcp.managerVersion.join(""),f=r,h=",",c,l,a,v;return(n.isString(f)&&f!=""||(f="",h=""),c=["[",'"dcp","dwasm_'+s,'",',i,',"',t.join(","),'"',h,f,"]"].join(""),u=this._innerFunRaw("GenerateURLForUploadData",c,!1,!1,!0),u&&n.isArray(u.result)&&u.result.length>1&&(l=u.result[0],a=u.result[1],l==!0&&(e=["dcp://dwasm_",s,"/file/",a].join(""))),v=[],n.isArray(t)&&n.each(t,function(n){var t=o._ImgManager.convertServerIdToClientIndex(n);t>-1&&v.push(t)}),e==!1)?(n.Errors.GenerateURL_InvalidRetFromServer(o),""):e};t._asyncGenerateURLForUploadData=function(t,i,r,u,f){var e=this,o=i,s=function(){if(n.isFunction(f)){var i=[];n.isArray(t)&&n.each(t,function(n){var t=e._ImgManager.convertServerIdToClientIndex(n);t>-1&&i.push(t)});f(i)}return""},l=",",v;if(o==EnumDWT_ImageType.IT_BMP||o==EnumDWT_ImageType.IT_JPG||o==EnumDWT_ImageType.IT_PNG){if(t.length>1)return n.Errors.UploadIndexMoreThanOne(e),s(),""}else if(o!=EnumDWT_ImageType.IT_TIF&&o!=EnumDWT_ImageType.IT_PDF)return n.Errors.InvalidImageType(e),s(),"";var h=!1,a=Dynamsoft.dcp.managerVersion.join(""),c=r;return n.isString(c)&&c!=""||(c="",l=""),v=["[",'"dcp","dwasm_'+a,'",',o,',"',t.join(","),'"',l,c,"]"].join(""),this._innerFunRaw("GenerateURLForUploadData",v,!0,!1,!0,function(r){var o,c,f;return(r&&n.isArray(r.result)&&r.result.length>0?(o=r.result[0],o==!0&&r.result.length>1?(c=r.result[1],h=["dcp://dwasm_",a,"/file/",c].join("")):r.exception!==undefined&&r.description!==undefined?(e._errorCode=r.exception,e._errorString=r.description):n.Errors.GenerateURL_InvalidRetFromServer(e)):n.Errors.GenerateURL_InvalidRetFromServer(e),h==!1)?(s(),""):(n.isFunction(u)&&(f=[],n.isArray(t)&&n.each(t,function(n){var t=e._ImgManager.convertServerIdToClientIndex(n);t>-1&&f.push(t)}),u(h,f,i)),h)},s)}}});Dynamsoft.Ready(function(n){var u=Dynamsoft;if(n.product.bHTML5Edition){var r=n.html5.STwain,i=r.prototype,t=n.html5.Funs;i.AddText=function(i,r,u,f,e,o,s,h){var c=this,l;if(c._resetErr(),c._isMobileMode())return c._mobileNotSupport("AddText");if(l=parseInt(i),isNaN(l)||l<0||l>=c._ImgManager.count())return n.Errors.IndexOutOfRange(c),!1;var v=n.RGB2BGR(e),y=n.RGB2BGR(o),a=c._ImgManager.convertClientIndexToServerId(l);return a==-1?(n.Errors.IndexOutOfRange(c),!1):c._innerFun("AddText",t.makeParams(a,r,u,f,v,y,s,h))};i.CreateTextFont=function(n,i,r,u,f,e,o,s,h,c,l,a,v,y){var p=this;return(p._resetErr(),p._isMobileMode())?p._mobileNotSupport("CreateTextFont"):this._innerFun("CreateTextFont",t.makeParams(n,i,r,u,f,e,o,s,h,c,l,a,v,y))};i.CopyToClipboard=function(i){var r=this,u,f;return(r._resetErr(),r._isMobileMode())?r._mobileNotSupport("CopyToClipboard"):(u=parseInt(i),isNaN(u)||u<0||u>=r._ImgManager.count())?(n.Errors.IndexOutOfRange(r),!1):(f=r._ImgManager.convertClientIndexToServerId(u),f==-1)?(n.Errors.IndexOutOfRange(r),!1):r._innerFun("CopyToClipboard",t.makeParams(f))};i.CopyToClipboardAsync=function(i){var r=this,u,f;return(r._resetErr(),r._isMobileMode())?r._mobileNotSupportAsync("CopyToClipboard"):(u=parseInt(i),isNaN(u)||u<0||u>=r._ImgManager.count())?(n.Errors.IndexOutOfRange(r),n.Promise.reject({code:r._errorCode,message:r._errorString})):(f=r._ImgManager.convertClientIndexToServerId(u),f==-1)?(n.Errors.IndexOutOfRange(r),n.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("CopyToClipboard",t.makeParams(f))};i._asyncErase=function(i,r,u,f,e,o,s){var c=this,l=function(){t.refreshImageAfterInvokeFun(c,i);n.isFunction(o)&&setTimeout(o,30)},a=function(){n.isFunction(s)&&s(c.ErrorCode,c.ErrorString)},v=parseInt(i),h=c.__BackgroundFillColor;return n.isUndef(h)?h="FFFFFF":n.isNumber(h)?h=h.toString(16):n.isString(h)&&(h=h.replace("#","")),c._innerSendToMobile("Erase",Dynamsoft.Lib.MobileFuns.makeParams(v,r,u,f,e,h),0,l,a)};i.Erase=function(i,r,u,f,e,o,s){var h=this,c,v,l,a;return(h._resetErr(),c=parseInt(i),isNaN(c)||c<0||c>=h._ImgManager.count())?(n.Errors.IndexOutOfRange(h),n.isFunction(s)&&s(h.ErrorCode,h.ErrorString),!1):h._isMobileMode()?h._asyncErase(c,r,u,f,e,o,s):(a=h._ImgManager.convertClientIndexToServerId(c),a==-1)?(n.Errors.IndexOutOfRange(h),n.isFunction(s)&&s(h.ErrorCode,h.ErrorString),!1):(h.SetSelectedImageArea(i,0,0,0,0),v=h._innerFun("Erase",t.makeParams(a,r,u,f,e)),l=v==1,l?n.isFunction(o)&&o():n.isFunction(s)&&s(h.ErrorCode,h.ErrorString),l)};i.GetImageBitDepth=function(i){var r=this,u,e,f;return(r._resetErr(),u=parseInt(i),isNaN(u)||u<0||u>=r._ImgManager.count())?(n.Errors.IndexOutOfRange(r),!1):r._isMobileMode()?(e=r._ImgManager._UIView.GetMetaDataByIndex(u),e.imageBitDepth):(f=r._ImgManager.convertClientIndexToServerId(u),f==-1)?(n.Errors.IndexOutOfRange(r),!1):r._innerFun("GetImageBitDepth",t.makeParams(f))};i.GetImageWidth=function(i){var r=this,u,e,f;return(r._resetErr(),u=parseInt(i),isNaN(u)||u<0||u>=r._ImgManager.count())?(n.Errors.IndexOutOfRange(r),!1):r._isMobileMode()?(e=r._ImgManager._UIView.GetMetaDataByIndex(u),e.imageWidth):(f=r._ImgManager.convertClientIndexToServerId(u),f==-1)?(n.Errors.IndexOutOfRange(r),!1):r._innerFun("GetImageWidth",t.makeParams(f))};i.GetImageHeight=function(i){var r=this,u,e,f;return(r._resetErr(),u=parseInt(i),isNaN(u)||u<0||u>=r._ImgManager.count())?(n.Errors.IndexOutOfRange(r),!1):r._isMobileMode()?(e=r._ImgManager._UIView.GetMetaDataByIndex(u),e.imageHeight):(f=r._ImgManager.convertClientIndexToServerId(u),f==-1)?(n.Errors.IndexOutOfRange(r),!1):r._innerFun("GetImageHeight",t.makeParams(f))};i.GetImageSize=function(i,r,u){var f=this,e,o;return(f._resetErr(),f._isMobileMode())?f._mobileNotSupport("GetImageSize"):(e=parseInt(i),isNaN(e)||e<0||e>=f._ImgManager.count())?(n.Errors.IndexOutOfRange(f),!1):(o=f._ImgManager.convertClientIndexToServerId(e),o==-1)?(n.Errors.IndexOutOfRange(f),!1):f._innerFun("GetImageSize",t.makeParams(o,r,u))};i.GetImageSizeWithSpecifiedType=function(i,r){var u=this,f,e;return(u._resetErr(),u._isMobileMode())?u._mobileNotSupport("GetImageSizeWithSpecifiedType"):(f=parseInt(i),isNaN(f)||f<0||f>=u._ImgManager.count())?(n.Errors.IndexOutOfRange(u),!1):(e=u._ImgManager.convertClientIndexToServerId(f),e==-1)?(n.Errors.IndexOutOfRange(u),!1):u._innerFun("GetImageSizeWithSpecifiedType",t.makeParams(e,r))};i.GetImageXResolution=function(i){var r=this,u,e,f;return(r._resetErr(),u=parseInt(i),isNaN(u)||u<0||u>=r._ImgManager.count())?(n.Errors.IndexOutOfRange(r),!1):r._isMobileMode()?(e=r._ImgManager._UIView.GetMetaDataByIndex(u),e.imageXResolution):(f=r._ImgManager.convertClientIndexToServerId(u),f==-1)?(n.Errors.IndexOutOfRange(r),!1):r._innerFun("GetImageXResolution",t.makeParams(f))};i.GetImageYResolution=function(i){var r=this,u,e,f;return(r._resetErr(),u=parseInt(i),isNaN(u)||u<0||u>=r._ImgManager.count())?(n.Errors.IndexOutOfRange(r),!1):r._isMobileMode()?(e=r._ImgManager._UIView.GetMetaDataByIndex(u),e.imageYResolution):(f=r._ImgManager.convertClientIndexToServerId(u),f==-1)?(n.Errors.IndexOutOfRange(r),!1):r._innerFun("GetImageYResolution",t.makeParams(f))};i.GetSelectedImageIndex=function(n){var t=this,i;return(t._resetErr(),n>=0)?(i=t._ImgManager.getSelectedClientIndexArray(),i[n]):-1};i.SelectAllImages=function(){var t=this,r=t.HowManyImagesInBuffer,n,i=[];for(t._resetErr(),n=0;n<r;n++)i.push(n);return t._ImgManager.SetSelectedClientIndexArray(i),i};i.SelectImages=function(n){var t=this;return t._resetErr(),t._ImgManager.SetSelectedClientIndexArray(n)};i.SetSelectedImageIndex=function(t,i){var r=this,u;return r._resetErr(),u=r._ImgManager.GetSelectedImageCount(),t<u&&t>=0?r._ImgManager.SetSelectedImageIndex(t,i):(n.Errors.InvalidIndex(r),!1)};i._asyncGetSkewAngle=function(i,r,u){var f=this,e=function(u){t.refreshImageAfterInvokeFun(f,i);n.isFunction(r)&&setTimeout(function(){r(u)},30)},o=function(){n.isFunction(u)&&u(f.ErrorCode,f.ErrorString)},s=parseInt(i);return f._innerSendToMobile("GetSkewAngle",Dynamsoft.Lib.MobileFuns.makeParams(s),0,e,o)};i.GetSkewAngle=function(i,r,u){var f=this,o,e,s;if(f._resetErr(),e=parseInt(i),isNaN(e)||e<0||e>=f._ImgManager.count())return n.Errors.IndexOutOfRange(f),n.isFunction(u)&&u(f.ErrorCode,f.ErrorString),!1;if(f._isMobileMode())return f._asyncGetSkewAngle(e,r,u);if(s=f._ImgManager.convertClientIndexToServerId(e),s==-1)return n.Errors.IndexOutOfRange(f),n.isFunction(u)&&u(f.ErrorCode,f.ErrorString),!1;if(o=f._innerFun("GetSkewAngle",t.makeParams(s)),f.ErrorCode==0)if(t.refreshImageAfterInvokeFun(f,e),n.isFunction(r))r(o);else return o;else n.isFunction(u)&&u(f.ErrorCode,f.ErrorString);return!0};i.GetSkewAngleEx=function(i,r,u,f,e){var o=this,s,h;return(o._resetErr(),o._isMobileMode())?o._mobileNotSupport("GetSkewAngleEx"):(s=parseInt(i),isNaN(s)||s<0||s>=o._ImgManager.count())?(n.Errors.IndexOutOfRange(o),!1):(h=o._ImgManager.convertClientIndexToServerId(s),h==-1)?(n.Errors.IndexOutOfRange(o),!1):o._innerFun("GetSkewAngleEx",t.makeParams(h,r,u,f,e))};i.IsBlankImageEx=function(i,r,u,f,e,o){var s=this,h=parseInt(i),c;return isNaN(h)||h<0||h>=s._ImgManager.count()?(n.Errors.IndexOutOfRange(s),!1):(c=s._ImgManager.convertClientIndexToServerId(h),c==-1)?(n.Errors.IndexOutOfRange(s),!1):s._innerFun("IsBlankImageEx",t.makeParams(c,r,u,f,e,o))};i.MirrorAsync=function(i){var r=this,u,f;return(r._resetErr(),u=parseInt(i),isNaN(u)||u<0||u>=r._ImgManager.count())?(n.Errors.IndexOutOfRange(r),n.Promise.reject({code:r._errorCode,message:r._errorString})):r._isMobileMode()?r._innerSendToMobileV2("Mirror",Dynamsoft.Lib.MobileFuns.makeParams(u)).then(function(){t.refreshImageAfterInvokeFun(r,u)}):(f=r._ImgManager.convertClientIndexToServerId(u),f==-1)?(n.Errors.IndexOutOfRange(r),n.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("Mirror",t.makeParams(f)).then(function(n){if(n==1)t.refreshImageAfterInvokeFun(r,u);else throw{code:r._errorCode,message:r._errorString};})};i.Mirror=function(i,r,u){var f=this,e,o,h,s;return(f._resetErr(),e=parseInt(i),isNaN(e)||e<0||e>=f._ImgManager.count())?(n.Errors.IndexOutOfRange(f),n.isFunction(u)&&u(f.ErrorCode,f.ErrorString),!1):f._isMobileMode()?(f._innerSendToMobileV2("Mirror",Dynamsoft.Lib.MobileFuns.makeParams(e)).then(function(){t.refreshImageAfterInvokeFun(f,e);r&&r()},function(){n.isFunction(u)&&u(f.ErrorCode,f.ErrorString)}),!0):(o=f._ImgManager.convertClientIndexToServerId(e),o==-1)?(n.Errors.IndexOutOfRange(f),n.isFunction(u)&&u(f.ErrorCode,f.ErrorString),!1):(h=f._innerFun("Mirror",t.makeParams(o)),s=h==1,s?(t.refreshImageAfterInvokeFun(f,e),n.isFunction(r)&&r()):n.isFunction(u)&&u(f.ErrorCode,f.ErrorString),s)};i.RemoveAllImages=function(){var n=this,i=!0,f=n._isMobileMode(),e,h,r;if(n._resetErr(),e=n._ImgManager.GetCurrentTag(),e==""||e=="All")f?n._OnBitmapChanged(["10","-1",3,-1,0]):(i=n._innerFun("RemoveAllImages"),(i||n._errorCode==-1033)&&n._OnBitmapChanged(["0","-1",3,-1,0]));else{var u,c=function(){},l=function(){},o=[],s="0";for(f&&(s="10"),h=n.HowManyImagesInBuffer,u=h-1;u>=0;u--)r=n._ImgManager.convertClientIndexToServerId(u),r>-1&&(f?o.push(r):(i=n._innerFunRaw("RemoveImage",t.makeParams(r),!0,!1,!0,c,l),(i||n._errorCode==-1033)&&o.push(r)));n._OnBitmapChanged([s,o.join(","),3,n._ImgManager.getCurrentImageIndex(),n._ImgManager.count()])}return i};i.RemoveImage=function(i){var r=this,u,e,f;return(r._resetErr(),u=parseInt(i),e=!0,isNaN(u)||u<0||u>=r._ImgManager.count())?(n.Errors.IndexOutOfRange(r),!1):(f=r._ImgManager.convertClientIndexToServerId(u),f==-1)?(n.Errors.IndexOutOfRange(r),!1):(r._isMobileMode()?r._OnBitmapChanged(["10",""+f,3,r._ImgManager.getCurrentImageIndex(),r._ImgManager.count()]):(e=r._innerFun("RemoveImage",t.makeParams(f)),(e||r._errorCode==-1033)&&r._OnBitmapChanged(["0",""+f,3,r._ImgManager.getCurrentImageIndex(),r._ImgManager.count()])),e)};i.RemoveAllImagesAsync=function(){var i=this,e,r,f,u,h,o,s;if(i._resetErr(),e=i._ImgManager.GetCurrentTag(),e==""||e=="All")return i._isMobileMode()?(i._OnBitmapChanged(["10","-1",3,-1,0]),n.Promise.resolve(!0)):i._innerFunV2("RemoveAllImages").then(function(n){return n||i._errorCode==-1033?(i._OnBitmapChanged(["0","-1",3,-1,0]),!0):!1});for(f=[],h=i.HowManyImagesInBuffer,r=0;r<h;r++)o=i._ImgManager.convertClientIndexToServerId(r),o>-1&&f.push(o);if(i._isMobileMode())u=n.Promise.resolve(f.join(","));else{for(s=[],u=n.Promise.resolve(0),r=0;r<f.length;r++)u=u.then(function(n){return i._innerFunRawV2("RemoveImage",t.makeParams(f[n])).then(function(t){return(t||i._errorCode==-1033)&&s.push(f[n]),n++})});u=u.then(function(){return s.join(",")})}return u.then(function(n){var t="0";i._isMobileMode()&&(t="10");n!=""&&i._OnBitmapChanged([t,n,3,i._ImgManager.getCurrentImageIndex(),i._ImgManager.count()])})};i.RemoveImageAsync=function(i){var r=this,u,f;return(r._resetErr(),u=parseInt(i),isNaN(u)||u<0||u>=r._ImgManager.count())?(n.Errors.IndexOutOfRange(r),n.Promise.reject({code:r._errorCode,message:r._errorString})):(f=r._ImgManager.convertClientIndexToServerId(u),f==-1)?(n.Errors.IndexOutOfRange(r),n.Promise.reject({code:r._errorCode,message:r._errorString})):r._isMobileMode()?(r._OnBitmapChanged(["10",""+f,3,r._ImgManager.getCurrentImageIndex(),r._ImgManager.count()]),n.Promise.resolve(!0)):r._innerFunV2("RemoveImage",t.makeParams(f)).then(function(n){return n||r._errorCode==-1033?(r._OnBitmapChanged(["0",""+f,3,r._ImgManager.getCurrentImageIndex(),r._ImgManager.count()]),!0):!1})};i._removeImageById=function(i,r,u){var f=this,e=function(){f._OnBitmapChanged(["0",""+i,3,f._ImgManager.getCurrentImageIndex(),f._ImgManager.count()]);n.isFunction(r)&&r()};return f._innerFunRaw("RemoveImage",t.makeParams(i),!0,!1,!0,e,u)};i._asyncRotateEx=function(i,r,u,f){var o=this,s=parseInt(i),e=o.__BackgroundFillColor;return n.isUndef(e)?e="FFFFFF":n.isNumber(e)?e="0x"+e.toString(16):n.isString(e)&&(e=e.replace("#","")),o._innerSendToMobileV2("RotateEx",Dynamsoft.Lib.MobileFuns.makeParams(s,r,u,f,e)).then(function(){t.refreshImageAfterInvokeFun(o,i)})};i.Rotate=function(i,r,u,f,e){var o=this,s,l,h,c;return(o._resetErr(),s=parseInt(i),isNaN(s)||s<0||s>=o._ImgManager.count())?(n.Errors.IndexOutOfRange(o),n.isFunction(e)&&e(o.ErrorCode,o.ErrorString),!1):o._isMobileMode()?(o._asyncRotateEx(s,r,u,-1).then(f,function(){n.isFunction(e)&&e(o.ErrorCode,o.ErrorString)}),!0):(c=o._ImgManager.convertClientIndexToServerId(s),c==-1)?(n.Errors.IndexOutOfRange(o),n.isFunction(e)&&e(o.ErrorCode,o.ErrorString),!1):(l=o._innerFun("Rotate",t.makeParams(c,r,u)),h=l==1,h?(t.refreshImageAfterInvokeFun(o,s),n.isFunction(f)&&f()):n.isFunction(e)&&e(o.ErrorCode,o.ErrorString),h)};i.RotateEx=function(i,r,u,f,e,o){var s=this,h,a,c,l;return(s._resetErr(),h=parseInt(i),isNaN(h)||h<0||h>=s._ImgManager.count())?(n.Errors.IndexOutOfRange(s),n.isFunction(o)&&o(s.ErrorCode,s.ErrorString),!1):s._isMobileMode()?(s._asyncRotateEx(h,r,u,f).then(e,function(){n.isFunction(o)&&o(s.ErrorCode,s.ErrorString)}),!0):(l=s._ImgManager.convertClientIndexToServerId(h),l==-1)?(n.Errors.IndexOutOfRange(s),n.isFunction(o)&&o(s.ErrorCode,s.ErrorString),!1):(a=s._innerFun("RotateEx",t.makeParams(l,r,u,f)),c=a==1,c?(t.refreshImageAfterInvokeFun(s,h),n.isFunction(e)&&e()):n.isFunction(o)&&o(s.ErrorCode,s.ErrorString),c)};i.RotateLeft=function(i,r,u){var f=this,e,h,o,s;return(f._resetErr(),e=parseInt(i),isNaN(e)||e<0||e>=f._ImgManager.count())?(n.Errors.IndexOutOfRange(f),n.isFunction(u)&&u(f.ErrorCode,f.ErrorString),!1):f._isMobileMode()?(f._asyncRotateEx(e,-90,!0,-1).then(r,function(){n.isFunction(u)&&u(f.ErrorCode,f.ErrorString)}),!0):(s=f._ImgManager.convertClientIndexToServerId(e),s==-1)?(n.Errors.IndexOutOfRange(f),n.isFunction(u)&&u(f.ErrorCode,f.ErrorString),!1):(h=f._innerFun("RotateLeft",t.makeParams(s)),o=h==1,o?(t.refreshImageAfterInvokeFun(f,e),n.isFunction(r)&&r()):n.isFunction(u)&&u(f.ErrorCode,f.ErrorString),o)};i.RotateRight=function(i,r,u){var f=this,e,h,o,s;return(f._resetErr(),e=parseInt(i),isNaN(e)||e<0||e>=f._ImgManager.count())?(n.Errors.IndexOutOfRange(f),n.isFunction(u)&&u(f.ErrorCode,f.ErrorString),!1):f._isMobileMode()?(f._asyncRotateEx(e,90,!0,-1).then(r,function(){n.isFunction(u)&&u(f.ErrorCode,f.ErrorString)}),!0):(s=f._ImgManager.convertClientIndexToServerId(e),s==-1)?(n.Errors.IndexOutOfRange(f),n.isFunction(u)&&u(f.ErrorCode,f.ErrorString),!1):(h=f._innerFun("RotateRight",t.makeParams(s)),o=h==1,o?(t.refreshImageAfterInvokeFun(f,e),n.isFunction(r)&&r()):n.isFunction(u)&&u(f.ErrorCode,f.ErrorString),o)};i.RotateAsync=function(i,r,u){var f=this,e,o;return(f._resetErr(),e=parseInt(i),isNaN(e)||e<0||e>=f._ImgManager.count())?(n.Errors.IndexOutOfRange(f),n.Promise.reject({code:f._errorCode,message:f._errorString})):f._isMobileMode()?f._asyncRotateEx(e,r,u,-1):(o=f._ImgManager.convertClientIndexToServerId(e),o==-1)?(n.Errors.IndexOutOfRange(f),n.Promise.reject({code:f._errorCode,message:f._errorString})):f._innerFunV2("Rotate",t.makeParams(o,r,u)).then(function(n){if(n==1)t.refreshImageAfterInvokeFun(f,e);else throw{code:f._errorCode,message:f._errorString};})};i.RotateExAsync=function(i,r,u,f){var e=this,o,s;return(e._resetErr(),o=parseInt(i),isNaN(o)||o<0||o>=e._ImgManager.count())?(n.Errors.IndexOutOfRange(e),n.Promise.reject({code:e._errorCode,message:e._errorString})):e._isMobileMode()?e._asyncRotateEx(o,r,u,f):(s=e._ImgManager.convertClientIndexToServerId(o),s==-1)?(n.Errors.IndexOutOfRange(e),n.Promise.reject({code:e._errorCode,message:e._errorString})):e._innerFunV2("RotateEx",t.makeParams(s,r,u,f)).then(function(n){if(n==1)t.refreshImageAfterInvokeFun(e,o);else throw{code:e._errorCode,message:e._errorString};})};i.RotateLeftAsync=function(i){var r=this,u,f;return(r._resetErr(),u=parseInt(i),isNaN(u)||u<0||u>=r._ImgManager.count())?(n.Errors.IndexOutOfRange(r),n.Promise.reject({code:r._errorCode,message:r._errorString})):r._isMobileMode()?r._asyncRotateEx(u,-90,!0,-1):(f=r._ImgManager.convertClientIndexToServerId(u),f==-1)?(n.Errors.IndexOutOfRange(r),n.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("RotateLeft",t.makeParams(f)).then(function(n){if(n==1)t.refreshImageAfterInvokeFun(r,u);else throw{code:r._errorCode,message:r._errorString};})};i.RotateRightAsync=function(i){var r=this,u,f;return(r._resetErr(),u=parseInt(i),isNaN(u)||u<0||u>=r._ImgManager.count())?(n.Errors.IndexOutOfRange(r),n.Promise.reject({code:r._errorCode,message:r._errorString})):r._isMobileMode()?r._asyncRotateEx(u,90,!0,-1):(f=r._ImgManager.convertClientIndexToServerId(u),f==-1)?(n.Errors.IndexOutOfRange(r),n.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("RotateRight",t.makeParams(f)).then(function(n){if(n==1)t.refreshImageAfterInvokeFun(r,u);else throw{code:r._errorCode,message:r._errorString};})};i._asyncChangeImageSize=function(n,i,r,u){var f=this,e=parseInt(n),o=parseInt(i),s=parseInt(r);return f._innerSendToMobileV2("ChangeImageSize",Dynamsoft.Lib.MobileFuns.makeParams(e,o,s,u)).then(function(){t.refreshImageAfterInvokeFun(f,n)})};i.ChangeImageSize=function(i,r,u,f,e,o){var s=this,h=parseInt(i),a=1*r,v=1*u,y,c,l;return(s._resetErr(),isNaN(h)||h<0||h>=s._ImgManager.count())?(n.Errors.IndexOutOfRange(s),n.isFunction(o)&&o(s.ErrorCode,s.ErrorString),!1):a<=0||v<=0?(n.Errors.InvalidWidthOrHeight(s),n.isFunction(o)&&o(s.ErrorCode,s.ErrorString),!1):s._isMobileMode()?(s._asyncChangeImageSize(h,r,u,f).then(e,function(){n.isFunction(o)&&o(s.ErrorCode,s.ErrorString)}),!0):(l=s._ImgManager.convertClientIndexToServerId(h),l==-1)?(n.Errors.IndexOutOfRange(s),n.isFunction(o)&&o(s.ErrorCode,s.ErrorString),!1):(y=s._innerFun("ChangeImageSize",t.makeParams(l,a,v,f)),c=y==1,c?(t.refreshImageAfterInvokeFun(s,h),n.isFunction(e)&&e()):n.isFunction(o)&&o(s.ErrorCode,s.ErrorString),c)};i.ChangeImageSizeAsync=function(i,r,u,f){var e=this,o=parseInt(i),h=1*r,c=1*u,s;return(e._resetErr(),isNaN(o)||o<0||o>=e._ImgManager.count())?(n.Errors.IndexOutOfRange(e),n.Promise.reject({code:e._errorCode,message:e._errorString})):h<=0||c<=0?(n.Errors.InvalidWidthOrHeight(e),n.Promise.reject({code:e._errorCode,message:e._errorString})):e._isMobileMode()?e._asyncChangeImageSize(o,r,u,f):(s=e._ImgManager.convertClientIndexToServerId(o),s==-1)?(n.Errors.IndexOutOfRange(e),n.Promise.reject({code:e._errorCode,message:e._errorString})):e._innerFunV2("ChangeImageSize",t.makeParams(s,h,c,f)).then(function(n){if(n==1)t.refreshImageAfterInvokeFun(e,o);else throw{code:e._errorCode,message:e._errorString};})};i._asyncFlip=function(n){var i=this,r=parseInt(n);return i._innerSendToMobileV2("Flip",Dynamsoft.Lib.MobileFuns.makeParams(r)).then(function(){t.refreshImageAfterInvokeFun(i,n)})};i.Flip=function(i,r,u){var f=this,e,h,o,s;return(f._resetErr(),e=parseInt(i),isNaN(e)||e<0||e>=f._ImgManager.count())?(n.Errors.IndexOutOfRange(f),n.isFunction(u)&&u(f.ErrorCode,f.ErrorString),!1):f._isMobileMode()?(f._asyncFlip(e).then(r,function(){n.isFunction(u)&&u(f.ErrorCode,f.ErrorString)}),!0):(s=f._ImgManager.convertClientIndexToServerId(e),s==-1)?(n.Errors.IndexOutOfRange(f),n.isFunction(u)&&u(f.ErrorCode,f.ErrorString),!1):(h=f._innerFun("Flip",t.makeParams(s)),o=h==1,o?(t.refreshImageAfterInvokeFun(f,e),n.isFunction(r)&&r()):n.isFunction(u)&&u(f.ErrorCode,f.ErrorString),o)};i.FlipAsync=function(i){var r=this,u,f;return(r._resetErr(),u=parseInt(i),isNaN(u)||u<0||u>=r._ImgManager.count())?(n.Errors.IndexOutOfRange(r),n.Promise.reject({code:r._errorCode,message:r._errorString})):r._isMobileMode()?r._asyncFlip(u):(f=r._ImgManager.convertClientIndexToServerId(u),f==-1)?(n.Errors.IndexOutOfRange(r),n.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("Flip",t.makeParams(f)).then(function(n){if(n==1)t.refreshImageAfterInvokeFun(r,u);else throw{code:r._errorCode,message:r._errorString};})};i._asyncCrop=function(n,i,r,u,f){var e=this,o=parseInt(n);return e._innerSendToMobileV2("Crop",Dynamsoft.Lib.MobileFuns.makeParams(o,i,r,u,f)).then(function(){t.refreshImageAfterInvokeFun(e,n);var i,r;i=e.ErrorCode;r=e.ErrorString;e.SetSelectedImageArea(n,0,0,0,0);e._errorCode=i;e._errorString=r})};i.Crop=function(i,r,u,f,e,o,s){var h=this,c,p,l,a,v,y;return(h._resetErr(),c=parseInt(i),isNaN(c)||c<0||c>=h._ImgManager.count())?(n.Errors.IndexOutOfRange(h),n.isFunction(s)&&s(h.ErrorCode,h.ErrorString),!1):h._isMobileMode()?(h._asyncCrop(c,r,u,f,e).then(o,function(){n.isFunction(s)&&s(h.ErrorCode,h.ErrorString)}),!0):(a=h._ImgManager.convertClientIndexToServerId(c),a==-1)?(n.Errors.IndexOutOfRange(h),n.isFunction(s)&&s(h.ErrorCode,h.ErrorString),!1):(p=h._innerFun("Crop",t.makeParams(a,r,u,f,e)),l=p==1,v=h.ErrorCode,y=h.ErrorString,h.SetSelectedImageArea(i,0,0,0,0),h._errorCode=v,h._errorString=y,l?(t.refreshImageAfterInvokeFun(h,c),n.isFunction(o)&&o()):n.isFunction(s)&&s(v,y),l)};i.CropAsync=function(i,r,u,f,e){var o=this,s,h;return(o._resetErr(),s=parseInt(i),isNaN(s)||s<0||s>=o._ImgManager.count())?(n.Errors.IndexOutOfRange(o),n.Promise.reject({code:o._errorCode,message:o._errorString})):o._isMobileMode()?o._asyncCrop(s,r,u,f,e):(h=o._ImgManager.convertClientIndexToServerId(s),h==-1)?(n.Errors.IndexOutOfRange(o),n.Promise.reject({code:o._errorCode,message:o._errorString})):o._innerFunV2("Crop",t.makeParams(h,r,u,f,e)).then(function(n){var r,u;if(r=o.ErrorCode,u=o.ErrorString,o.SetSelectedImageArea(i,0,0,0,0),o._errorCode=r,o._errorString=u,n==1)t.refreshImageAfterInvokeFun(o,s);else throw{code:o._errorCode,message:o._errorString};return!0})};i.CropToClipboard=function(i,r,u,f,e){var o=this,s,l,h,c;return(o._resetErr(),o._isMobileMode())?o._mobileNotSupport("CropToClipboard"):(s=parseInt(i),isNaN(s)||s<0||s>=o._ImgManager.count())?(n.Errors.IndexOutOfRange(o),!1):(c=o._ImgManager.convertClientIndexToServerId(s),c==-1)?(n.Errors.IndexOutOfRange(o),!1):(l=o._innerFun("CropToClipboard",t.makeParams(c,r,u,f,e)),h=l==1,h&&t.refreshImageAfterInvokeFun(o,s),h)};i.CutFrameToClipboard=function(i,r,u,f,e){var o=this,s,l,h,c;return(o._resetErr(),o._isMobileMode())?o._mobileNotSupport("CutFrameToClipboard"):(s=parseInt(i),isNaN(s)||s<0||s>=o._ImgManager.count())?(n.Errors.IndexOutOfRange(o),!1):(c=o._ImgManager.convertClientIndexToServerId(s),c==-1)?(n.Errors.IndexOutOfRange(o),!1):(l=o._innerFun("CutFrameToClipboard",t.makeParams(c,r,u,f,e)),h=l==1,h&&t.refreshImageAfterInvokeFun(o,s),h)};i.CutToClipboard=function(i){var r=this,u,o,e,f;return(r._resetErr(),r._isMobileMode())?r._mobileNotSupport("CutToClipboard"):(u=parseInt(i),isNaN(u)||u<0||u>=r._ImgManager.count())?(n.Errors.IndexOutOfRange(r),!1):(f=r._ImgManager.convertClientIndexToServerId(u),f==-1)?(n.Errors.IndexOutOfRange(r),!1):(o=r._innerFun("CutToClipboard",t.makeParams(f)),e=o==1,e&&r._OnBitmapChanged(["0",""+f,3,r._ImgManager.getCurrentImageIndex(),r._ImgManager.count()]),e)};i.CutFrameToClipboardAsync=function(i,r,u,f,e){var o=this,s,h;return(o._resetErr(),o._isMobileMode())?o._mobileNotSupportAsync("CutFrameToClipboard"):(s=parseInt(i),isNaN(s)||s<0||s>=o._ImgManager.count())?(n.Errors.IndexOutOfRange(o),n.Promise.reject({code:o._errorCode,message:o._errorString})):(h=o._ImgManager.convertClientIndexToServerId(s),h==-1)?(n.Errors.IndexOutOfRange(o),n.Promise.reject({code:o._errorCode,message:o._errorString})):o._innerFunV2("CutFrameToClipboard",t.makeParams(h,r,u,f,e)).then(function(n){var i=n==1;if(i)t.refreshImageAfterInvokeFun(o,s);else throw{code:o._errorCode,message:o._errorString};return i})};i.CropToClipboardAsync=function(i,r,u,f,e){var o=this,s,h;return(o._resetErr(),o._isMobileMode())?o._mobileNotSupportAsync("CropToClipboard"):(s=parseInt(i),isNaN(s)||s<0||s>=o._ImgManager.count())?(n.Errors.IndexOutOfRange(o),n.Promise.reject({code:o._errorCode,message:o._errorString})):(h=o._ImgManager.convertClientIndexToServerId(s),h==-1)?(n.Errors.IndexOutOfRange(o),n.Promise.reject({code:o._errorCode,message:o._errorString})):o._innerFunV2("CropToClipboard",t.makeParams(h,r,u,f,e)).then(function(n){var i=n==1;if(i)t.refreshImageAfterInvokeFun(o,s);else throw{code:o._errorCode,message:o._errorString};return i})};i.CutToClipboardAsync=function(i){var r=this,u,f;return(r._resetErr(),r._isMobileMode())?r._mobileNotSupportAsync("CutToClipboard"):(u=parseInt(i),isNaN(u)||u<0||u>=r._ImgManager.count())?(n.Errors.IndexOutOfRange(r),n.Promise.reject({code:r._errorCode,message:r._errorString})):(f=r._ImgManager.convertClientIndexToServerId(u),f==-1)?(n.Errors.IndexOutOfRange(r),n.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("CutToClipboard",t.makeParams(f)).then(function(n){var t=n==1;if(t)r._OnBitmapChanged(["0",""+f,3,r._ImgManager.getCurrentImageIndex(),r._ImgManager.count()]);else throw{code:r._errorCode,message:r._errorString};return t})};i._asyncSetDPI=function(i,r,u,f,e,o,s,h){var c=this,y=function(){t.refreshImageAfterInvokeFun(c,i);n.isFunction(s)&&setTimeout(s,30)},p=function(){n.isFunction(h)&&h(c.ErrorCode,c.ErrorString)},w=parseInt(i),l=parseInt(u),a=parseInt(f),v=parseInt(o);return isNaN(l)||l<=0||isNaN(a)||a<=0||isNaN(v)||v<0?(n.Errors.InvalidParameter(c),n.isFunction(h)&&h(c.ErrorCode,c.ErrorString),!1):c._innerSendToMobile("SetDPI",Dynamsoft.Lib.MobileFuns.makeParams(w,l,a,e,v),0,y,p)};i.SetDPI=function(i,r,u,f,e,o,s){var h=this,v,a,c,l;return(h._resetErr(),c=parseInt(i),isNaN(c)||c<0||c>=h._ImgManager.count())?(n.Errors.IndexOutOfRange(h),n.isFunction(s)&&s(h.ErrorCode,h.ErrorString),!1):(l=h._ImgManager.convertClientIndexToServerId(c),l==-1)?(n.Errors.IndexOutOfRange(h),n.isFunction(s)&&s(h.ErrorCode,h.ErrorString),!1):h._isMobileMode()?h._asyncSetDPI(c,l,r,u,f,e,o,s):(v=h._innerFun("SetDPI",t.makeParams(l,r,u,f,e)),a=v==1,a?n.isFunction(o)&&o():n.isFunction(s)&&s(h.ErrorCode,h.ErrorString),a)};i.MoveImage=function(t,i){var r=this,u,f;return(r._resetErr(),u=parseInt(t),f=parseInt(i),isNaN(u)||u<0||u>=r._ImgManager.count()||isNaN(f)||f<0||f>=r._ImgManager.count())?(n.Errors.IndexOutOfRange(r),!1):r._ImgManager.MoveImage(u,f)};i.SwitchImage=function(t,i){var r=this,u,f;return(r._resetErr(),u=parseInt(t),f=parseInt(i),isNaN(u)||u<0||u>=r._ImgManager.count()||isNaN(f)||f<0||f>=r._ImgManager.count())?(n.Errors.IndexOutOfRange(r),!1):r._ImgManager.SwitchImage(u,f)};i.CloseWorkingProcess=function(){var n=this;return(n._resetErr(),n._isMobileMode())?n._mobileNotSupport("CloseWorkingProcess"):n._innerFun("CloseWorkerProcess")};i.RemoveAllSelectedImages=function(){var i=this,f=i._isMobileMode(),s;i._resetErr();var u=!0,e=i._ImgManager.getCurrentImageIndex(),o=i._ImgManager.getSelectedClientIndexArray(),r=[];return n.isArray(o)&&n.each(o,function(n){var t=i._ImgManager.convertClientIndexToServerId(n);t!=-1&&r.push(t)}),r.length==0&&e>=0&&(s=i._ImgManager.convertClientIndexToServerId(e),r.push(s)),f||(u=i._innerFun("RemoveAllSelectedImages",t.makeParams(r.join(",")))),u&&(f||(i._HowManyImagesInBuffer=i._innerFun("HowManyImagesInBuffer")),n.each(r,function(n){var t="0";i._isMobileMode()&&(t="10");i._OnBitmapChanged([t,""+n,3,i._ImgManager.getCurrentImageIndex(),i._ImgManager.count()])})),u};i.RemoveAllSelectedImagesAsync=function(){var i=this,s=i._isMobileMode(),o;i._resetErr();var u=i._ImgManager.getCurrentImageIndex(),f=i._ImgManager.getSelectedClientIndexArray(),r=[],e;return n.isArray(f)&&n.each(f,function(n){var t=i._ImgManager.convertClientIndexToServerId(n);t!=-1&&r.push(t)}),r.length==0&&u>=0&&(o=i._ImgManager.convertClientIndexToServerId(u),r.push(o)),e=s?n.Promise.resolve(!0):i._innerFunV2("RemoveAllSelectedImages",t.makeParams(r.join(","))).then(function(n){return n&&i._innerFunV2("HowManyImagesInBuffer").then(function(n){return i._HowManyImagesInBuffer=n,!0})}),e.then(function(t){t&&n.each(r,function(n){var t="0";i._isMobileMode()&&(t="10");i._OnBitmapChanged([t,""+n,3,i._ImgManager.getCurrentImageIndex(),i._ImgManager.count()])})})};i.TagImages=function(t,i){var r=this,u,f;return(r._resetErr(),u=!0,f=r._ImgManager.getView().GetWebViewer().mydvs.totalImageCount,r._resetErr(),!n.isArray(t))?(n.Errors.IndicesNotArray(r),!1):!n.isString(i)||i==""?(n.Errors.InvalidTagName(r),!1):(n.each(t,function(t){if(isNaN(t)||t<0||t>=f)return n.Errors.IndexOutOfRange(r),u=!1}),!u)?u:r._ImgManager.AddImageTag(t,i)};i.ClearImageTags=function(t){var i=this;return(i._resetErr(),t==-1||t>=i.HowManyImagesInBuffer)?(n.Errors.IndexOutOfRange(i),!1):i._ImgManager.RemoveImageTag(t)};i.SetDefaultTag=function(n){var t=this;return t._resetErr(),t._ImgManager.SetDefaultTag(n)};i.FilterImagesByTag=function(n,t,i){var r=this;return r._resetErr(),r._ImgManager.ShowImagesByFilter(n,t,i)};i._asyncInvert=function(n){var i=this,r=parseInt(n);return i._innerSendToMobileV2("Invert",Dynamsoft.Lib.MobileFuns.makeParams(r)).then(function(){t.refreshImageAfterInvokeFun(i,n)})};i.Invert=function(i,r,u){var f=this,e=parseInt(i),h,o,s;return(f._resetErr(),isNaN(e)||e<0||e>=f._ImgManager.count())?(n.Errors.IndexOutOfRange(f),n.isFunction(u)&&u(f.ErrorCode,f.ErrorString),!1):f._isMobileMode()?(f._asyncInvert(e).then(r,function(){n.isFunction(u)&&u(f.ErrorCode,f.ErrorString)}),!0):(s=f._ImgManager.convertClientIndexToServerId(e),s==-1)?(n.Errors.IndexOutOfRange(f),n.isFunction(u)&&u(f.ErrorCode,f.ErrorString),!1):(h=f._innerFun("Invert",t.makeParams(s)),o=h==1,o?(t.refreshImageAfterInvokeFun(f,e),n.isFunction(r)&&r()):n.isFunction(u)&&u(f.ErrorCode,f.ErrorString),o)};i.InvertAsync=function(i){var r=this,u=parseInt(i),f;return(r._resetErr(),isNaN(u)||u<0||u>=r._ImgManager.count())?(n.Errors.IndexOutOfRange(r),n.Promise.reject({code:r._errorCode,message:r._errorString})):r._isMobileMode()?r._asyncInvert(u):(f=r._ImgManager.convertClientIndexToServerId(u),f==-1)?(n.Errors.IndexOutOfRange(r),n.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("Invert",t.makeParams(f)).then(function(n){var i=n==1;if(i)t.refreshImageAfterInvokeFun(r,u);else throw{code:r._errorCode,message:r._errorString};return i})};i._registLoadCallback=function(n){var t=this;return t._resetErr(),t._ImgManager.RegistLoadCallback(n)};i.GetImageBitDepthAsync=function(i){var r=this,u,e,f;return(r._resetErr(),u=parseInt(i),isNaN(u)||u<0||u>=r._ImgManager.count())?(n.Errors.IndexOutOfRange(r),n.Promise.reject({code:r._errorCode,message:r._errorString})):r._isMobileMode()?(e=r._ImgManager._UIView.GetMetaDataByIndex(u),n.Promise.resolve(e.imageBitDepth)):(f=r._ImgManager.convertClientIndexToServerId(u),f==-1)?(n.Errors.IndexOutOfRange(r),n.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("GetImageBitDepth",t.makeParams(f))};i.GetImageWidthAsync=function(i){var r=this,u,e,f;return(r._resetErr(),u=parseInt(i),isNaN(u)||u<0||u>=r._ImgManager.count())?(n.Errors.IndexOutOfRange(r),n.Promise.reject({code:r._errorCode,message:r._errorString})):r._isMobileMode()?(e=r._ImgManager._UIView.GetMetaDataByIndex(u),n.Promise.resolve(e.imageWidth)):(f=r._ImgManager.convertClientIndexToServerId(u),f==-1)?(n.Errors.IndexOutOfRange(r),n.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("GetImageWidth",t.makeParams(f))};i.GetImageHeightAsync=function(i){var r=this,u,e,f;return(r._resetErr(),u=parseInt(i),isNaN(u)||u<0||u>=r._ImgManager.count())?(n.Errors.IndexOutOfRange(r),n.Promise.reject({code:r._errorCode,message:r._errorString})):r._isMobileMode()?(e=r._ImgManager._UIView.GetMetaDataByIndex(u),n.Promise.resolve(e.imageHeight)):(f=r._ImgManager.convertClientIndexToServerId(u),f==-1)?(n.Errors.IndexOutOfRange(r),n.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("GetImageHeight",t.makeParams(f))};i.GetImageSizeAsync=function(i,r,u){var f=this,e,o;return(f._resetErr(),f._isMobileMode())?f._mobileNotSupportAsync("GetImageSize"):(e=parseInt(i),isNaN(e)||e<0||e>=f._ImgManager.count())?(n.Errors.IndexOutOfRange(f),n.Promise.reject({code:f._errorCode,message:f._errorString})):(o=f._ImgManager.convertClientIndexToServerId(e),o==-1)?(n.Errors.IndexOutOfRange(f),n.Promise.reject({code:f._errorCode,message:f._errorString})):f._innerFunV2("GetImageSize",t.makeParams(o,r,u))};i.GetImageSizeWithSpecifiedTypeAsync=function(i,r){var u=this,f,e;return(u._resetErr(),u._isMobileMode())?u._mobileNotSupportAsync("GetImageSizeWithSpecifiedType"):(f=parseInt(i),isNaN(f)||f<0||f>=u._ImgManager.count())?(n.Errors.IndexOutOfRange(u),n.Promise.reject({code:u._errorCode,message:u._errorString})):(e=u._ImgManager.convertClientIndexToServerId(f),e==-1)?(n.Errors.IndexOutOfRange(u),n.Promise.reject({code:u._errorCode,message:u._errorString})):u._innerFunV2("GetImageSizeWithSpecifiedType",t.makeParams(e,r))};i.GetImageXResolutionAsync=function(i){var r=this,u,e,f;return(r._resetErr(),u=parseInt(i),isNaN(u)||u<0||u>=r._ImgManager.count())?(n.Errors.IndexOutOfRange(r),n.Promise.reject({code:r._errorCode,message:r._errorString})):r._isMobileMode()?(e=r._ImgManager._UIView.GetMetaDataByIndex(u),n.Promise.resolve(e.imageXResolution)):(f=r._ImgManager.convertClientIndexToServerId(u),f==-1)?(n.Errors.IndexOutOfRange(r),n.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("GetImageXResolution",t.makeParams(f))};i.GetImageYResolutionAsync=function(i){var r=this,u,e,f;return(r._resetErr(),u=parseInt(i),isNaN(u)||u<0||u>=r._ImgManager.count())?(n.Errors.IndexOutOfRange(r),n.Promise.reject({code:r._errorCode,message:r._errorString})):r._isMobileMode()?(e=r._ImgManager._UIView.GetMetaDataByIndex(u),n.Promise.resolve(e.imageYResolution)):(f=r._ImgManager.convertClientIndexToServerId(u),f==-1)?(n.Errors.IndexOutOfRange(r),n.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("GetImageYResolution",t.makeParams(f))}}});Dynamsoft.Ready(function(n){var b=Dynamsoft,e;if(n.product.bHTML5Edition){var c=n,y=n.html5.STwain,i=y.prototype,o=!1,l=!0,t=n.html5.Funs,v=function(t,i){return t._ImgManager.count()==0?(n.Errors.NoImage(t),n.isFunction(i)&&i(t.ErrorCode,t.ErrorString),!1):!0},s=function(t,i,r){return v(t,r)?isNaN(i)||!n.isNumber(i)||i<0||i>=t._ImgManager.count()?(n.Errors.IndexOutOfRange(t),n.isFunction(r)&&r(t.ErrorCode,t.ErrorString),!1):!0:!1},p=function(t,i,r,u){var e,f;if(t._ImgManager.count()==0)return n.Errors.NoImage(t),n.isFunction(u)&&u(i),!1;if(n.isNumber(i)){if(isNaN(i)||i<-2||i>=t._ImgManager.count())return n.Errors.IndexOutOfRange(t),n.isFunction(u)&&u(i),!1}else if(n.isArray(i)){for(e=0;e<i.length;e++)if(f=i[e],isNaN(f)||!n.isNumber(f)||f<0||f>=t._ImgManager.count())return n.Errors.IndicesOutOfRange(t),n.isFunction(u)&&u(i),!1}else return n.Errors.IndexOutOfRange(t),n.isFunction(u)&&u(i),!1;if(r==EnumDWT_ImageType.IT_BMP||r==EnumDWT_ImageType.IT_JPG||r==EnumDWT_ImageType.IT_PNG)(i==-1&&t._ImgManager.count()>1||n.isArray(i)&&i.length>1)&&(n.Errors.UploadIndexMoreThanOne(t),n.isFunction(u)&&u(i));else if(r!=EnumDWT_ImageType.IT_TIF&&r!=EnumDWT_ImageType.IT_PDF)return n.Errors.InvalidImageType(t),n.isFunction(u)&&u(i),!1;return!0},h=function(t){var i=[],r,u,f;return t._ImgManager.count()<=0?i:(u=t._ImgManager.getCurrentImageIndex(),u>=0&&(r=t._ImgManager.convertClientIndexToServerId(u)),f=t._ImgManager.getSelectedClientIndexArray(),n.isArray(f)&&n.each(f,function(n){var r=t._ImgManager.convertClientIndexToServerId(n);r!=-1&&i.push(r)}),r!=-1&&i.length==0&&i.push(r),i)},w=function(t){var i,r;return t._ImgManager.count()<=0?[]:(i=t._ImgManager.getSelectedClientIndexArray(),n.isArray(i))?(i.length==0&&(r=t._ImgManager.getCurrentImageIndex(),r>=0&&i.push(r)),i):[]},a=function(n,t){for(var r=n._ImgManager.GetAllServerIdList(),i=0;i<r.length;i++)t.push(r[i])},u=function(n,t,i,r,u){try{n(t,i,r,u)}catch(f){}},r=function(n,t,i){try{n(t.ErrorCode,t.ErrorString,i)}catch(r){}},f=function(n,t,i,r,u,f){try{n(t.ErrorCode,t.ErrorString,i,r,u,f)}catch(e){}};i._asyncSaveImage=function(i,r,u,f,e){var s=this,a=function(e){var o=i;c.isString(o)&&o!=""?(o=c.replaceAll(o,"\\\\","_"),o=c.replaceAll(o,":","_")):o="img"+c.getRandom()+"."+u;c.MobileFuns.saveLocal(e,o,u);t.refreshImageAfterInvokeFun(s,r);n.isFunction(f)&&setTimeout(f,30)},v=function(){n.isFunction(e)&&e(s.ErrorCode,s.ErrorString)},h=window,o=Dynamsoft.navInfo,l=!0,y=h.requestFileSystem||h.webkitRequestFileSystem||h.mozRequestFileSystem;return(o.biPad||o.biPhone)&&!y&&(o.bSafari&&parseFloat(o.strBrowserVersion)<13||!o.bSafari)&&(l=!1),s._innerSendToMobile("SaveImage",Dynamsoft.Lib.MobileFuns.makeParams(i,r,u,1,l),0,a,v)};i.SaveAllAsMultiPageTIFF=function(i,u,f){var e=this,h,o,c,s;if(e._resetErr(),!n.License.checkProductKey(e,{Core:!0})&&!n.License.checkProductKey(e,{Webcam:!0},!0))return n.isFunction(f)&&f(e.ErrorCode,e.ErrorString),!1;if(!v(e,f))return!1;if(e._isMobileMode()){for(h=[],o=0;o<e.HowManyImagesInBuffer;o++)h.push(o);return e._asyncSaveImage(i,h,"tiff",u,f)}return(c=[],s=t.replaceLocalFilename(i),!s||s=="")?(n.Errors.InvalidFile(e),n.isFunction(f)&&r(f,e),!1):(a(e,c),e.__innerSaveImage("SaveSelectedImagesAsMultiPageTIFF",t.makeParams(s,c.join(",")),u,f))};i.SaveAllAsPDF=function(i,u,f){var e=this,h,o,c,s;if(e._resetErr(),!n.License.checkProductKey(e,{Core:!0})&&!n.License.checkProductKey(e,{Webcam:!0},!0))return n.isFunction(f)&&f(e.ErrorCode,e.ErrorString),!1;if(!v(e,f))return!1;if(e._isMobileMode()){for(h=[],o=0;o<e.HowManyImagesInBuffer;o++)h.push(o);return e._asyncSaveImage(i,h,"pdf",u,f)}return(c=[],s=t.replaceLocalFilename(i),!s||s=="")?(n.Errors.InvalidFile(e),n.isFunction(f)&&r(f,e),!1):(a(e,c),e.__innerSaveImage("SaveSelectedImagesAsMultiPagePDF",t.makeParams(s,c.join(",")),u,f))};i.SaveAsBMP=function(i,u,f,e){var o=this,h,c;return(o._resetErr(),o._isMobileMode())?o._mobileNotSupport("SaveAsBMP",e):!n.License.checkProductKey(o,{Core:!0})&&!n.License.checkProductKey(o,{Webcam:!0},!0)?(n.isFunction(e)&&e(o.ErrorCode,o.ErrorString),!1):(h=t.replaceLocalFilename(i),!h||h=="")?(n.Errors.InvalidFile(o),n.isFunction(e)&&r(e,o),!1):s(o,u,e)?(c=o._ImgManager.convertClientIndexToServerId(u),c==-1)?(n.Errors.IndexOutOfRange(o),n.isFunction(e)&&r(e,o),!1):o.__innerSaveImage("SaveAsBMP",t.makeParams(h,c),f,e):!1};i.SaveAsJPEG=function(i,u,f,e){var o=this,h,c;return(o._resetErr(),!n.License.checkProductKey(o,{Core:!0})&&!n.License.checkProductKey(o,{Webcam:!0},!0))?(n.isFunction(e)&&e(o.ErrorCode,o.ErrorString),!1):s(o,u,e)?o._isMobileMode()?o._asyncSaveImage(i,[u],"jpg",f,e):(h=t.replaceLocalFilename(i),!h||h=="")?(n.Errors.InvalidFile(o),n.isFunction(e)&&r(e,o),!1):(c=o._ImgManager.convertClientIndexToServerId(u),c==-1)?(n.Errors.IndexOutOfRange(o),n.isFunction(e)&&r(e,o),!1):o.__innerSaveImage("SaveAsJPEG",t.makeParams(h,c),f,e):!1};i.SaveAsPDF=function(i,u,f,e){var o=this,h,c;return(o._resetErr(),!n.License.checkProductKey(o,{Core:!0})&&!n.License.checkProductKey(o,{Webcam:!0},!0))?(n.isFunction(e)&&e(o.ErrorCode,o.ErrorString),!1):s(o,u,e)?o._isMobileMode()?o._asyncSaveImage(i,[u],"pdf",f,e):(h=t.replaceLocalFilename(i),!h||h=="")?(n.Errors.InvalidFile(o),n.isFunction(e)&&r(e,o),!1):(c=o._ImgManager.convertClientIndexToServerId(u),c==-1)?(n.Errors.IndexOutOfRange(o),n.isFunction(e)&&r(e,o),!1):o.__innerSaveImage("SaveAsPDF",t.makeParams(h,c),f,e):!1};i.SaveAsPNG=function(i,u,f,e){var o=this,h,c;return(o._resetErr(),!n.License.checkProductKey(o,{Core:!0})&&!n.License.checkProductKey(o,{Webcam:!0},!0))?(n.isFunction(e)&&e(o.ErrorCode,o.ErrorString),!1):s(o,u,e)?o._isMobileMode()?o._asyncSaveImage(i,[u],"png",f,e):(h=t.replaceLocalFilename(i),!h||h=="")?(n.Errors.InvalidFile(o),n.isFunction(e)&&r(e,o),!1):(c=o._ImgManager.convertClientIndexToServerId(u),c==-1)?(n.Errors.IndexOutOfRange(o),n.isFunction(e)&&r(e,o),!1):o.__innerSaveImage("SaveAsPNG",t.makeParams(h,c),f,e):!1};i.SaveAsTIFF=function(i,u,f,e){var o=this,h,c;return(o._resetErr(),!n.License.checkProductKey(o,{Core:!0})&&!n.License.checkProductKey(o,{Webcam:!0},!0))?(n.isFunction(e)&&e(o.ErrorCode,o.ErrorString),!1):s(o,u,e)?o._isMobileMode()?o._asyncSaveImage(i,[u],"tiff",f,e):(h=t.replaceLocalFilename(i),!h||h=="")?(n.Errors.InvalidFile(o),n.isFunction(e)&&r(e,o),!1):(c=o._ImgManager.convertClientIndexToServerId(u),c==-1)?(n.Errors.IndexOutOfRange(o),n.isFunction(e)&&r(e,o),!1):o.__innerSaveImage("SaveAsTIFF",t.makeParams(h,c),f,e):!1};i.SaveAsGIF=function(i,u,f,e){var h=this,c,l;return(h._resetErr(),h._isMobileMode())?(n.Errors.HTML5NotSupport(h),n.isFunction(e)&&r(e,h),o):!n.License.checkProductKey(h,{Core:!0})&&!n.License.checkProductKey(h,{Webcam:!0},!0)?(n.isFunction(e)&&e(h.ErrorCode,h.ErrorString),!1):(c=t.replaceLocalFilename(i),!c||c=="")?(n.Errors.InvalidFile(h),n.isFunction(e)&&r(e,h),!1):s(h,u,e)?(l=h._ImgManager.convertClientIndexToServerId(u),l==-1)?(n.Errors.IndexOutOfRange(h),n.isFunction(e)&&r(e,h),!1):h.__innerSaveImage("SaveAsGIF",t.makeParams(c,l),f,e):!1};i.SaveSelectedImagesAsMultiPagePDF=function(i,u,f){var e=this,s,o,c;return(e._resetErr(),!n.License.checkProductKey(e,{Core:!0})&&!n.License.checkProductKey(e,{Webcam:!0},!0))?(n.isFunction(f)&&f(e.ErrorCode,e.ErrorString),!1):e._isMobileMode()?(s=w(e),e._asyncSaveImage(i,s,"pdf",u,f)):(o=t.replaceLocalFilename(i),c=h(e),!o||o=="")?(n.Errors.InvalidFile(e),n.isFunction(f)&&r(f,e),!1):e.__innerSaveImage("SaveSelectedImagesAsMultiPagePDF",t.makeParams(o,c.join(",")),u,f)};i.SaveSelectedImagesAsMultiPageTIFF=function(i,u,f){var e=this,s,o,c;return(e._resetErr(),!n.License.checkProductKey(e,{Core:!0})&&!n.License.checkProductKey(e,{Webcam:!0},!0))?(n.isFunction(f)&&f(e.ErrorCode,e.ErrorString),!1):e._isMobileMode()?(s=w(e),e._asyncSaveImage(i,s,"tiff",u,f)):(o=t.replaceLocalFilename(i),c=h(e),!o||o=="")?(n.Errors.InvalidFile(e),n.isFunction(f)&&r(f,e),!1):e.__innerSaveImage("SaveSelectedImagesAsMultiPageTIFF",t.makeParams(o,c.join(",")),u,f)};i.SaveSelectedImagesToBase64Binary=function(i,r){var u=this,f;return(u._resetErr(),!n.License.checkProductKey(u,{Core:!0})&&!n.License.checkProductKey(u,{Webcam:!0},!0))?(n.isFunction(r)&&r(u.ErrorCode,u.ErrorString),!1):u._isMobileMode()?u._mobileNotSupport("SaveSelectedImagesToBase64Binary",r):(f=h(u),n.isFunction(i))?u._innerSend("SaveSelectedImagesToBase64Binary",t.makeParams(f.join(",")),!0,i,r):u._innerFun("SaveSelectedImagesToBase64Binary",t.makeParams(f.join(",")))};i.ShowFileDialog=function(n,i,r,u,f,e,o,s){var h=this,l,c;return(h._resetErr(),h._isMobileMode())?h._mobileNotSupport("ShowFileDialog"):(l=t.replaceLocalFilename(f),c=0,c=h.__GetLoadEventsNum(),h._innerSend("ShowFileDialog",t.makeParams(n,i,r,u,l,e,o,s,c),!0))};i.FTPDownload=function(i,r,u,f){var e=this,o;return(e._resetErr(),e._isMobileMode())?e._mobileNotSupport("FTPDownload",f):(o=n.html5.Funs.getImageType(r),e.__innerFTPDownload("FTPDownload",t.makeParams(i,r),o,u,f))};i.FTPDownloadEx=function(n,i,r,u,f){var e=this;return(e._resetErr(),e._isMobileMode())?e._mobileNotSupport("FTPDownloadEx",f):e.__innerFTPDownload("FTPDownloadEx",t.makeParams(n,i,r),r,u,f)};i.FTPUpload=function(i,u,f,e,o){var h=this,c;return(h._resetErr(),h._isMobileMode())?h._mobileNotSupport("FTPUpload",o):(c=h._ImgManager.convertClientIndexToServerId(u),!s(h,u,o))?!1:c==-1?(n.Errors.IndexOutOfRange(h),n.isFunction(o)&&r(o,h),!1):h.__innerFTPUpload("FTPUpload",t.makeParams(i,c,f),e,o)};i.FTPUploadEx=function(i,u,f,e,o,h){var c=this,l;return(c._resetErr(),c._isMobileMode())?c._mobileNotSupport("FTPUploadEx",h):s(c,u,h)?(l=c._ImgManager.convertClientIndexToServerId(u),l==-1)?(n.Errors.IndexOutOfRange(c),n.isFunction(h)&&r(h,c),!1):c.__innerFTPUpload("FTPUploadEx",t.makeParams(i,l,f,e),o,h):!1};i.FTPUploadAllAsMultiPageTIFF=function(n,i,r,u){var f=this,e;return(f._resetErr(),f._isMobileMode())?f._mobileNotSupport("FTPUploadAllAsMultiPageTIFF",u):(e=[],a(f,e),this.__innerFTPUpload("FTPUploadAsMultiPageTIFF",t.makeParams(n,i,e.join(",")),r,u))};i.FTPUploadAllAsPDF=function(n,i,r,u){var f=this,e;return(f._resetErr(),f._isMobileMode())?f._mobileNotSupport("FTPUploadAllAsPDF",u):(e=[],a(f,e),f.__innerFTPUpload("FTPUploadAsMultiPagePDF",t.makeParams(n,i,e.join(",")),r,u))};i.FTPUploadAsMultiPagePDF=function(n,i,r,u){var f=this,e;return(f._resetErr(),f._isMobileMode())?f._mobileNotSupport("FTPUploadAsMultiPagePDF",u):(e=h(f),f.__innerFTPUpload("FTPUploadAsMultiPagePDF",t.makeParams(n,i,e.join(",")),r,u))};i.FTPUploadAsMultiPageTIFF=function(n,i,r,u){var f=this,e;return(f._resetErr(),f._isMobileMode())?f._mobileNotSupport("FTPUploadAsMultiPageTIFF",u):(e=h(f),this.__innerFTPUpload("FTPUploadAsMultiPageTIFF",t.makeParams(n,i,e.join(",")),r,u))};i.HTTPDownload=function(n,i,r,u){var f=this,e;return f._resetErr(),e=t.getImageType(i),f.HTTPDownloadThroughGet(n,i,e,r,u)};y.prototype.HTTPDownloadEx=function(n,t,i,r,u){var f=this;return(f._resetErr(),f._isMobileMode())?f._mobileNotSupport("HTTPDownloadEx",u):f.HTTPDownloadThroughGet(n,t,i,r,u)};i.HTTPDownloadDirectly=function(i,u,f,o,s){var h=this,a,l,v,y,p,w,c;return(h._resetErr(),!n.License.checkProductKey(h,{Core:!0}))?(n.isFunction(s)&&s(h.ErrorCode,h.ErrorString),!1):h._isMobileMode()?h._mobileNotSupport("HTTPDownloadDirectly",s):(a=e.GetHttpHeadersAndClear(h),l=t.combineUrl(h,i,u),l===!1)?(n.Errors.ParameterCannotEmpty(h),!1):!f||f==""?(n.Errors.InvalidLocalFilename(h,"HTTPDownloadDirectly"),n.isFunction(s)&&r(s,h),!1):(v=n.html5.Funs.getImageType(f),t.isServerInvalid(h))?(n.isFunction(s)&&r(s,h),!1):n.License.checkPDFProductKeyWhenNeeds(h,v)?(n.cancelFrome=2,p=t.replaceLocalFilename(f),y="get",n.showProgress(h,"HTTPDownloadDirectly",!0),w=function(n){var t=n.total===0?100:Math.round(n.loaded*100/n.total),i=[n.loaded," / ",n.total].join("");h._OnPercentDone([0,t,"","http"])},c=!0,h._OnPercentDone([0,-1,Dynamsoft.MSG.Downloading,"http"]),n.isFunction(o)||(c=!1),t.loadHttpBlob(h,y,l,c,function(n){h._OnPercentDone([0,-1,Dynamsoft.MSG.Loading]);return h.__LoadImageFromBytes(n,3,p,c,o,s)},function(){return n.closeProgress("HTTPDownloadDirectly"),n.isFunction(s)&&r(s,h),!1},w,a)):(n.isFunction(s)&&s(h._errorCode,h._errorString),!1)};i.HTTPUploadThroughPostDirectly=function(i,u,f,e,o,s){var h=this,l,c,a,v;return(h._resetErr(),h._isMobileMode())?h._mobileNotSupport("HTTPUploadThroughPostDirectly",s):(l=t.combineUrl(h,i,f),c=function(){n.isFunction(s)&&r(s,h,h.__HTTPPostResponseString)},h.__HTTPPostResponseString="",i==="")?(n.Errors.HttpServerCannotEmpty(h),c(),!1):(a=0,v=!1,h._innerUploadDirectly(l,u,e,!0,!1,a,!0,v,o,c))};i._innerUploadDirectly=function(i,r,f,o,s,h,c,l,a,v){var y=this,d=e.GetHttpHeadersAndClear(y),k="HTTPUploadThroughPostDirectly",w=!0,b,p;return i===!1||i===""?(n.Errors.ParameterCannotEmpty(y),n.isFunction(v)&&v(y.ErrorCode,y.ErrorString),!1):(n.isFunction(a)||(w=!1),!n.License.checkProductKey(y,{Core:!0}))?(n.isFunction(v)&&v(y.ErrorCode,y.ErrorString),!1):(n.cancelFrome=1,p=function(){return n.needShowTwiceShowDialog=!1,o&&n.closeProgress(k),n.isFunction(v)&&v(y.ErrorCode,y.ErrorString),!1},n.needShowTwiceShowDialog=!0,o&&n.showProgress(y,k,!1),b=t.replaceLocalFilename(r),!b||b=="")?(n.Errors.InvalidFile(y),p(),!1):l&&l.bCancel?(l.st=2,p()):y.__SaveLocalFileToBytes(b,w,s,function(r){return(n.needShowTwiceShowDialog=!1,l&&l.bCancel)?(l.st=2,p()):r&&(n.dlgRef>0||y.__IfShowCancelDialogWhenImageTransfer==!1||w==!1||o===!1)?(r instanceof File?r.fileName=f:r.name=f,t.setBtnCancelVisibleForProgress(y,!0),t.httpPostUpload(y,i,r,w,0,d,!0,h,c,l,function(t){o&&n.closeProgress(k);n.isFunction(a)&&u(a,t)},p)):(p(),!1)},p)};i._innerUploadFilesDirectly=function(i,r,f,o,s,h,c,l,a){var v=this,nt=e.GetHttpHeadersAndClear(v),p="HTTPUploadThroughPostDirectly",w=!0,b=[],k,y;if(i===!1||i==="")return n.Errors.ParameterCannotEmpty(v),n.isFunction(a)&&a(v.ErrorCode,v.ErrorString,r),!1;if(n.isFunction(l)||(w=!1),!n.License.checkProductKey(v,{Core:!0}))return n.isFunction(a)&&a(v.ErrorCode,v.ErrorString,r),!1;n.cancelFrome=1;y=function(){return n.needShowTwiceShowDialog=!1,o&&n.closeProgress(p),n.isFunction(a)&&a(r),!1};n.needShowTwiceShowDialog=!0;o&&n.showProgress(v,p,!1);n.each(r,function(i){var r=t.replaceLocalFilename(i);if(!r||r=="")return n.Errors.InvalidFile(v),y(),!1;b.push(r)});var d=[],tt=b.length,g=0;return n.each(b,function(r,e){k=v.__SaveLocalFileToBytes(r,w,s,function(r){if(n.needShowTwiceShowDialog=!1,r&&(n.dlgRef>0||v.__IfShowCancelDialogWhenImageTransfer==!1||w==!1||o===!1)){var s=t.cformat(f,e+1);if(r instanceof File?r.fileName=s:r.name=s,d[e]=r,g++,g==tt)return t.setBtnCancelVisibleForProgress(v,!0),t.httpPostUploadFiles(v,i,d,w,0,nt,o,h,c,function(t){o&&n.closeProgress(p);n.isFunction(l)&&u(l,t)},function(){o&&n.closeProgress(p);n.isFunction(y)&&y()})}else return o&&n.closeProgress(p),n.isFunction(y)&&y(),!1},function(){o&&n.closeProgress(p);n.isFunction(y)&&y()})}),k};i.HTTPUploadThroughPost=function(i,r,e,o,s,h,c){var l=this;if(l._resetErr(),l._isMobileMode())return l._mobileNotSupport("HTTPUploadThroughPost",h);var v=t.getImageType(o),y=arguments,w=!1,a=function(t){return n.isFunction(h)&&f(h,l,l.__HTTPPostResponseString,t,y),!1};return!n.isString(o)||o==""?(n.Errors.UploadFileCannotEmpty(l),a()):(s&&n.isFunction(s)&&(w=function(n,t){return u(s,l.__HTTPPostResponseString,t,y),!0}),!p(l,r,v,a))?!1:l.innerHTTPUploadPost(i,r,e,o,v,w,a,c)};i.HTTPUploadThroughPostEx=function(t,i,r,e,o,s,h,c){var l=this;if(l._resetErr(),l._isMobileMode())return l._mobileNotSupport("HTTPUploadThroughPostEx",h);var v=arguments,y=!1,a=function(t){return n.isFunction(h)&&f(h,l,l.__HTTPPostResponseString,t,v),!1};return!n.isString(e)||e==""?(n.Errors.UploadFileCannotEmpty(l),a()):(s&&n.isFunction(s)&&(y=function(n,t){return u(s,l.__HTTPPostResponseString,t,v),!0}),!p(l,i,o,a))?!1:l.innerHTTPUploadPost(t,i,r,e,o,y,a,c)};i.innerHTTPUploadPost=function(i,r,u,f,s,h,c){var l=this,d="HTTPUploadThroughPostEx",y=t.combineUrl(l,i,u),w=!0,g=!1,a=[],v=function(t){return n.isFunction(c)&&c(t),!1},nt,p,tt=!1,k,b;if(l.__HTTPPostResponseString="",n.isNumber(r)){if(r<-2)return n.Errors.IndexOutOfRange(l),v(r)}else if(!n.isArray(r))return n.Errors.IndexOutOfRange(l),v(r);if(!n.isString(f)||f=="")return n.Errors.UploadFileCannotEmpty(l),v();if(n.isUndefined(s))return n.Errors.InvalidImageType(l),v(r);if(s==EnumDWT_ImageType.IT_BMP||s==EnumDWT_ImageType.IT_JPG||s==EnumDWT_ImageType.IT_PNG){if(r==-1&&l._ImgManager.count()>1||n.isArray(r)&&r.length>1)return n.Errors.UploadIndexMoreThanOne(l),v(r);n.isArray(r)?a.push(r[0]):r==-1?a.push(0):a.push(r)}else if(s==EnumDWT_ImageType.IT_TIF||s==EnumDWT_ImageType.IT_PDF)if(r==-1){if(l._ImgManager.count()==0)return n.Errors.NoImage(l),v();for(p=0;p<l._ImgManager.count();p++)a.push(p)}else if(r==-2)a=l._ImgManager.getSelectedClientIndexArray();else if(n.isArray(r))for(p=0;p<r.length;p++)a.push(r[p]);else a.push(r);else return n.Errors.InvalidImageType(l),v(r);if(l._isMobileMode()?w=!0:n.isFunction(h)||(w=!1),i==="")return n.Errors.HttpServerCannotEmpty(l),v(a);if(n.isUndefined(y)||y==="")return n.Errors.ParameterCannotEmpty(l),v(a);if(!n.isString(y))return n.Errors.InvalidUrl(l),v(a);if((y.indexOf("http://")!=0&&y.indexOf("https://")!=0&&(y=n.detect.ssl?"https://"+y:"http://"+y),!l._isMobileMode()&&t.isServerInvalid(l))||!l._checkIndices(a)&&a!=-1)return v(a);if(k=[],n.isArray(a)&&n.each(a,function(n){var t=l._ImgManager.convertClientIndexToServerId(n);t!=-1&&k.push(t)}),l._resetErr(),w)return nt={bOnlyUploadForm:o,method:"HTTPUploadThroughPostEx",_this:l,url:y,serverIds:k,enumImageType:s,saveSetup:tt,fileName:f,retry:0,bOnlyEmptyIsOK:!0,objUploadFileStatus:!1,dataFormat:EnumDWT_UploadDataFormat.Binary,asyncSuccessFunc:h,asyncFailureFunc:v},n._asyncUploadCmd(nt),!0;n.cancelFrome=1;b=function(){return n.needShowTwiceShowDialog=!1,n.closeProgress(d),v(a),!1};n.needShowTwiceShowDialog=!0;n.showProgress(l,d,!1);var rt=Dynamsoft.WebTwainEnv,it=e.GetHttpHeadersAndClear(l);return rt.IfAddMD5InUploadHeader&&(it["dwt-md5"]=""),l._OnPercentDone([0,-1,Dynamsoft.MSG.Encoding,"http"]),l.__innerConvertToBlob(s,k,tt,w,4,function(i){var r,u,e,o;return n.needShowTwiceShowDialog=!1,i&&(n.dlgRef>0||l.__IfShowCancelDialogWhenImageTransfer==!1||w==!1)?(r=l.MaxUploadImageSize,u=i.size,u>r&&r!=-1)?(n.Errors.UploadExceededMaxSize(l),b()):(i instanceof File?i.fileName=f:i.name=f,t.setBtnCancelVisibleForProgress(l,!0),e=0,o=!1,t.httpPostUpload(l,y,i,w,0,it,!0,e,!0,o,function(){return n.closeProgress(d),g=!0,!0},b)):b()},b),g};i._checkIndices=function(t){var r=this,f,u,i;if(!n.isArray(t))return n.Errors.IndicesNotArray(r),!1;if(t.length==0)return n.Errors.IndicesCannotEmpty(r),!1;for(f=r._ImgManager.count(),u=0;u<t.length;u++){if(i=t[u],n.isUndefined(i)||i===null)return n.Errors.IndexNullOrUndefined(r),!1;if(i=parseInt(i),isNaN(i))return n.Errors.InvalidIndex(r),!1;if(i<0||i>=f)return n.Errors.IndicesOutOfRange(r),!1}return!0};i.SetUploadSegment=function(t,i){var r=this;return(r._resetErr(),r._isMobileMode())?r._mobileNotSupport("SetUploadSegment"):!n.isNumber(t)||t<0?(n.Errors.InvalidSegmentUploadThreshold(r),!1):!n.isNumber(i)||i<=0?(n.Errors.InvalidModuleSize(r),!1):(r._segementUploadThreshold=t*1048576,r._moduleSize=i*1024,!0)};i.HTTPUpload=function(t,i,r,e,s,h,c){var a=this,b,p,v,y,k,w,d;if(a._resetErr(),y=arguments,arguments.length<=3)p=n.isFunction(i)?function(){i(a.__HTTPPostResponseString,t,y)}:!1,v=function(){n.isFunction(r)&&f(r,a,a.__HTTPPostResponseString,t,y)},b={bOnlyUploadForm:l,_this:a,url:t,asyncSuccessFunc:p,asyncFailureFunc:v};else{if(w=[],d=!1,n.isFunction(s)?(k="RemoteFile",p=function(n,t){s(a.__HTTPPostResponseString,t,y)},v=function(t){n.isFunction(h)&&f(h,a,a.__HTTPPostResponseString,t,y)}):(k=n.isString(s)?s:"RemoteFile",p=n.isFunction(h)?function(n,t){u(h,a.__HTTPPostResponseString,t,y)}:!1,v=function(t){n.isFunction(c)&&f(c,a,a.__HTTPPostResponseString,t,y)}),!a._checkIndices(i))return v(i),!1;if(n.isArray(i)&&n.each(i,function(n){var t=a._ImgManager.convertClientIndexToServerId(n);t!=-1&&w.push(t)}),w.length==0)return n.Errors.InvalidIndex(a),v(i),!1;if(n.isUndefined(r))return n.Errors.InvalidImageType(a),v(i),!1;if(r==EnumDWT_ImageType.IT_BMP||r==EnumDWT_ImageType.IT_JPG||r==EnumDWT_ImageType.IT_PNG){if(w.length>1)return n.Errors.UploadIndexMoreThanOne(a),v(i),!1}else if(r!=EnumDWT_ImageType.IT_TIF&&r!=EnumDWT_ImageType.IT_PDF)return n.Errors.InvalidImageType(a),v(i),!1;if(n.isUndefined(e)||e!=EnumDWT_UploadDataFormat.Binary&&e!=EnumDWT_UploadDataFormat.Base64)return n.Errors.InvalidDataFormat(a),v(i),!1;b={bOnlyUploadForm:o,method:"HTTPUpload",_this:a,url:t,serverIds:w,enumImageType:r,saveSetup:d,dataFormat:e,fileName:k,retry:0,bOnlyEmptyIsOK:!0,objUploadFileStatus:!1,asyncSuccessFunc:p,asyncFailureFunc:v}}return a._resetErr(),n._asyncUploadCmd(b),!0};i._innerHTTPUpload=function(i,r,f,o,s,h,c,l,a,v,y){var p=this,k=parseInt(f),ft=parseInt(o),b=s,tt="HTTPUpload",it=i,nt=!1,et=p._moduleSize,rt=p._segementUploadThreshold,d="",ut,g,w,ht,ot,st;if(p.__HTTPPostResponseString="",n.isUndefined(f))return n.Errors.InvalidImageType(p),n.isFunction(y)&&y(),!1;if(n.cancelFrome=1,w=function(){return n.needShowTwiceShowDialog=!1,n.closeProgress(tt),n.isFunction(y)&&y(),!1},ut=function(n){var t=n.total===0?100:Math.round(n.loaded*100/n.total),i=[n.loaded," / ",n.total].join("");p._OnPercentDone([0,t,"","http",b])},b=t.addImageFileExt(b,k),n.needShowTwiceShowDialog=!0,n.showProgress(p,tt,!1),!p._isMobileMode()&&t.isServerInvalid(p))return w();if(ft==EnumDWT_UploadDataFormat.Binary){if(ht=0,ot=4,a&&a.bCancel)return a.st=2,w();p._OnPercentDone([0,-1,Dynamsoft.MSG.Encoding,"http"]);nt=p.__innerConvertToBlob(k,r,h,!0,ot,function(t){var i,r;if(g=function(){return n.needShowTwiceShowDialog=!1,n.closeProgress(tt),n.isFunction(v)&&u(v,t),!0},a&&a.bCancel)return a.st=2,w();if(!t||t.size<=0)return n.Errors.UploadFileCannotEmpty(p),w();if(i=p.MaxUploadImageSize,r=t.size,r>i&&i!=-1)return n.Errors.UploadExceededMaxSize(p),w();if(p._errorCode!=0)return w();if(rt>0&&t.size>rt){var f=e.GetHttpHeadersAndClear(p),o=Dynamsoft.WebTwainEnv;o.IfAddMD5InUploadHeader&&(f["dwt-md5"]=d);p._OnPercentDone([0,-1,Dynamsoft.MSG.Uploading,"http",b]);nt=e.UploadBinary(p,it,k,t,b,f,0,et,ut,c,l,a,g,w)}else nt=p.__innnerHTTPUploadBinaryFull(it,d,t,k,b,c,l,a,g,w)},w)}else ft==EnumDWT_UploadDataFormat.Base64&&(st=4,nt=p._convertToBase64ByServerIds(r,k,h,st,function(t){var i;if(!t||t.getLength()<=0)return n.Errors.UploadFileCannotEmpty(p),w();if(g=function(){return n.needShowTwiceShowDialog=!1,n.closeProgress(tt),n.isFunction(v)&&u(v,t),!0},rt>0&&t.getLength()>rt){var r=e.GetHttpHeadersAndClear(p),f=Dynamsoft.WebTwainEnv;d=t.getMD5();f.IfAddMD5InUploadHeader&&(r["dwt-md5"]=d);p._OnPercentDone([0,-1,Dynamsoft.MSG.Uploading,"http"]);e.UploadBase64(p,it,k,t,b,r,0,et,ut,g,w)}else{if(d=t.getMD5(),i=t.getData(0,t.getLength()),!i||i=="")return n.Errors.UploadFileCannotEmpty(p),w();p.__innnerHTTPUploadBase64Full(it,d,i,k,b,c,l,g,w)}},w));return nt};i._innerFormFieldHTTPUpload=function(i,f,s){var h=this,l,a="HTTPUpload",c=i,v,y;return(h.__HTTPPostResponseString="",l=function(){return n.needShowTwiceShowDialog=!1,n.closeProgress(a),n.isFunction(s)&&r(s,h,h.__HTTPPostResponseString),!1},n.isUndefined(c)||c==="")?(n.Errors.ParameterCannotEmpty(h),l()):n.isString(c)?(c.indexOf("http://")!=0&&c.indexOf("https://")!=0&&(c=n.detect.ssl?"https://"+c:"http://"+c),h.__HTTPPostResponseString="",n.cancelFrome=1,n.showProgress(h,a,!1),n.needShowTwiceShowDialog=!0,v=e.GetHttpHeadersAndClear(h),h._OnPercentDone([0,-1,Dynamsoft.MSG.Uploading,"http"]),y=!1,t.httpUploadByBIO(h,c,o,0,!0,v,!0,0,!0,y,function(t){n.needShowTwiceShowDialog=!1;n.closeProgress(a);n.isFunction(f)&&u(f,t)},l)):(n.Errors.InvalidUrl(h),l())};e={UploadBinary:function(i,r,f,o,s,h,c,l,a,v,y,p,w,b){var k,nt,d=o.size,g;return(k=d-c,k>0)?(k>=l?(k-=l,nt=l):(nt=k,k=0),g=o.slice(c,c+nt),!g)?(n.Errors.UploadFileCannotEmpty(i),b()):n.dlgRef>0||i.__IfShowCancelDialogWhenImageTransfer==!1?(g.name=s,t.setBtnCancelVisibleForProgress(i,!0),h["Content-Range"]=["bytes ",c,"-",c+g.size-1,"/",d].join(""),a({total:d,loaded:c}),t.httpPostUpload(i,r,g,!0,0,h,!1,v,y,p,function(t){k==0?(n.needShowTwiceShowDialog=!1,a({total:d,loaded:d}),n.isFunction(w)&&u(w,t)):(c+=nt,setTimeout(function(){n.cancelFrome=1;e.UploadBinary(i,r,f,o,s,h,c,l,a,v,y,p,w,b)},100))},b),!0):(n.Errors.UploadError(i,!0),b()):(n.needShowTwiceShowDialog=!1,n.closeProgress("HttpUpload"),n.isFunction(w)&&w(""),!0)},UploadBase64:function(i,r,f,o,s,h,c,l,a,v,y){var w=o.getLength(),p,b,k;return(p=w-c,p>0)?(p>=l?(p-=l,b=l):(b=p,p=0),k=o.getData(c,l),!k||k=="")?(n.Errors.UploadFileCannotEmpty(i),y()):n.dlgRef>0||i.__IfShowCancelDialogWhenImageTransfer==!1?(t.setBtnCancelVisibleForProgress(i,!0),h["Content-Range"]=["bytes ",c,"-",c+b-1,"/",w].join(""),a({total:w,loaded:c}),t.httpPostUploadString(i,r,k,s,0,h,!1,0,!0,function(t){p==0?(n.needShowTwiceShowDialog=!1,a({total:w,loaded:w}),n.isFunction(v)&&u(v,t)):(c+=b,setTimeout(function(){n.cancelFrome=1;e.UploadBase64(i,r,f,o,s,h,c,l,a,v,y)},100))},y),!0):(n.Errors.UploadError(i,!0),y()):(n.needShowTwiceShowDialog=!1,n.closeProgress("HttpUpload"),n.isFunction(v)&&v(""),!0)},GetHttpHeadersAndClear:function(n){var t=n.__httpHeaderMap;return n.__httpHeaderMap={},t||(t={}),t}};i.__innnerHTTPUploadBinaryFull=function(i,r,f,o,s,h,c,l,a,v){var y=this,p=e.GetHttpHeadersAndClear(y),w=s,b=i,k=Dynamsoft.WebTwainEnv;return k.IfAddMD5InUploadHeader&&(p["dwt-md5"]=r),n.dlgRef>0||y.__IfShowCancelDialogWhenImageTransfer==!1?(f instanceof File?f.fileName=w:f.name=w,t.setBtnCancelVisibleForProgress(y,!0),t.httpPostUpload(y,b,f,!0,0,p,!0,h,c,l,function(t){n.isFunction(a)&&u(a,t)},v)):(n.Errors.UploadError(y,!0),v())};i.__innnerHTTPUploadBase64Full=function(i,r,f,o,s,h,c,l,a){var v=this,y=e.GetHttpHeadersAndClear(v),p=s,w=i,b=Dynamsoft.WebTwainEnv;return n.dlgRef>0||v.__IfShowCancelDialogWhenImageTransfer==!1?(b.IfAddMD5InUploadHeader&&y&&(y["dwt-md5"]=r),t.setBtnCancelVisibleForProgress(v,!0),t.httpPostUploadString(v,w,f,p,0,y,!0,h,c,function(t){n.isFunction(l)&&u(l,t)},a)):(n.Errors.UploadError(v,!0),a())};i.ConvertToBase64=function(i,r,e,o){var s=this;s._resetErr();var h=[],l=arguments,c=parseInt(r);if(!n.License.checkProductKey(s,{Core:!0}))return n.isFunction(o)&&o(s.ErrorCode,s.ErrorString),!1;if(!s._isMobileMode()&&t.isServerInvalid(s)||!s._checkIndices(i))return n.isFunction(o)&&f(o,s,i,r,l),!1;if(c==EnumDWT_ImageType.IT_BMP||c==EnumDWT_ImageType.IT_JPG||c==EnumDWT_ImageType.IT_PNG){if(i.length>1)return n.Errors.ConvertBase64IndexMoreThanOne(s),n.isFunction(o)&&f(o,s,i,r,l),!1}else if(c!=EnumDWT_ImageType.IT_TIF&&c!=EnumDWT_ImageType.IT_PDF)return n.Errors.InvalidImageType(s),n.isFunction(o)&&f(o,s,i,r,l),!1;n.isArray(i)&&n.each(i,function(n){var t=s._ImgManager.convertClientIndexToServerId(n);t!=-1&&h.push(t)});var a=function(t){var i=[];return n.isArray(h)&&n.each(h,function(n){var t=s._ImgManager.convertServerIdToClientIndex(n);t>-1&&i.push(t)}),n.isFunction(e)&&u(e,t,i,r,l),!1},v=function(){var t=[];return n.isArray(h)&&n.each(h,function(n){var i=s._ImgManager.convertServerIdToClientIndex(n);i>-1&&t.push(i)}),n.isFunction(o)&&f(o,s,t,r,l),!1};return s._convertToBase64ByServerIds(h,c,!1,3,a,v)};i._convertToBase64ByServerIds=function(t,i,r,f,e,o){var s=this,h="ConvertToBase64",l=r,c,a,v,y;return(n.showProgress(s,h,!1),c=function(){return n.closeProgress(h),n.isFunction(o)&&o(),!1},a=function(i){var f=0,o="",l="",r=i&&i.result,v=[],a;if(n.isArray(t)&&n.each(t,function(n){var t=s._ImgManager.convertServerIdToClientIndex(n);t>-1&&v.push(t)}),s.ErrorCode!=0){c();return}r&&n.isArray(r)&&r.length==3?(l=r[0],f=r[1],o=r[2],a=new n.html5.Base64Result(s,f,o,l),n.closeProgress(h),n.isFunction(e)&&u(e,a)):(n.Errors.ConvertBase64Failed(s),c())},s._isMobileMode())?i==EnumDWT_ImageType.IT_BMP?(n.closeProgress(h),s._mobileNotSupport("Convert to bmp",o)):s.__innerConvertToBase64ByMobile(t,i,f,a,c):(n.isString(l)&&l!=""||(l="{}"),v=["[",i,',"',t.join(","),'",',l,",1]"].join(""),y=!1,s._innerFunRaw(h,v,!0,y,!0,a,c))};i.ClearAllHTTPFormField=function(){var n=this;return n._resetErr(),n.httpFormFields={},!0};i.SetHTTPFormField=function(t,i,r){var f=this,u;return f._resetErr(),u=t,n.isString(u)||(u=""+u),i instanceof Blob&&(i.name=r),f.httpFormFields[u]=i,!0};i.HTTPUploadAllThroughPostAsMultiPageTIFF=function(t,i,r,e,o,s){var h=this;if(h._resetErr(),h._isMobileMode())return h._mobileNotSupport("HTTPUploadAllThroughPostAsMultiPageTIFF",o);var c=arguments,l=!1,a=function(t){return n.isFunction(o)&&f(o,h,h.__HTTPPostResponseString,t,c),!1};return!n.isString(r)||r==""?(n.Errors.UploadFileCannotEmpty(h),a()):(e&&n.isFunction(e)&&(l=function(n,t){return u(e,h.__HTTPPostResponseString,t,c),!0}),h.innerHTTPUploadPost(t,-1,i,r,2,l,a,s))};i.HTTPUploadThroughPostAsMultiPageTIFF=function(t,i,r,e,o,s){var h=this;if(h._resetErr(),h._isMobileMode())return h._mobileNotSupport("HTTPUploadThroughPostAsMultiPageTIFF",o);var c=arguments,l=!1,a=function(t){return n.isFunction(o)&&f(o,h,h.__HTTPPostResponseString,t,c),!1};return!n.isString(r)||r==""?(n.Errors.UploadFileCannotEmpty(h),a()):(e&&n.isFunction(e)&&(l=function(n,t){return u(e,h.__HTTPPostResponseString,t,c),!0}),h.innerHTTPUploadPost(t,-2,i,r,2,l,a,s))};i.HTTPUploadAllThroughPostAsPDF=function(t,i,r,e,o,s){var h=this;if(h._resetErr(),h._isMobileMode())return h._mobileNotSupport("HTTPUploadAllThroughPostAsPDF",o);var c=arguments,l=!1,a=function(t){return n.isFunction(o)&&f(o,h,h.__HTTPPostResponseString,t,c),!1};return!n.isString(r)||r==""?(n.Errors.UploadFileCannotEmpty(h),a()):(e&&n.isFunction(e)&&(l=function(n,t){return u(e,h.__HTTPPostResponseString,t,c),!0}),h.innerHTTPUploadPost(t,-1,i,r,4,l,a,s))};i.HTTPUploadThroughPostAsMultiPagePDF=function(t,i,r,e,o,s){var h=this;if(h._resetErr(),h._isMobileMode())return h._mobileNotSupport("HTTPUploadThroughPostAsMultiPagePDF",o);var c=arguments,l=!1,a=function(t){return n.isFunction(o)&&f(o,h,h.__HTTPPostResponseString,t,c),!1};return!n.isString(r)||r==""?(n.Errors.UploadFileCannotEmpty(h),a()):(e&&n.isFunction(e)&&(l=function(n,t){return u(e,h.__HTTPPostResponseString,t,c),!0}),h.innerHTTPUploadPost(t,-2,i,r,4,l,a,s))};i.HTTPDownloadThroughPost=function(i,u,f,s,h){var c=this,b=e.GetHttpHeadersAndClear(c),a=arguments,y=t.combineUrl(c,i,u),p,w,v;return y===o?(n.Errors.ParameterCannotEmpty(c),o):t.isServerInvalid(c)?(n.isFunction(h)&&r(h,c,a),o):n.License.checkProductKey(c,{Core:!0})?n.License.checkPDFProductKeyWhenNeeds(c,f)?(n.cancelFrome=2,n.showProgress(c,"HttpDownloadThroughPost",l),p="post",w=function(n){var t=n.total===0?100:Math.round(n.loaded*100/n.total),i=[n.loaded," / ",n.total].join("");c._OnPercentDone([0,t,"","http"])},v=l,c._OnPercentDone([0,-1,Dynamsoft.MSG.Downloading,"http"]),n.isFunction(s)||(v=o),t.loadHttpBlob(c,p,y,v,function(n){c._OnPercentDone([0,-1,Dynamsoft.MSG.Loading]);var t=f;(t<-1||t>5)&&(t=-1);c.__LoadImageFromBytes(n,t,"",v,s,h)},function(){n.closeProgress("HttpDownloadThroughPost");n.isFunction(h)&&r(h,c,a)},w,b)):(n.isFunction(h)&&r(h,c,a),o):(n.isFunction(h)&&r(h,c,a),o)};i.HTTPDownloadThroughGet=function(i,u,f,s,h){var c=this,w=e.GetHttpHeadersAndClear(c),v=t.combineUrl(c,i,u),y,p,a;if(v===o)return n.Errors.ParameterCannotEmpty(c),n.isFunction(h)&&r(h,c),o;if(c._isMobileMode()){if(!n.License.checkProductKey(c,{Core:!0}))return n.isFunction(h)&&r(h,c),o}else if(t.isServerInvalid(c)||!n.License.checkProductKey(c,{Core:!0})||!n.License.checkPDFProductKeyWhenNeeds(c,f))return n.isFunction(h)&&r(h,c),o;return n.cancelFrome=2,y="get",n.showProgress(c,"HTTPDownloadThroughGet",l),p=function(n){var t=n.total===0?100:Math.round(n.loaded*100/n.total),i=[n.loaded," / ",n.total].join("");c._OnPercentDone([0,t,"","http"])},a=l,c._OnPercentDone([0,-1,Dynamsoft.MSG.Downloading,"http"]),n.isFunction(s)||(a=o),c._isMobileMode()?t.loadHttpBlob(c,y,v,a,function(t){c._OnPercentDone([0,-1,Dynamsoft.MSG.Loading]);c.LoadImageFromBinary(t,function(){Dynamsoft.Lib.closeProgress("");n.isFunction(s)&&s()},function(){n.closeProgress("HTTPDownloadThroughGet");n.isFunction(h)&&r(h,c)})},function(){n.closeProgress("HTTPDownloadThroughGet");n.isFunction(h)&&r(h,c)},p,w):t.loadHttpBlob(c,y,v,a,function(n){c._OnPercentDone([0,-1,Dynamsoft.MSG.Loading]);var t=f;(t<-1||t>5)&&(t=-1);c.__LoadImageFromBytes(n,t,"",a,s,h)},function(){n.closeProgress("HTTPDownloadThroughGet");n.isFunction(h)&&r(h,c)},p,w)};i.HTTPUploadThroughPut=function(n,i,r,u,f){var e=t.getImageType(r);return this.HTTPUploadThroughPutEx(n,i,r,e,u,f)};i.HTTPUploadThroughPutEx=function(i,r,o,s,h,c){var l=this,rt=e.GetHttpHeadersAndClear(l),p="HTTPUploadThroughPutEx",k=t.combineUrl(l,i,o),w=!0,d="",a=[],v,g,b,y,nt,tt,it;if(k===!1)return n.Errors.ParameterCannotEmpty(l),n.isFunction(c)&&f(c,l,"",[r],o,s),!1;n.isFunction(h)||(w=!1);n.cancelFrome=1;v=function(){return n.needShowTwiceShowDialog=!1,n.closeProgress(p),n.isFunction(c)&&f(c,l,l.__HTTPPostResponseString,a,o,s),!1};n.needShowTwiceShowDialog=!0;n.showProgress(l,p,!1);switch(r){case-1:for(b=0;b<l._ImgManager.count();b++)a.push(b);break;case-2:a=l._ImgManager.getSelectedClientIndexArray();break;default:if(a.push(r),!(r>=0))return n.Errors.IndexOutOfRange(l),v()}return i===""?(n.Errors.HttpServerCannotEmpty(l),v()):(y=[],n.isArray(a)&&n.each(a,function(n){var t=l._ImgManager.convertClientIndexToServerId(n);t!=-1&&y.push(t)}),nt=Dynamsoft.WebTwainEnv,nt.IfAddMD5InUploadHeader&&d&&(rt["dwt-md5"]=d),tt=!1,it=4,l._OnPercentDone([0,-1,Dynamsoft.MSG.Encoding,"http"]),l.__innerConvertToBlob(s,y,tt,w,it,function(i){if(n.needShowTwiceShowDialog=!1,i&&(n.dlgRef>0||l.__IfShowCancelDialogWhenImageTransfer==!1||w==!1)){var r=l.MaxUploadImageSize,f=i.size;return f>r&&r!=-1?(n.Errors.UploadExceededMaxSize(l),v()):(g=function(n){var t=n.total===0?100:Math.round(n.loaded*100/n.total),i=[n.loaded," / ",n.total].join("");l._OnPercentDone([0,t,"","http"])},l._OnPercentDone([0,-1,Dynamsoft.MSG.Uploading,"http"]),t.setBtnCancelVisibleForProgress(l,!0),t.httpPutImage(l,k,i,w,function(t){if(l.__HTTPPostResponseString=t,n.closeProgress(p),n.isFunction(h)){var i=[];n.isArray(y)&&n.each(y,function(n){var t=l._ImgManager.convertServerIdToClientIndex(n);t>-1&&i.push(t)});u(h,l.__HTTPPostResponseString,i,o,s)}return!0},v,g))}return n.closeProgress(p),!1},v))};i.HTTPUploadAllThroughPutAsMultiPageTIFF=function(n,t,i,r){var u=this;return u.HTTPUploadThroughPutEx(n,-1,t,2,i,r)};i.HTTPUploadThroughPutAsMultiPageTIFF=function(n,t,i,r){var u=this;return u.HTTPUploadThroughPutEx(n,-2,t,2,i,r)};i.HTTPUploadAllThroughPutAsPDF=function(n,t,i,r){var u=this;return u.HTTPUploadThroughPutEx(n,-1,t,4,i,r)};i.HTTPUploadThroughPutAsMultiPagePDF=function(n,t,i,r){var u=this;return u.HTTPUploadThroughPutEx(n,-2,t,4,i,r)};i.GetSelectedImagesSize=function(n){var i=this,r;return(i._resetErr(),i._isMobileMode())?i._mobileNotSupport("GetSelectedImagesSize"):(r=h(i),i._innerFun("GetSelectedImagesSize",t.makeParams(n,r.join(","))))};i.SetHTTPHeader=function(t,i){var r=this,e,f,u;if(r._resetErr(),u=t,r.__httpHeaderMap||(r.__httpHeaderMap={}),!u||!n.isString(u))return n.isUndefined(u)?n.Errors.HttpHeaderIsUndefined(r):u===""?n.Errors.HttpHeaderIsEmpty(r):u===null?n.Errors.HttpHeaderIsNull(r):n.Errors.HttpHeaderIsInvalid(r),!1;for(e=["if-modified-since","if-none-match","if-range","range","accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via","dwt-md5"],u=u.toLowerCase(),f=0;f<e.length;f++)if(e[f]==u)return n.Errors.HttpHeaderNotAllowed(r),!1;return n.isUndefined(i)||i===null||i===""?(t in r.__httpHeaderMap&&delete r.__httpHeaderMap[t],!0):(n.isNumber(i)&&(i=""+i),r.__httpHeaderMap[t]=i,!0)};n.html5.Base64Result=function(n,t,i,r){var u=this;u._stwain=n;u._md5=i;u._length=t;u._content=r};n.html5.Base64Result.prototype.getLength=function(){return this._length};n.html5.Base64Result.prototype.getMD5=function(){return this._md5};n.html5.Base64Result.prototype.getData=function(t,i){var r=this,u=i;return!n.isNumber(t)||!n.isNumber(i)?"":t<0||i<=0?"":(t+u>r._length&&(u=r._length-t),r._content.substr(t,u))};i._ConvertToBlob=function(i,r,e,o,s){var h=this,a="ConvertToBlob",v=!0,y=arguments,c,l,p;return n.isFunction(o)||(v=!1),n.cancelFrome=0,n.showProgress(h,a,!1),c=function(){if(n.needShowTwiceShowDialog=!1,n.closeProgress(a),n.isFunction(s)){var t=[];n.isArray(i)&&n.each(i,function(n){var i=h._ImgManager.convertServerIdToClientIndex(n);i>-1&&t.push(i)});f(s,h,t,r,y)}return!1},p=2,h.__innerConvertToBlob(r,i,e,v,p,function(f){var s,p,e;return!f||f.size<=0?(n.Errors.ConvertBlobIsEmpty(h),c()):(s=h.MaxUploadImageSize,p=f.size,p>s&&s!=-1)?(n.Errors.UploadExceededMaxSize(h),c()):(n.needShowTwiceShowDialog=!1,n.closeProgress(a),n.isFunction(o)&&(e=[],n.isArray(i)&&n.each(i,function(n){var t=h._ImgManager.convertServerIdToClientIndex(n);t>-1&&e.push(t)}),f instanceof Blob?(l=t.getBlobTypeByImageType(r),u(o,f.slice(0,f.size,l),e,y)):u(o,f,e,y)),v?!0:(l=t.getBlobTypeByImageType(r),f.slice(0,f.size,l)))},c)};i.ConvertToBlob=function(i,r,e,o){var s=this,l;s._resetErr();var h=parseInt(r),a=arguments,y=function(t,i){return n.isFunction(e)&&u(e,t,i,r,a),!0},c=function(t){return n.isFunction(o)&&f(o,s,t,r,a),!1},v=!1;if(!n.License.checkProductKey(s,{Core:!0}))return n.isFunction(o)&&o(s.ErrorCode,s.ErrorString),!1;if(!s._isMobileMode()&&t.isServerInvalid(s)||!s._checkIndices(i))return c(i);if(h==EnumDWT_ImageType.IT_BMP||h==EnumDWT_ImageType.IT_JPG||h==EnumDWT_ImageType.IT_PNG){if(i.length>1)return n.Errors.ConvertBinaryIndexMoreThanOne(s),c(i)}else if(h!=EnumDWT_ImageType.IT_TIF&&h!=EnumDWT_ImageType.IT_PDF)return n.Errors.InvalidImageType(s),c(i);return(l=[],n.isArray(i)&&n.each(i,function(n){var t=s._ImgManager.convertClientIndexToServerId(n);t!=-1&&l.push(t)}),!n.isFunction(e))?s._ConvertToBlob(l,h,v):(s._ConvertToBlob(l,h,v,y,c),!0)};n._asyncUploadCmd=function(t){var i=t._this,c=t.bOnlyUploadForm,s=t.url,f=t.asyncSuccessFunc,e=t.asyncFailureFunc;if(c)i._innerFormFieldHTTPUpload(s,function(){if(n.isFunction(f))try{f()}catch(t){}},function(){if(n.isFunction(e))try{e()}catch(t){}});else{var r=t.serverIds,l=t.enumImageType,a=t.dataFormat,v=t.fileName,y=t.saveSetup,o=t.retry,p=t.bOnlyEmptyIsOK,w=t.objUploadFileStatus,h=function(){if(n.isFunction(e)){var t=[];n.isArray(r)&&n.each(r,function(n){var r=i._ImgManager.convertServerIdToClientIndex(n);r>-1&&t.push(r)});try{e(t)}catch(u){}}return!1};return(n.isNumber(o)&&o>0||(o=0),i._errorCode!=0)?h():i._innerHTTPUpload(s,r,l,a,v,y,o,p,w,function(t){if(n.isFunction(f)){var e=[];n.isArray(r)&&n.each(r,function(n){var t=i._ImgManager.convertServerIdToClientIndex(n);t>-1&&e.push(t)});try{u(f,t,e)}catch(o){}}return!0},h)}};i._asyncUploadFilesCmd=function(i,r,f,o,s,h,c,l,a,v){var y=this,it=parseInt(f),k="HTTPUpload",rt=i,d=!1,w=[],p;if(y.__HTTPPostResponseString="",n.cancelFrome=1,p=function(){if(y._bServerPercentDone=!0,n.needShowTwiceShowDialog=!1,h&&n.closeProgress(k),w=null,n.isFunction(v)){var t=[];n.isArray(r)&&n.each(r,function(n){var i=y._ImgManager.convertServerIdToClientIndex(n);i>-1&&t.push(i)});try{v(t)}catch(i){}}return!1},n.needShowTwiceShowDialog=!0,h&&n.showProgress(y,k,!1),t.isServerInvalid(y))return p();var ut=function(t){if(y._bServerPercentDone=!0,n.needShowTwiceShowDialog=!1,h&&n.closeProgress(k),w=null,n.isFunction(a)){var i=[];n.isArray(r)&&n.each(r,function(n){var t=y._ImgManager.convertServerIdToClientIndex(n);t>-1&&i.push(t)});u(a,t,i)}},g=r.length,b=0,nt=0,ft=4,tt="";return y._bServerPercentDone=!1,y._OnPercentDone([0,-1,Dynamsoft.MSG.Encoding,"http"]),n.each(r,function(i,r){d=y.__innerConvertToBlob(it,[i],s,!0,ft,function(i,u){var f,a,s,v,k;if(!i||i.size<=0)return n.Errors.UploadFileCannotEmpty(y),p();if(f=y.MaxUploadImageSize,a=i.size,a>f&&f!=-1)return n.Errors.UploadExceededMaxSize(y),p();if(s=t.cformat(o,r+1),nt=(b+1)/g*100,tt=[b+1,"/",g].join(""),y._OnPercentDone([0,nt,tt,"http",s]),v=u[0],k=u[1],i.name=s,w.push(i),b++,b>=g){var it=e.GetHttpHeadersAndClear(y);d=t.httpPostUploadFiles(y,rt,w,!0,0,it,h,c,l,function(n){ut(n)},p)}},p,[i,r])}),d}}});Dynamsoft.Ready(function(n){var f=Dynamsoft,i=f.navInfo,u=n.html5,e=u.STwain,r=u.Funs,t,o=Dynamsoft.WebTwainEnv,s={upload:"Uploading...",download:"Downloading...",load:"Loading...",decode:"Decoding...",decodeTIFF:"Decoding tiff...",decodePDF:"Decoding pdf...",encodeTIFF:"Encoding tiff...",encodePDF:"Encoding pdf...",encode:"Encoding..."};n.product.bHTML5Edition&&(t=e.prototype,t.RegisterEvent=function(n,t){var i=this,r;return i._resetErr(),r=["__",n].join(""),i[r]=t,!0},t.onEvent=function(n,t){this.RegisterEvent(n,t)},t.on=function(n,t){this.RegisterEvent(n,t)},t.OnRefreshUI=function(n,t,i,r){var u=this;return u._bNoUI||(i&&u._ImgManager.refresh(n,u._ImgManager.count(),!0,r),Dynamsoft.Lib.isFunction(u.__OnRefreshUI)&&u.__OnRefreshUI(u._ImgManager.getCurrentImageIndex(),u._ImgManager.count())),!0},t._OnBitmapChanged=function(t){var i=this,h=t[0]=="10",e=t[0]=="0"||h,u=t[1].split(","),f=t[2],c=t[3],v=i.__maxImagesInBuffer,o=1,y=2,r={},s,l,p,a;if(h?t.length>5&&(r=t[5]):(t.length>5&&(r.imageWidth=t[5]),t.length>6&&(r.imageHeight=t[6]),t.length>7&&(r.imageBitDepth=t[7]),t.length>8&&(r.imageXResolution=t[8]),t.length>9&&(r.imageYResolution=t[9])),n.log("OnBitmapChanged:"+t),f!=y&&(f!=o||i.__IfAppendImage)?f==o&&i.__IfAppendImage?(n.each(u,function(n){var t=parseInt(n),u;if(isNaN(t)||t<0)return!0;if(e)i._aryBitmapCache.push(t);else for(u=0;u<i._aryBitmapCache.length;u++)if(i._aryBitmapCache[u]==t)return i._aryBitmapCache.splice(u,1),!0;if(i._ImgManager.exists(t))return!0;i._ImgManager.append(v,t,r)}),n.isFunction(i.__OnRefreshUI)&&i.__OnRefreshUI(i._ImgManager.getCurrentImageIndex(),i._ImgManager.count())):f==3&&e?(s=!1,u.length==1&&u[0]==-1?s=!0:u.length==1&&i._ImgManager.count()<=1&&(s=i._ImgManager.convertClientIndexToServerId(0)==u[0]),s?i._ImgManager.clear():n.each(u,function(n){var t=parseInt(n);if(isNaN(t)||t<0)return!0;i._ImgManager.removeByServerId(t)}),n.isFunction(i.__OnRefreshUI)&&i.__OnRefreshUI(i._ImgManager.getCurrentImageIndex(),i._ImgManager.count())):f==4?n.each(u,function(n){var t=parseInt(n),u;if(isNaN(t)||t<0)return!0;t>=0&&!i.__bLoadingImage&&(i._bNoUI||(i._ImgManager.bImageJustChangedInEditor==!1?i._ImgManager.bImageChangedInViewer=!0:(i._ImgManager.bImageJustChangedInEditor=!1,i._ImgManager.bImageChangedInViewer=!1)),u=i._ImgManager.convertServerIdToClientIndex(t),u>-1&&i.OnRefreshUI(u,i._ImgManager.count(),!0,r))}):f==5&&c>=0&&!i.__bLoadingImage&&(i.__IfAppendImage==!1&&i._ImgManager._UIView.bSingleMode==!0&&i.OnRefreshUI(c,i._ImgManager.count(),!0,r),i._ImgManager.refresh(c,i._ImgManager.count(),!1,r)):(n.each(u,function(n){var t=parseInt(n),f=i._ImgManager.getCurrentImageIndex(),u;if(isNaN(t)||t<0)return!0;if(e)i._aryBitmapCache.push(t);else for(u=0;u<i._aryBitmapCache.length;u++)if(i._aryBitmapCache[u]==t)return i._aryBitmapCache.splice(u,1),!0;if(i._ImgManager.exists(t))return!0;i.__insertingIndex>-1&&(f=i.__insertingIndex);f==-1&&(f=0);i._ImgManager.insertBefore(f,v,t,r);i.__insertingIndex>-1&&(i.__insertingIndex=i.__insertingIndex+1)}),n.isFunction(i.__OnRefreshUI)&&i.__OnRefreshUI(i._ImgManager.getCurrentImageIndex(),i._ImgManager.count())),n.isFunction(i.__OnBitmapChanged)){if(!h&&e)return!0;l=[];n.each(u,function(n){var t=parseInt(n),r;if(isNaN(t)||t<0)return!0;r=i._ImgManager.convertServerIdToClientIndex(t);r>-1&&l.push(r)});p=i._ImgManager.getCurrentImageIndex();a=f;f==o&&(a=i.__IfAppendImage?o:y);i.__OnBitmapChanged(l,a,p,i._ImgManager.count())}},t._OnPostLoad=function(t,i){var u=this,e,f,o,s;i!==undefined&&i.exception!==undefined&&i.description!==undefined&&(u._errorCode=i.exception,u._errorString=i.description);n.log("OnPostLoad Results:");f=t[1].split(",");e=n.base64.decode(f[0]);o=n.base64.decode(f[1]);n.log(e);n.log(o);n.log(f[2]);r.autoDiscardBlankImage(u,"On PostLoad");s=u._ImgManager.getCurrentImageIndex();s>=0&&u.OnRefreshUI(s);n.isFunction(u.__OnPostLoad)&&u.__OnPostLoad(e,o,f[2])},t._OnPostTransfer=function(t){var i=this;n.log("On PostTransfer Results:"+t);r.autoDiscardBlankImage(i,"On PostTransfer");n.isFunction(i.__OnPostTransfer)&&i.__OnPostTransfer()},t._OnPostTransferAsync=function(t){var r=this,i,u,f;if(n.log("On PostTransfer Async Results:"+t),n.isFunction(r.__OnPostTransferAsync)){if(t&&t.length>=2)try{u=String(t[1]);f=u.replace(/\\/g,"\\\\");i=n.parse(f);i.imageId&&(i.imageId=r.objImageIndexManager.convertServerIdToGuid(i.imageId))}catch(e){n.log(t)}i||(i={imageId:-1});r.__OnPostTransferAsync(i)}},t._OnPreAllTransfersAsync=function(t){var r=this,i;if(n.isFunction(r.__OnPreAllTransfersAsync)){i={event:"beforeAcquire",result:{}};try{n.isArray(t)&&t.length>1&&(i=n.parse(t[1]))}catch(u){}setTimeout(function(){r.__OnPreAllTransfersAsync(i)},10)}},t._OnPostAllTransfers=function(t){var i=this;t.length>=2&&i._errorCode==0&&(i._errorCode=t[1],i._errorString=t[2]);n.log("On PostAllTransfers Results:"+t);i.__bLoadingImage=!1;n.isFunction(i.__OnPostAllTransfers)&&i.__OnPostAllTransfers()},t._OnResult=function(t){var i=this,r=t[1];n.isFunction(i.__OnResult)&&i.__OnResult(r)},t._OnTransferCancelled=function(){var t=this,i=t._ImgManager.getCurrentImageIndex(),r=t._ImgManager.count();t.__bLoadingImage=!1;n.isFunction(t.__OnTransferCancelled)&&t.__OnTransferCancelled()},t._OnTransferError=function(){var t=this;n.isFunction(t.__OnTransferError)&&t.__OnTransferError()},t._OnSourceUIClose=function(){var t=this;n.isFunction(t.__OnSourceUIClose)&&t.__OnSourceUIClose()},t._OnPreTransfer=function(){var t=this;n.isFunction(t.__OnPreTransfer)&&t.__OnPreTransfer()},t._OnPreAllTransfers=function(){var t=this;n.isFunction(t.__OnPreAllTransfers)&&t.__OnPreAllTransfers()},t._OnPercentDone=function(n){var h=this,y=!1,u,t=Dynamsoft.Lib,c=!1,nt,l=0,a,p,w,rt,d,v,g,it;if(t.isArray(n)&&n.length>2&&(nt=n[0],l=n[1],a=n[2],n.length>3&&(p=n[3]),n.length>4&&(w=n[4]),n.length>5&&(rt=n[5]),u=l,l<0?u=0:l>100&&(u=100),u=Math.floor(u),(t.cancelFrome==1||t.cancelFrome==2||t.cancelFrome==5)&&(c=w)),h._bServerPercentDone||nt==0){if((l>0||l==0)&&((t.cancelFrome==1||t.cancelFrome==2)&&p=="http"&&(y=!0),(t.cancelFrome==3||t.cancelFrome==4)&&w=="ftp"&&(y=!0)),t.cancelFrome==0&&h.__IfShowProgressBar==!0||t.cancelFrome!=0&&h.__IfShowCancelDialogWhenImageTransfer==!0){var f=t.one(".dynamsoft-progressBar"),b=t.one(".dynamsoft-status"),k=t.one(".dynamsoft-finalMessage"),tt=t.one(".dynamsoft-desc"),e;(t.cancelFrome==3||t.cancelFrome==4)&&(d=p,d==0?r.setBtnCancelVisibleForProgress(h,!1):d==1&&r.setBtnCancelVisibleForProgress(h,!0));l<0?(t.progressMessage=a,e=t.progressMessage):e=a!=""&&a!="1/1"?t.progressMessage+"("+a+")":t.progressMessage;k&&k.getEL()&&(v="",g="",e.indexOf(" ...")&&(e=e.replace(" ...","...")),e.indexOf("(")!=-1?(v=e.substr(0,e.indexOf("(")),g=e.substr(e.indexOf("("))):v=e,t.each(s,function(n,t){n.indexOf(v)!=-1&&(e=o.CustomizableDisplayInfo.customProgressText[t]+g)}),e==""&&(e="&nbsp;"),k.html(e));c!=!1?(c==""||t.isUndef(c)?c="&nbsp;":t.isString(c)&&c.length>30&&(c=c.substring(0,30)+"..."),tt.html(c)):tt.html("&nbsp;");(u||u===0)&&(b&&b.getEL()&&b.html(u+"%"),f&&f.getEL()&&(i.bIE?f[0].objProgressBar?f[0].objProgressBar.setValue(u):f[0].value=u:i.bEdge?(f[0].style.display="",f[0].value=u):f[0].value=u));u&&(u>=100||t.dlgRef<=0)&&(setTimeout(function(){f&&f.getEL()&&(i.bIE?f[0].objProgressBar?f[0].objProgressBar.setValue(0):f[0].value=0:i.bEdge?(f[0].style.display="none",f[0].value=0):f[0].value=0)},1e3),t.dlgRef<=0&&(it="OnPercentDone",t.closeProgress(it)))}y==!0&&(t.isFunction(h.__OnInternetTransferPercentage)&&h.__OnInternetTransferPercentage(u,!1),t.isFunction(h.__OnInternetTransferPercentageEx)&&h.__OnInternetTransferPercentageEx(u,!1));t.isFunction(h.__OnPercentDone)&&h.__OnPercentDone()}},t._OnGetFilePath=function(t){var f=this,i,r,u;i=t[1].split(",");n.log("On GetFilePath Results:"+t);r=n.base64.decode(i[3]);u=n.base64.decode(i[4]);i[2]=="-1032"&&(i[2]="-1",r=u="");n.isFunction(f.__OnGetFilePath)&&f.__OnGetFilePath(i[0]*1,i[1]*1,i[2]*1,r,u)},t.checkErrorString=function(){var t=this,n=t.ErrorCode,i;return n===-2115?!0:(n===-2003&&(i=window.open("","ErrorMessage","height=500,width=750,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no"),i.document.writeln(t.__HTTPPostResponseString)),n===0)},t.__GetLoadEventsNum=function(){var i=this,t=0;return n.isFunction(i.__OnPostLoad)&&(t=t|1),n.isFunction(i.__OnGetFilePath)&&(t=t|2),t})});Dynamsoft.Ready(function(n){var o=Dynamsoft;if(n.product.bHTML5Edition){var e=n.html5.STwain,t=e.prototype,r=n,i=n.html5.Funs,s=Dynamsoft.WebTwainEnv,f=!1,u=!0;t.SetCookie=function(n){return this._cookie=n,document.cookie=n,u};t.LoadImageFromBase64Binary=function(t,e,o,s){var h=this,v,b,a;h._resetErr();var w=f,l="LoadImageFromBase64Binary",c=e,y,p=0;if(((n.isUndef(e)||e==5)&&n.isString(t)&&(t.indexOf("data:image/bmp")!=-1?c=0:t.indexOf("data:image/jpeg")!=-1?c=1:t.indexOf("data:image/tif")!=-1?c=2:t.indexOf("data:image/png")!=-1?c=3:t.indexOf("data:application/pdf")!=-1&&(c=4)),(c<-1||c>5)&&(c=-1),!n.License.checkProductKey(h,{Core:!0}))||!n.License.checkPDFProductKeyWhenNeeds(h,c))return n.isFunction(s)&&s(h.ErrorCode,h.ErrorString),f;if(h._isMobileMode()){if(n.cancelFrome=2,n.showProgress(h,l,u),h.__bLoadingImage=u,v=t,r.isString(t)){if(t.indexOf("blob:")>=0||t.indexOf("data:")>=0||(b=e==EnumDWT_ImageType.IT_PNG?"data:image/png;base64,":e==EnumDWT_ImageType.IT_JPG?"data:image/jpeg;base64,":e==EnumDWT_ImageType.IT_TIF?"data:image/tif;base64,":e==EnumDWT_ImageType.IT_PDF?"data:application/pdf;base64,":e==EnumDWT_ImageType.IT_BMP?"data:image/bmp;base64,":"data:application/octet-stream;base64,",t=[b,t].join("")),t.indexOf("data:")>=0&&(v=r.MobileFuns.dataURLtoBlob(t),v==!1))return Dynamsoft.Lib.closeProgress(l),h.__bLoadingImage=!1,n.Errors.ConvertFromBase64Failed(h),n.isFunction(s)&&s(h.ErrorCode,h.ErrorString,t,e),!1}else t instanceof ArrayBuffer&&(a="image/png",e==EnumDWT_ImageType.IT_PNG?a="image/png":e==EnumDWT_ImageType.IT_JPG?a="image/jpeg":e==EnumDWT_ImageType.IT_TIF?a="image/tiff":e==EnumDWT_ImageType.IT_PDF?a="application/pdf":e==EnumDWT_ImageType.IT_BMP&&(a="image/bmp"),v=new Blob([t],{type:a}));return y=h._innerSendToMobile("LoadImageFromBinary",r.MobileFuns.makeParams(v),0,function(){if(Dynamsoft.Lib.closeProgress(l),h.__bLoadingImage=!1,!h._bNoUI){var n=h._ImgManager.getCurrentImageIndex();n>=0&&h.OnRefreshUI(n)}return o&&o(t,e),!0},function(){Dynamsoft.Lib.closeProgress(l);h.__bLoadingImage=!1;n.isFunction(s)&&s(h.ErrorCode,h.ErrorString,t,e)}),!0}if(n.isFunction(o)&&(w=u),n.isString(t)&&t.indexOf("base64,")!=-1&&(t=t.substr(t.indexOf("base64,")+7)),p=h.__GetLoadEventsNum(),w){if(i.isServerInvalid(h))return n.isFunction(s)&&s(h.ErrorCode,h.ErrorString,t,e),f;n.cancelFrome=2;n.showProgress(h,l,u);h.__bLoadingImage=u;y=h._innerSend(l,i.makeParams(t,c,p),u,function(){if(Dynamsoft.Lib.closeProgress(l),h.__bLoadingImage=!1,!h._bNoUI){var n=h._ImgManager.getCurrentImageIndex();n>=0&&h.OnRefreshUI(n)}return o&&o(t,e),!0},function(){Dynamsoft.Lib.closeProgress(l);h.__bLoadingImage=!1;n.isFunction(s)&&s(h.ErrorCode,h.ErrorString,t,e)})}else y=h.__innerLoadImageFun(l,i.makeParams(t,c,p));return y};t.SaveSelectedImagesToBytes=function(){return n.Errors.HTML5NotSupport(this),f};t.LoadImageFromBytes=function(){return n.Errors.HTML5NotSupport(this),f};t.UnregisterEvent=function(n){var t=this,i;return t._resetErr(),i=["__",n].join(""),t[i]=null,u};t.SetCancel=function(n,t){var i=this;return(i._resetErr(),i._isMobileMode())?i._mobileNotSupport("SetCancel",t):this._innerSend("SetCancel",null,u,n,t)};t._asyncSetImageWidth=function(t,u,f,e){var o=this,s=function(){i.refreshImageAfterInvokeFun(o,t);n.isFunction(f)&&setTimeout(f,30)},h=function(){n.isFunction(e)&&e(o.ErrorCode,o.ErrorString)},c=parseInt(t);return o._innerSendToMobile("SetImageWidth",r.MobileFuns.makeParams(c,u),0,s,h)};t.SetImageWidth=function(t,r,u,f){var e=this,c,s,o,h;return(e._resetErr(),o=parseInt(t),isNaN(o)||o<0||o>=e._ImgManager.count())?(n.Errors.IndexOutOfRange(e),n.isFunction(f)&&f(e.ErrorCode,e.ErrorString),!1):n.isUndefined(r)?(n.Errors.InvalidParameter(e),n.isFunction(f)&&f(e.ErrorCode,e.ErrorString),!1):e._isMobileMode()?e._asyncSetImageWidth(o,r,u,f):(h=e._ImgManager.convertClientIndexToServerId(o),h==-1)?(n.Errors.IndexOutOfRange(e),n.isFunction(f)&&f(e.ErrorCode,e.ErrorString),!1):(c=e._innerFun("SetImageWidth",i.makeParams(h,r)),s=c==1,s?n.isFunction(u)&&u():n.isFunction(f)&&f(e.ErrorCode,e.ErrorString),s)};t.HTTPDownloadStreamThroughPost=function(){return n.Errors.HTML5NotSupport(this),f};t.HTTPUploadStreamThroughPost=function(){return n.Errors.HTML5NotSupport(this),f};t.HTTPUploadThroughPutDirectly=function(){return n.Errors.HTML5NotSupport(this),!1};t.SetCustomDSDataEx=function(n){var t=this;return(t._resetErr(),t._isMobileMode())?t._mobileNotSupport("SetCustomDSDataEx"):this._innerFun("SetCustomDSDataEx",i.makeParams(n))};t.SetCustomDSData=function(n){var t=this,r;return(t._resetErr(),t._isMobileMode())?t._mobileNotSupport("SetCustomDSData"):(r=i.replaceLocalFilename(n),this._innerFun("SetCustomDSData",i.makeParams(r)))};t.GetCustomDSDataEx=function(){var n=this;return(n._resetErr(),n._isMobileMode())?n._mobileNotSupport("GetCustomDSDataEx"):n._innerFun("GetCustomDSDataEx")};t.GetCustomDSData=function(n){var t=this,r;return(t._resetErr(),t._isMobileMode())?t._mobileNotSupport("GetCustomDSData"):(r=i.replaceLocalFilename(n),t._innerFun("GetCustomDSData",i.makeParams(r)))};t._asyncConvertToBW=function(t,u,f){var e=this,o=function(){i.refreshImageAfterInvokeFun(e,t);n.isFunction(u)&&u()},s=function(){n.isFunction(f)&&f(e.ErrorCode,e.ErrorString)},h=parseInt(t);return e._innerSendToMobile("ConvertToBWScale",r.MobileFuns.makeParams(h),0,o,s)};t.ConvertToBW=function(t,i,r){var u=this,f,e;return(u._resetErr(),!n.License.checkProductKey(u,{Core:!0}))?(n.isFunction(r)&&r(u.ErrorCode,u.ErrorString),!1):(f=parseInt(t),isNaN(f)||f<0||f>=u._ImgManager.count())?(n.Errors.IndexOutOfRange(u),n.isFunction(r)&&r(u.ErrorCode,u.ErrorString),!1):u._isMobileMode()?u._asyncConvertToBW(f,i,r):(e=u.ChangeBitDepth(t,1,!0),e?n.isFunction(i)&&i():n.isFunction(r)&&r(u.ErrorCode,u.ErrorString),e)};t.LoadImageFromBinary=function(t,i,u){var f=this,o,e;if(!n.License.checkProductKey(f,{Core:!0}))return n.isFunction(u)&&u(f.ErrorCode,f.ErrorString),!1;if(!t||t=="")return n.Errors.ParameterCannotEmpty(f),n.isFunction(u)&&u(f.ErrorCode,f.ErrorString),!1;if(t instanceof FileList)return f.LoadImageFromBinary(t[0],i,u);if(window.ReadableStream&&t instanceof ReadableStream?o=new Response(t):window.Response&&t instanceof Response&&(o=t),f._bLocalService)if(o)o.arrayBuffer().then(function(n){var t=new Blob([n]);f.__LoadImageFromBytes(t,-1,"",!0,i,u)});else{e=t;(e instanceof ArrayBuffer||e instanceof Uint8Array)&&(e=new Blob([t]));var s=-1,h=Dynamsoft.EnumDWT_ImageType;n.isString(e.type)&&(e.type=="application/pdf"?s=h.IT_PDF:e.type=="image/png"?s=h.IT_PNG:e.type=="image/jpeg"?s=h.IT_JPG:e.type=="image/bmp"?s=h.IT_BMP:e.type=="image/tiff"&&(s=h.IT_TIF));f.__LoadImageFromBytes(e,s,"",!0,i,u)}else o?o.arrayBuffer().then(function(n){f._innerSendToMobile("LoadImageFromBinary",r.MobileFuns.makeParams(n),0,i,u)}):f._innerSendToMobile("LoadImageFromBinary",r.MobileFuns.makeParams(t),0,i,u);return!0};t.EnableSourceUI=function(n,t){var i=this;return(i._resetErr(),i._isMobileMode())?i._mobileNotSupport("EnableSourceUI",t):i._innerSend("EnableSourceUI",null,!0,n,t)};t.getCapabilities=function(n,t){var i=this;return i._bLocalService?i._innerFunRaw("GetCapabilities",null,!0,!1,!1,function(u){var f;u[0]=r.replaceAll(u[0],"\\\\","\\\\");try{f=JSON.parse(u[0])}catch(e){i._errorCode=-2302;i._errorString=e;r.isFunction(t)&&t(i.ErrorCode,i.ErrorString);return}f.errorCode==0?r.isFunction(n)&&n(f.response):(i._errorCode=f.errorCode,i._errorString=f.errorString,r.isFunction(t)&&t(i.ErrorCode,i.ErrorString))},t):i._mobileNotSupport("GetCapabilities",t)};t.setCapabilities=function(t,i,r){var u=this,f,e;return u._bLocalService?n.isObject(t)&&!n.isArray(t)?(f=["[",n.stringify(t),"]"].join(""),e=function(t){n.isFunction(i)&&i(t)},u._innerSend("SetCapabilities",f,0,e,r)):(n.Errors.InvalidParameter(u),n.isFunction(r)&&r(u.ErrorCode,u.ErrorString),!1):u._mobileNotSupport("SetCapabilities",r)};t.BindViewer=function(t,i){var r=this,u=!1;return r.config.containerID!=t&&(r.config.containerID=t,r.config.ifBindViewer=!0,n.html5.ui.init(r,r.config)),u=r._ImgManager.BindView(t,i),r._bNoUI=!1,r.config.ifBindViewer=!1,u};t.UnbindViewer=function(){var n=this;return n._bNoUI=!0,n.config.containerID="",n._ImgManager.UnbindView()};t.UpdateViewer=function(n){var t=this;return t._ImgManager.UpdateView(n)};t.GetIfShowVideoContainer=function(){var n=this;return n._ImgManager.GetIfShowVideoContainer()};t.ShowVideoContainer=function(n){var t=this;return t._bNoUI=n?!0:!1,t._ImgManager.ShowVideoContainer(n)};t.UpdateVideoContainer=function(n){var t=this;return t._ImgManager.UpdateVideoContainer(n)};t.ChangeBitDepth=function(t,r,u){var f=this,e,o;return(f._resetErr(),f._isMobileMode())?f._mobileNotSupport("ChangeBitDepth"):(e=parseInt(t),isNaN(e)||e<0||e>=f._ImgManager.count())?(n.Errors.IndexOutOfRange(f),!1):(o=f._ImgManager.convertClientIndexToServerId(e),o==-1)?(n.Errors.IndexOutOfRange(f),!1):f._innerFun("ChangeBitDepth",i.makeParams(o,r,u))};t._asyncConvertToGrayScale=function(t,u,f){var e=this,h=function(){i.refreshImageAfterInvokeFun(e,t);n.isFunction(u)&&setTimeout(u,30)},o=function(){n.isFunction(f)&&f(e.ErrorCode,e.ErrorString)},s;return n.License.checkProductKey(e,{Core:!0})?(s=parseInt(t),e._innerSendToMobile("ConvertToGrayScale",r.MobileFuns.makeParams(s),0,h,o)):(o(),!1)};t.ConvertToGrayScale=function(t,r,u){var f=this,h,o,e,s;return(f._resetErr(),e=parseInt(t),isNaN(e)||e<0||e>=f._ImgManager.count())?(n.Errors.IndexOutOfRange(f),n.isFunction(u)&&u(f.ErrorCode,f.ErrorString),!1):f._isMobileMode()?f._asyncConvertToGrayScale(e,r,u):(s=f._ImgManager.convertClientIndexToServerId(e),s==-1)?(n.Errors.IndexOutOfRange(f),n.isFunction(u)&&u(f.ErrorCode,f.ErrorString),!1):(h=f._innerFun("ConvertToGrayScale",i.makeParams(s)),o=h==1,o?(i.refreshImageAfterInvokeFun(f,e),n.isFunction(r)&&r()):n.isFunction(u)&&u(f.ErrorCode,f.ErrorString),o)};t.ClearTiffCustomTag=function(){var n=this;return(n._resetErr(),n._aryTiffTag.splice(0,n._aryTiffTag.length),n._isMobileMode())?!0:n._innerFun("ClearTiffCustomTag")};t.SetTiffCustomTag=function(t,r,u){var f=this,c,e;if(f._resetErr(),c=n.replaceAll(r,'"','\\"'),e=t*1,e<=0||e>2147483647)return n.Errors.InvalidTiffTagError(f),!1;for(var o=0,s,h=!1,l=f._aryTiffTag.length,o=0;o<l;o++)s=f._aryTiffTag[o],s.tag==e&&(s.Content=r,s.isBinary=!u,h=!0);return!h&&l>=32?(n.Errors.TiffTagCountExceedError(f),!1):f._isMobileMode()?h?!0:(f._aryTiffTag.push({tag:t,content:r,isBinary:!u}),!0):f._innerFun("SetTiffCustomTag",i.makeParams(e,c,u))};t.IsBlankImage=function(t){var r=this,u=parseInt(t),e;return isNaN(u)||u<0||u>=r._ImgManager.count()?(n.Errors.IndexOutOfRange(r),!1):(e=r._ImgManager.convertClientIndexToServerId(u),e==-1)?(n.Errors.IndexOutOfRange(r),!1):r._innerFun("IsBlankImage",i.makeParams(e,f))};t.IsBlankImageExpress=function(t){var r=this,f,e;return(r._resetErr(),r._isMobileMode())?r._mobileNotSupport("IsBlankImageExpress"):(f=parseInt(t),isNaN(f)||f<0||f>=r._ImgManager.count())?(n.Errors.IndexOutOfRange(r),!1):(e=r._ImgManager.convertClientIndexToServerId(f),e==-1)?(n.Errors.IndexOutOfRange(r),!1):r._innerFun("IsBlankImage",i.makeParams(e,u))};t.SetOpenSourceTimeout=function(n){var t=this;return(t._resetErr(),t._isMobileMode())?t._mobileNotSupport("SetOpenSourceTimeout"):t._innerFun("SetOpenSourceTimeout",i.makeParams(n))};t.GetImageURL=function(t,i,r,u,f){var o=this,l;if(o._resetErr(),o._isMobileMode())return o._mobileNotSupport("GetImageURL");var s=t,a=parseInt(i),v=parseInt(r),h,c,e;if(u?(h="",c="dwt://"):(h=o.httpUrl,c="dwt/"),e=[h,c,n.product.getDWTPrefix(),n.product.getServerVersionInfo(),"/img?id=",o.clientId],n.isUndefined(s)||s===null)return n.Errors.IndexNullOrUndefined(o),"";if(f)e.push("&index=-1&width=-1&height=-1&webcam="),e.push(f);else{if(s=parseInt(s),isNaN(s))return n.Errors.InvalidIndex(o),"";if(s<-1||s>=o._ImgManager.count())return n.Errors.IndexOutOfRange(o),"";if(l=o._ImgManager.convertClientIndexToServerId(s),l==-1)return"";e.push("&index=");e.push(l);a>0&&v>0&&(e.push("&width="),e.push(a),e.push("&height="),e.push(v))}return e.push("&t="),e.push((new Date).getTime()),e.join("")};t.GetImagePartURL=function(t,i,r){var u=this,f;return(u._resetErr(),u._isMobileMode())?u._mobileNotSupport("GetImagePartURL"):(f=parseInt(t),isNaN(f)||f<0||f>=u._ImgManager.count())?(n.Errors.IndexOutOfRange(u),""):this.GetImageURL(f,i,r,!0)};t.SetLanguage=function(n){var t=this;return(t._resetErr(),t._isMobileMode())?t._mobileNotSupport("SetLanguage"):t._innerFun("SetLanguageForSecurity",i.makeParams(n))};t._wasmGetLicenseInfo=function(n,t){var i=this,u=function(r){r?r.exception?t&&t(r.exception):(i.__licenseInfo=r,n&&n(i.__licenseInfo)):t&&t()};return i._innerSendToMobile("GetLicenseInfo",r.MobileFuns.makeParams(),0,u,t)};t.GetLicenseInfo=function(n,t){var r=this;if(!r.__licenseInfo){if(r._isMobileMode())return r._wasmGetLicenseInfo(n,t);if(i.isHttpServerInvalid(r))return f;r._innerFunRaw("GetLicenseInfo",null,u,f,u,function(i){i?i.exception?t&&t(i.exception):(r.__licenseInfo=i,n&&n(r.__licenseInfo)):t&&t()},t)}return u};t.IndexToImageID=function(t){var i=this,r,u;return(i._resetErr(),r=parseInt(t),isNaN(r)||r<0||r>=i._ImgManager.count())?(n.Errors.IndexOutOfRange(i),-1):(u=i._ImgManager.convertClientIndexToServerId(r),i.objImageIndexManager.convertServerIdToGuid(u))};t.ImageIDToIndex=function(t){var i=this,r,u;return i._resetErr(),r=i.objImageIndexManager.convertGuidToServerId(t),r>0&&(u=i._ImgManager.convertServerIdToClientIndex(r)),u==-1&&n.Errors.InvalidImageID(i),u};t._setProductKeyV2=function(t){var r=this,f=t,u,e;return(r._resetErr(),i.isHttpServerInvalid(r))?n.Promise.reject({code:r._errorCode,message:r._errorString}):!n.isString(f)||f=="******"?(n.Errors.LicenseEmptyOrInvalid(r),n.Promise.reject({code:r._errorCode,message:r._errorString})):(e=Dynamsoft.WebTwainEnv.ProductKey,u=n.startsWith(f,"http://")||n.startsWith(f,"https://")?n.fetch(f,{method:"get"}):n.Promise.resolve(f),u=u.then(function(n){return r._innerFunRawV2("ProductKey",i.makeParams(n))},function(t){n.Errors.HttpLicenseInvalid(r);var i;i=t?[r._errorString," Http info: ",t.errorString," (",t.httpCode,")"].join(""):r._errorString;Dynamsoft.WebTwainEnv.ProductKey=e;throw{code:r._errorCode,message:i};}),u=u.then(function(t){if(t){if(t.exception!==undefined&&t.description!==undefined){r._errorCode=t.exception;r._errorString=t.description;Dynamsoft.WebTwainEnv.ProductKey=e;u.context=null;throw{code:r._errorCode,message:r._errorString};}return Dynamsoft.WebTwainEnv.ProductKey=u.context.productKey,u.context=null,r._innerFunRawV2("GetLicenseInfo")}n.Errors.LicenseEmptyOrInvalid(r);Dynamsoft.WebTwainEnv.ProductKey=e;u.context=null;throw{code:r._errorCode,message:r._errorString};}),u.context={productKey:f},u)};t.SetProductKeyAsync=function(t){var i=this,u;return(i._resetErr(),n.isUndefined(t))?(n.Errors.LicenseEmptyOrInvalid(i),n.Promise.reject({code:i._errorCode,message:i._errorString})):(u=i._isMobileMode()?i._innerSendToMobileV2("GetLicenseInfo",r.MobileFuns.makeParams(t)):i._setProductKeyV2(t),u.then(function(r){var u=r;if(!u||u.message){n.Errors.LicenseEmptyOrInvalid(i);u&&u.message&&(i._errorString=u.message);throw{code:i._errorCode,message:i._errorString};}return Dynamsoft.WebTwainEnv.ProductKey=t,i.__licenseInfo=u,u}))};t.GetVersionInfoAsync=function(){return this._innerFunV2("VersionInfo")}}});Dynamsoft.Ready(function(n){function f(n,t){var i=this;i._stwain=n;i.__SelectionImageBorderColor=8233678;i.__BackgroundColor=16777215;i.__BackgroundFillColor=16777215;i.__Ratio=0;i.bImageJustChangedInEditor=!1;i.bImageChangedInViewer=!1;i._Init(n,t)}function e(){var n=this;n.bIsDirty=!1;n.imageWidth=0;n.imageHeight=0;n.iImageControlWidth=0;n.iImageControlHeight=0;n.imageUrl="";n.minImageUrl="";n.uuid=-1;n.serverId=-1;n.aryOverlayRectangleData=[];n.ticks=Date.now()}function o(n,t,i){var r=this;r.Url=n;r.Width=t;r.Height=i}var s=Dynamsoft,t;if(n.product.bHTML5Edition){var u=Dynamsoft.navInfo,r=n.html5.Funs2={getImageUrl:function(t,i,r,u,f){var e=[t];return n.isNumber(i)&&i<0?"":(i!==undefined&&i!==null&&(e.push("&index="),e.push(i)),e.push("&width="),e.push(r),e.push("&height="),e.push(u),e.push("&ticks="),f?e.push(f):e.push(Date.now()),e.join(""))},getUrlByAct:function(n,t,i){var r=[n];return t!==undefined&&t!==null&&(r.push("&index="),r.push(t)),i&&(r.push("&act="),r.push(i)),r.push("&ticks="),r.push(Date.now()),r.join("")},output:function(t,i){Dynamsoft.WebTwainEnv.Debug&&n.log(i)},print:function(t){var p,o=850,s=1120,r=0,w=0,b=0,a="",c,l,y,k,i;for(n.product.bHTML5Edition&&(u.bIE&&(s=1160),u.bFirefox&&(s=1150)),r=0;r<t.length;r++){var h=s,v=t[r],f=v.Width,e=v.Height,d=v.Url;f<=0&&(f=o);e<=0&&(e=h);c=o/f;l=h/e;c<l?h=parseInt(e*c):c>l&&(o=parseInt(f*l));w+=f;b+=e;a=a+'<div style="width:850px;height:'+s+'px"><img id="D_img'+r+'" src="'+d+'" style="position:relative;left:0px;top:0px;width: '+o+"px;height: "+h+'px" /><\/div>'}k=["alwaysRaised=yes,z-look=yes,top=0,left=0,toolbar=no,menubar=no,location=no,status=no,width=",w,",height=",b].join("");i=window.open("about:blank","_blank",k);p='<html><body id="D_img">'+a+"<\/body><\/html>";i&&(i.document.write(p),i.document.close(),i.focus(),y=i.document.getElementById("D_img"),y?y.onload=function(){i.print();n.log("print image...ok")}:n.log("cannot find image"))}},h=n.DOM,c=Dynamsoft.WebTwainEnv,i={getServerImageUrlPrefix:function(t){var i=t.httpUrl,r=[i,"dwt/",n.product.getDWTPrefix(),n.product.getServerVersionInfo(),"/img?id=",t.clientId];return r.join("")},output:function(t){Dynamsoft.WebTwainEnv.Debug&&n.log(t)}};t=f.prototype;t._Init=function(t,i){var r=this;i.mapModelImageControl=t._ifBindViewer?r.getView().mapModelImageControl:{};i.onTopImageInTheViewChanged=function(n){Dynamsoft.Lib.isFunction(t.__OnTopImageInTheViewChanged)&&t.__OnTopImageInTheViewChanged(n.index,n.bByScrollBar)};i.onGetImageInfo=function(n){var t=-1;return t=r.GetImageWidth(n),{width:t,height:-1}};r._UIView?r._UIView._Init(i):r._UIView=new n.UI.ImageUIView(r,i)};t.getUidByIndex=function(n){var t=this;return t.getWebViewer().GetUidByIndex(n)};t.getIndexByUid=function(n){var t=this;return t.getWebViewer().GetIndexByUid(n)};t.getCurrentImageIndex=function(){var n=this;return n.getWebViewer().GetCurrentIndex()};t.convertServerIdToClientIndex=function(n){var r=this,u=-1,t,i;return i=r._UIView.GetDataImageControl(n),i&&(t=i.uuid),t&&(u=r.getWebViewer().GetIndexByUid(t)),u};t.convertClientIndexToServerId=function(n){var i=this,t=i.getWebViewer().GetCustomDataByIndex(n);return t?t.imageId:-1};t.getWebViewer=function(){var n=this;return n.getView()._WebViewer};t.getTwain=function(){var n=this;return n._stwain};t.getView=function(){var n=this;return n._UIView};t.OnReady=function(){var n=this,t=n.getView();return t.BaseUrl=i.getServerImageUrlPrefix(n._stwain),!0};t.count=function(){var n=this,t=n.getView();return t.GetWebViewer().GetHowManyImagesInBuffer()};t.clear=function(){var t=this,n=t.getView();return n.RemoveAllImages(),n.GetWebViewer().bShowImageEdit&&n.GetWebViewer().updateMode(),!0};t.unshift=function(n,t,i){var r=this,f=r.getView(),u;return u=0,r._updateUIAfterAdd(u,t,i)};t.append=function(n,t,i){var u=this,o=u.getView(),r,f,h,s,e;for(f=o.GetWebViewer().GetHowManyImagesInBuffer(),h=o.GetWebViewer().GetCurrentIndex(),e=f-1;e>=n;e--)s=u.convertClientIndexToServerId(e),o.RemoveImage(e,s);return f<n?(r=f,u._updateUIAfterAdd(r,t,i,!0)):(r=h>=f-1?0:h+1,s=u.convertClientIndexToServerId(r),o.RemoveImage(r,s),r==n-1?u._updateUIAfterAdd(r,t,i,!0):u._updateUIAfterAdd(r,t,i,!1))};t.exists=function(n){var t=this,i=t.getView();return i.exists(n)};t.insertBefore=function(n,t,i,r){var e=this,o=e.getView(),u=1*n,f;return(u<0||u>t)&&(u=-1),f=o.GetWebViewer().GetHowManyImagesInBuffer(),u>=f&&(u=f),e._updateUIAfterAdd(u,i,r,!1)};t.insert=function(n,t,i,r){var e=this,o=e.getView(),u=1*n,f;return(u<0||u>t)&&(u=-1),f=o.GetWebViewer().GetHowManyImagesInBuffer(),u>=f&&(u=f),e._updateUIAfterAdd(u,i,r,!1)};t._updateUIAfterAdd=function(n,t,i,r){var e=this,u=e.getView(),f;return t<0?!1:(f=u.AddImage(n,t,i,r),u.GetWebViewer().bShowImageEdit&&u.GetWebViewer().updateMode(),f)};t.removeByServerId=function(n){var t=this,i=t.getView();return t.remove(n)};t.remove=function(n){var i=this,t=i.getView(),r=i.convertServerIdToClientIndex(n),u=t.RemoveImage(r,n);return t.GetWebViewer().bShowImageEdit&&t.GetWebViewer().updateMode(),u};t.MoveImage=function(n,t){var i=this,r=i.getView();return r.MoveImage(n,t)};t.SwitchImage=function(n,t){var i=this,r=i.getView();return r.SwitchImage(n,t)};t.GetImageHeight=function(n){var t=this,i=n*1,f,u,r,e,o;return(u=t.getView(),f=t.count(),i<0||i>f)?0:t._stwain._isMobileMode()?(o=u.GetMetaDataByIndex(i),o.imageHeight):(e=t.convertClientIndexToServerId(i),r=u.GetDataImageControl(e),r&&r.imageHeight?r.imageHeight:t._stwain.GetImageHeight(i))};t.GetImageWidth=function(n){var t=this,i=n*1,f,u,r,e,o;return(u=t.getView(),f=t.count(),i<0||i>f)?0:t._stwain._isMobileMode()?(o=u.GetMetaDataByIndex(i),o.imageWidth):(e=t.convertClientIndexToServerId(i),r=u.GetDataImageControl(e),r&&r.imageWidth?r.imageWidth:t._stwain.GetImageWidth(i))};t.get=function(n){var t=this,i=parseInt(n),r,u,f;return(u=t.getView(),r=t.count(),i<0||i>r)?!1:(f=t.convertClientIndexToServerId(i),u.GetDataImageControl(f))};t.refresh=function(n,t,i,r){var f=this,u=n*1,e,o,s;if(i){if(s=f.getView(),o=f.count(),u<0||u>o)return!1;e=f.convertClientIndexToServerId(u);s.SetDataImageControl(u,e,r)}return!0};t.Go=function(n){var t=this,i=t.getView();return i.Go(n)};t.__Next=function(){var t=this,n=t.getView(),i=n.__Next();return n.GetWebViewer().bShowImageEdit&&n.GetWebViewer().updateMode(),i};t.__Previous=function(){var t=this,n=t.getView(),i=n.__Previous();return n.GetWebViewer().bShowImageEdit&&n.GetWebViewer().updateMode(),i};t.SetSelectedClientIndexArray=function(n){var t=this,i=t.getView();return i.SetSelectedindexes(n)};t.getSelectedClientIndexArray=function(){var n=this,t=n.getView();return t.GetSelectedindexes()};t.GetSelectedImageCount=function(){var n=this,t=n.getView();return t.GetSelectedImageCount()};t.SetSelectedImageCount=function(n){var t=this,i=t.getView();return i.SetSelectedImageCount(n)};t.SetSelectedImageIndex=function(n,t){var i=this,r=i.getView();return r.SetSelectedImageIndex(n,t)};t.GetZoom=function(){var n=this,t=n.getView();return t.GetZoom()};t.SetZoom=function(n){var t=this,i=t.getView();return i.SetZoom(n)};t.__GetPrintUrl=function(t,i,r){var f=this,u,e=f.getView();return u=e.GetDataImageControl(i),u.imageWidth<=0&&(u.imageWidth=f.GetImageWidth(r)),u.imageHeight<=0&&(u.imageHeight=f.GetImageHeight(r)),new n.UI.PrintUrl(t,u.imageWidth,u.imageHeight)};t.__GetPrintUrlforMobile=function(n,t,i){var u=this,f,o,h=u.getView(),e,s;if(n==t)return r.print(i),!0;e=u.convertClientIndexToServerId(n);e!=-1&&(s=u.getWebViewer().GetUidByIndex(n),u.getWebViewer().GetImageData(s).then(function(r){f=r.originalData instanceof ArrayBuffer?URL.createObjectURL(new Blob([r.originalData])):r.originalData;o=u.__GetPrintUrl(f,e,n);i.push(o);u.__GetPrintUrlforMobile(n+1,t,i)}))};t.Print=function(){var n=this,o=n.getView(),t,f,i,e,u;if(!(n.count()<=0)){if(u=[],n._stwain._isMobileMode())n.__GetPrintUrlforMobile(0,n.count(),u);else{for(t=0;t<n.count();t++)i=n.convertClientIndexToServerId(t),i!=-1&&(f=r.getImageUrl(o.BaseUrl,i,-1,-1),e=n.__GetPrintUrl(f,i,t),u.push(e));r.print(u)}return!0}};t._isNoUI=function(){var n=this;return n._stwain._bNoUI};t.ChangeSize=function(n,t){var i=this,r=i.getView();return r.ChangeImageViewSize(n,t)};t.SetViewMode=function(n,t){var i=this,r;return i._isNoUI()?i._nouiNotSupport("SetViewMode"):(r=i.getView(),r.SetViewMode(n,t))};t.ShowImageEditorEx=function(n,t,r,u,f,e,o){var h=this,c,s,a,l;if(h._isNoUI())return h._nouiNotSupport("ShowImageEditorEx");switch(f){case 3:if(h.getWebViewer().bShowImageEdit)return h.getWebViewer().OnClose(),!0}for(c=document,a=h.getView(),h.getTwain()._containerID==o&&(e=!1,i.output("warning: cannot use the same DIV for the main viewer and the editor viewer.")),l=0;l<Dynamsoft.WebTwainEnv.DynamicContainers.length;l++)if(Dynamsoft.WebTwainEnv.DynamicContainers[l]==o){e=!1;i.output("warning: cannot use an DIV which is already consumed by the method CreateDWTObject.");break}e&&o?(s=c.getElementById(o),s&&s.nodeName=="DIV"?s=o:(s&&s.nodeName!="DIV"&&i.output("warning: cannot create the editor viewer in a non-DIV element."),e=!1,s=c.createElement("div"),c.body.appendChild(s),document.body.insertBefore(s,document.body.firstElementChild))):(s=c.createElement("div"),c.body.appendChild(s),document.body.insertBefore(s,document.body.firstElementChild));a.GetWebViewer().ShowImageEditor(s,e,r,u)};t.SetSelectionRectAspectRatio=function(n){var t=this,i=n,r;return(t.__Ratio=i,t._isNoUI())?!0:(r=t.getView(),r.SetSelectionRectAspectRatio(i))};t.GetSelectionRectAspectRatio=function(){return this.__Ratio};t.GetSelectionImageBorderColor=function(){return this.__SelectionImageBorderColor};t.SetSelectionImageBorderColor=function(n){var i=this,t=n,r;return i._isNoUI()?!0:(r=i.getView(),i.__SelectionImageBorderColor=t,Dynamsoft.Lib.isNumber(t)&&(t=Dynamsoft.Lib.getColor(t)),r.SetSelectionImageBorderColor(t))};t.GetBackgroundColor=function(){return this.__BackgroundColor};t.SetBackgroundColor=function(t,i){var u=this,r=t,f,e,o;return(u.__BackgroundColor=r,u._isNoUI())?!0:(o=u.getView(),Dynamsoft.Lib.isNumber(r)&&(r=Dynamsoft.Lib.getColor(r)),f=n.one("#"+u._stwain._containerID),f&&(e=n.one(".dynamsoft-dwt-container-box",f),e&&e.style("background-color",r)),i?o.SetBackgroundColor(r,!0):o.SetBackgroundColor(r))};t.GetAllowMultiSelect=function(){var n=this,t=n.getView();return n._isNoUI()?!1:t.GetAllowMultiSelect()};t.SetAllowMultiSelect=function(n){var t=this,i=t.getView();return t._isNoUI()?!0:i.SetAllowMultiSelect(n)};t.GetFitWindowType=function(){var n=this,t=n.getView();return n._isNoUI()?0:t.GetFitWindowType()};t.SetFitWindowType=function(n){var t=this,i=t.getView();return t._isNoUI()?!0:i.SetFitWindowType(n)};t.GetIfFitWindow=function(){var n=this,t=n.getView();return n._isNoUI()?!0:t.GetIfFitWindow()};t.SetIfFitWindow=function(n){var t=this,i=t.getView();return t._isNoUI()?!0:i.SetIfFitWindow(n)};t.GetImageMargin=function(){var n=this,t=n.getView();return n._isNoUI()?0:t.GetImageMargin()};t.SetImageMargin=function(n){var t=this,i=t.getView();return t._isNoUI()?!0:i.SetImageMargin(n)};t.GetMouseShape=function(){var n=this,t=n.getView();return n._isNoUI()?0:t.GetMouseShape()};t.SetMouseShape=function(n){var t=this,i=t.getView();return t._isNoUI()?!0:i.SetMouseShape(n)};t.GetShowPageNumber=function(){var n=this,t=n.getView();return n._isNoUI()?!1:t.GetShowPageNumber()};t.SetShowPageNumber=function(n){var t=this,i=t.getView();return t._isNoUI()?!0:i.SetShowPageNumber(n)};t.GetIfAutoScroll=function(){var n=this,t=n.getView();return n._isNoUI()?!1:t.GetIfAutoScroll()};t.SetIfAutoScroll=function(n){var t=this,i=t.getView();return t._isNoUI()?!0:i.SetIfAutoScroll(n)};t.OverlayRectangle=function(n,t,i,r,u,f,e){var o=this,s;return o._isNoUI()?!0:(s=o.getView(),s.OverlayRectangle(n,t,i,r,u,f,e))};t.SetSelectedImageArea=function(n,t,i,r,u){var f=this,e=f.getView();return n!=e.GetWebViewer().GetCurrentIndex()?!1:f._isNoUI()?!0:e.SetSelectedImageArea(t,i,r,u)};t.ShowImagesByFilter=function(n,t,i){var r=this,u=r.getView();return u.FilterImagesByTag(n,t,i)};t.GetServerIdListByTag=function(n){var t=this,i=t.getView();return i.GetServerIdListByTag(n)};t.GetAllServerIdList=function(){var n=this,t=n.getView(),i=n.GetCurrentTag();return t.GetServerIdListByTag(i)};t.RemoveImageTag=function(n){var t=this,i=t.getView();return i.RemoveImageTag(n)};t.SetDefaultTag=function(n){var t=this,i=t.getView();return i.SetDefaultTag(n)};t.AddImageTag=function(n,t){var i=this,r=i.getView();return r.AddImageTag(n,t)};t.GetCurrentTag=function(){var n=this,t=n.getView();return t.GetCurrentTag()};t.BindView=function(t,i){var f=this,e=f.getView(),u=t,r;return n.isDOMInBody(u)&&(r=u,r.id&&r.id!=""||(r.id=["dwt_",n.getRandom()].join("")),u=r.id),e.BindView(u,i)};t.UnbindView=function(){var n=this,t=n.getView();return t.UnbindView()};t.UpdateView=function(n){var t=this,i=t.getView();return i.UpdateView(n)};t.GetIfShowVideoContainer=function(){var n=this,t=n.getView();return t.GetIfShowVideoContainer()};t.ShowVideoContainer=function(n){var t=this,i=t.getView();return i.ShowVideoContainer(n)};t.UpdateVideoContainer=function(n){var t=this,i=t.getView();return i.UpdateVideoContainer(n)};t.GetImageData=function(n){var t=this,r=t.getView(),i=t.convertServerIdToClientIndex(n);return i>=0?r.GetImageData(t.getUidByIndex(i)):NaN};t.Rotate=function(n,t){var i=this,r=i.getView();return r.Rotate(n,t)};t.Mirror=function(n){var t=this,i=t.getView();return i.Mirror(n)};t.Flip=function(n){var t=this,i=t.getView();return i.Flip(n)};t.Crop=function(n,t,i,r,u){var f=this,e=f.getView();return e.Crop(n,t,i,r,u)};t.RegistLoadCallback=function(n){var t=this,i=t.getView();return i.RegistLoadCallback(n)};e.prototype.Clear=function(){var n=this;n.imageUrl="";n.minImageUrl="";n.serverId=-1;n.aryOverlayRectangleData=[]};n.UI=n.UI||{};n.UI.ImageManager=f;n.UI.ModelImageControl=e;n.UI.PrintUrl=o}});Dynamsoft.Ready(function(n){var f=Dynamsoft;if(n.product.bHTML5Edition){var r=n.html5.STwain,t=n.html5.Funs,e=Dynamsoft.WebTwainEnv,i={TRANS_SERVICE_ERROR_404:12,TRANS_SERVICE_ERROR_500:13,TRANS_SERVICE_ERROR_503:14},u=function(t,i){if(!n.isUndef(t)&&!n.isUndef(i)&&null!=t&&null!=i){for(var r in i)t.hasOwnProperty(r)?typeof t[r]=="object"&&u(t[r],i[r]):t[r]=i[r];return t}};r.prototype.checkStartScanParams=function(t,i){var r=this;if(!t)return n.Errors.ScanUploader_InvalidScanSetup(r),!1;if(!n.isUndefined(i.transferMode)&&t.transferMode!=0&&t.transferMode!=1&&t.transferMode!=2)return n.Errors.ScanUploader_InvalidTransferMode(r),!1;if(t.transferMode==EnumDWT_TransferMode.TWSX_FILE){if(!t.fileXfer)return n.Errors.ScanUploader_InvalidFileXfer(r),!1;if(!n.isString(t.fileXfer.fileName)||t.fileXfer.fileName=="")return n.Errors.ScanUploader_InvalidFileXferFilename(r),!1;if(!n.isNumber(t.fileXfer.fileFormat)||t.fileXfer.fileFormat<0||t.fileXfer.fileFormat>16)return n.Errors.ScanUploader_InvalidFileXferFileFormat(r),!1}if(i){if(!n.isString(i.type)||i.type=="")return n.Errors.ScanUploader_InvalidHttpType(r),!1;if(!i.httpParams)return n.Errors.ScanUploader_InvalidHttpParams(r),!1;if(t.transferMode!=EnumDWT_TransferMode.TWSX_FILE&&n.isUndefined(i.format))return n.Errors.ScanUploader_InvalidOutputFormat(r),!1;if(!n.isString(i.httpParams.url)||i.httpParams.url=="")return n.Errors.ScanUploader_InvalidHttpUrl(r),!1;if(!n.isString(i.httpParams.fileName)||i.httpParams.fileName=="")return n.Errors.ScanUploader_InvalidHttpFilename(r),!1}return!0};r.prototype.startScan=function(r){var f=this,et,ot,rt,yt,vt;if(f._resetErr(),f._isMobileMode())return f._mobileNotSupport("startScan");var k=!1,st=!1,ut=!0,w=!0,ht=!0,c=!1,p=r.onFinally,d=[],b=[],s=0,nt=1,ft=[],a,e,v,ct={type:"http",format:EnumDWT_ImageType.IT_PDF,reTries:3,useUploader:!1,singlePost:!0,showProgressBar:!0,removeAfterOutput:!0,httpParams:{url:"",headers:{},formFields:{},remoteName:"RemoteFile",fileName:""}},h=n.clone(r),it=r;if(v=h.funcScanStatus,delete h.funcScanStatus,h.bfuncScanStatus=n.isFunction(v)?!0:!1,h.outputSetup?(et={pdfSetup:{},tiffSetup:{}},u(h.outputSetup,ct),e=h.outputSetup,delete h.outputSetup,e.pdfSetup&&(e.format==EnumDWT_ImageType.IT_MULTIPAGE_PDF||e.format==EnumDWT_ImageType.IT_PDF)&&n.mix(et.pdfSetup,e.pdfSetup),e.tiffSetup&&(e.format==EnumDWT_ImageType.IT_MULTIPAGE_TIF||e.format==EnumDWT_ImageType.IT_TIF)&&n.mix(et.tiffSetup,e.tiffSetup),(e.format==EnumDWT_ImageType.IT_MULTIPAGE_PDF||e.format==EnumDWT_ImageType.IT_MULTIPAGE_TIF)&&(e.singlePost=!0),n.isNumber(e.httpParams.threads)&&(nt=e.httpParams.threads),k=n.stringify(et),st=f.checkStartScanParams(h,e)):(e=ct,e.type="",st=f.checkStartScanParams(h,!1)),!st)return new n.Promise(function(n,t){if(ut){var i={code:f.ErrorCode,message:f.ErrorString,response:""};t(i);ut=!1}});e.funcHttpUploadStatus&&(c=e.funcHttpUploadStatus);var pt=f.HttpFieldNameOfUploadedImage,wt=f.MaxUploadImageSize,bt=f.IfShowProgressBar,kt=f.__IfShowCancelDialogWhenImageTransfer,dt=f.__OnPostTransferAsync,gt=f.__OnPostAllTransfers,ni=f.__OnHttpUploadStatus,ti=f.__insertingIndex,ii=f.__IfAppendImage,g=!1,o=e.showProgressBar,lt=function(t){var i=!0;if(n.each(ft,function(n){n.st==-1&&(i=!1)}),!i){setTimeout(function(){lt(t)},200);return}tt(t)},tt=function(n){n.__OnPostTransferAsync=dt;n.__OnPostAllTransfers=gt;n.__OnHttpUploadStatus=ni;n.HttpFieldNameOfUploadedImage=pt;n.__maxUploadImageSize=wt;n.IfShowProgressBar=bt;n.__IfShowCancelDialogWhenImageTransfer=kt;n.__insertingIndex=ti;n.__IfAppendImage=ii;n.httpFormFields={};n.__OnCancel=!1;Dynamsoft.FileUploader&&(Dynamsoft.FileUploader.nextLoopTime=600)},at=function(n,t,i){if(!w){setTimeout(function(){at(n,t,i)},200);return}t(i);lt(n)},y=function(n,t){g=!0;ut&&(ut=!1,w||f._innerSendCmd("CancelAllPendingTransfers"),at(f,n,t))},l=function(t,i,r,u){if(n.isFunction(c)){var o=i,f=0,e;n.isNumber(u)&&u>0&&(f=u);e={fileName:o,percentage:r,statusCode:f,responseString:t.__HTTPPostResponseString};setTimeout(function(){c(e)},10)}};return(f.__OnCancel=!1,f._resetErr(),f.__HTTPPostResponseString="",f.IfShowProgressBar=o,f.__IfShowCancelDialogWhenImageTransfer=o,n.isNumber(h.insertingIndex)&&h.insertingIndex>-1&&(f.__insertingIndex=h.insertingIndex,f.__IfAppendImage=!1),f.__OnHttpUploadStatus=n.isFunction(c)?c:!1,e.useUploader&&!Dynamsoft.FileUploader)?new n.Promise(function(t,i){n.Errors.Uploader_ModuleError(f);var r={code:f.ErrorCode,message:f.ErrorString,response:""};w=!0;y(i,r)}):(a=e.reTries,e.useUploader?(ot=e.httpParams.url,n.startsWith(ot,"http://")||n.startsWith(ot,"https://")||(rt=window.location.href,yt=rt.lastIndexOf("/"),rt=rt.substring(0,yt+1),e.httpParams.url=rt+ot)):(n.each(e.httpParams.headers,function(n,t){f.SetHTTPHeader(t,n)}),n.each(e.httpParams.formFields,function(n,t){f.SetHTTPFormField(t,n)})),e.httpParams.remoteName!==""&&(f.HttpFieldNameOfUploadedImage=e.httpParams.remoteName),vt=new n.Promise(function(n,t){e.useUploader?Dynamsoft.FileUploader.Init(0,function(t){n({uploadManager:t})},function(n,i){f._errorCode=n;f._errorString=i;var r={code:n,message:i,response:f.__HTTPPostResponseString};w=!0;y(t,r)}):n({})}),f._resetErr(),vt.then(function(r){return new n.Promise(function(u,rt){var ut=function(){var t=!1;t=h.transferMode==EnumDWT_TransferMode.TWSX_FILE?s==b.length:s==d.length;t?(n.closeProgress("Scan Upload"),g=!0,u(it),tt(f)):setTimeout(ut,100)},et;v&&n.isFunction(v)&&(f.__OnPreAllTransfersAsync=function(n){v(n)});f.RegisterEvent("OnPostTransferAsync",function(u){var it,vt=e.httpParams.url,p=f.objImageIndexManager.convertGuidToServerId(u.imageId),bt=e.singlePost,et=h.transferMode==EnumDWT_TransferMode.TWSX_FILE,yt=e.removeAfterOutput,lt=0,ut,pt,kt,ct,st,wt,dt,at,tt,gt,ot,ni,ti;if(ht&&(w=!1,ht=!1),et?(lt=b.length,b.push(u.path)):(lt=d.length,d.push(p)),v&&n.isFunction(v)&&(kt={event:"postTransfer",bScanCompleted:!1,result:{currentPageNum:lt+1}},setTimeout(function(){v(kt)},10)),g)return!1;if(e.type=="http")if(ut=t.cformat(e.httpParams.fileName,lt+1),pt=t.cformat(e.httpParams.remoteName,lt+1),bt||e.type!="http")!bt&&e.type=="ftp";else if(n.isNumber(e.httpParams.maxSizeLimit)&&(f.__maxUploadImageSize=e.httpParams.maxSizeLimit),e.useUploader)o&&(Dynamsoft.FileUploader.nextLoopTime=300,n.showProgress(f,"Scan Upload",!0)),ct=function(t,i){return f.__HTTPPostResponseString=i,l(f,t._fileName,100,200),f._OnPercentDone([0,100,"","http",t._fileName]),o&&n.closeProgress("Scan Upload"),!et&&e.removeAfterOutput?setTimeout(function(){var n=f._ImgManager.convertServerIdToClientIndex(p);n>-1?f._removeImageById(p,function(){s++},function(){s++}):s++},100):s++,!0},at=r.uploadManager,wt=function(){var t,i,r;if(o)for(t=0,t=et?b.length:d.length,i=0;i<t;i++)n.closeProgress("Scan Upload");return!et&&e.removeAfterOutput&&setTimeout(function(){var n=f._ImgManager.convertServerIdToClientIndex(p);n>-1&&f._removeImageById(p)},100),at.CancelAllUpload(),r={code:f.ErrorCode,message:f.ErrorString,response:f.__HTTPPostResponseString},y(rt,r),!1},st=function(n,t,r,u){var e=303;t==i.TRANS_SERVICE_ERROR_404?e=404:t==i.TRANS_SERVICE_ERROR_500?e=500:t==i.TRANS_SERVICE_ERROR_503&&(e=503);f._errorCode=t;f._errorString=r;f.__HTTPPostResponseString=u;l(f,ut,100,e);wt()},f.__OnCancel=function(){st(null,-1032,"User cancelled the operation.","")},dt=function(){f.__HTTPPostResponseString="";l(f,ut,100,303);wt()},et?(tt=at.CreateJob(),gt=tt.FormField,n.each(e.httpParams.headers,function(n,t){tt.HttpHeader[t]=n}),n.each(e.httpParams.formFields,function(n,t){gt.Add(t,n)}),tt.ServerUrl=vt,tt.bDeleteFile=yt,tt.reTries=a,n.isNumber(e.httpParams.maxSizeLimit)&&(tt.maxSizeLimit=e.httpParams.maxSizeLimit),tt._fileName=ut,tt.SourceValue.Add(u.path,ut,pt),tt.ImageType=h.fileXfer.fileFormat,tt.ThreadNum=nt,tt.OnRunSuccess=ct,tt.OnRunFailure=st,(o||n.isFunction(c))&&(tt.OnUploadTransferPercentage=function(t,i){i>0&&i<=100&&(i==100&&(i=99),o&&f._OnPercentDone([0,i,"","http",t._fileName]),n.isFunction(c)&&l(f,t._fileName,i,0))},n.cancelFrome=5,o&&f._OnPercentDone([0,-1,Dynamsoft.MSG.Uploading,"http",ut]),l(f,ut,0,0)),at.Run(tt)):(it=e.format,it==EnumDWT_ImageType.IT_MULTIPAGE_PDF?it=EnumDWT_ImageType.IT_PDF:it==EnumDWT_ImageType.IT_MULTIPAGE_TIF&&(it=EnumDWT_ImageType.IT_TIF),o&&(n.cancelFrome=5,f._OnPercentDone([0,-1,Dynamsoft.MSG.Encoding,"http",ut])),f._asyncGenerateURLForUploadData([p],it,k,function(t){var i=at.CreateJob(),r=i.FormField;n.each(e.httpParams.headers,function(n,t){i.HttpHeader[t]=n});n.each(e.httpParams.formFields,function(n,t){r.Add(t,n)});i.ServerUrl=vt;i.bDeleteFile=yt;i.reTries=a;n.isNumber(e.httpParams.maxSizeLimit)&&(i.maxSizeLimit=e.httpParams.maxSizeLimit);i._fileName=ut;i.SourceValue.Add(t,ut,pt);i.ImageType=it;i.ThreadNum=nt;i.OnRunSuccess=ct;i.OnRunFailure=st;(o||n.isFunction(c))&&(i.OnUploadTransferPercentage=function(t,i){i>0&&i<=100&&(i==100&&(i=99),o&&f._OnPercentDone([0,i,"","http",t._fileName]),n.isFunction(c)&&l(f,t._fileName,i,0))},n.cancelFrome=5,o&&f._OnPercentDone([0,-1,Dynamsoft.MSG.Uploading,"http",ut]),l(f,ut,0,0));at.Run(i)},dt));else if(ot={id:p,st:-1,bCancel:!1},ft.push(ot),lt==0&&n.showProgress(f,"Scan Upload",!0),et)ct=function(){return ot.st=0,!et&&e.removeAfterOutput?setTimeout(function(){var n=f._ImgManager.convertServerIdToClientIndex(p);n>-1?f._removeImageById(p,function(){s++},function(){s++}):s++},100):s++,!0},st=function(){!et&&e.removeAfterOutput&&setTimeout(function(){var n=f._ImgManager.convertServerIdToClientIndex(p);n>-1&&f._removeImageById(p)},100);var t={code:f.ErrorCode,message:f.ErrorString,response:f.__HTTPPostResponseString};return(n.closeProgress("Scan Upload"),ot.st==2)?!1:(ot.st=1,n.each(ft,function(n){n.st==-1&&(n.bCancel=!0)}),y(rt,t),!1)},f._innerUploadDirectly(vt,u.path,ut,o,yt,a,!1,ot,ct,st);else{if(ct=function(){return ot.st=0,!et&&e.removeAfterOutput?setTimeout(function(){var n=f._ImgManager.convertServerIdToClientIndex(p);n>-1?f._removeImageById(p,function(){s++},function(){s++}):s++},100):s++,!0},st=function(){!et&&e.removeAfterOutput&&setTimeout(function(){var n=f._ImgManager.convertServerIdToClientIndex(p);n>-1&&f._removeImageById(p)},100);var t={code:f.ErrorCode,message:f.ErrorString,response:f.__HTTPPostResponseString};return(n.closeProgress("Scan Upload"),ot.st==2)?!1:(ot.st=1,n.each(ft,function(n){n.st==-1&&(n.bCancel=!0)}),y(rt,t),!1)},it=e.format,n.isUndefined(it))return ni=f._ImgManager.convertServerIdToClientIndex(p),n.Errors.InvalidImageType(f),st([ni]),!1;it==EnumDWT_ImageType.IT_MULTIPAGE_PDF?it=EnumDWT_ImageType.IT_PDF:it==EnumDWT_ImageType.IT_MULTIPAGE_TIF&&(it=EnumDWT_ImageType.IT_TIF);ti={bOnlyUploadForm:!1,method:"startScan",_this:f,url:vt,serverIds:[p],enumImageType:it,saveSetup:k,fileName:ut,dataFormat:EnumDWT_UploadDataFormat.Binary,retry:a,bOnlyEmptyIsOK:!1,objUploadFileStatus:ot,asyncSuccessFunc:ct,asyncFailureFunc:st};n._asyncUploadCmd(ti)}});f.__OnPostAllTransfers=function(){var et,ui=EnumDWT_UploadDataFormat.Binary,lt=e.httpParams.url,gt=e.singlePost,ht=h.transferMode==EnumDWT_TransferMode.TWSX_FILE,at=e.removeAfterOutput,vt,ni,ti,ct,st,ot,fi,bt,kt;if(v&&n.isFunction(v)&&(vt=ht?b.length:d.length,ni={event:"postTransfer",bScanCompleted:!0,result:{currentPageNum:vt}},setTimeout(function(){v(ni)},10)),vt==0){n.Errors.SourceHasNothingToCapture(f);setTimeout(function(){w=!0;p&&n.isFunction(p)&&p();var t={code:f.ErrorCode,message:f.ErrorString,response:f.__HTTPPostResponseString};y(rt,t)},1e3);return}if(vt>0&&f.ErrorCode==-1029)f._errorCode=0;else if(f.ErrorCode!=0){w=!0;p&&n.isFunction(p)&&p();ti={code:f.ErrorCode,message:f.ErrorString,response:f.__HTTPPostResponseString};y(rt,ti);return}if(e.type=="http"){if(gt&&e.type=="http")if(ot=d,fi=[],n.isNumber(e.httpParams.maxSizeLimit)&&(f.__maxUploadImageSize=e.httpParams.maxSizeLimit),e.useUploader){var yt=r.uploadManager,ft=yt.CreateJob(),wt=ft.FormField;if(o&&(Dynamsoft.FileUploader.nextLoopTime=300,n.showProgress(f,"Scan Upload",!0)),ct=function(t,i){var r=t._fileName;return r||(r=""),f._bServerPercentDone=!0,f.__HTTPPostResponseString=i,l(f,r,100,200),f._OnPercentDone([0,100,"","http"]),o&&n.closeProgress("Scan Upload"),!ht&&e.removeAfterOutput?setTimeout(function(){s=0;n.each(ot,function(n){var t=f._ImgManager.convertServerIdToClientIndex(n);t>-1?f._removeImageById(n,function(){s++},function(){s++}):s++});setTimeout(ut,100)},100):(g=!0,u(it),tt(f)),!0},bt=function(){f._OnPercentDone([0,100,"","http"]);o&&n.closeProgress("Scan Upload");f._bServerPercentDone=!0;var t={code:f.ErrorCode,message:f.ErrorString,response:f.__HTTPPostResponseString};return y(rt,t),!ht&&e.removeAfterOutput&&setTimeout(function(){n.each(ot,function(n){var t=f._ImgManager.convertServerIdToClientIndex(n);t>-1&&f._removeImageById(n)})},100),!1},st=function(n,t,r,u){var e=303;t==i.TRANS_SERVICE_ERROR_404?e=404:t==i.TRANS_SERVICE_ERROR_500?e=500:t==i.TRANS_SERVICE_ERROR_503&&(e=503);f._errorCode=t;f._errorString=r;f.__HTTPPostResponseString=u;l(f,"",100,e);bt()},f.__OnCancel=function(){st(null,-1032,"User cancelled the operation.","")},kt=function(){f.__HTTPPostResponseString="";l(f,"",100,303);bt()},ht)n.each(e.httpParams.headers,function(n,t){ft.HttpHeader[t]=n}),n.each(e.httpParams.formFields,function(n,t){wt.Add(t,n)}),ft.ServerUrl=lt,ft.bDeleteFile=at,ft.reTries=a,n.isNumber(e.httpParams.maxSizeLimit)&&(ft.maxSizeLimit=e.httpParams.maxSizeLimit),n.each(b,function(n,i){var r=t.cformat(e.httpParams.fileName,i+1),u=t.cformat(e.httpParams.remoteName,i+1);ft.SourceValue.Add(n,r,u)}),ft.ImageType=h.fileXfer.fileFormat,ft.ThreadNum=nt,ft.OnRunSuccess=ct,ft.OnRunFailure=st,(o||n.isFunction(c))&&(ft.OnUploadTransferPercentage=function(t,i){i>0&&i<=100&&(i==100&&(i=99),o&&f._OnPercentDone([0,i,"","http"]),n.isFunction(c)&&(i>99&&(i=99),l(f,"",i,0)))},o&&f._OnPercentDone([0,-1,Dynamsoft.MSG.Uploading,"http"]),l(f,"",0,0)),yt.Run(ft);else if(et=e.format,et==EnumDWT_ImageType.IT_MULTIPAGE_PDF||et==EnumDWT_ImageType.IT_MULTIPAGE_TIF)et==EnumDWT_ImageType.IT_MULTIPAGE_PDF?et=EnumDWT_ImageType.IT_PDF:et==EnumDWT_ImageType.IT_MULTIPAGE_TIF&&(et=EnumDWT_ImageType.IT_TIF),o&&f._OnPercentDone([0,-1,Dynamsoft.MSG.Encoding,"http"]),f._asyncGenerateURLForUploadData(ot,et,k,function(i){n.each(e.httpParams.headers,function(n,t){ft.HttpHeader[t]=n});n.each(e.httpParams.formFields,function(n,t){wt.Add(t,n)});ft.ServerUrl=lt;ft.bDeleteFile=at;ft.reTries=a;n.isNumber(e.httpParams.maxSizeLimit)&&(ft.maxSizeLimit=e.httpParams.maxSizeLimit);var r=t.cformat(e.httpParams.fileName,1),u=t.cformat(e.httpParams.remoteName,1);ft._fileName=r;ft.SourceValue.Add(i,r,u);ft.ImageType=et;ft.ThreadNum=nt;ft.OnRunSuccess=ct;ft.OnRunFailure=st;(o||n.isFunction(c))&&(ft.OnUploadTransferPercentage=function(t,i){i>0&&i<=100&&(i==100&&(i=99),o&&f._OnPercentDone([0,i,"","http",r]),n.isFunction(c)&&l(f,r,i,0))},n.cancelFrome=5,o&&f._OnPercentDone([0,-1,Dynamsoft.MSG.Uploading,"http",r]));yt.Run(ft)},kt);else{var dt=ot.length,pt=0,ii=0,ri="";o&&(f._bServerPercentDone=!1,f._OnPercentDone([0,-1,Dynamsoft.MSG.Encoding,"http"]));n.each(ot,function(i,r){var u=t.cformat(e.httpParams.fileName,r+1),s=t.cformat(e.httpParams.remoteName,r+1);f._asyncGenerateURLForUploadData([i],et,k,function(t){ii=(pt+1)/dt*100;ri=[pt+1,"/",dt].join("");f._OnPercentDone([0,ii,ri,"http"]);ft.SourceValue.Add(t,u,s);pt++;pt>=dt&&(o&&(f._bServerPercentDone=!0),n.each(e.httpParams.headers,function(n,t){ft.HttpHeader[t]=n}),n.each(e.httpParams.formFields,function(n,t){wt.Add(t,n)}),ft.ServerUrl=lt,ft.bDeleteFile=at,ft.reTries=a,n.isNumber(e.httpParams.maxSizeLimit)&&(ft.maxSizeLimit=e.httpParams.maxSizeLimit),ft.ImageType=et,ft.ThreadNum=nt,ft.OnRunSuccess=ct,ft.OnRunFailure=st,(o||n.isFunction(c))&&(ft.OnUploadTransferPercentage=function(t,i){i>0&&i<=100&&(i==100&&(i=99),o&&f._OnPercentDone([0,i,"","http"]),n.isFunction(c)&&(i>99&&(i=99),l(f,"",i,0)))},o&&f._OnPercentDone([0,-1,Dynamsoft.MSG.Uploading,"http"])),yt.Run(ft))},kt)})}}else if(ht)ct=function(){return f._bServerPercentDone=!0,!ht&&e.removeAfterOutput?setTimeout(function(){s=0;n.each(ot,function(n){var t=f._ImgManager.convertServerIdToClientIndex(n);t>-1?f._removeImageById(n,function(){s++},function(){s++}):s++});setTimeout(ut,100)},100):(g=!0,u(it),tt(f)),!0},st=function(){f._bServerPercentDone=!0;var t={code:f.ErrorCode,message:f.ErrorString,response:f.__HTTPPostResponseString};return y(rt,t),!ht&&e.removeAfterOutput&&setTimeout(function(){n.each(ot,function(n){var t=f._ImgManager.convertServerIdToClientIndex(n);t>-1&&f._removeImageById(n)})},100),!1},f._innerUploadFilesDirectly(lt,b,e.httpParams.fileName,o,at,a,!1,ct,st);else if(ct=function(){return f._bServerPercentDone=!0,!ht&&e.removeAfterOutput?setTimeout(function(){s=0;n.each(ot,function(n){var t=f._ImgManager.convertServerIdToClientIndex(n);t>-1?f._removeImageById(n,function(){s++},function(){s++}):s++});setTimeout(ut,100)},100):(g=!0,u(it),tt(f)),!0},st=function(){f._bServerPercentDone=!0;var t={code:f.ErrorCode,message:f.ErrorString,response:f.__HTTPPostResponseString};return y(rt,t),!ht&&e.removeAfterOutput&&setTimeout(function(){n.each(ot,function(n){var t=f._ImgManager.convertServerIdToClientIndex(n);t>-1&&f._removeImageById(n)})},100),!1},et=e.format,et==EnumDWT_ImageType.IT_MULTIPAGE_PDF||et==EnumDWT_ImageType.IT_MULTIPAGE_TIF){et==EnumDWT_ImageType.IT_MULTIPAGE_PDF?et=EnumDWT_ImageType.IT_PDF:et==EnumDWT_ImageType.IT_MULTIPAGE_TIF&&(et=EnumDWT_ImageType.IT_TIF);var ei=t.cformat(e.httpParams.fileName,1),si=t.cformat(e.httpParams.remoteName,1),oi={bOnlyUploadForm:!1,method:"startScan",_this:f,url:lt,serverIds:ot,enumImageType:et,saveSetup:k,fileName:ei,dataFormat:ui,retry:a,bOnlyEmptyIsOK:!1,objUploadFileStatus:!1,asyncSuccessFunc:ct,asyncFailureFunc:st};n._asyncUploadCmd(oi)}else f._asyncUploadFilesCmd(lt,ot,et,e.httpParams.fileName,k,o,a,!1,ct,st);gt&&e.type=="ftp"}w=!0;p&&n.isFunction(p)&&p()};et=function(){e.type!="http"?(g=!0,u(it),tt(f)):e.singlePost||setTimeout(ut,100)};f._startScan(h,et,function(){var t,n,i;if(f.ErrorCode==-1029&&(t=h.transferMode==EnumDWT_TransferMode.TWSX_FILE,n=!1,n=t?b.length>0:d.length>0,n))return f._errorCode=0,et();i={code:f.ErrorCode,message:f.ErrorString,response:f.__HTTPPostResponseString};y(rt,i)})})}))}}});Dynamsoft.Ready(function(n,t){var f=Dynamsoft;if(n.product.bHTML5Edition){var r=f.WebTwainEnv,e=n,i=f.navInfo,u=e.each;n.env.WSVersion="12.0.0";n.env.WSSession=(new Date).getTime();n.getHttpUrl=function(n){return n.ssl?["https://",n.host,":",n.port,"/"].join(""):["http://",n.host,":",n.port,"/"].join("")};n.getWSUrl=function(n,t,i){return i?["wss://",n,":",t].join(""):["ws://",n,":",t].join("")};n.getWS=function(t,r,u){var a=this,h,e=n.getWSUrl(t,r,u),o=n.product.wsProtocol,c=window.MozWebSocket,s,l,f;if(a.detect.OnCreatWS&&a.detect.OnCreatWS(e,o),typeof c!="undefined")h=o?new c(e,o):new c(e);else{if(s=WebSocket,i.bEdge)for(l=window,f=parent;l!=f&&f.WebSocket;)s=f.WebSocket,l=f.window,f=f.parent;h=o?new s(e,o):new s(e)}return h};n._init=function(n){var i=Dynamsoft.Lib,s=Dynamsoft.dcp,e=i.LS.item("DWT_port"),o=i.LS.item("DWT_ssl"),r,f,h;if(s.bEnhancedMode||(i.detect.urls.splice(0),i.detect.cUrlIndex=0,!n.bLocalService))return!0;e!==t&&o!==t&&(r={port:e,ssl:o=="true"});f=function(n){return r?n&&(n.port!=r.port||n.ssl!=r.ssl)?!0:!1:!0};i.detect.detectType===1?(r!==t&&r.ssl&&i.detect.urls.push(r),u(i.detect.ports,function(n){n.ssl&&f(n)&&i.detect.urls.push(n)})):i.detect.detectType===0?(r===t||r.ssl||i.detect.urls.push(r),u(i.detect.ports,function(n){n.ssl===!1&&f(n)&&i.detect.urls.push(n)})):(r!==t&&i.detect.urls.push(r),u(i.detect.ports,function(n){f(n)&&i.detect.urls.push(n)}));h=t};n._reconnect=function(){var r=Dynamsoft.Lib,u,f,e,t,i;if(r.detect.aryReconnectSTwains.length>0&&(t=r.detect.aryReconnectSTwains[0]),t&&!t.__bConnecting){t.__bConnecting=!0;u=t._host;e=t._ssl;f=t._port;try{i=r.getWS(u,f,e);i.onopen=function(){i.readyState==1?(t._objWS=i,t.bReady||t._OnReady(!0),t.__bConnecting=!1,n.detect.hideMask(),r.detect.bOK=!0):i.readyState==0?setTimeout(i.onopen,100):t.__bConnecting=!1};i.onclose=function(){i.onopen=null;t.__bConnecting=!1;t.bReady?(n.closeProgress("Reconnect"),n.detect.hideMask()):(t.__wsRetry++,t.__wsRetry<5?setTimeout(n._reconnect,1e3):(n.closeProgress("Reconnect"),n.Errors.Server_Restarted(t)))}}catch(o){n.log(o);t.__bConnecting=!1;t.bReady?n.detect.hideMask():(t.__wsRetry++,t.__wsRetry<5&&setTimeout(n._reconnect,1e3))}}};n.startWS=function(){var t=n.detect,i,h=!0,e,o,s,f,u;if(!n.product.bHTML5Edition){n.appendMessage("This browser is currently not supported. Please try Chrome or Firefox!");return}if((r.UseLocalService===!1||n.isUndefined(r.UseLocalService)&&n.env.bMobile)&&(h=!1),h&&t.tryTimes>5){n.log("Failed more than 5 times.");return}if(t.OnDetectNext&&t.OnDetectNext(),t.tryTimes==0&&t.cUrlIndex>0&&t.arySTwains.length>0&&!t.bNoControlEvent){if(t.hideMask(),n.isFunction(t.onNoControl)){e=t.arySTwains[0];o=e._width;s=e._height;o<=0&&(o=270);s<=0&&(s=350);t.onNoControl(e._containerID,o,s,e)}t.bNoControlEvent=!0}if(h&&t.cUrlIndex>=t.urls.length&&(t.cUrlIndex=0,t.tryTimes++),t.arySTwains.length>0)i=t.arySTwains[0];else{t.hideMask();t.bOK=!0;return}if(i._bLocalService==!1&&(i.bReady=!0,i._OnReady()),i.bReady){t.arySTwains.splice(0,1);t.arySTwains.length<=0?(t.hideMask(),t.bOK=!0):setTimeout(n.startWS,100);return}if(t.bNoControlEvent||t.showMask(),!i.__bConnecting){i.__bConnecting=!0;try{f=t.urls[t.cUrlIndex];u=n.getWS(n.product.host,f.port,f.ssl);n.log(["connecting ... [port:",f.port,"]"].join(""));u.onopen=function(){i.__bConnecting=!1;u.readyState==1?(i._objWS=u,i.bReady||(i._port=f.port,i._ssl=f.ssl,i._OnReady()),t.arySTwains.splice(0,1),t.arySTwains.length<=0?(t.hideMask(),t.bOK=!0):setTimeout(n.startWS,100)):u.readyState==0&&setTimeout(u.onopen,100)};u.onclose=function(){u.onopen=null;i.__bConnecting=!1;i.bReady?t.hideMask():(t.cUrlIndex++,setTimeout(n.startWS,100))}}catch(c){n.log(c);i.__bConnecting=!1;i.bReady?t.hideMask():(t.cUrlIndex++,setTimeout(n.startWS,100))}}};n.startWSByIP=function(){var i=n.detect,t,u,f,e,r;if(!n.product.bHTML5Edition){n.appendMessage("This browser is currently not supported. Please try Chrome or Firefox!");return}if(i.arySTwainsByIP.length>0)t=i.arySTwainsByIP[0];else{i.hideMask();i.bOK=!0;return}if(t._bLocalService==!1&&(t.bReady=!0,t._OnReady()),t.bReady){i.arySTwainsByIP.splice(0,1);i.arySTwainsByIP.length<=0?(i.hideMask(),i.bOK=!0):setTimeout(n.startWSByIP,100);return}if(i.bNoControlEvent||i.showMask(),!t.__bConnecting){if(t.__wsRetry>0&&!i.bNoControlEvent){if(i.hideMask(),n.isFunction(i.onNoControl)){u=t._width;f=t._height;u<=0&&(u=270);f<=0&&(f=350);i.onNoControl(t._containerID,u,f,t)}i.bNoControlEvent=!0}t.__bConnecting=!0;try{e=t._port;r=n.getWS(t._host,e,t._ssl);n.log(["connecting ... [port:",e,"]"].join(""));r.onopen=function(){t.__bConnecting=!1;r.readyState==1?(t._objWS=r,t.bReady||t._OnReady(),i.arySTwainsByIP.splice(0,1),i.arySTwainsByIP.length<=0?(i.hideMask(),i.bOK=!0):setTimeout(n.startWSByIP,100)):r.readyState==0&&setTimeout(r.onopen,100)};r.onclose=function(){r.onopen=null;t.__bConnecting=!1;t.bReady?i.hideMask():(t.__wsRetry++,setTimeout(n.startWSByIP,100))}}catch(o){n.log(o);t.__bConnecting=!1;t.bReady?i.hideMask():(t.__wsRetry++,setTimeout(n.startWSByIP,100))}}};n.html5.closeAll=function(){var i,r,t,e,o,u,f,s=!1;for(n.dlgProgress=!1,n.detect.bOK=!1,n.detect.bFirst=!0,i=n.detect.arySTwains.length-1;i>=0;i--)if(t=n.detect.arySTwains[i],t){for(o=t._id,e=t._containerID,f=!1,r=0;r<Dynamsoft.WebTwainEnv.Containers.length;r++)if((u=Dynamsoft.WebTwainEnv.Containers[r],u)&&(o==u.WebTwainId||e==u.ContainerId)){f=!0;break}f&&(t.__unload(),n.detect.arySTwains.splice(i,1));t._isMobileMode()&&(s=!0)}};n.bio=!1;n.progressMessage="";n.dialogShowStatus=!1;n.needShowTwiceShowDialog=!1;n.dlgProgress=!1;n.cancelFrome=0;n.dlgRef=0;n.initProgress=function(){var t,r,u,e,f;n.dlgProgress||(r=[],r.push('<dialog class="dynamsoft-dwt-dialogProgress" closed="closed" style="top:30%"><h3 class="dynamsoft-finalMessage"> <\/h3>'),r.push('<p class="dynamsoft-desc"> <\/p><p class="dynamsoft-status">0%<\/p>'),i.bIE?r.push('<div class="dynamsoft-progressBar" value="" max="100"><\/div>'):r.push('<progress class="dynamsoft-progressBar" value="" max="100"><\/progress>'),r.push('<br /><button class="dynamsoft-btnCancel" value="cancel" autofcus >cancel<\/button><\/dialog>'),t=n.one(".dynamsoft-dwt-dialogProgress"),t&&t.getEL()&&t.remove(),u=n.parseHTML(r.join("")),u&&u.length>0&&document.body.appendChild(u[0]),i.bIE&&(e=n.one(".dynamsoft-progressBar"),f=e&&e.getEL(),f&&(f.objProgressBar=new n.ProgressBar(f,{width:300,height:20}))),t=n.one(".dynamsoft-dwt-dialogProgress"),t&&t.getEL()&&(n.dlgProgress=t[0],n.dialog.setup(n.dlgProgress)),n.dlgRef=0,n.dialogShowStatus=!1,n.cancelFrome=0)};n.setBtnCancelVisibleForProgress=function(t){if(!(n.dlgRef<=0)&&n.dialogShowStatus!=!1){var i=n.one(".dynamsoft-btnCancel"),r=i&&i.getEL();r&&(r.style.display=t?"":"none")}};n.showProgressMsg=function(t,r,u){var c;if(!(n.dlgRef<=0)&&n.dialogShowStatus!=!1){var f=n.one(".dynamsoft-progressBar"),o=n.one(".dynamsoft-status"),s=n.one(".dynamsoft-finalMessage"),h=n.one(".dynamsoft-desc"),e=t;t<0?e=0:t>100&&(e=100);e=Math.floor(e);s&&s.getEL()&&s.html(r);h&&h.getEL()&&h.html(u);(e||e===0)&&(o&&o.getEL()&&o.html(e+"%"),f&&f.getEL()&&(i.bIE?f[0].objProgressBar?f[0].objProgressBar.setValue(e):f[0].value=e:i.bEdge?(f[0].style.display="",f[0].value=e):f[0].value=e));e&&(e>=100||n.dlgRef<=0)&&(setTimeout(function(){f&&f.getEL()&&(i.bIE?f[0].objProgressBar?f[0].objProgressBar.setValue(0):f[0].value=0:i.bEdge?(f[0].style.display="none",f[0].value=0):f[0].value=0)},300),n.dlgRef<=0&&(c="OnPercentDone",n.closeProgress(c)))}};n.showProgress=function(t,r,u){var c=t,e,o;if(n.log("showProgress:"+r+",bCancel:"+u),n.cancelFrome==0&&c.__IfShowProgressBar==!0||n.cancelFrome!=0&&c.__IfShowCancelDialogWhenImageTransfer==!0){if(e=n.one(".dynamsoft-btnCancel"),o=e&&e.getEL(),o&&(o.style.display=u==!1?"none":""),n.dialogShowStatus==!1){n.dlgProgress&&n.dlgProgress.showModal();n.dialogShowStatus=!0;var s=n.one(".dynamsoft-finalMessage"),l=n.one(".dynamsoft-progressBar"),f=l&&l.getEL(),h=n.one(".dynamsoft-status");s&&s.getEL()&&s.html("");h&&h.getEL()&&h.html("0%");f&&(i.bIE?f.objProgressBar?f.objProgressBar.setValue(0):f.value=0:f.value=0)}n.dlgRef++}};n.closeProgress=function(t){n.log("closeProgress:"+t);var i=n.one(".dynamsoft-btnCancel");n.dlgRef--;n.dlgRef<=0&&(n.dlgRef=0);n.needShowTwiceShowDialog==!0&&n.cancelFrome==1?i&&i.getEL()&&(i[0].innerHTML="Cancel"):(i&&i.getEL()&&(i[0].innerHTML="Cancel"),n.dlgRef==0&&(n.dialogShowStatus==!0&&(n.dlgProgress&&n.dlgProgress.close(),n.dialogShowStatus=!1),n.needShowTwiceShowDialog=!1,n.cancelFrome=0))};n.html5.CreateDWTObject=function(t){for(var i,u,r=0;r<n.detect.arySTwains.length;r++)if(u=n.detect.arySTwains[r],u._id==t.id)return!1;return(i=new n.html5.STwain(t),t.customIP)?(n.detect.arySTwainsByIP.push(i),i):(n.detect.arySTwains.push(i),n.detect.bFirst&&n._init(t),n.detect.bFirst=!1,i)};r.RemoveAllAuthorizations=function(){var r=n.LS.item("DWT_port"),u=n.LS.item("DWT_ssl"),t="http://",f=n.product.host,i;return u=="true"&&(t="https://"),i=[t,f,":",r,"/dwt/",n.product.getDWTPrefix(),n.product.getServerVersionInfo(),"/RemoveAllAuthorizations?t=",n.now()].join(""),n.ajax({method:"GET",url:i,"async":!0}),!0}}});Dynamsoft.Ready(function(n){function h(t){var i=t,u=n.get(i._strDWTNonInstallInnerContainerID),f="",r,e;u.innerHTML==""&&(Dynamsoft.WebTwainEnv.ActiveXInstallWithCAB&&s.bIE?r=["<div style='display: block; border:solid black 1px; text-align:center; width:",i._strWidth,";height:",i._strHeight,"'>","<ul style='padding-top:100px;'>","<li>The Component is not installed<\/li>","<li>You need to download and install the ActiveX to use this sample.<\/li>","<li>Please follow the instructions in the information bar.<\/li>","<\/ul><\/div>"].join(""):(e="https:"==location.protocol?"https://":"http://",f=n.product.bHTML5Edition?Dynamsoft.dcp.getDSPath():s.bIE?Dynamsoft.dcp.getDSPath():s.bWin?n.product.getMSIPath():n.product.getPKGPath(),r=["<div style='display: block; border:solid black 1px; text-align:center; width:",i._strWidth,";height:",i._strHeight,"'>","<ul style='padding-top:100px;'>","<li>The Component is not installed<\/li>","<li>You need to download and install to use this sample.<\/li>","<li>Please click the below link to download it.<\/li>","<li><a href='",f,"'>Download<\/a><\/li>","<\/ul><\/div>"].join("")),u.innerHTML=r)}var c=Dynamsoft,s;if(n.product.bPluginEdition||n.product.bActiveXEdition){s=Dynamsoft.navInfo;Object.defineProperty||(Object.defineProperty=function(n,t,i){var f=n[t],r=function(){return i.get.apply(n,[f])},e=function(t){return f=i.set.apply(n,[t])},u;n.__defineGetter__?(n.__defineGetter__(t,r),n.__defineSetter__(t,e)):(u=function(){if(event.propertyName==t){n.detachEvent("onpropertychange",u);var i=e(n[t]);n[t]=r;n[t].toString=r;n.attachEvent("onpropertychange",u)}},n[t]=r,n[t].toString=r,n.attachEvent("onpropertychange",u))});var o=!0,e=!1,t={isFunction:function(n){return n&&typeof n=="function"},isReturnSuccess:function(n){if(n._errorCode===-2115)return o;if(n._errorCode===-2003){var t=window.open("","ErrorMessage","height=500,width=750,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no");t.document.writeln(n.HTTPPostResponseString)}return n._errorCode==0?o:e},setErrorString:function(n){n._errorCode=n.getSWebTwain().ErrorCode;n._errorString=n.getSWebTwain().ErrorString},checkErrorString:function(n){return t.setErrorString(n),t.isReturnSuccess(n)},wrapperRet:function(n,i,r,u,f,e){if(t.checkErrorString(n)){if(t.isFunction(r))if(f)r(n.getSWebTwain().HTTPPostResponseString);else{if(e)return r(i),!0;r()}}else t.isFunction(u)&&(f?u(n._errorCode,n._errorString,n.getSWebTwain().HTTPPostResponseString):u(n._errorCode,n._errorString));return i},wrapperPromise:function(t,i){return i?n.Promise.resolve(!0):n.Promise.reject({errorCode:t._errorCode,errorString:t._errorString})},getImageType:function(n){var r=n.length,i,t;return r<4?-1:(i=n.lastIndexOf("."),i===-1)?-1:(t=n.slice(i).toLowerCase(),t===".bmp"||t===".dib")?0:t===".jpg"||t===".jpe"||t===".jpeg"||t===".jfif"?1:t===".tif"||t===".tiff"?2:t===".png"?3:t===".pdf"?4:t===".gif"?5:-1},replaceLocalFilename:function(n){var t=n;return Dynamsoft.navInfoSync.bFileSystem&&(t=decodeURI(t)),t},makeParams:function(){var n=arguments;return n===undefined||n.length===0?undefined:n}};n.checkErrorString=t.checkErrorString;n.wrapperRet=t.wrapperRet;n.setErrorString=t.setErrorString;n.DynamicLoadAddonFuns=[];n.attachAddon=function(t){if(s.bWin){var i=navigator.userAgent.toLowerCase(),r=!s.bOSx64||i.indexOf("wow64")>=0,u=t.getSWebTwain(),f=r?"DynamicPdfCore_"+Dynamsoft.WebTwainEnv.PdfVersion+".dll":"DynamicPdfCorex64_"+Dynamsoft.WebTwainEnv.PdfVersion+".dll";try{u.GetAddOnVersion("pdf",f)}catch(e){}}n.each(n.DynamicLoadAddonFuns,function(i){n.isFunction(i)&&i(t)})};var f=0,i=1,r=1,u=2;n.attachProperty=function(s){var c=s,h=function(o,s,h){var l;s!==f&&s!==i?l=s:(l={},s&&(l.set=h==r?function(i){return(i=i*1,!n.isNumber(i)||isNaN(i))?(n.Errors.InvalidValue(c),e):(c.getSWebTwain()[o]=i,t.checkErrorString(c))}:h==u?function(i){return n.isBoolean(i)?(c.getSWebTwain()[o]=i,t.checkErrorString(c)):(n.Errors.InvalidValue(c),e)}:function(i){return n.isString(i)?(c.getSWebTwain()[o]=i,t.checkErrorString(c)):(n.Errors.InvalidValue(c),e)}));l.get||(l.get=function(){var n=c.getSWebTwain()[o];return c._errorCode=c.getSWebTwain().ErrorCode,c._errorString=c.getSWebTwain().ErrorString,n});o in c||Object.defineProperty(c,o,l)};h("ErrorCode",{get:function(){return c._errorCode}});h("ErrorString",{get:function(){return c._errorString}});h("LogLevel",i,r);h("Manufacturer",i);h("ProductFamily",i);h("ProductKey",{get:function(){return Dynamsoft.WebTwainEnv.ProductKey},set:function(i){var u=o,r=i,f=Dynamsoft.WebTwainEnv;return n.isString(r)&&r!="******"||(r=""),f.ProductKey=r,c.__licenseInfo=e,r==""?(u=e,n.License.checkProductKey(c,{Core:o},e,o)):n.startsWith(r,"http://")||n.startsWith(r,"https://")?(n.ajax({method:"GET",url:r,"async":!1,onSuccess:function(n){c.GetLicenseInfo(n)}}),u=t.checkErrorString(c)):(c.GetLicenseInfo(r),u=t.checkErrorString(c)),u}});h("ProductName",i);h("VersionInfo",i);h("BitDepth",i,r);h("Brightness",i,r);h("Contrast",i,r);h("CurrentSourceName",f);h("DataSourceStatus",f);h("DefaultSourceName",f);h("Duplex",f);h("IfAppendImage",i,u);h("IfAutoBright",i,u);h("IfAutoDiscardBlankpages",i,u);h("IfAutoFeed",i,u);h("IfAutomaticBorderDetection",i,u);h("IfAutomaticDeskew",i,u);h("IfAutoScan",i,u);h("IfDisableSourceAfterAcquire",i,u);h("IfDuplexEnabled",i,u);h("IfFeederEnabled",i,u);h("IfModalUI",i,u);h("IfScanInNewThread",i,u);h("IfShowCancelDialogWhenImageTransfer",i,u);h("IfShowUI",i,u);h("IfShowIndicator",i,u);h("IfUseTwainDSM",i,u);h("IfFeederLoaded",f,u);h("IfPaperDetectable",f,u);h("IfUIControllable",f,u);h("ImageBitsPerPixel",f);h("ImageCaptureDriverType",i,r);h("ImageLayoutDocumentNumber",f);h("ImageLayoutFrameBottom",f);h("ImageLayoutFrameLeft",f);h("ImageLayoutFrameNumber",f);h("ImageLayoutFrameRight",f);h("ImageLayoutFrameTop",f);h("ImageLayoutPageNumber",f);h("ImageLength",f);h("ImagePixelType",f);h("ImageWidth",f);h("ImageXResolution",f);h("ImageYResolution",f);h("MagData",f);h("MagType",f);h("PageSize",i,r);h("PendingXfers",f);h("PixelFlavor",i,r);h("PixelType",i,r);h("Resolution",i,r);h("SourceCount",f);h("TransferMode",i,r);h("Unit",i,r);h("XferCount",i,r);h("Capability",i,r);h("CapCurrentIndex",i,r);h("CapCurrentValue",i,r);h("CapDefaultIndex",f);h("CapDefaultValue",f);h("CapDescription",i);h("CapMaxValue",i,r);h("CapMinValue",i,r);h("CapNumItems",i,r);h("CapStepSize",i,r);h("CapType",i,r);h("CapValue",i,r);h("CapValueString",i);h("CapValueType",i,r);h("AllowMultiSelect",i,u);h("BackgroundColor",i,r);h("BackgroundFillColor",i,r);h("BlankImageCurrentStdDev",f);h("BlankImageMaxStdDev",i,r);h("BlankImageThreshold",i,r);h("CurrentImageIndexInBuffer",{set:function(n){return n!=c.getSWebTwain().CurrentImageIndexInBuffer&&(c.getSWebTwain().CurrentImageIndexInBuffer=n),t.checkErrorString(c)}});h("FitWindowType",i,r);h("HowManyImagesInBuffer",f);h("IfFitWindow",i,u);h("ImageMargin",i,r);h("MaxImagesInBuffer",i,r);h("MouseX",f);h("MouseY",f);h("SelectedImagesCount",i,r);h("SelectionImageBorderColor",i);h("Zoom",i,r);h("MouseShape",i,r);h("SelectedImagesIndices",{get:function(){for(var t=[],i=c.getSWebTwain().SelectedImagesCount,n=0;n<i;n++)t.push(c.getSWebTwain().GetSelectedImageIndex(n));return t}});h("HTTPPostResponseString",f);h("AsyncMode",i,u);h("FTPPassword",i);h("FTPPort",{set:function(n){return n!==""?(n=n*1,c.getSWebTwain().FTPPort=n,t.checkErrorString(c)):e}});h("FTPUserName",i);h("HTTPPort",{set:function(i){return i!==""?(i=i*1,c.getSWebTwain().HTTPPort=i,t.checkErrorString(c)):(i=n.detect.ssl?443:80,c.getSWebTwain().HTTPPort=i,t.checkErrorString(c))}});h("HTTPPassword",i);h("HTTPUserName",i);h("IfPASVMode",i,u);h("IfShowProgressBar",i,u);h("ProxyServer",i);h("IfShowFileDialog",i,u);h("IfTiffMultiPage",i,u);h("PDFAuthor",i);h("PDFCompressionType",i,r);h("PDFCreationDate",i);h("PDFCreator",i);h("PDFKeywords",i);h("PDFModifiedDate",i);h("PDFProducer",i);h("PDFSubject",i);h("PDFTitle",i);h("PDFVersion",i);h("TIFFCompressionType",i,r);h("JPEGQuality",{set:function(n){return n=n*1,n>=100?n=100:n<0&&(n=0),c.getSWebTwain().JPEGQuality=n,t.checkErrorString(c)}});h("HttpContentTypeFieldValue",i);h("SelectionRectAspectRatio",i,r);h("IfAllowLocalCache",i,u);h("_AutoCropMethod",i,u);h("BrokerProcessType",i,r);h("BorderStyle",i,r);h("IfShowPrintUI",i,u);h("VScrollBar",i,u);h("EnableInteractiveZoom",i,u);h("ImageEditorIfEnableEnumerator",i,u);h("ImageEditorIfReadonly",i,u);h("ImageEditorIfModal",i,u);h("ImageEditorWindowTitle",i);h("IfSSL",i,u);h("AllowPluginAuthentication",i,u);h("HttpFieldNameOfUploadedImage",i);h("MaxInternetTransferThreads",i,r);h("MaxUploadImageSize",i,r);h("IfOpenImageWithGDIPlus",i,u);h("BufferMemoryLimit",i,r);h("Width",{get:function(){return c.getSWebTwain().style.width},set:function(n){return c._ChangeWidth(n),t.checkErrorString(c)}});h("Height",{get:function(){return c.getSWebTwain().style.height},set:function(n){return c._ChangeHeight(n),t.checkErrorString(c)}});h("IfThrowException",i,u);h("IfAutoScroll",i,u);h("ShowPageNumber",{get:function(){return e},set:function(){return e}});h("UseLocalService",{get:function(){return!1}})};n.attachMethod=function(i){var r=i,u=function(t){return n.License.checkProductKey(r,{Core:o})?o:(n.isFunction(t)&&t(r.ErrorCode,r.ErrorString),e)},f=function(t,i){return n.License.checkPDFProductKeyWhenNeeds(r,t)?o:(n.isFunction(i)&&i(r.ErrorCode,r.ErrorString),e)},h=function(t,i){return t.HowManyImagesInBuffer==0?(n.Errors.NoImage(t),n.isFunction(i)&&i(t.ErrorCode,t.ErrorString),!1):!0},s=function(t,i,r){return h(t,r)?isNaN(i)||!n.isNumber(i)||i<0||i>=t.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(t),n.isFunction(r)&&r(t.ErrorCode,t.ErrorString),!1):!0:!1};i.RegisterEvent=function(i,u){if(!n.isString(i)||i.toLowerCase()==="onwsmessage")return n.Errors.InvalidEventName(r),!1;if(i.toLowerCase()==="onpostalltransfers")return n.isFunction(u)&&(r.__OnPostAllTransfers=u),!0;var f=["__",i].join("");return r[f]=u,r.getSWebTwain().RegisterEvent(i,u),t.checkErrorString(r)};i.onEvent=function(n,t){return r.RegisterEvent(n,t)};i.on=function(n,t){return r.RegisterEvent(n,t)};i._isMobileMode=function(){return!1};i.CancelAllPendingTransfers=function(){return r.getSWebTwain().CancelAllPendingTransfers(),t.checkErrorString(r)};i.CloseSource=function(){return r.getSWebTwain().CloseSource(),t.checkErrorString(r)};i.CloseSourceManager=function(){return r.getSWebTwain().CloseSourceManager(),t.checkErrorString(r)};i.DisableSource=function(){return r.getSWebTwain().DisableSource(),t.checkErrorString(r)};i.FeedPage=function(){return r.getSWebTwain().FeedPage(),t.checkErrorString(r)};i.GetDeviceType=function(){var n=r.getSWebTwain().GetDeviceType();return t.setErrorString(r),n};i.GetSourceNameItems=function(n){var i=r.getSWebTwain().GetSourceNameItems(n);return t.setErrorString(r),i};i.SourceNameItems=function(n){var i=r.getSWebTwain().GetSourceNameItems(n);return t.setErrorString(r),i};i.GetSourceNames=function(){return n.Errors.ActiveXNotSupport(r),[]};i.GetSourceType=function(n){var i=r.getSWebTwain().GetSourceType(n);return t.setErrorString(r),i};i.OpenSource=function(){return r.getSWebTwain().OpenSource(),t.checkErrorString(r)};i.OpenSourceManager=function(){return r.getSWebTwain().OpenSourceManager(),t.checkErrorString(r)};i.ResetImageLayout=function(){return r.getSWebTwain().ResetImageLayout(),t.checkErrorString(r)};i.RewindPage=function(){return r.getSWebTwain().RewindPage(),t.checkErrorString(r)};i.SelectSource=function(i,u){if(n.isUndefined(i))return r.getSWebTwain().SelectSource(),t.checkErrorString(r);r.getSWebTwain().SelectSource();var f=t.checkErrorString(r);return f?(i(),!0):(u(),!1)};i.SelectSourceByIndex=function(n){return r.getSWebTwain().SelectSourceByIndex(n),t.checkErrorString(r)};i.CloseSourceAsync=function(){return t.wrapperPromise(r,r.CloseSource())};i.CloseSourceManagerAsync=function(){return t.wrapperPromise(r,r.CloseSourceManager())};i.GetSourceNamesAsync=function(){return t.wrapperPromise(r,r.GetSourceNames())};i.GetSourceTypeAsync=function(n){return t.wrapperPromise(r,r.GetSourceType(n))};i.OpenSourceAsync=function(){return t.wrapperPromise(r,r.OpenSource())};i.OpenSourceManagerAsync=function(){return t.wrapperPromise(r,r.OpenSourceManager())};i.SelectSourceAsync=function(){return t.wrapperPromise(r,r.SelectSource())};i.SelectSourceByIndexAsync=function(n){return t.wrapperPromise(r,r.SelectSourceByIndex(n))};i.SetFileXferInfo=function(n,i){var u=t.replaceLocalFilename(n);return r.getSWebTwain().SetFileXferInfo(u,i),t.checkErrorString(r)};i.SetImageLayout=function(n,i,u,f){return r.getSWebTwain().SetImageLayout(n,i,u,f),t.checkErrorString(r)};i.CapGet=function(){var n=r.getSWebTwain().CapGet();return t.setErrorString(r),n};i.CapGetCurrent=function(){var n=r.getSWebTwain().CapGetCurrent();return t.setErrorString(r),n};i.CapGetDefault=function(){var n=r.getSWebTwain().CapGetDefault();return t.setErrorString(r),n};i.CapGetFrameBottom=function(n){var i=r.getSWebTwain().CapGetFrameBottom(n);return t.setErrorString(r),i};i.CapGetFrameLeft=function(n){var i=r.getSWebTwain().CapGetFrameLeft(n);return t.setErrorString(r),i};i.CapGetFrameRight=function(n){var i=r.getSWebTwain().CapGetFrameRight(n);return t.setErrorString(r),i};i.CapGetFrameTop=function(n){var i=r.getSWebTwain().CapGetFrameTop(n);return t.setErrorString(r),i};i.CapGetHelp=function(){var n=r.getSWebTwain().CapGetHelp();return t.setErrorString(r),n};i.CapGetLabel=function(){var n=r.getSWebTwain().CapGetLabel();return t.setErrorString(r),n};i.CapGetLabels=function(){var n=r.getSWebTwain().CapGetLabels();return t.setErrorString(r),n};i.CapIfSupported=function(n){var i=r.getSWebTwain().CapIfSupported(n);return t.setErrorString(r),i};i.CapReset=function(){return r.getSWebTwain().CapReset(),t.checkErrorString(r)};i.CapSet=function(){return r.getSWebTwain().CapSet(),t.checkErrorString(r)};i.CapSetFrame=function(n,i,u,f,e){return r.getSWebTwain().CapSetFrame(n,i,u,f,e),t.checkErrorString(r)};i.GetCapItems=function(n){var i=r.getSWebTwain().GetCapItems(n);return t.setErrorString(r),i};i.GetCapItemsString=function(n){var i=r.getSWebTwain().GetCapItemsString(n);return t.setErrorString(r),i};i.SetCapItems=function(n,i){return r.getSWebTwain().SetCapItems(n,i),t.checkErrorString(r)};i.SetCapItemsString=function(n,i){return r.getSWebTwain().SetCapItemsString(n,i),t.checkErrorString(r)};i.AddText=function(i,u,f,e,o,s,h,c){var l=parseInt(i);return isNaN(l)||l<0||l>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),!1):(r.getSWebTwain().AddText(l,u,f,e,o,s,h,c),t.checkErrorString(r))};i.CreateTextFont=function(n,i,u,f,e,o,s,h,c,l,a,v,y,p){return r.getSWebTwain().CreateTextFont(n,i,u,f,e,o,s,h,c,l,a,v,y,p),t.checkErrorString(r)};i.CopyToClipboard=function(i){var u=parseInt(i);return isNaN(u)||u<0||u>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),!1):(r.getSWebTwain().CopyToClipboard(u),t.checkErrorString(r))};i.Erase=function(i,u,f,e,o,s,h){var c=parseInt(i),l;return isNaN(c)||c<0||c>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),n.isFunction(h)&&h(r.ErrorCode,r.ErrorString),!1):(l=r.getSWebTwain().Erase(c,u,f,e,o),t.wrapperRet(r,l,s,h))};i.GetImageBitDepth=function(i){var u=parseInt(i),f;return isNaN(u)||u<0||u>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),!1):(f=r.getSWebTwain().GetImageBitDepth(u),t.setErrorString(r),f)};i.GetImageWidth=function(i){var u=parseInt(i),f;return isNaN(u)||u<0||u>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),!1):(f=r.getSWebTwain().GetImageWidth(u),t.setErrorString(r),f)};i.GetImageHeight=function(i){var u=parseInt(i),f;return isNaN(u)||u<0||u>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),!1):(f=r.getSWebTwain().GetImageHeight(u),t.setErrorString(r),f)};i.GetImageSize=function(i,u,f){var e=parseInt(i),o;return isNaN(e)||e<0||e>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),!1):(o=r.getSWebTwain().GetImageSize(e,u,f),t.setErrorString(r),o)};i.GetImageSizeWithSpecifiedType=function(i,u){var f=parseInt(i),e;return isNaN(f)||f<0||f>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),!1):(e=r.getSWebTwain().GetImageSizeWithSpecifiedType(f,u),t.setErrorString(r),e)};i.GetImageXResolution=function(i){var u=parseInt(i),f;return isNaN(u)||u<0||u>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),!1):(f=r.getSWebTwain().GetImageXResolution(u),t.setErrorString(r),f)};i.GetImageYResolution=function(i){var u=parseInt(i),f;return isNaN(u)||u<0||u>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),!1):(f=r.getSWebTwain().GetImageYResolution(u),t.setErrorString(r),f)};i.CopyToClipboardAsync=function(n){return t.wrapperPromise(r,r.CopyToClipboard(n))};i.EraseAsync=function(n,i,u,f,e){return t.wrapperPromise(r,r.Erase(n,i,u,f,e))};i.GetImageBitDepthAsync=function(n){return t.wrapperPromise(r,r.GetImageBitDepth(n))};i.GetImageWidthAsync=function(n){return t.wrapperPromise(r,r.GetImageWidth(n))};i.GetImageHeightAsync=function(n){return t.wrapperPromise(r,r.GetImageHeight(n))};i.GetImageSizeAsync=function(n,i,u){return t.wrapperPromise(r,r.GetImageSize(n,i,u))};i.GetImageSizeWithSpecifiedTypeAsync=function(n,i){return t.wrapperPromise(r,r.GetImageSizeWithSpecifiedType(n,i))};i.GetImageXResolutionAsync=function(n){return t.wrapperPromise(r,r.GetImageXResolution(n))};i.GetImageYResolutionAsync=function(n){return t.wrapperPromise(r,r.GetImageYResolution(n))};i.GetSelectedImageIndex=function(n){var i=r.getSWebTwain().GetSelectedImageIndex(n);return t.setErrorString(r),i};i.SetSelectedImageIndex=function(n,i){return r.getSWebTwain().SetSelectedImageIndex(n,i),t.checkErrorString(r)};i.SelectAllImages=function(){var i=r.getSWebTwain().HowManyImagesInBuffer,n,u=[];for(r.getSWebTwain().SelectedImagesCount=i,n=0;n<i;n++)r.getSWebTwain().SetSelectedImageIndex(n,n),u.push(n);return t.checkErrorString(r),u};i.SelectImages=function(n){var u=n.length,i;for(r.getSWebTwain().SelectedImagesCount=u,i=0;i<u;i++)r.getSWebTwain().SetSelectedImageIndex(i,n[i]);return t.checkErrorString(r)};i.GetSelectedImagesSize=function(n){var i=r.getSWebTwain().GetSelectedImagesSize(n);return t.setErrorString(r),i};i.GetSkewAngle=function(i,u,f){var e=parseInt(i),o;return isNaN(e)||e<0||e>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),n.isFunction(f)&&f(r.ErrorCode,r.ErrorString),!1):(o=r.getSWebTwain().GetSkewAngle(e),t.wrapperRet(r,o,u,f,!1,!0))};i.GetSkewAngleEx=function(i,u,f,e,o,s,h){var c=parseInt(i),l;return isNaN(c)||c<0||c>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),n.isFunction(h)&&h(r.ErrorCode,r.ErrorString),!1):(l=r.getSWebTwain().GetSkewAngleEx(c,u,f,e,o),t.wrapperRet(r,l,s,h))};i.IsBlankImage=function(i){var u=parseInt(i),f;return isNaN(u)||u<0||u>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),!1):(f=r.getSWebTwain().IsBlankImage(u),t.setErrorString(r),f)};i.IsBlankImageEx=function(i,u,f,e,o,s){var h=parseInt(i),c;return isNaN(h)||h<0||h>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),!1):(c=r.getSWebTwain().IsBlankImageEx(h,u,f,e,o,s),t.setErrorString(r),c)};i.Mirror=function(i,u,f){var e=parseInt(i),o;return isNaN(e)||e<0||e>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),n.isFunction(f)&&f(r.ErrorCode,r.ErrorString),!1):(o=r.getSWebTwain().Mirror(e),t.wrapperRet(r,o,u,f))};i.OverlayRectangle=function(n,i,u,f,e,o,s){return r.getSWebTwain().OverlayRectangle(n,i,u,f,e,o,s),t.checkErrorString(r)};i.RemoveAllImages=function(){var n;return r.getSWebTwain().RemoveAllImages(),n=t.checkErrorString(r),n&&r.__innerRefreshImage(),n};i.RemoveAllSelectedImages=function(){var n;return r.getSWebTwain().RemoveAllSelectedImages(),n=t.checkErrorString(r),n&&r.__innerRefreshImage(),n};i.RemoveImage=function(i){var u=parseInt(i);return isNaN(u)||u<0||u>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),!1):(r.getSWebTwain().RemoveImage(u),t.checkErrorString(r))};i.MirrorAsync=function(n){return t.wrapperPromise(r,r.Mirror(n))};i.RemoveAllImagesAsync=function(){return t.wrapperPromise(r,r.RemoveAllImages())};i.RemoveAllSelectedImagesAsync=function(){return t.wrapperPromise(r,r.RemoveAllSelectedImages())};i.RemoveImageAsync=function(n){return t.wrapperPromise(r,r.RemoveImage(n))};i.Rotate=function(i,u,f,e,o){var s=parseInt(i),h;return isNaN(s)||s<0||s>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),n.isFunction(o)&&o(r.ErrorCode,r.ErrorString),!1):(h=r.getSWebTwain().Rotate(s,u,f),t.wrapperRet(r,h,e,o))};i.RotateEx=function(i,u,f,e,o,s){var h=parseInt(i),c;return isNaN(h)||h<0||h>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),n.isFunction(s)&&s(r.ErrorCode,r.ErrorString),!1):(c=r.getSWebTwain().RotateEx(h,u,f,e),t.wrapperRet(r,c,o,s))};i.RotateLeft=function(i,u,f){var e=parseInt(i),o;return isNaN(e)||e<0||e>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),n.isFunction(f)&&f(r.ErrorCode,r.ErrorString),!1):(o=r.getSWebTwain().RotateLeft(e),t.wrapperRet(r,o,u,f))};i.RotateRight=function(i,u,f){var e=parseInt(i),o;return isNaN(e)||e<0||e>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),n.isFunction(f)&&f(r.ErrorCode,r.ErrorString),!1):(o=r.getSWebTwain().RotateRight(e),t.wrapperRet(r,o,u,f))};i.ChangeImageSize=function(i,u,f,e,o,s){var h=parseInt(i),c;return isNaN(h)||h<0||h>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),n.isFunction(s)&&s(r.ErrorCode,r.ErrorString),!1):u<=0||f<=0?(n.Errors.InvalidWidthOrHeight(r),n.isFunction(s)&&s(r.ErrorCode,r.ErrorString),!1):(c=r.getSWebTwain().ChangeImageSize(h,u,f,e),t.wrapperRet(r,c,o,s))};i.Flip=function(i,u,f){var e=parseInt(i),o;return isNaN(e)||e<0||e>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),n.isFunction(f)&&f(r.ErrorCode,r.ErrorString),!1):(o=r.getSWebTwain().Flip(e),t.wrapperRet(r,o,u,f))};i.Crop=function(i,u,f,e,o,s,h){var c=parseInt(i),l;return isNaN(c)||c<0||c>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),n.isFunction(h)&&h(r.ErrorCode,r.ErrorString),!1):(l=r.getSWebTwain().Crop(c,u,f,e,o),t.wrapperRet(r,l,s,h))};i.CropToClipboard=function(i,u,f,e,o){var s=parseInt(i),h;return isNaN(s)||s<0||s>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),!1):(h=r.getSWebTwain().CropToClipboard(s,u,f,e,o),t.checkErrorString(r))};i.CutFrameToClipboard=function(i,u,f,e,o){var s=parseInt(i),h;return isNaN(s)||s<0||s>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),!1):(h=r.getSWebTwain().CutFrameToClipboard(s,u,f,e,o),t.checkErrorString(r))};i.CutToClipboard=function(i){var u=parseInt(i),f;return isNaN(u)||u<0||u>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),!1):(f=r.getSWebTwain().CutToClipboard(u),t.checkErrorString(r))};i.RotateAsync=function(n,i,u){return t.wrapperPromise(r,r.Rotate(n,i,u))};i.RotateExAsync=function(n,i,u,f){return t.wrapperPromise(r,r.RotateEx(n,i,u,f))};i.RotateLeftAsync=function(n){return t.wrapperPromise(r,r.RotateLeft(n))};i.RotateRightAsync=function(n){return t.wrapperPromise(r,r.RotateRight(n))};i.ChangeImageSizeAsync=function(n,i,u,f){return t.wrapperPromise(r,r.ChangeImageSize(n,i,u,f))};i.FlipAsync=function(n){return t.wrapperPromise(r,r.Flip(n))};i.CropAsync=function(n,i,u,f,e){return t.wrapperPromise(r,r.Crop(n,i,u,f,e))};i.CropToClipboardAsync=function(n,i,u,f,e){return t.wrapperPromise(r,r.CropToClipboard(n,i,u,f,e))};i.CutFrameToClipboardAsync=function(n,i,u,f,e){return t.wrapperPromise(r,r.CutFrameToClipboard(n,i,u,f,e))};i.CutToClipboardAsync=function(n){return t.wrapperPromise(r,r.CutToClipboard(n))};i.InvertAsync=function(n){return t.wrapperPromise(r,r.Invert(n))};i.Invert=function(t){var i=parseInt(t);return isNaN(i)||i<0||i>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),!1):(n.Errors.ActiveXNotSupport(r),!1)};i.SetDPI=function(i,u,f,e,o,s,h){var c=parseInt(i),l;return isNaN(c)||c<0||c>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),n.isFunction(h)&&h(r.ErrorCode,r.ErrorString),!1):(l=r.getSWebTwain().SetDPI(c,u,f,e,o),t.wrapperRet(r,l,s,h))};i.SetViewMode=function(n,i){return r.getSWebTwain().SetViewMode(n,i),t.checkErrorString(r)};i.GetViewModeH=function(){var n=r.getSWebTwain().GetViewModeH();return t.setErrorString(r),n};i.GetViewModeV=function(){var n=r.getSWebTwain().GetViewModeV();return t.setErrorString(r),n};i.MoveImage=function(i,u){var f=parseInt(i),e=parseInt(u);return isNaN(f)||f<0||f>=r.HowManyImagesInBuffer||isNaN(e)||e<0||e>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),!1):(r.getSWebTwain().MoveImage(f,e),t.checkErrorString(r))};i.SwitchImage=function(i,u){var f=parseInt(i),e=parseInt(u);return isNaN(f)||f<0||f>=r.HowManyImagesInBuffer||isNaN(e)||e<0||e>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),!1):(r.getSWebTwain().SwitchImage(f,e),t.checkErrorString(r))};i.Print=function(){return r.getSWebTwain().Print(),t.checkErrorString(r)};i.checkErrorString=function(){return t.isReturnSuccess(r)};i.FileExists=function(n){var i=t.replaceLocalFilename(n),u=r.getSWebTwain().FileExists(i);return t.setErrorString(r),u};i.SaveAllAsMultiPageTIFF=function(n,i,u){if(!h(r,u))return!1;var e=t.replaceLocalFilename(n),f;return f=r.getSWebTwain().SaveAllAsMultiPageTIFF(e),t.wrapperRet(r,f,i,u)};i.SaveAllAsPDF=function(n,i,u){if(!h(r,u))return!1;var e=t.replaceLocalFilename(n),f;return f=r.getSWebTwain().SaveAllAsPDF(e),t.wrapperRet(r,f,i,u)};i.SaveAsBMP=function(n,i,u,f){if(!s(r,i,f))return!1;var o=t.replaceLocalFilename(n),e;return e=r.getSWebTwain().SaveAsBMP(o,i),t.wrapperRet(r,e,u,f)};i.SaveAsJPEG=function(n,i,u,f){if(!s(r,i,f))return!1;var o=t.replaceLocalFilename(n),e;return e=r.getSWebTwain().SaveAsJPEG(o,i),t.wrapperRet(r,e,u,f)};i.SaveAsPDF=function(n,i,u,f){if(!s(r,i,f))return!1;var o=t.replaceLocalFilename(n),e;return e=r.getSWebTwain().SaveAsPDF(o,i),t.wrapperRet(r,e,u,f)};i.SaveAsPNG=function(n,i,u,f){if(!s(r,i,f))return!1;var o=t.replaceLocalFilename(n),e;return e=r.getSWebTwain().SaveAsPNG(o,i),t.wrapperRet(r,e,u,f)};i.SaveAsTIFF=function(n,i,u,f){if(!s(r,i,f))return!1;var o=t.replaceLocalFilename(n),e;return e=r.getSWebTwain().SaveAsTIFF(o,i),t.wrapperRet(r,e,u,f)};i.SaveSelectedImagesAsMultiPagePDF=function(n,i,u){var e=t.replaceLocalFilename(n),f;return f=r.getSWebTwain().SaveSelectedImagesAsMultiPagePDF(e),t.wrapperRet(r,f,i,u)};i.SaveSelectedImagesAsMultiPageTIFF=function(n,i,u){var e=t.replaceLocalFilename(n),f;return f=r.getSWebTwain().SaveSelectedImagesAsMultiPageTIFF(e),t.wrapperRet(r,f,i,u)};i.SaveSelectedImagesToBase64Binary=function(n,i){var u=r.getSWebTwain().SaveSelectedImagesToBase64Binary();return t.wrapperRet(r,u,n,i)};i.ShowFileDialog=function(n,i,u,f,e,o,s,h){return r.getSWebTwain().ShowFileDialog(n,i,u,f,e,o,s,h),t.checkErrorString(r)};i.FTPDownload=function(n,i,f,e){if(!u(e))return!1;var o=r.getSWebTwain().FTPDownload(n,i);return t.wrapperRet(r,o,f,e)};i.FTPDownloadDirectly=function(n,i,f,e,o){if(!u(o))return!1;var s=r.getSWebTwain().FTPDownloadDirectly(n,i,f);return t.wrapperRet(r,s,e,o)};i.FTPDownloadEx=function(n,i,o,s,h){if(!u(h))return!1;if((o<-1||o>5)&&(o=-1),!f(o,h))return e;var c=r.getSWebTwain().FTPDownloadEx(n,i,o);return t.wrapperRet(r,c,s,h)};i.FTPUpload=function(n,i,f,e,o){if(!u(o))return!1;var s=r.getSWebTwain().FTPUpload(n,i,f);return t.wrapperRet(r,s,e,o)};i.FTPUploadDirectly=function(n,i,f,e,o){if(!u(o))return!1;var s=r.getSWebTwain().FTPUploadDirectly(n,i,f);return t.wrapperRet(r,s,e,o)};i.FTPUploadEx=function(n,i,f,e,o,s){if(!u(s))return!1;var h=r.getSWebTwain().FTPUploadEx(n,i,f,e);return t.wrapperRet(r,h,o,s)};i.FTPUploadAllAsMultiPageTIFF=function(n,i,f,e){if(!u(e))return!1;var o=r.getSWebTwain().FTPUploadAllAsMultiPageTIFF(n,i);return t.wrapperRet(r,o,f,e)};i.FTPUploadAllAsPDF=function(n,i,f,e){if(!u(e))return!1;var o=r.getSWebTwain().FTPUploadAllAsPDF(n,i);return t.wrapperRet(r,o,f,e)};i.FTPUploadAsMultiPagePDF=function(n,i,u,f){var e=r.getSWebTwain().FTPUploadAsMultiPagePDF(n,i);return t.wrapperRet(r,e,u,f)};i.FTPUploadAsMultiPageTIFF=function(n,i,u,f){var e=r.getSWebTwain().FTPUploadAsMultiPageTIFF(n,i);return t.wrapperRet(r,e,u,f)};i.HTTPDownloadDirectly=function(n,i,f,e,o){if(!u(o))return!1;var s=r.getSWebTwain().HTTPDownloadDirectly(n,i,f);return t.wrapperRet(r,s,e,o)};i.HTTPDownload=function(n,i,u,f){var e=t.getImageType(i);return r.HTTPDownloadEx(n,i,e,u,f)};i.HTTPDownloadEx=function(n,i,o,s,h){if(!u(h)||((o<-1||o>5)&&(o=-1),!f(o,h)))return e;var c=r.getSWebTwain().HTTPDownloadEx(n,i,o);return t.wrapperRet(r,c,s,h)};i.HTTPDownloadThroughGet=i.HTTPDownloadEx;i.HTTPUploadThroughPostDirectly=function(n,i,f,e,o,s){if(!u(s))return!1;var h=r.getSWebTwain().HTTPUploadThroughPostDirectly(n,i,f,e);return t.wrapperRet(r,h,o,s,!0)};i.HTTPUploadThroughPost=function(i,u,f,e,o,s){if(!n.isNumber(u)||isNaN(u)||u<-2)return n.Errors.IndexOutOfRange(r),n.isFunction(s)&&s(r.ErrorCode,r.ErrorString),!1;var h=r.getSWebTwain().HTTPUploadThroughPost(i,u,f,e);return t.wrapperRet(r,h,o,s,!0)};i.HTTPUploadThroughPostEx=function(i,u,f,e,o,s,h){if(!n.isNumber(u)||isNaN(u)||u<-2)return n.Errors.IndexOutOfRange(r),n.isFunction(h)&&h(r.ErrorCode,r.ErrorString),!1;var c=r.getSWebTwain().HTTPUploadThroughPostEx(i,u,f,e,o);return t.wrapperRet(r,c,s,h,!0)};i.ClearAllHTTPFormField=function(){return r.getSWebTwain().ClearAllHTTPFormField(),t.checkErrorString(r)};i.SetHTTPFormField=function(n,i){return r.getSWebTwain().SetHTTPFormField(n,i),t.checkErrorString(r)};i.HTTPUploadAllThroughPostAsMultiPageTIFF=function(n,i,u,f,e){var o;return o=r.getSWebTwain().HTTPUploadAllThroughPostAsMultiPageTIFF(n,i,u),t.wrapperRet(r,o,f,e,!0)};i.HTTPUploadThroughPostAsMultiPageTIFF=function(n,i,u,f,e){var o;return o=r.getSWebTwain().HTTPUploadThroughPostAsMultiPageTIFF(n,i,u),t.wrapperRet(r,o,f,e,!0)};i.HTTPUploadAllThroughPostAsPDF=function(n,i,u,f,e){var o;return o=r.getSWebTwain().HTTPUploadAllThroughPostAsPDF(n,i,u),t.wrapperRet(r,o,f,e,!0)};i.HTTPUploadThroughPostAsMultiPagePDF=function(n,i,u,f,e){var o;return o=r.getSWebTwain().HTTPUploadThroughPostAsMultiPagePDF(n,i,u),t.wrapperRet(r,o,f,e,!0)};i.HTTPUploadThroughPutDirectly=function(n,i,u,f,e){var o;return o=r.getSWebTwain().HTTPUploadThroughPutDirectly(n,i,u),t.wrapperRet(r,o,f,e)};i.HTTPUploadThroughPut=function(n,i,u,f,e){var o=t.getImageType(u);return r.HTTPUploadThroughPutEx(n,i,u,o,f,e)};i.HTTPUploadThroughPutEx=function(n,i,u,f,e,o){var s;return s=r.getSWebTwain().HTTPUploadThroughPutEx(n,i,u,f),t.wrapperRet(r,s,e,o)};i.HTTPUploadAllThroughPutAsMultiPageTIFF=function(n,t,i,u){return r.HTTPUploadThroughPutEx(n,-1,t,2,i,u)};i.HTTPUploadThroughPutAsMultiPageTIFF=function(n,t,i,u){return r.HTTPUploadThroughPutEx(n,-2,t,2,i,u)};i.HTTPUploadAllThroughPutAsPDF=function(n,t,i,u){return r.HTTPUploadThroughPutEx(n,-1,t,4,i,u)};i.HTTPUploadThroughPutAsMultiPagePDF=function(n,t,i,u){return r.HTTPUploadThroughPutEx(n,-2,t,4,i,u)};i.ShowImageEditor=function(){return r.getSWebTwain().ShowImageEditor(),t.checkErrorString(r)};i.SetCookie=function(n){return r.getSWebTwain().SetCookie(n),t.checkErrorString(r)};i.LoadImageFromBase64Binary=function(n,i){if(!u()||((i<-1||i>5)&&(i=-1),!f(i)))return e;var o=r.getSWebTwain().LoadImageFromBase64Binary(n,i);return t.setErrorString(r),o};i.SaveSelectedImagesToBytes=function(n,i){var u=r.getSWebTwain().SaveSelectedImagesToBytes(n,i);return t.setErrorString(r),u};i.LoadImageFromBytes=function(n,i,o){if(!u()||((o<-1||o>5)&&(o=-1),!f(o)))return e;var s=r.getSWebTwain().LoadImageFromBytes(n,i,o);return t.setErrorString(r),s};i.UnregisterEvent=function(n,i){return r.getSWebTwain().UnregisterEvent(n,i),t.checkErrorString(r)};i.SetImageWidth=function(i,u,f,e){var o=parseInt(i),s;return isNaN(o)||o<0||o>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),n.isFunction(e)&&e(r.ErrorCode,r.ErrorString),!1):(s=r.getSWebTwain().SetImageWidth(o,u),t.wrapperRet(r,s,f,e))};i.HTTPDownloadThroughPost=function(n,i,o,s,h){if(!u(h))return!1;if((o<-1||o>5)&&(o=-1),!f(o,h))return e;var c=r.getSWebTwain().HTTPDownloadThroughPost(n,i,o);return t.wrapperRet(r,c,s,h)};i.SetCustomDSDataEx=function(n){return r.getSWebTwain().SetCustomDSDataEx(n),t.checkErrorString(r)};i.SetCustomDSData=function(n){return r.getSWebTwain().SetCustomDSData(n),t.checkErrorString(r)};i.GetCustomDSDataEx=function(){var n=r.getSWebTwain().GetCustomDSDataEx();return t.setErrorString(r),n};i.GetCustomDSData=function(n){var i=r.getSWebTwain().GetCustomDSData(n);return t.setErrorString(r),i};i.ChangeBitDepth=function(i,u,f){var e=parseInt(i);return isNaN(e)||e<0||e>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),!1):(r.getSWebTwain().ChangeBitDepth(e,u,f),t.checkErrorString(r))};i.ConvertToGrayScale=function(i,u,f){var e=parseInt(i),o;return isNaN(e)||e<0||e>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),n.isFunction(f)&&f(r.ErrorCode,r.ErrorString),!1):(o=r.getSWebTwain().ConvertToGrayScale(i),t.wrapperRet(r,o,u,f))};i.ShowImageEditorEx=function(n,i,u,f,e){return r.getSWebTwain().ShowImageEditorEx(n,i,u,f,e),t.checkErrorString(r)};i.ClearTiffCustomTag=function(){return r.getSWebTwain().ClearTiffCustomTag(),t.checkErrorString(r)};i.SetTiffCustomTag=function(n,i,u){var f=n*1;return f<=0||f>2147483647?(Dynamsoft.Lib.Errors.InvalidTiffTagError(r),!1):(r.getSWebTwain().SetTiffCustomTag(n,i,u),t.checkErrorString(r))};i.IsBlankImageExpress=function(i){var u=parseInt(i),f;return isNaN(u)||u<0||u>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),!1):(f=r.getSWebTwain().IsBlankImageExpress(u),t.setErrorString(r),f)};i._ChangeWidth=function(t){var f=document.getElementById(r._strDWTInnerContainerID),i,u;return n.isString(t)&&t.length>0&&t.charAt(t.length-1)==="%"&&(i=t),i||(u=parseInt(t),u&&u>2&&(i=u-2+"px")),i&&(r._strWidth=i,r.getSWebTwain().style.width=i,f&&(f.style.width=i)),o};i._ChangeHeight=function(t){var f=document.getElementById(r._strDWTInnerContainerID),i,u;return n.isString(t)&&t.length>0&&t.charAt(t.length-1)==="%"&&(i=t),i||(u=parseInt(t),u&&(i=u+"px")),i&&(r._strHeight=i,r.getSWebTwain().style.height=i,f&&(f.style.height=i)),o};i.SetSize=function(n,t){var i=this;return i._ChangeWidth(n),i._ChangeHeight(t),o};i.SetSelectedImageArea=function(n,i,u,f,e){return r.getSWebTwain().SetSelectedImageArea(n,i,u,f,e),t.checkErrorString(r)};i.SetVideoRotateMode=function(n){return r.getSWebTwain().SetVideoRotateMode(n),t.checkErrorString(r)};i.SetOpenSourceTimeout=function(n){return r.getSWebTwain().SetOpenSourceTimeout(n),t.checkErrorString(r)};i.SetHTTPHeader=function(){return!1};i.GetImageURL=function(){return""};i.GetImagePartURL=function(i){var u=parseInt(i),f;return isNaN(u)||u<0||u>=r.HowManyImagesInBuffer?(n.Errors.IndexOutOfRange(r),""):(f=r.getSWebTwain().GetDIB(u),t.setErrorString(r),f)};i.GetLicenseInfo=function(i){var f,u;try{r.getSWebTwain().ProductKey=i;f=r.getSWebTwain().GetLicenseInfo();t.checkErrorString(r)?(u=n.parse(f),u&&u.message&&(n.Errors.LicenseEmptyOrInvalid(r),r._errorString=u.message,u=undefined),r.__licenseInfo=u):r.__licenseInfo=undefined}catch(e){r.__licenseInfo=undefined}return Promise.resolve(r.__licenseInfo)};i.LoadDibFromClipboard=function(n,i){var u;return u=r.getSWebTwain().LoadDibFromClipboard(),t.wrapperRet(r,u,n,i)};i.LoadImage=function(n,i,f){if(!u(f))return!1;var o=t.replaceLocalFilename(n),e;return e=r.getSWebTwain().LoadImage(o),t.wrapperRet(r,e,i,f)};i.LoadImageEx=function(n,i,o,s){if(!u(s)||((i<-1||i>5)&&(i=-1),!f(i,s)))return e;var l=t.replaceLocalFilename(n),h=i,c;return h==EnumDWT_ImageType.IT_ALL&&(h=-1),c=r.getSWebTwain().LoadImageEx(l,h),t.wrapperRet(r,c,o,s)};i.EnableSource=function(n,i,u){return r.AcquireImage(n,i,u),t.checkErrorString(r)};i.AcquireImage=function(i,f,e){var h=r.getSWebTwain(),a,s=null,l=null,c=null,o;return(n.isUndefined(e)&&(n.isFunction(i)&&n.isFunction(f)||n.isFunction(i)&&n.isUndefined(f)||n.isFunction(i)&&f==null||i==null&&n.isFunction(f))?(s=null,n.isFunction(i)&&(l=i),n.isFunction(f)&&(c=f)):(n.isUndefined(i)||(s=i),n.isFunction(f)&&(l=f),n.isFunction(e)&&(c=e)),!u(c))?!1:(s!==undefined&&s!==null&&(o=s.SelectSourceByIndex,o!=null&&typeof o!="undefined"&&(h.SelectSourceByIndex(o),h.CloseSource(),h.OpenSource()),o=s.IfShowUI,o!=null&&typeof o!="undefined"&&(h.IfShowUI=o),o=s.PixelType,o!=null&&typeof o!="undefined"&&(h.PixelType=o),o=s.Resolution,o!=null&&typeof o!="undefined"&&(h.Resolution=o),o=s.IfFeederEnabled,o!=null&&typeof o!="undefined"&&(h.IfFeederEnabled=o),o=s.IfDuplexEnabled,o!=null&&typeof o!="undefined"&&(h.IfDuplexEnabled=o),o=s.IfDisableSourceAfterAcquire,o!=null&&typeof o!="undefined"&&(h.IfDisableSourceAfterAcquire=o)),r.getSWebTwain().RegisterEvent("OnPostAllTransfers",function(){var i=t.checkErrorString(r);i?n.isFunction(l)&&l():n.isFunction(c)&&c(r._errorCode,r._errorString);n.isFunction(r.__OnPostAllTransfers)&&r.__OnPostAllTransfers()}),a=h.AcquireImage(),t.checkErrorString(r))};i.GenerateURLForUploadData=function(n,i,u){var f=n,e;return f==EnumDWT_ImageType.IT_ALL&&(f=-1),e=!0,t.wrapperRet(r,e,i,u)};i._innerFun=function(n,t){var u=r.getSWebTwain(),i=u[n];return typeof i=="function"?i.apply(u,t):i};i.ActiveUI=function(){};i.startScan=function(){return new Promise(function(){})};i.IndexToImageID=function(n){return n};i.ImageIDToIndex=function(n){return n};i.first=function(){var n=r.HowManyImagesInBuffer;return n>0&&(r.CurrentImageIndexInBuffer=0,r.__innerRefreshImage()),o};i.previous=function(){var t=r.HowManyImagesInBuffer,n;return t>0&&(n=r.CurrentImageIndexInBuffer,n>0&&(r.CurrentImageIndexInBuffer=n-1,r.__innerRefreshImage())),o};i.next=function(){var t=r.HowManyImagesInBuffer,n;return t>0&&(n=r.CurrentImageIndexInBuffer,n>=0&&n<t-1&&(r.CurrentImageIndexInBuffer=n+1,r.__innerRefreshImage())),o};i.last=function(){var n=r.HowManyImagesInBuffer;return n>0&&(r.CurrentImageIndexInBuffer=n-1,r.__innerRefreshImage()),o};i.__innerRefreshImage=function(){var n=r.HowManyImagesInBuffer,t;n>0&&(t=r.CurrentImageIndexInBuffer,r.__OnRefreshUI&&r.__OnRefreshUI(t,n))};i._attachEvents=function(){var n=r.getSWebTwain(),t;(t=Dynamsoft.Lib.detect.getVersionArray(String(r.VersionInfo)),t.length<=2||t[0]<9||t[0]==9&&t[1]<=2)||(r.__OnPostTransfer!=""&&n.RegisterEvent("OnPostTransfer",r.__OnPostTransfer),r.__OnPostAllTransfers!=""&&n.RegisterEvent("OnPostAllTransfers",r.__OnPostAllTransfers),r.__OnMouseClick!=""&&n.RegisterEvent("OnMouseClick",r.__OnMouseClick),r.__OnPostLoad!=""&&n.RegisterEvent("OnPostLoad",r.__OnPostLoad),r.__OnImageAreaSelected!=""&&n.RegisterEvent("OnImageAreaSelected",r.__OnImageAreaSelected),r.__OnMouseDoubleClick!=""&&n.RegisterEvent("OnMouseDoubleClick",r.__OnMouseDoubleClick),r.__OnMouseRightClick!=""&&n.RegisterEvent("OnMouseRightClick",r.__OnMouseRightClick),r.__OnTopImageInTheViewChanged!=""&&n.RegisterEvent("OnTopImageInTheViewChanged",r.__OnTopImageInTheViewChanged),r.__OnImageAreaDeSelected!=""&&n.RegisterEvent("OnImageAreaDeSelected",r.__OnImageAreaDeSelected),r.__OnGetFilePath!=""&&n.RegisterEvent("OnGetFilePath",r.__OnGetFilePath),r.__OnAfterOperate!=""&&n.RegisterEvent("OnAfterOperate",r.__OnAfterOperate),r.__OnBeforeOperate!=""&&n.RegisterEvent("OnBeforeOperate",r.__OnBeforeOperate),r.__OnOperateStatus!=""&&n.RegisterEvent("OnOperateStatus",r.__OnOperateStatus),r.__OnBitmapChanged!=""&&n.RegisterEvent("OnBitmapChanged",r.__OnBitmapChanged),r.__OnMouseMove!=""&&n.RegisterEvent("OnMouseMove",r.__OnMouseMove),r.__OnPreAllTransfers!=""&&n.RegisterEvent("OnPreAllTransfers",r.__OnPreAllTransfers),r.__OnPreTransfer!=""&&n.RegisterEvent("OnPreTransfer",r.__OnPreTransfer),r.__OnSourceUIClose!=""&&n.RegisterEvent("OnSourceUIClose",r.__OnSourceUIClose),r.__OnTransferCancelled!=""&&n.RegisterEvent("OnTransferCancelled",r.__OnTransferCancelled),r.__OnTransferError!=""&&n.RegisterEvent("OnTransferError",r.__OnTransferError),r.__OnInternetTransferPercentage!=""&&n.RegisterEvent("OnInternetTransferPercentage",r.__OnInternetTransferPercentage),r.__OnInternetTransferPercentageEx!=""&&n.RegisterEvent("OnInternetTransferPercentageEx",r.__OnInternetTransferPercentageEx))}};n.noControl=function(t){var f,r,i;if(Dynamsoft.WebTwainEnv.IfUseEmbeddedDownloadNoticeForActiveX)if(n.isFunction(n.detect.onNoControl))n.detect.onNoControl(t._containerID,t._strWidth,t._strHeight);else for(f=n.detect.arySTwains,r=0;r<f.length;r++)i=f[r],i._vPluginExist||(h(i),n.show(i._strDWTNonInstallInnerContainerID),n.hide(i._strDWTInnerContainerID));else{var e=window,u=n.product,o="";n.isFunction(e.OnWebTwainNotFoundOnWindowsCallback)&&(o=s.bIE?Dynamsoft.dcp.getDSPath():u.bHTML5Edition?Dynamsoft.dcp.getDSPath():u.getMSIPath(),e.OnWebTwainNotFoundOnWindowsCallback(u.name,o,u.bHTML5Edition,s.bIE,s.bSafari,n.detect.ssl,n.env.strIEVersion))}}}});Dynamsoft.Ready(function(n){function t(t){var i=this,r=t||{},u;i._containerID=r.containerID||"dwtcontrolContainer";i._strWidth=r.width||270;i._strHeight=r.height||350;i._errorCode=0;i._errorString="";i.__licenseInfo=!1;n.isString(i._strWidth)&&i._strWidth.indexOf("%")>0||(i._strWidth=[parseInt(i._strWidth),"px"].join(""));n.isString(i._strHeight)&&i._strHeight.indexOf("%")>0||(i._strHeight=[parseInt(i._strHeight),"px"].join(""));i._strObjectName=i._containerID+"_Obj";i.__config=r;i.__OnPluginReady=r.onPluginReady;i.__OnPluginNotReady=r.onPluginNotReady;i.Addon={};i._strDWTInnerContainerID=i._containerID+"_CID";i._strDWTNonInstallInnerContainerID=i._containerID+"_NonInstallCID";u=document.createElement("div");document.body.appendChild(u);i._fakeControl=u;i._createControl()}if(n.product.bActiveXEdition){var i=Dynamsoft.navInfo;t.prototype._createControl=function(){var f,t=this,r=t._strWidth,u=t._strHeight,e;n.isString(r)&&(r=r.indexOf("%")>0?"100%":parseInt(r)+2+"px");n.isString(u)&&(u=u.indexOf("%")>0?"100%":parseInt(u)+2+"px");e=Dynamsoft.WebTwainEnv.ActiveXInstallWithCAB?['<div id="',t._strDWTInnerContainerID,'" style="width:',r,";height:",u,'">','<object id="',t._strObjectName,'" style="width:',t._strWidth,";height:",t._strHeight,';border:1px solid #AAAAAA"',' codebase="',i.bWin64?n.product.getActiveXCABx64Path():n.product.getActiveXCABx86Path(),"#version=",Dynamsoft.WebTwainEnv.ActiveXVersion,'"',' classid="clsid:',n.product.strFullClassID,'" viewastext>','<param name="wmode" value="transparent"/>',"<\/object>","<\/div>"]:['<div id="',t._strDWTInnerContainerID,'" style="width:',r,";height:",u,'">','<object id="',t._strObjectName,'" style="width:',t._strWidth,";height:",t._strHeight,';border:1px solid #AAAAAA"',' classid="clsid:',n.product.strFullClassID,'" viewastext>','<param name="wmode" value="transparent"/>',"<\/object>","<\/div>"];e.push('<div id="',t._strDWTNonInstallInnerContainerID,'" style="width: ',r,';display:none"><\/div>');f=document.getElementById(t._containerID);f&&(f.innerHTML=e.join(""));t._fakeControl._objWebTwain=null;t._fakeControl.getSWebTwain=function(){var n=this;return n._objWebTwain===null&&(n._objWebTwain=document.getElementById(t._strObjectName)),n._objWebTwain}};t.prototype.getInstance=function(){var n=this,t=n._fakeControl.getSWebTwain();return t?n._fakeControl:!1};t.prototype._isMobileMode=function(){return!1};n.detect._controlDetect=function(){var f=n.detect.arySTwains,r=f[0],t=r&&r._fakeControl&&r._fakeControl.getSWebTwain(),h,c,l,s;if(t){var e=Dynamsoft.WebTwainEnv,u=e.ProductKey,o=!1;i.bIE?(h=navigator.userAgent.toLowerCase(),c=!i.bOSx64||h.indexOf("wow64")>=0,l=c?"DynamicPdfCore_"+e.PdfVersion+".dll":"DynamicPdfCorex64_"+e.PdfVersion+".dll",t.ErrorCode==0&&""!=t.GetAddOnVersion("pdf",l)&&(o=!0)):t.ErrorCode==0&&(o=!0);o?(clearInterval(n.detect._varSeed),s=function(t){for(var i,u,r=0;r<f.length;r++)i=f[r],u=i._fakeControl.getSWebTwain(),n.__innerInitEvents(i._fakeControl,i.__config),i._fakeControl.__OnRefreshUI=i.__config.onRefreshUI||"",n.attachProperty(i._fakeControl),n.attachMethod(i._fakeControl),i._fakeControl._attachEvents(),i._fakeControl.GetLicenseInfo(t),n.attachAddon(i._fakeControl),n.isFunction(i.__OnPluginReady)&&i.__OnPluginReady()},n.startsWith(u,"http://")||n.startsWith(u,"https://")?n.ajax({method:"GET",url:u,onSuccess:function(n){s(n)}}):s(u)):(n.detect.bNoControlEvent||(n.noControl(r),n.detect.bNoControlEvent=!0),n.isFunction(t.__OnPluginNotReady)&&t.__OnPluginNotReady())}else clearInterval(n.detect._varSeed)};n.ie={};n.ie.DynamicWebTwain=function(i){var r=new t(i);return n.detect.arySTwains.push(r),r};n.ie.closeAll=function(){for(var u=n.detect.arySTwains,i,r,t=0;t<u.length;t++)i=u[t],i&&i._fakeControl&&(r=i._fakeControl.getSWebTwain(),r&&r.ErrorCode==0&&r.RemoveAllImages());n.detect.arySTwains=[]};Dynamsoft.WebTwainEnv.RemoveAllAuthorizations=function(){return!1}}});Dynamsoft.Ready(function(n){function f(t){var i=this,r=t||{};i._containerID=r.containerID||"dwtcontrolContainer";i._strWidth=r.width||270;i._strHeight=r.height||350;n.isString(i._strWidth)&&i._strWidth.indexOf("%")>0||(i._strWidth=[parseInt(i._strWidth),"px"].join(""));n.isString(i._strHeight)&&i._strHeight.indexOf("%")>0||(i._strHeight=[parseInt(i._strHeight),"px"].join(""));i._strObjectName=i._containerID+"_Obj";n.__innerInitEvents(i,r);i.__OnPluginReady=r.onPluginReady;i.__OnPluginNotReady=r.onPluginNotReady;i.__OnRefreshUI=r.onRefreshUI||"";i._objectWebTwain=null;i._strDWTInnerContainerID=i._containerID+"_CID";i._strDWTNonInstallInnerContainerID=i._containerID+"_NonInstallCID";i._vNotAllowedForChrome=!1;i._vPluginExist=!1;i.Addon={}}var e=Dynamsoft;if(n.product.bPluginEdition){var t=Dynamsoft.navInfo,u=document,r=navigator,i;i=f.prototype;i.getSWebTwain=function(){var n=this;return n._objectWebTwain};i._isMobileMode=function(){return!1};i.getInstance=function(){var n=this;return n._objectWebTwain?n:!1};i._createControl=function(){var i=this,o,r=i._strWidth,e=i._strHeight,u,f;n.isString(r)&&(r=r.indexOf("%")>0?"100%":parseInt(r)+2+"px");n.isString(e)&&(e=e.indexOf("%")>0?"100%":parseInt(e)+2+"px");u=['<div id="',i._strDWTInnerContainerID,'" style="width:',r,";height:",e,'">'];t.bIE?Dynamsoft.WebTwainEnv.ActiveXInstallWithCAB?u.push('<object id="',i._strObjectName,'" style="width:',i._strWidth,";height:",i._strHeight,';border:1px solid #AAAAAA"',' codebase="',t.bWin64?n.product.getActiveXCABx64Path():n.product.getActiveXCABx86Path(),"#version=",Dynamsoft.WebTwainEnv.ActiveXVersion,'"',' classid="clsid:',n.product.strFullClassID,'" viewastext>','<param name="wmode" value="transparent"/>',"<\/object>"):u.push('<object id="',i._strObjectName,'" style="width:',i._strWidth,";height:",i._strHeight,';border:1px solid #AAAAAA"',' classid="clsid:',n.product.strFullClassID,'" viewastext>','<param name="wmode" value="transparent"/>',"<\/object>"):(f=i._strWidth,n.isString(f)&&f.indexOf("%")==-1&&(f=parseInt(f)-2+"px"),u.push('<embed id="',i._strObjectName,'" style="display: inline; width:',f,";height:",i._strHeight,'" type="',n.product.strMIMEType,'"',' pluginspage="',t.bWin?n.product.getMSIPath():n.product.getPKGPath(),'"><\/embed>'));u.push('<\/div><div id="',i._strDWTNonInstallInnerContainerID,'" style="width: ',r,';display:none"><\/div>');o=n.get(i._containerID);o&&(o.innerHTML=u.join(""));i._objectWebTwain=n.get(i._strObjectName)};i._notAllowedForChrome=function(){if(!t.bIE){var u=r.userAgent.toLowerCase(),i=this;u.match(/chrome\/([\d.]+)/)&&(i.__OnNotAllowedForChrome?i.__OnNotAllowedForChrome(i._strDWTInnerContainerID):(i._createNonAllowedDivPlugin(),n.get(i._strDWTNonInstallInnerContainerID).style.display="inline",n.get(i._strDWTInnerContainerID).style.display="none"))}};i._createNonAllowedDivPlugin=function(){function o(){n.get(i._strDWTNonInstallInnerContainerID).style.display="none";n.get(i._strDWTInnerContainerID).style.display="inline"}var i=this,f=n.get(i._strDWTNonInstallInnerContainerID),t,e,r;if(f.innerHTML=="")for(t=i._strHeight,n.isString(t)&&t.indexOf("%")==-1&&(t=parseInt(t)-10+"px"),e=['<div style="display: block; border:1px solid black; width:',i._strWidth,";height:",t,'">','<div style="margin: 200px 0 0 0; padding: 5px; font-size: 16px;line-height: 30px; ">',"<div>The Component is not allowed to run on this site.<\/div>",'<div>Please click <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJeSURBVDhPvZRNSxthEMeX0mNpKS09tP04tdBqobT9WCGJ5kU9pIk5xB4KaoJGmoiNMS+IUiqNB08mjUoUN2vU3WyS9d+ZIbvEZREP0j8Mk5ln5sfs7jxRcM/6f8BKpYKZmRlEIhGUSiUYhjE8uV2eQIal0xmobQ3aeQc/CwWUy+Xh6e3yBM7OzuJMbcPs9cUYzNPeRQLc29tDKpVCOBx2LJ3JQDe66Jo9fI3HEY1GnTOurdVqAnBLgFxwcNBAp3N5w0yTJiTTtA5UVXPy9XpDerwkwOnpaZydtWma/p3s8OgYcZraSwIMhULoXFx6NntZvf4XyWRSAG45QO38wrO51x/Asq7F27nbJMBEIoFm8wiLS0uYm0s6j88QfXUF6ucJXNMe2lAWx+qXD3I+KgHu7OwgEAjI/q2vr2N5eUUaebIWwRovFLTG38AaQtlzLPlP4wKyJcB8Pi83IpfLoVqtYmFh0ZnQ0nU0qHn/uSJ+0G7fiPl8VAL0+/20cyZdsTLm57+hdXIqQAdKE+1T869nCnZfK+I5dsNYAgwGg7i8MhwIG8cbG0Wafo1+X6FPk5VfPUDxqSK+r6oCcEuAU1NT0GhhDQLZVtwsIZvNShFPuDX+FqtPFORfPhS/9X5M8m4JkO/pyakKo0uwof3e/SMF3FQg2PfHCgoEMWlS9nbshgqQt755eIwr3RTYOV+vRlMK1j5OIPlIwY93YxgM39mAIBxzns9HJcDt7W3EYjH5OD6fD5OTk7KbrDo99go12TBbDOV8Peuxh5Zl0Z8ATUdFOjWy55jztt1VArw/Af8A9+n0bhYJ0I4AAAAASUVORK5CYII="/>','at the right end of the address bar and click "<b>Always allow plug-ins<\/b>". Then refresh/restart the browser.<\/div>',"<\/div><\/div>"].join(""),f.innerHTML=e,r=0;r<u.links.length;r++)u.links[r].className=="DWT_CloseNonAllowedDiv"&&(u.links[r].onclick=o)};n.detect._controlDetect=function(){var f=n.detect.arySTwains,u=f[0],s=u&&u._objectWebTwain,p,w,b,v,i,e,c,o,y;if(s){var l=Dynamsoft.WebTwainEnv,h=l.ProductKey,a=!1;if(t.bIE?(p=navigator.userAgent.toLowerCase(),w=!Dynamsoft.navInfo.bOSx64||p.indexOf("wow64")>=0,b=w?"DynamicPdfCore_"+l.PdfVersion+".dll":"DynamicPdfCorex64_"+l.PdfVersion+".dll",s.ErrorCode==0&&""!=s.GetAddOnVersion("pdf",b)&&(a=!0)):s.ErrorCode==0&&(a=!0),a)clearInterval(n.detect._varSeed),v=function(i){for(var r,u=0;u<f.length;u++)r=f[u],n.attachProperty(r),n.attachMethod(r),r._attachEvents(),r.GetLicenseInfo(i),n.attachAddon(r),r._objectWebTwain.BrokerProcessType=n.product._iBrokerProcessType,t.bWin||(r._objectWebTwain.ImageCaptureDriverType=n.product._iImageCaptureDriverType),n.isFunction(r.__OnPluginReady)&&r.__OnPluginReady()},n.startsWith(h,"http://")||n.startsWith(h,"https://")?n.ajax({method:"GET",url:h,onSuccess:function(n){v(n)}}):v(h);else{if(o=r.mimeTypes,t.bIE)n.detect.bNoControlEvent||(n.noControl(u),n.detect.bNoControlEvent=!0);else{if(y=!0,r.plugins.refresh(!1),n.env.iPluginLength!=r.plugins.length)for(i=0;i<o.length;i++)o[i].type.toLowerCase().indexOf(n.product.strMIMEType.toLowerCase())>-1&&location.reload();for(i=0;i<o.length;i++)if(o[i].type.toLowerCase().indexOf(n.product.strMIMEType.toLowerCase())>-1)for(c=0;c<f.length;c++)e=f[c],y=!1,e._vPluginExist=!0,e._vNotAllowedForChrome==!1&&(e._notAllowedForChrome(),e._vNotAllowedForChrome=!0);y&&!n.detect.bNoControlEvent&&(n.noControl(u),n.detect.bNoControlEvent=!0)}n.isFunction(u.__OnPluginNotReady)&&u.__OnPluginNotReady()}}else clearInterval(n.detect._varSeed)};n.plugin={};n.plugin.DynamicWebTwain=function(t){var i=new f(t);return i._createControl(),n.detect.arySTwains.push(i),i};n.plugin.closeAll=function(){for(var u=n.detect.arySTwains,i,r,t=0;t<u.length;t++)i=u[t],i&&i._objectWebTwain&&(r=i._objectWebTwain,r&&r.ErrorCode==0&&r.RemoveAllImages());n.detect.arySTwains=[]};Dynamsoft.WebTwainEnv.RemoveAllAuthorizations=function(){return!1}}}),function(n,t,i){function et(){try{if(typeof WebAssembly=="object"&&typeof WebAssembly.instantiate=="function"){var n=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(n instanceof WebAssembly.Module)return new WebAssembly.Instance(n)instanceof WebAssembly.Instance}}catch(t){}return!1}function at(){var n=['<div style="padding: 0 25px;">',Dynamsoft.MSG.Err_BrowserNotSupportWasm,"<\/div>",'<div style="padding-top:60px"><\/div>'];t.ShowDialog(365,0,n.join(""))}function vt(r,o,h){if(!n.product.bHTML5Edition)return h(ft),u;if(r.UseLocalService===!1&&!et())return n.closeLoadingMsg(),at(),h(Dynamsoft.MSG.Err_BrowserNotSupportWasm),u;yt();var c={},l=r.WebTwainId,a=r.Host,v=r.Port,y=r.PortSSL;return!t._srcUseLocalService&&r.UseLocalService&&(n.detect.dcpStatus=ti,t._srcUseLocalService=!0),l===i||l===null||l===""?(c.id=["dwt_",f.getRandom()].join(""),c.bNoUI=!0):f.get(l)?(c.id=l,c.containerID=l,c.bNoUI=!1):(c.id=l,c.bNoUI=!0),c.UseLocalService=r.UseLocalService,n.isString(a)&&a!=""||(a=Dynamsoft.dcp.host),c.host=a,s.bSSL?(y||(y=18623),c.port=y):(v||(v=18622),c.port=v),o&&(c.asyncSuccessFunc=o),h&&(c.asyncFailureFunc=h),n.waitForScripts().then(function(){return new n.Promise(kt)}).then(function(){tt({callback:it,docViewCallback:function(){it("",0,!0)},host:c.host,port:c.port,UseLocalService:c.UseLocalService})}),t.initQueue.push(c),e}var s=Dynamsoft.navInfoSync,f=n,o=Dynamsoft.dcp,r=f.win,e=!0,u=!1,a={OK:0,BadVersion:1,Error:2},b={bConnected:!1,versionInfo:function(i,r,u){var e=function(u,f){var h=[b._getPreUrl(i,r),"fa/VersionInfo?ts=",n.now()].join(""),e,o,s;e=[n.product.getDWTPrefix(),n.product.getServerVersionInfo()].join("");o=n.stringify({id:"1",method:"VersionInfo",version:e,parameter:[]});t.OnWebTwainInitMessage&&(s=t.CustomizableDisplayInfo.generalMessages.checkingDWTVersion,t.OnWebTwainInitMessage(s,EnumDWT_InitMsg.Info));n.ajax({method:"POST",url:h,data:o,onSuccess:u,onError:f})},f=function(){b.bConnected=!1;t.OnWebTwainInitMessage&&t.OnWebTwainInitMessage(t.CustomizableDisplayInfo.errorMessages.ERR_MODULE_NOT_INSTALLED,EnumDWT_InitMsg.NotInstalledError);u&&y(u,a.Error,t.CustomizableDisplayInfo.errorMessages.ERR_MODULE_NOT_INSTALLED)},s=function(e){var s=o._getJSON(e);if(s&&"result"in s&&(s=s.result,n.isArray(s)&&s.length>0)){u&&setTimeout(function(){var n=s[0],f=s.length>1?s[1]:"",o=s.length>2?s[2]:0,e;f!==""?(t.OnWebTwainInitMessage&&t.OnWebTwainInitMessage(f,EnumDWT_InitMsg.Error),u&&y(u,a.Error,t.CustomizableDisplayInfo.errorMessages.ERR_MODULE_NOT_INSTALLED)):(e="The WebTwain version is: "+n,t.OnWebTwainInitMessage&&t.OnWebTwainInitMessage(e,EnumDWT_InitMsg.Info),o=="64"&&(Dynamsoft.dcp.b64bit=!0),u(a.OK,i,r,n))},0);return}setTimeout(f,1e3)};e(s,f)},_getPreUrl:function(n,t){var i;return i=s.bSSL?"https://":"http://",[i,n,":",t,"/"].join("")}},rt;n.DynamicWebTwain=u;var hi=r.document,k,ut,ft=t.CustomizableDisplayInfo.errorMessages.ERR_BROWSER_NOT_SUPPORT,dt=t.CustomizableDisplayInfo.errorMessages.ERR_CreateID_MustNotInContainers,gt=t.CustomizableDisplayInfo.errorMessages.ERR_CreateID_NotContainer,ni=n.each,v="dwt",ti=0,d=2,c=3,y=function(t,i,r,u){n.isFunction(t)&&setTimeout(function(){t(i,r,u)},10)};n.__innerInitEvents=function(n,t){t&&ni(["onAfterOperate","onBeforeOperate","onOperateStatus","onBitmapChanged","onGetFilePath","onImageAreaDeSelected","onImageAreaSelected","onMouseClick","onMouseDoubleClick","onMouseMove","onMouseRightClick","onPreAllTransfers","onPreTransfer","onPostLoad","onPostTransfer","onPostTransferAsync","onPreAllTransfersAsync","onPostAllTransfers","onSourceUIClose","onTopImageInTheViewChanged","onTransferCancelled","onTransferError","onInternetTransferPercentage","onInternetTransferPercentageEx"],function(i){n["__O"+i.substring(1)]=t[i]||""})};n.replaceControl=function(n,i){t.ContainerMap[n]=i};k=function(i,e,o,s){var l=n.product,h=f.getNavInfo(),a,c,v,y,p,w;if(s&&s._customIP&&!n.isLocalIP(s._host)){n.isFunction(r.OnRemoteWebTwainNotFoundCallback)&&(y=s._port,r.OnRemoteWebTwainNotFoundCallback(l.name,s._host,y,s._ssl));return}h.bMac?(i&&(a=n.one("#"+i),a.before(n.install._strNonInstallDIV),c=n.get(n.install._divDWTNonInstallContainerID),c&&(c.style.width=e,c.style.height=o),n.show(n.install._divDWTNonInstallContainerID),n.hide(i)),n.install._divDWTemessageContainer!=""&&n.hide(n.install._divDWTemessageContainer),n.isFunction(r.OnWebTwainNotFoundOnMacCallback)&&(v=l.bHTML5Edition?Dynamsoft.dcp.getDSPath():n.product.getPKGPath(),r.OnWebTwainNotFoundOnMacCallback(l.name,v,l.bHTML5Edition,h.bIE,h.bSafari,n.detect.ssl,n.env.strIEVersion))):h.bLinux?(i&&(a=n.one("#"+i),a.before(n.install._strNonInstallDIV),c=n.get(n.install._divDWTNonInstallContainerID),c&&(c.style.width=e,c.style.height=o),n.show(n.install._divDWTNonInstallContainerID),n.hide(i)),n.install._divDWTemessageContainer!=""&&n.hide(n.install._divDWTemessageContainer),n.isFunction(r.OnWebTwainNotFoundOnLinuxCallback)&&(p=Dynamsoft.dcp.getLinuxHTML5DebPath(),w=Dynamsoft.dcp.getLinuxHTML5RpmPath(),r.OnWebTwainNotFoundOnLinuxCallback(l.name,p,w,l.bHTML5Edition,h.bIE,h.bSafari,n.detect.ssl,n.env.strIEVersion))):(h.bChrome||h.bSafari||h.bFirefox||h.bOpera||t.IfUseActiveXForIE10Plus==u||!t.ActiveXInstallWithCAB&&h.bIE)&&(i&&(a=n.one("#"+i),a.before(n.install._strNonInstallDIV),c=n.get(n.install._divDWTNonInstallContainerID),c&&(c.style.width=e,c.style.height=o),n.show(n.install._divDWTNonInstallContainerID),n.hide(i)),n.install._divDWTemessageContainer!=""&&n.hide(n.install._divDWTemessageContainer),n.isFunction(r.OnWebTwainNotFoundOnWindowsCallback)&&(v="",v=h.bIE?Dynamsoft.dcp.getDSPath():l.bHTML5Edition?Dynamsoft.dcp.getDSPath():l.getMSIPath(),r.OnWebTwainNotFoundOnWindowsCallback(l.name,v,l.bHTML5Edition,h.bIE,h.bSafari,n.detect.ssl,n.env.strIEVersion)))};ut=function(t){var i=f.getNavInfo();i.bChrome&&(n.one("#"+t).before(n.install._strNonInstallDIV),n.show(n.install._divDWTNonInstallContainerID),n.hide(t),n.install._divDWTemessageContainer!=""&&n.hide(n.install._divDWTemessageContainer),n.isFunction(r.OnWebTwainOldPluginNotAllowedCallback)&&r.OnWebTwainOldPluginNotAllowedCallback(n.product.name))};n.detect.getVersionArray=function(t){var i=t.toLowerCase().replace(n.product.name.toLowerCase()+" ","");return i=n.replaceAll(i,"[.]",","),i.split(",")};n.detect.isDWTVersionLatest=function(i){var a=f.getNavInfo(),c,o,h,s,l,r;if(n.isUndefined(i))return u;for(c=i.toString().toLowerCase(),o=n.detect.getVersionArray(c),h=a.bIE&&(n.product.bPluginEdition||n.product.bActiveXEdition)?t.ActiveXVersion:n.product.bPluginEdition?t.PluginVersion:n.product.getServerVersionInfo(!0),h=n.replaceAll(String(h),"[.]",","),s=h.split(","),l=o.length>s.length?o.length:s.length,r=0;r<l;r++){if(o[r]==null&&(o[r]=0),s[r]==null&&(s[r]=0),parseInt(o[r])<parseInt(s[r]))return u;if(parseInt(o[r])>parseInt(s[r]))return e}return e};var ot=function(t,i){var u=f.getNavInfo(),o,h,s,l,a,v,c;n.isFunction(r.OnWebTwainNeedUpgradeCallback)&&(o={},u.bWin?(u.bIE?s=Dynamsoft.dcp.getDSPath():(l=n.product,s=l.bHTML5Edition?Dynamsoft.dcp.getDSPath():l.getMSIPath()),h=EnumDWT_PlatformType.enumWindow):u.bLinux?(a=Dynamsoft.dcp.getLinuxHTML5DebPath(),v=Dynamsoft.dcp.getLinuxHTML5RpmPath(),s=a,o.deb=a,o.rpm=v,h=EnumDWT_PlatformType.enumLinux):(s=n.product.bHTML5Edition?Dynamsoft.dcp.getDSPath():n.product.getPKGPath(),h=EnumDWT_PlatformType.enumMac),o["default"]=s,c=n.one(".dynamsoft-dialog-license"),c&&c.getEL()&&(c.getEL().style.display="none"),n.detect.needUpgrade=e,r.OnWebTwainNeedUpgradeCallback(n.product.name,o,n.product.bHTML5Edition,h,u.bIE,u.bSafari,n.detect.ssl,n.env.strIEVersion,n.detect.bPromptJSOrServerOutdated,t,i))},p=function(i,u){if(!n.detect.bNeedUpgradeEvent&&!n.detect.isDWTVersionLatest(u.VersionInfo)){if(n.detect.bNeedUpgradeEvent=e,!t.UseDefaultInstallUI&&n.isFunction(t.OnWebTwainNeedUpgrade)){t.OnWebTwainNeedUpgrade();return}if(u&&u._customIP&&!n.isLocalIP(u._host)){if(n.isFunction(r.OnRemoteWebTwainNeedUpgradeCallback)){var f=u._port;r.OnRemoteWebTwainNeedUpgradeCallback(n.product.name,u._host,f,u._ssl)}return}u._bNoUI||(n.one("#"+i).before(n.install._strNonInstallDIV),n.show(n.install._divDWTNonInstallContainerID),n.hide(i),n.install._divDWTemessageContainer!=""&&n.hide(n.install._divDWTemessageContainer),ot())}},ii=function(i){var r=i||{};r.basePath&&(n.env.basePath=r.basePath);r.pathType&&(n.env.pathType=r.pathType);n.isUndefined(r.bDiscardBlankImage)||(n.config.bDiscardBlankImage=r.bDiscardBlankImage);r.msgPrefix&&(n.config.msgPrefix=r.msgPrefix);r.msgSuffix&&(n.config.msgSuffix=r.msgSuffix);r.detectType&&(n.detect.detectType=r.detectType);r.tryTimes&&(n.detect.tryTimes=r.tryTimes);r.onReady&&(t.OnWebTwainReady=r.onReady);r.onNotAllowedForChrome&&(n.detect.onNotAllowedForChrome=r.onNotAllowedForChrome);r.onNoControl&&(n.detect.onNoControl=r.onNoControl)},g=function(i){var c=t.Containers,d=f.getNavInfo(),u,s,l,y,o,a=n.Promise.resolve(0),b,k;if(c.length>0){if(r.DCP_DWT_OnClickCloseInstall(),n.isUndefined(i))for(s=0;s<c.length;s++)if(n.product.bHTML5Edition){if(l=c[s].WebTwainId,w(l)&&(o=t.ContainerMap[l],o))break}else{if(l=c[s].ContainerId,!h(l))continue;if(o=t.ContainerMap[l],o)break}else y=i._containerID,o=i;o&&(n.product.bHTML5Edition?o._bLocalService&&(a=o._innerFunRawV2("LogLevel").then(function(){p(y,o)},function(){o.ErrorCode==-2207&&(!t.UseDefaultInstallUI&&n.isFunction(t.OnWebTwainNeedUpgradeWebJavascript)?t.OnWebTwainNeedUpgradeWebJavascript(o.ErrorString):n.detect.bPromptJSOrServerOutdated||(n.detect.bPromptJSOrServerOutdated=e));p(y,o)})):p(y,o))}for(b=[],s=0;s<c.length;s++)l=n.product.bHTML5Edition?c[s].WebTwainId:c[s].ContainerId,u=t.ContainerMap[l],u&&(n.product.bHTML5Edition?(u._bNoUI||(u.Width<=0||u.Height<=0)&&(u.Width<=0&&(u.Width=270),u.Height<=0&&(u.Height=350)),u._bLocalService?b.push(st(u)):n.License.checkProductKey(u,{Core:!0})):(u.IfAllowLocalCache=!0,u.IfShowFileDialog=!0,u.IfDisableSourceAfterAcquire=!0,u.BrokerProcessType=n.product._iBrokerProcessType,s==0&&(n.License.checkProductKey(u,{Core:!0})||n.License.checkProductKey(u,{Webcam:!0},!0)||n.License.checkProductKey(u,{Core:!0},!1,!0)),d.bWin||(u.ImageCaptureDriverType=n.product._iImageCaptureDriverType))),u=null,b.length>0&&(a=a.then(function(){return Dynamsoft.Lib.Promise.all(b)}));c=null;k=Dynamsoft.initOrder;k[0]==v&&k.splice(0,1);a=a.then(function(){n.isFunction(t.OnWebTwainReady)?t.OnWebTwainReady():n.isFunction(r.Dynamsoft_OnReady)&&r.Dynamsoft_OnReady()})},st=function(t){return n.showLoadingMsg(-1,"",Dynamsoft.MSG.Init_ConfiguringDWT),t._innerFunV2("IfDisableSourceAfterAcquire","[1]").then(function(){var i=f.getNavInfo(),n=Dynamsoft.EnumDWT_Driver.TWAIN;return i.bMac?n=Dynamsoft.EnumDWT_Driver.TWAIN_AND_ICA:i.bLinux&&(n=Dynamsoft.EnumDWT_Driver.SANE),t._driverType=n,n!=Dynamsoft.EnumDWT_Driver.TWAIN_AND_ICA?t._innerFunV2("ImageCaptureDriverType","["+n+"]"):void 0}).then(function(){n.License.checkProductKey(t,{Core:!0})})},w=function(n){return n==""||!f.isString(n)&&!f.isNumber(n)?u:e},h=function(t){return!t||t==""?u:n.get(t)?e:u},ri=function(i){if(h(i.ContainerId)){var r;return(r=n.isString(i.WebTwainId)?t.ContainerMap[i.WebTwainId]:t.ContainerMap[i.ContainerId],r)?u:e}return u},ht=function(){n.detect.StartWSTimeoutId||n.detect.arySTwains.length!=0||(n.detect.StartWSTimeoutId=setTimeout(function(){n.detect.StartWSTimeoutId=u;n.startWS()},100))},ui=function(){n.detect.StartWSByIPTimeoutId||n.detect.arySTwainsByIP.length!=0||(n.detect.StartWSByIPTimeoutId=setTimeout(function(){n.detect.StartWSByIPTimeoutId=u;n.startWSByIP()},100))};n.detect.__WebTwainMain=function(i,u,e){var o={id:i.WebTwainId,containerID:i.ContainerId,width:i.Width,height:i.Height},l,s,a,v,c,y,p,b;if(w(o.id)||h(o.containerID)?!o.id&&h(o.containerID)&&(o.id=o.containerID):o.id=o.containerID="dwtcontrolContainer",t.UseDefaultInstallUI?(o.onNotAllowedForChrome=ut,o.onNoControl=k):(o.tAllowedForChrome=t.OnWebTwainOldPluginNotAllowed,o.onNoControl=t.OnWebTwainNotFound),ii(o),n.product.bHTML5Edition){for(f.mix(o,i.bLocalService?{port:i.port,HTTPPort:n.detect.ssl?443:80,bLocalService:!0}:{bLocalService:!1}),o.onReady=function(t){if(n.replaceControl(o.id,t),n.isFunction(u)){var i={stwain:t};e&&n.mix(i,e);u(i)}},s=0;s<n.detect.arySTwains.length;s++)a=n.detect.arySTwains[s],o.id==a._id&&(o.id=o.id+"_"+f.getRandom()),o.containerID==a._containerID&&(o.containerID="");return o.bNoUI=h(o.containerID)?!1:!0,l=new n.html5.STwain(o),n.detect.arySTwains.push(l),n.detect.bFirst&&n._init(o),n.detect.bFirst=!1,l}for(o.onPluginReady=function(){n.replaceControl(o.id,v.getInstance())},o.onPluginNotReady=function(){n.isFunction(r.Dynamsoft_OnNotReady)&&r.Dynamsoft_OnNotReady()},v=new n.DynamicWebTwain(o),y=0,p=t.Containers,c=p.length-1;c>=0;c--)b=p[c],h(b.ContainerId)&&y++;return n.detect.arySTwains.length==y&&(n.detect._varSeed=setInterval(n.detect._controlDetect,200)),v};t.Unload=function(){var o=t.Containers,i,f,r,u,s;if(n.closeAll&&n.closeAll(),o)if(n.product.bHTML5Edition)for(u=t.ContainerMap,i=0;i<o.length;i++)r=o[i].WebTwainId,r&&r in u&&(f=u[r],f&&(f.__unload(),delete u[r]));else for(u=t.ContainerMap,i=o.length-1;i>=0;i--)r=o[i].ContainerId,r&&(f=n.get(r),f&&(r in u&&u[r]&&delete u[r],f.innerHTML=""));for(n.page.bUnload=e,n.page.OnUnload&&n.page.OnUnload(),t.initQueue.splice(0),i=0;i<Dynamsoft.unloadQueue.length;i++)s=Dynamsoft.unloadQueue[i],n.isFunction(s)&&s();return Dynamsoft.unloadQueue.splice(0),n.MobileFuns?n.MobileFuns.unloadWasm():n.Promise.resolve()};var ct=function(){for(var r=t.Containers,f,u,i=0;i<r.length;i++)if(h(r[i].ContainerId)&&(u=r[i].ContainerId,w(r[i].WebTwainId)&&(u=r[i].WebTwainId)),u&&(f=t.ContainerMap[u],!f)){setTimeout(ct,200);return}n.closeLoadingMsg();r=null;g()},fi=function(n){var t,i,r;if(n&&"readyObj"in n&&(t=n.readyObj,t)){i=n.stwain;r=t.totalCount;t.readyCount=t.readyCount+1;t.readyCount>=r&&g(i);return}g(n)},lt=function(i,r,u){var e=t.Containers,c,f,l;if(n.config.usingMainMode){n.closeLoadingMsg();n.detect.hideMask();return}if(!e||e.length===0){n.closeLoadingMsg();n.detect.hideMask();n.log("DEnv.Containers was not set.");return}for(o.bEnhancedMode&&(n.product.host=i,n.detect.urls.splice(0),n.detect.urls.push({port:r,ssl:s.bSSL}),n.detect.cUrlIndex=0),ht(),l={totalCount:e.length,readyCount:0},c=0;c<e.length;c++)f=e[c],h(f.ContainerId)||(f.bNoUI=!0),u?(f.bLocalService=!1,f.ip="",f.port=0):(f.bLocalService=!0,o.bEnhancedMode&&(f.port=r)),n.detect.__WebTwainMain(f,fi,{readyObj:l})},ei=function(){var r,i,f;if(n.config.usingMainMode){n.closeLoadingMsg();return}if(i=t.Containers,i===u||i.length===0){n.log("DEnv.Containers was not set.");n.closeLoadingMsg();return}for(r=0;r<i.length;r++)f=i[r],ri(f)&&n.detect.__WebTwainMain(f);setTimeout(ct,100)},oi=function(i){var l,s=i.bNoUI,a=i.id,f=i.containerID,d=i.host,b=i.port,v=d&&b&&b>0?{host:d,port:b}:u,h=i.asyncSuccessFunc,y=i.asyncFailureFunc,w,k,o,c;if(i.bNoUI||n.isString(f)&&f!=""&&n.get(f)){if(t.Containers&&!s)for(k=t.Containers,w=0;w<k.length;w++)if(k[w].ContainerId==f)return n.detect.hideMask(),n.isFunction(y)&&y(dt),u}else s=!0,f=0;return(l=t.DynamicDWTMap[a],l)?(n.detect.hideMask(),n.isFunction(h)&&h(l),l):(v?ui():ht(),o={id:a,containerID:f,customIP:!1,width:s?0:300,height:s?0:300,bNoUI:s,bLocalService:i.bLocalService},s||(c=n.get(f),c.style.width&&(o.width=c.style.width),c.style.height&&(o.height=c.style.height)),v&&(o.customIP=!0,o.host=v.host,o.port=v.port),o.onReady=function(i){return(r.DCP_DWT_OnClickCloseInstall(),!i)?(n.closeLoadingMsg(),n.detect.hideMask(),n.isFunction(y)&&y(gt),!1):(n.showLoadingMsg(-1,"",Dynamsoft.MSG.Init_ConfiguringDWT),t.DynamicContainers.push(a),t.DynamicDWTMap[a]=i,!t.IfDisableDefaultSettings&&i._bLocalService?st(i).then(function(){n.detect.hideMask();n.isFunction(h)&&h(i);p(f,i)},function(){n.detect.hideMask();i.ErrorCode==-2207&&(n.detect.bPromptJSOrServerOutdated||(n.detect.bPromptJSOrServerOutdated=e));p(f,i)}):(n.detect.hideMask(),n.isFunction(h)&&h(i)),!0)},new n.html5.CreateDWTObject(o))};t.Load=function(){n.waitForScripts().then(function(){return t.Unload()}).then(function(){if(n.detect.wasmScriptLoaded&&Dynamsoft.WasmEnv)try{Dynamsoft.WasmEnv.load(t.ProductKey)}catch(i){i&&console.log(i.message)}y(bt)})};t.CheckConnectToTheService=function(i,r,u,f){if(n.detect.scriptLoaded)if(n.product.bHTML5Edition){var e=0,o=i,s=r,c=u,h=f;if(n.isFunction(o)&&n.isFunction(s)&&(c=o,h=s,o=null,s=null),o||(o=Dynamsoft.dcp.host),!s)for(e=0;e<Dynamsoft.Lib.detect.ports.length;e++)if(Dynamsoft.navInfoSync.bSSL&&Dynamsoft.Lib.detect.ports[e].ssl||!Dynamsoft.navInfoSync.bSSL&&!Dynamsoft.Lib.detect.ports[e].ssl){s=Dynamsoft.Lib.detect.ports[e].port;break}b.versionInfo(o,s,function(t,i,r,u){if(t===a.OK&&u&&u.length>0&&pt(u,n.product.getServerVersionInfo(!0))){n.isFunction(c)&&c(i,r);return}n.isFunction(h)&&h()},h)}else n.isFunction(f)&&f();else setTimeout(function(){t.CheckConnectToTheService(i,r,u,f)},500)};t.ConnectToTheService=t.Load;t.CreateDWTObject=function(i,r,e,o,s,h){var v=s,c=h,l,a;if(arguments.length<=3?(v=r,c=e,l={WebTwainId:i}):l={WebTwainId:i,Host:r,Port:e,PortSSL:o},!n.product.bHTML5Edition)return n.isFunction(c)&&c(ft),u;if(a=i,n.isDOMInBody(a))l.Container=a,a.id&&a.id!=""||(a.id=["dwt_",f.getRandom()].join("")),l.WebTwainId=a.id;else{if(!n.isString(i))return n.isFunction(c)&&c(n.Errors.container_id_not_string()),u;if(!n.get(i))return n.isFunction(c)&&c(n.Errors.container_id_not_exist(i)),u}return n.isUndefined(l.UseLocalService)&&(l.UseLocalService=n.isUndefined(t.UseLocalService)?n.env.bMobile?!1:!0:t.UseLocalService),vt(l,v,c)};t.CreateDWTObjectEx=function(i,r,e){if(n.isDOMInBody(i.Container))i.Container.id&&i.Container.id!=""||(i.Container.id=["dwt_",f.getRandom()].join("")),n.isString(i.WebTwainId)||(i.WebTwainId=i.Container.id);else if(!n.isString(i.WebTwainId))return e(n.Errors.webtwain_id_not_string()),u;return n.isUndefined(i.UseLocalService)&&(i.UseLocalService=n.isUndefined(t.UseLocalService)?n.env.bMobile?!1:!0:t.UseLocalService),vt(i,r,e)};var yt=function(){for(var n=Dynamsoft.initOrder,i=u,t=0;t<n.length;t++)if(n[t]==v){i=e;break}i||n.push(v)},pt=function(t,i){var r=t.split(","),u=i.split(",");return r.length>3&&n.trim(r[0])==u[0]&&n.trim(r[1])>=u[1]&&n.trim(r[2])>=u[2]&&n.trim(r[3])>=u[3]},wt=function(t,i){n.isLocalIP(t)&&(n.LS.item("DWT_port",i),n.LS.item("DWT_ssl",s.bSSL?"true":"false"))},si=function(t){var u,e="",i=t,h="",r=f.getNavInfo();return u=r.bMac?"mac/MacDWT_":r.bLinux?"linux/LinuxDWT_":"win/WinDWT_",s.bFileSystem||(e="?t="+n.getRandom()),i.length>0&&i[i.length-1]!="/"&&(i=i+"/"),r.bWin&&o.b64bit&&(h="_x64"),[i,"dist/",u,n.product.getServerVersionInfo(),h,".zip",e].join("")},nt=function(i,h){var v=si(t.ResourcesPath),y=function(i){o.loadZip(i,0,function(){var u=f.getNavInfo(),i;if(n.detect.hideMask(),n.isFunction(r.OnWebTWAINDllDownloadSuccessful)&&r.OnWebTWAINDllDownloadSuccessful(),t.OnWebTwainInitMessage){if(s.bSSL&&u.bFirefox){i=t.CustomizableDisplayInfo.generalMessages.refreshNeeded;t.OnWebTwainInitMessage(i,EnumDWT_InitMsg.DownloadNotRestartError);return}i=t.CustomizableDisplayInfo.generalMessages.DWTmoduleLoaded;t.OnWebTwainInitMessage(i,EnumDWT_InitMsg.Info)}setTimeout(h,3e3)},l)},l=function(f,o,s){var l,v,h,a;n.detect.hideMask();l=e;t.OnWebTwainInitMessage&&(v=t.CustomizableDisplayInfo.errorMessages.ERR_DWT_NOT_DOWNLOADED,t.OnWebTwainInitMessage(v,EnumDWT_InitMsg.DownloadError));n.isFunction(r.OnWebTWAINDllDownloadFailure)&&(h={},s.status==404?(n.Errors.WebTwainModuleNotExist(h),a=e):(n.Errors.WebTwainModuleDownloadFailure(h),a=u),l=r.OnWebTWAINDllDownloadFailure(n.product.name,h._errorCode,h._errorString),a&&(l=u));n.detect.dcpStatus=c;n.isFunction(i.dwtFailedCallback)&&i.dwtFailedCallback()},a;t.OnWebTwainInitMessage&&(a=t.CustomizableDisplayInfo.generalMessages.downloadingDWTModule,t.OnWebTwainInitMessage(a,EnumDWT_InitMsg.Info));n.ajax({method:"GET",url:v,"async":!0,dataType:"blob",onSuccess:y,onError:l})},l=function(i,r,f){var p=u,w=u,k=n.detect,v=i.host,o=i.port,h=1;if(i.UseLocalService===!1){n.showLoadingMsg(-1,"",Dynamsoft.MSG.Init_CreatingDWT);n.detect.dcpStatus=d;n.product.host="";wt("",0);y(i.docViewCallback);return}if(n.detect.dcpStatus==d){n.showLoadingMsg(-1,"",Dynamsoft.MSG.Init_CreatingDWT);n.isFunction(i.callback)&&i.callback(v,o);return}n.showLoadingMsg(-1,"",Dynamsoft.MSG.Init_CheckDWT);h=f>0?f+1:1;o||n.each(n.detect.ports,function(n){s.bSSL?n.ssl&&(o=n.port):n.ssl||(o=n.port)});n.showLoadingMsg(-1,"",Dynamsoft.MSG.Init_CheckDWTVersion);b.versionInfo(v,o,function(f,o,s,v){if(f===a.OK&&v&&v.length>0&&pt(v,n.product.getServerVersionInfo(!0))){n.detect.dcpStatus=d;n.product.host=o;wt(o,s);n.showLoadingMsg(-1,"",Dynamsoft.MSG.Init_CreatingDWT);n.isFunction(i.callback)&&i.callback(o,s);return}if(r){if(h>3){n.closeLoadingMsg();n.detect.dcpStatus=c;n.isFunction(i.dwtFailedCallback)&&i.dwtFailedCallback();return}setTimeout(function(){l(i,e,h)},1e3)}else if(t.IfInstallDWTModuleWithZIP)nt(i,function(){l(i,e,h)},function(){l(i,u,h)});else{n.closeLoadingMsg();n.detect.dcpStatus=c;n.isFunction(i.dwtFailedCallback)&&i.dwtFailedCallback();return}})},tt=function(i){var y=Dynamsoft.initOrder,h=!1,a;if(y.length>0&&y[0]===v){if(a=function(){var u,f;t.OnWebTwainInitMessage&&(u=t.CustomizableDisplayInfo.generalMessages.downloadNeeded,t.OnWebTwainInitMessage(u,EnumDWT_InitMsg.Info));n.isLocalIP(i.host)?k():n.isFunction(r.OnRemoteWebTwainNotFoundCallback)&&(f=s.bSSL,r.OnRemoteWebTwainNotFoundCallback(n.product.name,i.host,i.port,f))},!t.IfCheckDCP){i.dwtFailedCallback||(i.dwtFailedCallback=a);l(i,u,0);return}var p=function(){n.detect.showMask()},w=function(){n.detect.hideMask()},b=function(){var i=!1,u;return n.isFunction(r.OnWebTwainShowUpdatingDialog)&&(i=r.OnWebTwainShowUpdatingDialog()),i||(u=['<div class="dynamsoft-dwt-dlg-tips dynamsoft-dwt-dlg-center">',t.CustomizableDisplayInfo.generalMessages.updatingDService,"<\/div>",'<div style="padding-top:35px"><\/div>'],t.ShowDialog(365,0,u.join(""),0,1)),!0},d=function(){var i=!1;return n.isFunction(r.OnWebTwainCloseUpdatingDialog)&&(i=r.OnWebTwainCloseUpdatingDialog()),i||t.CloseDialog(),!0},g=function(n,t){h=!0;ot(n,t)},e=function(a){var v=1,d=f.getNavInfo(),y,p;if(d.bWin&&(v=a>0?a+1:1,v>3)){e=null;n.detect.hideMask();n.detect.dcpStatus=c;n.isFunction(i.dwtFailedCallback)&&i.dwtFailedCallback();return}if(!h){if(i.dwtFailedCallback||(i.dwtFailedCallback=function(){var t=f.getNavInfo(),i,u;n.detect.hideMask();n.isFunction(r.OnWebTWAINModuleDownloadManually)&&(t.bLinux?(i=EnumDWT_PlatformType.enumLinux,u={"default":Dynamsoft.dcp.getLinuxHTML5DebPath(),deb:Dynamsoft.dcp.getLinuxHTML5DebPath(),rpm:Dynamsoft.dcp.getLinuxHTML5RpmPath()}):t.bMac?(i=EnumDWT_PlatformType.enumMac,u={"default":Dynamsoft.dcp.getDSPath()}):(i=EnumDWT_PlatformType.enumWindow,u={"default":Dynamsoft.dcp.getDSPath()}),r.OnWebTWAINModuleDownloadManually(u,i,t.bIE,t.bSafari,n.detect.ssl,n.env.strIEVersion))}),o.bEnhancedMode){var w=0,b=function(r){if(n.isArray(r)&&r.length>1){n.detect.hideMask();var f=r[1],h,a;if(f&&(o.currentUserPorts=f,f.dwt))return(h=f.dwt.port,a=f.dwt.sslPort,h==0||a==0)?(w++,w>5)?(e(v),!1):(setTimeout(function(){o.getPorts(o.strSID,b,k)},300),!0):(i.port=s.bSSL?a:h,l(i,u,0),!0)}if(t.IfInstallDWTModuleWithZIP)nt(i,function(){e(v)},function(){e(v)});else{n.detect.dcpStatus=c;n.isFunction(i.dwtFailedCallback)&&i.dwtFailedCallback();return}return!0},k=function(){if(n.detect.hideMask(),t.IfInstallDWTModuleWithZIP)nt(i,function(){e(v)},function(){e(v)});else{n.detect.dcpStatus=c;n.isFunction(i.dwtFailedCallback)&&i.dwtFailedCallback();return}return!0};return o.getPorts(o.strSID,b,k),!0}return e=null,l(i,u,0),!0}y=n.install._dlgInstall;p=500;y&&y.open||(h=!1,p=0);setTimeout(e,p)};Dynamsoft.managerEnv.IfUpdateService=Dynamsoft.WebTwainEnv.IfUpdateService;Dynamsoft.managerEnv.IfDownload64bitService=Dynamsoft.WebTwainEnv.IfDownload64bitService;o.checkDcpForUpdate(a,p,w,b,d,g,e,t.ProductKey)}else n.env.stopCheckingForService||setTimeout(function(){tt(i)},1e3)},bt=function(){n.page.bUnload=u;for(var c=t.Containers,s,i,h=[],r,e=0;e<c.length;e++)if(i=c[e],n.product.bHTML5Edition){for(n.isDOMInBody(i.Container)&&(r=i.Container,r.id&&r.id!=""||(r.id=["dwt_",n.getRandom()].join("")),i.ContainerId=r.id),(n.isString(i.WebTwainId)||n.isNumber(i.WebTwainId))&&i.WebTwainId!=""||(i.WebTwainId=n.isString(i.ContainerId)&&i.ContainerId!=""?i.ContainerId:["dwt_",n.getRandom()].join("")),s=0;s<h.length;s++)if(i.WebTwainId==h[s]){i.WebTwainId=i.WebTwainId+"_"+f.getRandom();break}h.push(i.WebTwainId)}else f.isString(i.WebTwainId)&&(!f.isString(i.ContainerId)||i.ContainerId=="")&&(i.ContainerId=i.WebTwainId);if(n.product.bHTML5Edition){if(t.UseLocalService===!1||n.isUndefined(t.UseLocalService)&&n.env.bMobile){if(!et()){n.closeLoadingMsg();at();return}n.showLoadingMsg(-1,"",Dynamsoft.MSG.Init_InitWasm)}else n.showLoadingMsg(-1,"",Dynamsoft.MSG.Init_InitH5);yt();n.waitForScripts().then(function(){return new n.Promise(kt)}).then(function(){var i=!0;(t.UseLocalService===!1||n.isUndefined(t.UseLocalService)&&n.env.bMobile)&&(i=!1);tt({callback:lt,docViewCallback:function(){lt("",0,!0)},host:o.host,UseLocalService:i})})}else n.showLoadingMsg(-1,"",Dynamsoft.MSG.Init_InitActiveX),ei()},kt=function(i){var r=[Dynamsoft.WebTwainEnv.ResourcesPath,"/src/dynamsoft.imageio.js","?t=20200811"].join("");if(t.UseLocalService===!1||n.isUndefined(t.UseLocalService)&&n.env.bMobile){if(!n.detect.wasmScriptLoaded){n.showLoadingMsg(-1,"",Dynamsoft.MSG.Init_DownloadingWasm);n.getScript(r,!0,function(){n.detect.wasmScriptLoaded=!0;n.showLoadingMsg(-1,"",Dynamsoft.MSG.Init_CompilingWasm);try{Dynamsoft.WasmEnv.load(t.ProductKey)}catch(r){console.log(r)}i()});return}}else n.showLoadingMsg(-1,"",Dynamsoft.MSG.Init_InitDynamsoftService),n.detect.wasmScriptLoaded||Dynamsoft.navInfoSync.bFileSystem||!Dynamsoft.WebTwainEnv.UseCameraAddonWasm||n.getScript(r,!0,function(){n.detect.wasmScriptLoaded=!0;try{Dynamsoft.WasmEnv.load(t.ProductKey)}catch(i){console.log(i)}});i()},it=function(i,r,f){var h=Dynamsoft.initOrder,c=u,o,s;if(h.length>0&&h[0]===v&&(n.detect.onNoControl||(n.detect.onNoControl=k),o=t.initQueue,o.length>0)){for(c=e,s=0;s<o.length;s++)o[s].bLocalService=f?!1:!0,oi(o[s]);o.splice(0)}c||setTimeout(function(){it(i,r,f)},100)};t.DeleteDWTObject=function(i){var f=t.DynamicDWTMap,r,o;if(!n.product.bHTML5Edition)return u;for(f&&(i in f)&&(o=f[i],o&&(delete f[i],o.__unload())),r=0;r<t.DynamicContainers.length;r++)if(t.DynamicContainers[r]==i){t.DynamicContainers.splice(r,1);break}return n.detect.hideMask(),e};t.GetWebTwain=function(i){var r,e,u,o,f=i,s;if(r=t.Containers,n.isDOMInBody(f)){if(f=f.id,!f)return null}else if(!f&&r&&r.length>0)for(u=0;u<r.length;u++)if(h(r[u].ContainerId)){f=r[u].ContainerId;break}if(f&&r&&r.length>0)for(u=0;u<r.length;u++)if(e=r[u],e.ContainerId==f&&(s=w(e.WebTwainId)?e.WebTwainId:e.ContainerId,o=t.ContainerMap,o&&s in o))return o[s];return t.GetWebTwainEx(f)};t.GetWebTwainEx=function(i){var r=i,u,e,f;if(u=t.DynamicContainers,n.isDOMInBody(r))r=r.id;else if(!r&&u&&u.length>0)for(e=0;e<u.length;e++)if(w(u[e])){r=u[e];break}return(u=null,r&&((f=t.ContainerMap,f&&r in f)||(f=t.DynamicDWTMap,f&&r in f)))?f[r]:null};rt=function(){if(n.isUndefined(t.ProductKey))setTimeout(rt,100);else{n.openLoadingMsg();n.showLoadingMsg(-1,"",Dynamsoft.MSG.Init_LookingLicense);var i=n.get("dynamsoft_waiting");i&&i.parentNode.removeChild(i);Dynamsoft.Ready(function(){var a=f.getNavInfo(),w=s.bFileSystem,h=n.env.basePath,i=Dynamsoft.WebTwainEnv.ResourcesPath,r;w||(r=i,typeof r=="undefined"||r==""?i=h:r.length>0&&r.charAt(0)!="/"&&r.indexOf("//")<0&&h!=""&&(i=[h,"/",r].join("")),i.length>0&&i.charAt(i.length-1)=="/"&&(i=i.substr(0,i.length-1)),Dynamsoft.WebTwainEnv.ResourcesPath=i);Dynamsoft.managerEnv.resourcesPath=i;var o="?t=20200715",v=e,c=[],p=[[i,"/src/dynamsoft.webtwain.css",o].join(""),[i,"/src/dynamsoft.viewer.css",o].join("")],l=function(){n.detect.cssLoaded=e};a.bSafari?(n.getAllCss(p,l),l()):n.getAllCss(p,l);a.bSafari&&(v=u);c.push([i,"/dynamsoft.webtwain.install.js",o].join(""));n.product.bHTML5Edition&&(c.push([i,"/src/dynamsoft.viewer.js",o].join("")),n.showLoadingMsg(-1,"",Dynamsoft.MSG.Init_LoadingViewerJs));n.getScripts(c,v,function(i){var r,u;if(!i){n.log("error: load js failed.");return}if(n.showLoadingMsg(-1,"",Dynamsoft.MSG.Init_AllJsLoaded),n.detect.scriptLoaded=e,n.isString(t.Host)&&(Dynamsoft.dcp.host=t.Host),n.product.bHTML5Edition?n.closeAll=n.html5.closeAll:n.product.bPluginEdition?(n.DynamicWebTwain=n.plugin.DynamicWebTwain,n.closeAll=n.plugin.closeAll):n.product.bActiveXEdition&&(n.DynamicWebTwain=n.ie.DynamicWebTwain,n.closeAll=n.ie.closeAll),n.isUndefined(t.UseLocalService)&&(t.UseLocalService=n.env.bMobile?!1:!0),t._srcUseLocalService=t.UseLocalService,n.isArray(Dynamsoft.aryAddonReadyFun)){for(r=0;r<Dynamsoft.aryAddonReadyFun.length;r++)if(u=Dynamsoft.aryAddonReadyFun[r],n.isFunction(u))try{u(n)}catch(f){n.log(f.stack||f,"error");setTimeout(function(){throw f;},0)}Dynamsoft.aryAddonReadyFun=[]}t.AutoLoad?(n.showLoadingMsg(-1,"",Dynamsoft.MSG.Init_FireBeforeInitEvt),t.OnWebTwainWillInit&&t.OnWebTwainWillInit(),y(bt)):n.closeLoadingMsg()})})}};t.IsLocalServiceConnected=function(){return new n.Promise(function(i,r){var f=o.host,u;n.each(n.detect.ports,function(n){s.bSSL?n.ssl&&(u=n.port):n.ssl||(u=n.port)});t.CheckConnectToTheService(f,u,function(){i(!0)},function(){r(!1)})})};n.domReady(function(){rt();s.bIE&&r.addEventListener&&r.addEventListener("unload",t.Unload,!1)});n.waitForScripts=function(){return n.waitForScripts._promise?n.waitForScripts._resolve&&n.detect.scriptLoaded?n.waitForScripts._resolve():setTimeout(n.waitForScripts,60):n.waitForScripts._promise=new Promise(function(t){n.waitForScripts._resolve=t;setTimeout(n.waitForScripts,60)}),n.waitForScripts._promise};r.Dynamsoft_OnClickInstallButton||(r.Dynamsoft_OnClickInstallButton=function(){n.hide("dwt-btn-install");n.hide("dwt-install-url-div")})}(Dynamsoft.Lib,Dynamsoft.WebTwainEnv);Dynamsoft.Ready(function(n){function t(n,t){var i=this;i._ImgManager=n;i._stwain=n._stwain;i.fZoom=1;i.zoomInStep=1.2;i.zoomOutStep=.8;i.MIN_ZOOM=.02;i.MAX_ZOOM=65;i.BaseUrl=!1;i.imagesPerRow=1;i.imagesPerColumn=1;i.MAX_ROWS=128;i.MAX_COLUMNS=128;i.bSingleMode=!1;i.iMouseShape=i._stwain._isMobileMode()&&!i._stwain._isPC()?EnumDWT_MouseShape.Hand:EnumDWT_MouseShape.Crosshair;i.bIfFitWindow=!0;i.enumDWTFitWindowType=0;i.AllowMultiSelect=!0;i.SelectionImageBorderColor="#7DA2CE";i.bShowPageNumber=!1;i.ratio=0;i.__IfAutoScroll=!0;i.__MousewheelValue=0;this._Init(t)}var u=Dynamsoft;if(n.product.bHTML5Edition){var f=Dynamsoft.navInfo,e=document,i=n.html5.Funs2,r=Dynamsoft.WebTwainEnv;t.prototype._Init=function(t){var i=this;i.borderWidth=n.isUndefined(t.borderWidth)?1:t.borderWidth;i.imageViewWidth=t.Width;i.imageViewHeight=t.Height;i.BackgroundColorByDefault=t.BackgroundColor?t.BackgroundColor:"#FFFFFF";i.BackgroundColor=i.BackgroundColorByDefault;i._WebViewer?i._WebViewer._Init(t):i._WebViewer=new n.UI.WebViewer(i._ImgManager,t,i);i.mapModelImageControl=t.mapModelImageControl;i.__InitEvents(t);i._ImgManager._isNoUI()||i.__InitWebViewer()};t.prototype.__InitEvents=function(t){var i=this;n.isFunction(t.onTopImageInTheViewChanged)&&(i.onTopImageInTheViewChanged=t.onTopImageInTheViewChanged);n.isFunction(t.onGetImageInfo)&&(i.onGetImageInfo=t.onGetImageInfo);n.isFunction(t.onZoomChanged)&&(i.onZoomChanged=t.onZoomChanged);n.isFunction(t.onMouseMove)&&(i.onMouseMove=t.onMouseMove);n.isFunction(t.onMouseClick)&&(i.onMouseClick=t.onMouseClick);n.isFunction(t.onMouseRightClick)&&(i.onMouseRightClick=t.onMouseRightClick);n.isFunction(t.onMouseDoubleClick)&&(i.onMouseDoubleClick=t.onMouseDoubleClick);n.isFunction(t.onImageAreaDeSelected)&&(i.onImageAreaDeSelected=t.onImageAreaDeSelected);n.isFunction(t.onImageAreaSelected)&&(i.onImageAreaSelected=t.onImageAreaSelected);n.isFunction(t.onSelected)&&(i.onSelected=t.onSelected);n.isFunction(t.onRefreshUI)&&(i.onRefreshUI=t.onRefreshUI);n.isFunction(t.onResetCurrentIndex)&&(i.onResetCurrentIndex=t.onResetCurrentIndex)};t.prototype.__InitWebViewer=function(){var n=this,t=n.GetWebViewer();n.imagesPerRow==1&&n.imagesPerColumn==1?(t.SetMouseShape(n.iMouseShape),t.SetShowPageNumber(!1)):(t.SetMouseShape(EnumDWT_MouseShape.Hand),t.SetShowPageNumber(n.bShowPageNumber));t.SetSelectionRectAspectRatio(n.ratio);t.SetBackgroundColor(n.BackgroundColor);t.SetSelectionImageBorderColor(n.SelectionImageBorderColor);n.bSingleMode?n.bIfFitWindow?t.SetFitType(n.enumDWTFitWindowType):t.SetZoom(n.fZoom):t.SetFitType(0)};t.prototype.SetMetaDataByIndex=function(n,t){var i=this,r=i.GetWebViewer();return r.SetMetaDataByIndex(n,t)};t.prototype.GetMetaDataByIndex=function(n){var t=this,i=t.GetWebViewer();return i.GetMetaDataByIndex(n)};t.prototype.GetDataImageControl=function(n){var t=this;return t.mapModelImageControl[n]};t.prototype.SetDataImageControl=function(t,i,r){var f=this,u;return i==-1?!1:(u=f.mapModelImageControl[i],u||(u=new n.UI.ModelImageControl,u.serverId=i,f.mapModelImageControl[i]=u),u!=null&&(u.bIsDirty=!0),f.__GetImageAndAttach(u,i,!0,!1,!1,t,r),!0)};t.prototype.AttachImagesForControl=function(n,t){var r=this,i=r.GetWebViewer();return n.bAddImage?i.AppendImage(n,t):i.UpdateImage(n,t),i.bCouldBeTimeConsuming&&(i.bCouldBeTimeConsuming=!1,Dynamsoft.Lib.hideMask()),!0};t.prototype.MobileAttachImagesForControl=function(n,t){var r=this,i=r.GetWebViewer(),u;return u=n.bAddImage?i.MobileAppendImage(n,t):i.MobileUpdateImage(n,t),i.bCouldBeTimeConsuming&&(i.bCouldBeTimeConsuming=!1,Dynamsoft.Lib.hideMask()),!0};t.prototype.GetWebViewer=function(){var n=this;return n._WebViewer};t.prototype.__GetWebViewerUuid=function(n){var t=this;return t.mapModelImageControl[n].uuid};t.prototype.SetSelectedImageArea=function(n,t,i,r){var u=this,f=u.GetWebViewer();return null!=f?u.imagesPerRow==1&&u.imagesPerColumn==1?f.SetSelectedThumbnailArea(n,t,i,r):!1:!1};t.prototype.OverlayRectangle=function(n,t,i,r,u,f,e){var s=this,o=s.GetWebViewer();return null!=o?o.OverlayRectangle(n,t,i,r,u,f,e):!1};t.prototype.ChangeImageViewSize=function(n,t){var i=this,r=!1;return n>=0&&(n>i.imageViewWidth&&(r=!0),i.imageViewWidth=n,i.GetWebViewer().SetWidth(n)),t>=0&&(t>i.imageViewHeight&&(r=!0),i.imageViewHeight=t,i.GetWebViewer().SetHeight(t)),r&&i.RefreshAllImages(n,t),!0};t.prototype.RefreshAllImages=function(n,t){var r=this,e,s,h,o=r.GetWebViewer(),u,f;if(!r._stwain._isMobileMode()&&r.mapModelImageControl)for(u=0;u<o.GetHowManyImagesInBuffer();u++)e=r.getImageManager().convertClientIndexToServerId(u),f=r.mapModelImageControl[e],f&&(s=i.getImageUrl(r.BaseUrl,e,n,t,Date.now()),f.minImageUrl=s,h=o.GetMetaDataByIndex(u),o.UpdateImage(f,h))};t.prototype.SetViewMode=function(n,t){var i=this,r,u;return r=i.imagesPerRow,u=i.imagesPerColumn,i.imagesPerRow=t,i.imagesPerColumn=n,n==-1&&t==-1?(i.imagesPerRow=1,i.imagesPerColumn=1,i.bSingleMode=!0):(i.bSingleMode=!1,t==-1&&(i.imagesPerRow=1)),i.GetWebViewer().SetViewMode(n,t),!0};t.prototype.RemoveAllImages=function(){var n=this;return n.GetWebViewer().bShowImageEdit&&n.GetWebViewer()._IfChangedWithinTheEditor==!0&&(n.GetWebViewer()._IfChangedWithinTheEditor=!1,n.GetWebViewer().iChangedIndex=-1,n.GetWebViewer().updateButtons()),n.Clear()};t.prototype.Clear=function(){for(var n=this,t,i=0;i<n._ImgManager.count();i++)t=n.getImageManager().convertClientIndexToServerId(i),t!=-1&&n.mapModelImageControl[t]&&(n.mapModelImageControl[t].Clear(),delete n.mapModelImageControl[t]);return n.mapModelImageControl={},n.GetWebViewer().RemoveAllImages(),!0};t.prototype.__GetImageAndAttach=function(n,t,i,r,u,f,e){var o=this,h=o.imageViewWidth,c=o.imageViewHeight,l=!1,s;(l=i?!0:n.bIsDirty==!0?!0:!1,s=o.__GetWebViewerUuid(t),s&&n.iImageControlWidth==h&&n.iImageControlHeight==c&&n.bIsDirty==!1)||o.__SetArrayControlLoadImage(s,t,n,h,c,o.AttachImagesForControl,l,r,u,f,e)};t.prototype.__SetArrayControlLoadImage=function(n,t,i,r,u,f,e,o,s,h,c){var l=this;l._stwain._isMobileMode()?l.OnGetImageFromMobileServer(t,i,r,u,o,s,h,c):e?l.OnGetImageFromServer(t,i,r,u,o,s,h,c):l.OnGetImageByURL(t,i,r,u,o,s,h,c)};t.prototype.OnGetImageByURL=function(n,t,i,r,u,f,e,o){var s=this;if(t.imageUrl&&t.imageUrl!="")t.iImageControlWidth=i,t.iImageControlHeight=r,t.bAddImage=u,t.bAppendImage=f,t.index=e,s._stwain._isMobileMode()?s.MobileAttachImagesForControl(t,o):s.AttachImagesForControl(t,o);else return s.OnGetImageFromServer(n,t,i,r,u,f,e,o);return!0};t.prototype.OnGetImageFromMobileServer=function(n,t,i,r,u,f,e,o){var s=this;t.iImageControlWidth=i;t.iImageControlHeight=r;t.bAddImage=u;t.bAppendImage=f;t.index=e;s.MobileAttachImagesForControl(t,o)};t.prototype.OnGetImageFromServer=function(n,t,r,u,f,e,o,s){var c=this,l,a,h=c.BaseUrl;if(h){if(n==-1)return!1;t.bIsDirty&&(t.ticks=Date.now());l=i.getImageUrl(h,n,-1,-1,t.ticks);a=i.getImageUrl(h,n,r,u,t.ticks);t.iImageControlWidth=r;t.iImageControlHeight=u;t.imageUrl=l;t.minImageUrl=a;t.bAddImage=f;t.bAppendImage=e;t.index=o;c.AttachImagesForControl(t,s)}return!0};t.prototype.SetIfFitWindowAndType=function(n){var t=this,i;return t.bSingleMode==!0?(t.bIfFitWindow=!0,t.enumDWTFitWindowType=n,i=t.GetWebViewer(),null!=i&&(i.SetFitType(n),t.fZoom=i.GetZoom())):t.bIfFitWindow=!0,!0};t.prototype.GetAllowMultiSelect=function(){var n=this;return n.AllowMultiSelect};t.prototype.SetAllowMultiSelect=function(n){var t=this;return t.AllowMultiSelect=n,!0};t.prototype.GetFitWindowType=function(){var n=this;return n.enumDWTFitWindowType};t.prototype.SetSelectionRectAspectRatio=function(n){var t=this;return t.ratio=n,t.GetWebViewer().SetSelectionRectAspectRatio(n),!0};t.prototype.SetFitWindowType=function(n){var t=this;return t.enumDWTFitWindowType=n,t.bSingleMode?t.GetWebViewer().SetFitType(n):(t.bIfFitWindow=!0,t.enumDWTFitWindowType=0),!0};t.prototype.GetIfFitWindow=function(){var n=this;return n.bIfFitWindow};t.prototype.SetIfFitWindow=function(n){var t=this;return t.bIfFitWindow=n,t.bSingleMode?t.bIfFitWindow?t.GetWebViewer().SetFitType(t.enumDWTFitWindowType):t.GetWebViewer().SetFitType(5):(t.bIfFitWindow=!0,t.enumDWTFitWindowType=0),!0};t.prototype.GetImageMargin=function(){var n=this;return n.imagesPerColumn==n.imagesPerRow&&n.imagesPerRow==1?0:n.GetWebViewer().GetImageMargin()};t.prototype.SetImageMargin=function(n){var t=this;return t.imagesPerColumn==t.imagesPerRow&&t.imagesPerRow==1||t.GetWebViewer().SetImageMargin(n),!0};t.prototype.GetSelectionImageBorderColor=function(){var n=this;return n.SelectionImageBorderColor};t.prototype.SetSelectionImageBorderColor=function(n){var t=this,i=n;return t.SelectionImageBorderColor=i,t.GetWebViewer().SetSelectionImageBorderColor(i),!0};t.prototype.GetZoom=function(){var n=this,t;return n.bIfFitWindow&&(t=n.GetWebViewer(),null!=t)?t.GetZoom():n.fZoom};t.prototype.SetZoom=function(n){var t=this,i;return n<t.MIN_ZOOM&&(n=t.MIN_ZOOM),n>t.MAX_ZOOM&&(n=t.MAX_ZOOM),t.fZoom=n,t.bSingleMode==!0?(t.bIfFitWindow=!1,t.enumDWTFitWindowType=0,i=t.GetWebViewer(),null!=i&&i.SetZoom(t.fZoom)):t.bIfFitWindow=!0,!0};t.prototype.ZoomIn=function(n,t){var u=this,e,f;if(u.bSingleMode==!0){var o=15e3,s=u.mapModelImageControl[u.getImageManager().convertClientIndexToServerId(u._WebViewer.GetCurrentIndex())],h=u.fZoom;if(u.bIfFitWindow&&(e=u.GetWebViewer(),null!=e&&(h=e.GetZoom())),f=Math.floor(h*100*u.zoomInStep)+1,1<f&&f<2501){if(parseInt(s.imageWidth*u.fZoom)>o||parseInt(s.imageHeight*u.fZoom)>o)return i.output(u,r.CustomizableDisplayInfo.errorMessages.limitReachedForZoomIn),alert(r.CustomizableDisplayInfo.errorMessages.limitReachedForZoomIn),!1;u.SetZoom(f/100,n,t)}else return i.output(u,r.CustomizableDisplayInfo.errorMessages.limitReachedForZoomIn),alert(r.CustomizableDisplayInfo.errorMessages.limitReachedForZoomIn),!1}return!0};t.prototype.ZoomOut=function(){var n=this,u,f,t;if(n.bSingleMode==!0)if(u=n.fZoom,n.bIfFitWindow&&(f=n.GetWebViewer(),null!=f&&(u=f.GetZoom())),t=Math.floor(u*100*n.zoomOutStep)-1,1<t&&t<6501)n.SetZoom(t/100);else return i.output(n,r.CustomizableDisplayInfo.errorMessages.limitReachedForZoomOut),alert(r.CustomizableDisplayInfo.errorMessages.limitReachedForZoomOut),!1;return!0};t.prototype.GetMouseShape=function(){var n=this;return n.iMouseShape};t.prototype.SetMouseShape=function(n){var t=this;return t.iMouseShape=n,t._ImgManager._isNoUI()||t.GetWebViewer().SetMouseShape(n),!0};t.prototype.GetShowPageNumber=function(){var n=this;return n.bShowPageNumber};t.prototype.SetShowPageNumber=function(n){var t=this;return t.bShowPageNumber=n,t.GetWebViewer().SetShowPageNumber(n),!0};t.prototype.SetBackgroundColor=function(n){var t=this,i=n;return t.BackgroundColor=i,t.GetWebViewer().SetBackgroundColor(i),t.imagesPerRow==1&&t.imagesPerColumn==1&&t.GetWebViewer().SetSelectedImageBackground(i),!0};t.prototype.Go=function(n){var t=this;return t.GetWebViewer().bShowImageEdit&&t.GetWebViewer()._IfChangedWithinTheEditor==!0&&t.GetWebViewer().iChangedIndex!=n&&t.GetWebViewer().ShowDialogForSaveImage(n,!1,function(){return t.__GoInner(n)},function(){return t.__GoInner(n)}),t.__GoInner(n)};t.prototype.SetCurrentIndexOnly=function(n){var t=this;return t.__GoInner(n)};t.prototype.__GoInner=function(n){var t=this;return t.GetWebViewer().__goInner(n),!0};t.prototype.GetSelectedImageCount=function(){var n=this;return n.GetWebViewer().GetSelectedImagesCount()};t.prototype.SetSelectedImageCount=function(n){var t=this;return t.GetWebViewer().SetSelectedImagesCount(n),!0};t.prototype.SetSelectedImageIndex=function(n,t){var i=this;return i.GetWebViewer().SetSelectedImageIndex(n,t),!0};t.prototype.SetSelectedindexes=function(n){var t=this;return t.GetWebViewer().SetSelectedindexes(n)};t.prototype.GetSelectedindexes=function(){var n=this;return n.GetWebViewer().GetSelectedindexes()};t.prototype.__Previous=function(){var n=this;return n.Go(n.GetWebViewer().GetCurrentIndex()-1),!0};t.prototype.__Next=function(){var n=this;return n.Go(n.GetWebViewer().GetCurrentIndex()+1),!0};t.prototype.__fireEvent=function(t,i){var r=this;return n.isFunction(r[t])?r[t](i):!0};t.prototype.AddImage=function(t,i,r,u){var e=this,o=t*1,f;return i==-1?!1:(f=new n.UI.ModelImageControl,f.bIsDirty=!0,f.serverId=i,e.mapModelImageControl[i]=f,i>=0&&e.__GetImageAndAttach(f,i,!1,!0,u,o,r),!0)};t.prototype.RemoveImage=function(n,t){var i=this,r=n*1;return i.GetWebViewer().bShowImageEdit?(i.GetWebViewer()._IfChangedWithinTheEditor==!0&&(i.GetWebViewer().iChangedIndex!=r?(i.GetWebViewer().iChangedIndex>r&&i.GetWebViewer().iChangedIndex--,i.GetWebViewer()._IfChangedWithinTheEditor=!1,i.GetWebViewer().iChangedIndex=-1,i.GetWebViewer().updateButtons()):(i.GetWebViewer()._IfChangedWithinTheEditor=!1,i.GetWebViewer().iChangedIndex=-1,i.GetWebViewer().updateButtons())),i.RemoveImageInner(r,t)):i.RemoveImageInner(r,t)};t.prototype.RemoveImageInner=function(n,t){var i=this,r=n*1,u;return typeof r=="undefined"||r<0||r>=i._ImgManager.count()?!1:(u=i._ImgManager.count(),t!=-1&&i.mapModelImageControl[t]&&(i.mapModelImageControl[t].Clear(),delete i.mapModelImageControl[t]),i.GetWebViewer().RemoveByIndex(r))};t.prototype.MoveImage=function(n,t){var i=this;return i.GetWebViewer().MoveImage(n,t)};t.prototype.SwitchImage=function(n,t){var i=this;return i.GetWebViewer().SwitchImage(n,t)};t.prototype.GetIfAutoScroll=function(){return this.__IfAutoScroll};t.prototype.SetIfAutoScroll=function(n){var t=this;return t.__IfAutoScroll=n?!0:!1,t._WebViewer.SetIfAutoScroll(this.__IfAutoScroll),!0};t.prototype.Print=function(){var t=this,r=-1,f,u,e;if(r=t.GetWebViewer().GetCurrentIndex(),!(r<0)){if(u=t.getImageManager().convertClientIndexToServerId(r),u==-1)return n.Errors.IndexOutOfRange(t),!1;if(t._stwain._isMobileMode())e=t.GetWebViewer().GetUidByIndex(r),t.GetWebViewer().GetImageData(e).then(function(n){return n.originalData instanceof ArrayBuffer?t.__PrintInner(URL.createObjectURL(new Blob([n.originalData])),u,r):t.__PrintInner(n.originalData,u,r)});else return f=i.getImageUrl(t.BaseUrl,u,-1,-1),t.__PrintInner(f,u,r);return!0}};t.prototype.__PrintInner=function(t,r,u){var e=this,f=e.mapModelImageControl[r],o=[],s;if(f)f.imageWidth<=0&&(f.imageWidth=e.getImageManager().GetImageWidth(u)),f.imageHeight<=0&&(f.imageHeight=e.getImageManager().GetImageHeight(u)),s=new n.UI.PrintUrl(t,f.imageWidth,f.imageHeight),o.push(s);else return!1;return i.print(o),!0};t.prototype.GetHowManyImagesInBuffer=function(){var n=this;return n.GetWebViewer().GetHowManyImagesInBuffer()};t.prototype.RemoveImageTag=function(n){var t=this;return t.GetWebViewer().RemoveImageTag(n)};t.prototype.FilterImagesByTag=function(n,t,i){var r=this;return r.GetWebViewer().FilterImagesByTag(n,t,i)};t.prototype.GetServerIdListByTag=function(n){var r=this,u,f=[],t,e,i;if(n.length==0)for(t=0;t<r.GetHowManyImagesInBuffer();t++)i=r.GetWebViewer().GetCustomDataByIndex(t),i&&f.push(i.imageId);else for(u=r.GetWebViewer().GetTagContents(n),t=0;t<u.length;t++)e=r.GetWebViewer().GetIndexByUid(u[t]),e>=0&&(i=r.GetWebViewer().GetCustomDataByIndex(e),i&&f.push(i.imageId));return f};t.prototype.SetDefaultTag=function(n){var t=this;return t.GetWebViewer().SetDefaultTag(n)};t.prototype.AddImageTag=function(n,t){var i=this;return i.GetWebViewer().AddImageTag(n,t)};t.prototype.GetCurrentTag=function(){var t=this,n;return n=t.GetWebViewer().GetCurrentTag(),n==!1?"":n};t.prototype.BindView=function(n,t){var i=this,r=!0,u=i.GetWebViewer();return r=u.BindView(n),r&&(i.SetBackgroundColor(i.BackgroundColor),i.UpdateView(t),u.SetViewerBorderColor(u.ThumbnailBorderColor)),r};t.prototype.UnbindView=function(){var n=this;return n.GetWebViewer().UnbindView()};t.prototype.UpdateView=function(t){var i=this,r,e=!1,u,f,o;return t&&(t.Height&&(u=t.Height,Dynamsoft.Lib.isString(u)&&u.indexOf("%")>=0?(i._stwain._height=u,o=Dynamsoft.Lib.one("#"+i._stwain._containerID),r=parseInt(n.css(o,"height")*parseInt(u)/100)):(r=parseInt(u),r&&(i._stwain._height=r+"px")),r&&(r>i.imageViewHeight&&(e=!0),i.imageViewHeight=r,i.GetWebViewer().SetHeight(i.imageViewHeight))),t.Width&&(t.Width>i.imageViewWidth&&(e=!0),i.imageViewWidth=t.Width,f=t.Width,Dynamsoft.Lib.isString(f)&&f.indexOf("%")>=0?(i._stwain._width=f,o=Dynamsoft.Lib.one("#"+i._stwain._containerID),r=parseInt(n.css(o,"width")*parseInt(f)/100)):(r=parseInt(f),r&&(i._stwain._width=r+"px")),r&&(r>i.imageViewWidth&&(e=!0),i.imageViewWidth=r,i.GetWebViewer().SetWidth(i.imageViewWidth))),e&&i.RefreshAllImages(i.imageViewWidth,i.imageViewHeight),t.view&&i.GetWebViewer().ShowThumbnail(t.view.bShow,t.view.Width)),!0};t.prototype.GetIfShowVideoContainer=function(){var n=this;return n.GetWebViewer().GetIfShowVideoContainer()};t.prototype.ShowVideoContainer=function(n){var t=this;return t.GetWebViewer().ShowVideoContainer(n)};t.prototype.UpdateVideoContainer=function(n){var t=this;return t.GetWebViewer().UpdateVideoContainer(n)};t.prototype.__AttachImages=function(){for(var n=this,t,u,r=n.GetWebViewer().GetHowManyImagesInBuffer(),i=0;i<r;i++)t=n._ImgManager.convertClientIndexToServerId(i),t>=0&&(u=n.mapModelImageControl[t],n.__GetImageAndAttach(u,t,!0,!1,!1,0))};t.prototype.exists=function(t){var i=this;return n.isUndefined(i.mapModelImageControl[t])?!1:!0};t.prototype.getImageManager=function(){var n=this;return n._ImgManager};t.prototype.GetImageData=function(n){var t=this;t.GetWebViewer().GetImageData(n)};t.prototype.Rotate=function(n,t){var i=this;i.GetWebViewer().RotateByWebViewer(n,t)};t.prototype.Mirror=function(n){var t=this;t.GetWebViewer().MirrorByWebViewer(n)};t.prototype.Flip=function(n){var t=this;t.GetWebViewer().FlipByWebViewer(n)};t.prototype.Crop=function(n,t,i,r,u){var f=this;f.GetWebViewer().CropByWebViewer(n,t,i,r,u)};t.prototype.RegistLoadCallback=function(n){var t=this;return t.GetWebViewer().RegistLoadCallback(n)};n.UI=n.UI||{};n.UI.ImageUIView=t}});Dynamsoft.Ready(function(n){function t(n,t,i){var r=this;r._ImgManager=n;r._stwain=n._stwain;r._UIView=i;r._HowManyImagesInBuffer=0;r._currentIndex=-1;r._currentTag="";r.bCouldBeTimeConsuming=!1;r.bShowImageEdit=!1;r.bShowImageEditForFullScreen=!1;r.ThumbnailBorderColor="rgb(204, 204, 204)";r.SelectedImageBorderColor="#7DA2CE";r.SelectedImageBackground="rgb(199, 222, 252)";r.ImageBorderColor="rgb(238, 238, 238)";r.HoverBorderColor="rgb(238, 238, 238)";r.HoverBackgroundColor="rgb(239, 246, 253)";r.PlaceholderBackgroundColor="rgb(251, 236, 136)";r.sHorizontalImageCount=-1;r.sVerticalImageCount=-1;r.ifWebviewerInit=!1;r._Init(t)}var l=Dynamsoft;if(n.product.bHTML5Edition){var e=document,a=n.DOM,o=window,u=Dynamsoft.WebTwainEnv,i=u.CustomizableDisplayInfo.buttons,f=n.html5.Funs2,s={component:{bottomMenu:!1,header:!1},group:{viewMenu:{visibility:!1},myGroup:{visibility:!0,location:"topMenu",sequence:1}},cropStyle:{cropMask:!1,cropBar:!1},buttonResize:{ifResize:!0,maxSize:22,minSize:16},buttons:{loadImage:{visibility:!1},readDirection:{visibility:!1},panelChange:{visibility:!1},previousImage:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-preImage",sequence:1,onButtonClick:"OnPreviousImage"},nextImage:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-nextImage",sequence:2,onButtonClick:"OnNextImage"},blank1:{visibility:!0,location:"myGroup",sequence:3},acquire:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-acquire",sequence:4,onButtonClick:"OnAcquire"},loadImages:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-load",sequence:5,onButtonClick:"OnLoadImage"},print:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-printImage",sequence:6,onButtonClick:"OnPrint"},blank2:{visibility:!0,location:"myGroup",sequence:7},removeAll:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-removeall",sequence:8,onButtonClick:"OnRemoveAll"},remove:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-removeImage",sequence:9,onButtonClick:"OnRemove"},blank3:{visibility:!0,location:"myGroup",sequence:10},rotateLeft:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-rotateLeftImage",sequence:11,onButtonClick:"OnRotateLeft"},rotate:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-rotate",sequence:12,onButtonClick:"OnRotate"},rotateRight:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-rotateRightImage",sequence:13,onButtonClick:"OnRotateRight"},deskew:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-deskew",sequence:14,onButtonClick:"OnDeskew"},blank4:{visibility:!0,location:"myGroup",sequence:15},crop:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-cropImage-grey",sequence:16,onButtonClick:"OnCrop"},erase:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-erase-grey",sequence:17,onButtonClick:"OnErase"},changeImageSize:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-changeImageSize",sequence:18,onButtonClick:"OnChangeImageSize"},flip:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-flipImage",sequence:19,onButtonClick:"OnFlip"},mirror:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-mirrorImage",sequence:20,onButtonClick:"OnMirror"},blank5:{visibility:!0,location:"myGroup",sequence:21},zoomin:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-zoomin",sequence:22,onButtonClick:"OnZoomin"},originalsize:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-originalsize",sequence:23,onButtonClick:"OnOriginalsize"},zoomout:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-zoomout",sequence:24,onButtonClick:"OnZoomout"},stretch:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-stretch",sequence:25,onButtonClick:"OnStretch"},blank6:{visibility:!0,location:"myGroup",sequence:26},fitPage:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-fullWebType",sequence:27,onButtonClick:"OnFitPage"},fitWidth:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-fitWidthType",sequence:28,onButtonClick:"OnFitWidth"},fitHeight:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-fitHeightType",sequence:29,onButtonClick:"OnFitHeight"},blank7:{visibility:!0,location:"myGroup",sequence:30},hand:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-hand",sequence:31,onButtonClick:"OnHand"},select:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-select",sequence:32,onButtonClick:"OnSelect"},clicktozoomin:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-clicktozoomin",sequence:33,onButtonClick:"OnClicktozoomin"},blank8:{visibility:!0,location:"myGroup",sequence:34},restore:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-restore",sequence:35,onButtonClick:"OnRestore"},save:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-saveImage",sequence:36,onButtonClick:"OnSave"},close:{visibility:!0,location:"topMenuRight",iconClass:"d-icon-font icon-close",sequence:1,onButtonClick:"OnClose"}},content:{besides:{visibility:!1,sequence:4},thumbnail:{backgroundColor:"#fff"}},thumbnail:{showThumbnailControl:!1,hoverBackgroundColor:"rgb(239, 246, 253)",hoverBorderColor:"rgb(238, 238, 238)",imageBackgroundColor:"transparent",imageBorderColor:"rgb(238, 238, 238)",placeholderBackgroundColor:"rgb(251, 236, 136)",selectedBorderColor:"#7DA2CE",thumbnailBorderColor:"rgb(204, 204, 204)"},tipsConfig:{previousImage:i.titles.previous,nextImage:i.titles.next,acquire:i.titles.scan,loadImages:i.titles.load,print:i.titles.print,removeAll:i.titles.removeall,remove:i.titles.removeselected,rotateLeft:i.titles.rotateleft,rotate:i.titles.rotate,rotateRight:i.titles.rotateright,deskew:i.titles.deskew,crop:i.titles.crop,erase:i.titles.erase,changeImageSize:i.titles.changeimagesize,flip:i.titles.flip,mirror:i.titles.mirror,zoomin:i.titles.zoomin,originalsize:i.titles.originalsize,zoomout:i.titles.zoomout,stretch:i.titles.stretch,fitPage:i.titles.fit,fitWidth:i.titles.fitw,fitHeight:i.titles.fith,hand:i.titles.hand,select:i.titles.rectselect,clicktozoomin:i.titles.zoom,restore:i.titles.restore,save:i.titles.save,close:i.titles.close}},h={component:{header:!0},group:{viewMenu:{visibility:!1},global:{visibility:!1},viewChange:{visibility:!1},viewerCorner:{visibility:!1},pager:{visibility:!1},myGroup:{visibility:!0,location:"topMenu",sequence:1},myGroup2:{visibility:!0,location:"bottomMenu",sequence:1},myGroup3:{visibility:!0,location:"header",sequence:1},myGroup4:{visibility:!0,location:"bottomMenu",sequence:2}},cropStyle:{cropMask:!1,cropBar:!1},buttonResize:{ifResize:!0,maxSize:22,minSize:16},buttons:{loadImage:{visibility:!1},readDirection:{visibility:!1},panelChange:{visibility:!1},print:{visibility:!1},loadImages:{visibility:!0,location:"myGroup3",iconClass:"d-icon-font icon-load",sequence:1,onButtonClick:"OnLoadImage"},close:{visibility:!0,location:"myGroup3",iconClass:"d-icon-font icon-close",sequence:2,onButtonClick:"OnClose"},rotateLeft:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-rotateLeftImage",sequence:1,onButtonClick:"OnRotateLeft"},rotateRight:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-rotateRightImage",sequence:2,onButtonClick:"OnRotateRight"},flip:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-flipImage",sequence:3,onButtonClick:"OnFlip"},mirror:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-mirrorImage",sequence:4,onButtonClick:"OnMirror"},crop:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-cropImage-grey",sequence:5,onButtonClick:"OnCrop"},erase:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-erase-grey",sequence:6,onButtonClick:"OnErase"},hand:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-hand",sequence:7,onButtonClick:"OnHand"},select:{visibility:!0,location:"myGroup",iconClass:"d-icon-font icon-select",sequence:8,onButtonClick:"OnSelect"},firstPage:{visibility:!0,location:"myGroup2",sequence:1,onButtonClick:"onFirstImage"},previousPage:{visibility:!0,location:"myGroup2",sequence:2,onButtonClick:"OnPreviousImage"},pagination:{visibility:!0,location:"myGroup2",sequence:3},nextPage:{visibility:!0,location:"myGroup2",sequence:4,onButtonClick:"OnNextImage"},lastPage:{visibility:!0,location:"myGroup2",sequence:5,onButtonClick:"onLastImage"},removeAll:{visibility:!0,location:"myGroup4",iconClass:"d-icon-font icon-removeall",sequence:7,onButtonClick:"OnRemoveAll"},remove:{visibility:!0,location:"myGroup4",iconClass:"d-icon-font icon-removeImage",sequence:8,onButtonClick:"OnRemove"},restore:{visibility:!0,location:"myGroup4",iconClass:"d-icon-font icon-restore",sequence:10,onButtonClick:"OnRestore"},save:{visibility:!0,location:"myGroup4",iconClass:"d-icon-font icon-saveImage",sequence:11,onButtonClick:"OnSave"}},content:{besides:{visibility:!1,sequence:4},thumbnail:{backgroundColor:"#fff"}},thumbnail:{showThumbnailControl:!1,hoverBackgroundColor:"rgb(239, 246, 253)",hoverBorderColor:"rgb(238, 238, 238)",imageBackgroundColor:"transparent",imageBorderColor:"rgb(238, 238, 238)",placeholderBackgroundColor:"rgb(251, 236, 136)",selectedBorderColor:"#7DA2CE",thumbnailBorderColor:"rgb(204, 204, 204)"},tipsConfig:{previousImage:i.titles.previous,nextImage:i.titles.next,acquire:i.titles.scan,loadImages:i.titles.load,print:i.titles.print,removeAll:i.titles.removeall,remove:i.titles.removeselected,rotateLeft:i.titles.rotateleft,rotate:i.titles.rotate,rotateRight:i.titles.rotateright,deskew:i.titles.deskew,crop:i.titles.crop,erase:i.titles.erase,changeImageSize:i.titles.changeimagesize,flip:i.titles.flip,mirror:i.titles.mirror,zoomin:i.titles.zoomin,originalsize:i.titles.originalsize,zoomout:i.titles.zoomout,stretch:i.titles.stretch,fitPage:i.titles.fit,fitWidth:i.titles.fitw,fitHeight:i.titles.fith,hand:i.titles.hand,select:i.titles.rectselect,clicktozoomin:i.titles.zoom,restore:i.titles.restore,save:i.titles.save,close:i.titles.close}},r={isFunction:function(n){return n&&typeof n=="function"},addClass:function(t,i){var r=n.one(t);r&&r.length>0&&r.addClass(i)},removeClass:function(t,i){var r=n.one(t);r&&r.length>0&&r.removeClass(i)},output:function(t,i){Dynamsoft.WebTwainEnv.Debug&&n.log(i)},getTop:function(n){var t=n.offsetTop;return n.offsetParent!=null&&(t+=r.getTop(n.offsetParent)),t},getLeft:function(n){var t=n.offsetLeft;return n.offsetParent!=null&&(t+=r.getLeft(n.offsetParent)),t}},c;c=n.env.bMac?Dynamsoft.dcp.b64bit?"libDynamicPdfCorex64_"+Dynamsoft.WebTwainEnv.PdfVersion+".dylib":"libDynamicPdfCore_"+Dynamsoft.WebTwainEnv.PdfVersion+".dylib":n.env.bLinux?"libDynamicPdfCore_"+Dynamsoft.WebTwainEnv.PdfVersion+".so":Dynamsoft.dcp.b64bit?"DynamicPdfCorex64_"+Dynamsoft.WebTwainEnv.PdfVersion+".dll":"DynamicPdfCore_"+Dynamsoft.WebTwainEnv.PdfVersion+".dll";t.prototype._Init=function(t){var i=this,u,r;if(t.Container&&(n.isNodeList(t.Container)||n.isArray(t.Container)&&t.Container.length>0)?(u=t.Container[0],i.iContainerId=u?u.id:""):i.iContainerId="",i.WebviewerHeight=t.Height,i.WebviewerWidth=t.Width,i.mydvs){i.iContainerId!=""&&i.BindView(i.iContainerId);return}r=s;i.bMobile=!1;i.bMobile_function=!1;i._stwain._isMobileMode()&&(i._stwain._isPC()||(r=h,i.bMobile=!0,i.bMobile_function=!0));i.iContainerId?(i.mydvs=new DVS({containerId:i.iContainerId,uiConfig:r,scrollerConfig:{useRelativeZoom:!1,zoomInStretch:!1}}),i._InitDVS()):i.mydvs=new DVS({containerId:"",uiConfig:r,scrollerConfig:{useRelativeZoom:!1,zoomInStretch:!1}});try{i.mydvs.bindAreaDetectFunction&&i.mydvs.bindAreaDetectFunction(i._stwain._areaDetectCallback);i.mydvs.bindPerspectiveFunction&&i.mydvs.bindPerspectiveFunction(i._stwain._perspectiveCallback);i.mydvs.bindLicenseCallback&&i.mydvs.bindLicenseCallback(function(){return i._stwain._checkWebcamWasmLicense()});i.mydvs.bindSavePhotoCallback&&i.mydvs.bindSavePhotoCallback(function(n){return i._stwain._saveImageCallback(n)})}catch(f){}i._stwain.Viewer=i.mydvs;i._BindButtonEvents();i._bRegistedLoad=!1};t.prototype.BindView=function(t){var i=this,r=!1;return(i.mydvs.showHeader=!1,i.mydvs.showTopMenu=!1,i.mydvs.showFooter=!1,r=i.mydvs.bindViewer(t),!r)?(n.Errors.WebviewerError(i._stwain,i.mydvs.errorMessage,i.mydvs.errorCode),!1):(i.iContainerId=t,i._stwain._containerID=t,i.ifWebviewerInit||(i._InitDVS(),i._UIView.__InitWebViewer()),r)};t.prototype.UnbindView=function(){var t=this,i=!1;return t._stwain&&t._stwain.Addon&&t._stwain.Addon.Camera&&t._stwain.Addon.Camera.getStatus()!=""&&t._stwain.Addon.Camera.closeSource(),i=t.mydvs.unbindViewer(),t.iContainerId="",i||n.Errors.WebviewerError(t._stwain,t.mydvs.errorMessage,t.mydvs.errorCode),i};t.prototype.SetUIView=function(n){var t=this;t._UIView=n};t.prototype._BindButtonEvents=function(){var t=this;n.each(["OnPreviousImage","OnNextImage","OnAcquire","OnLoadImage","OnPrint","OnRemoveAll","OnRemove","OnRotateLeft","OnRotate","OnRotateRight","OnDeskew","OnCrop","OnErase","OnChangeImageSize","OnFlip","OnMirror","OnZoomin","OnOriginalsize","OnZoomout","OnStretch","OnFitPage","OnFitWidth","OnFitHeight","OnHand","OnSelect","OnClicktozoomin","OnRestore","OnSave","OnClose","topImageChange","click","imageClick","rightClick","imageRightClick","doubleClick","imageDoubleClick","move","imageAreaSelected","imageAreaUnselected","dragDone","imageMove","onDrop","onFirstImage","onLastImage","pageChange"],function(n){t.mydvs.on(n,function(i,r){t[n](i,r)})})};t.prototype._InitDVS=function(){var t=this,i=!1;t.ifWebviewerInit=!0;t.mydvs.showHeader=!1;t.mydvs.showTopMenu=!1;t.mydvs.showFooter=!1;t.mydvs.showMain=!1;t.mydvs.bOnlyShowThumbnailsView=!0;t.mydvs.showThumbnail=!0;t.mydvs.showThumbnailControl=!1;t.mydvs.keepZoom=!0;t.mydvs.showLatestImage=!0;t.mydvs.useOuterDrop=!0;t.mydvs.minZoom=t._UIView.MIN_ZOOM;t.mydvs.maxZoom=t._UIView.MAX_ZOOM;t.mydvs.off("imageRightClick");t.SetWidthInner(t.WebviewerWidth);t.SetHeightInner(t.WebviewerHeight);t.mydvs.thumbnailBorderColor=t.ThumbnailBorderColor;t.mydvs.selectedImageBorderColor=t.SelectedImageBorderColor;t.mydvs.imageBorderColor=t.ImageBorderColor;t.mydvs.viewerBorderColor=t.ThumbnailBorderColor;t.mydvs.hoverBorderColor=t.HoverBorderColor;t.mydvs.hoverBackgroundColor=t.HoverBackgroundColor;t.mydvs.placeholderBackgroundColor=t.PlaceholderBackgroundColor;t.SetSelectedImageBackground(t._UIView.BackgroundColor);t.SetImageMargin(25);i=t.mydvs.setViewMode(1,1);i||n.Errors.WebviewerError(t._stwain,t.mydvs.errorMessage,t.mydvs.errorCode)};t.prototype.ShowImageEditor=function(t,i,r,u){var f=this,o=n.one(".dynamsoft-cvs-container"),l,a,c,v,e,y;o&&o.getEL()?(f.cvsContainer=o,f.cvsParentId=o.parent()[0].id,f._stwain&&f._stwain.Addon&&f._stwain.Addon.Camera&&(f.cvsStatus=f._stwain.Addon.Camera.getStatus())):(f.cvsContainer="",f.cvsParentId="",f.cvsStatus="");f.config_Zoom=f.mydvs.zoom;f.config_uiConfig=f.mydvs.uiConfig;!f.bMobile||f.bPadViewer?f.mydvs.updateUISettings(s):f.mydvs.updateUISettings(h);f.bShowImageEdit=!0;f.config_SelectionRectAspectRatio=f.mydvs.selectionRectAspectRatio;f.config_showHeader=f.mydvs.showHeader;f.config_showTopMenu=f.mydvs.showTopMenu;f.config_showFooter=f.mydvs.showFooter;f.config_showMain=f.mydvs.showMain;f.config_showThumbnail=f.mydvs.showThumbnail;f.config_fullThumbnail=f.mydvs.bOnlyShowThumbnailsView;f.config_canvasBackground=f.mydvs.canvasBackground;f.config_iMouseShape=f._UIView.iMouseShape;f.UIEditor=t;i?(f.sHorizontalImageCount!=-1||f.sVerticalImageCount!=-1||f.bShowImageEdit?f.sHorizontalImageCount>1||f.sHorizontalImageCount<-1||f.sVerticalImageCount>1||f.sVerticalImageCount<-1?(f.SetSelectedImageBackground(f.SelectedImageBackground),f.SetBackgroundColor(f._UIView.BackgroundColor)):f.SetSelectedImageBackground(f._UIView.BackgroundColor):(f.SetBackgroundColor(f._UIView.BackgroundColor),f.SetSelectedImageBackground(f._UIView.BackgroundColor)),f.mydvs.bindContent(t,r,u),l=document.getElementById(f.cvsParentId),l&&l.appendChild(f.cvsContainer[0])):(f.UIEditor.className="D_ImageUIEditor",f.UIEditor.style.width="100%",f.UIEditor.style.height="100%",f.UIEditor.style.position="fixed",f.UIEditor.style.left="0px",f.UIEditor.style.top="0px",f.UIEditor.style.zIndex="9999",f.SetWidthInner("100%",!0),f.SetHeightInner("100%",!0),a=document.getElementById(f.iContainerId),a&&f.UIEditor.appendChild(a.childNodes[0]),document.documentElement.scrollLeft=0,document.documentElement.scrollTop=0,document.body.style.overflow="hidden",f.mydvs.showThumbnail=!1,f.bShowImageEditForFullScreen=!0);f._UIView&&(f._UIView.bSingleMode=!0,f._UIView.SetIfFitWindowAndType(0));f.updateMode();f.mydvs.canvasBackground="rgba(67,66,70,1)";f.mydvs.showMain=!0;f.mydvs.showTopMenu=!0;f.SetSelectionRectAspectRatio(0);f.HideEditorButtonForPad();f.actualSelectedCanvasAreas=[{left:0,top:0,right:0,bottom:0}];f._stwain._isMobileMode()&&(f.BackImageData(),c=n.one(".icon-acquire"),c&&c.getEL()&&(c[0].style.display="none"),f.dwtMobileFileId="dwtmobilefile",f.UIEditor&&f.UIEditor.nodeName=="DIV"?(e=document.createElement("div"),e.innerHTML=f.bMobile?"<input multiple accept='image/jpeg,image/png,image/tiff' id ='"+f.dwtMobileFileId+"' type='file' style='display:none' />":"<input multiple accept='image/*,.pdf' id ='"+f.dwtMobileFileId+"' type='file' style='display:none' />",f.UIEditor.appendChild(e)):(v=document.getElementById(f.UIEditor),e=document.createElement("div"),e.innerHTML=f.bMobile?"<input id ='"+f.dwtMobileFileId+"' type='file' accept='image/jpeg,image/png,image/tiff' style='display:none' />":"<input id ='"+f.dwtMobileFileId+"' type='file' accept='image/*,.pdf' style='display:none' />",v.appendChild(e)),y=n.get(f.dwtMobileFileId),y.onchange=function(){for(var t,n=0;n<this.files.length;n++)f._stwain.LoadImageFromBinary(this.files[n]);t=document.getElementById(f.dwtMobileFileId);t.value=""});f.mydvs.off("slideSwitch");f.mydvs.on("slideSwitch",function(n){n=="left"?f.previous():n=="right"&&f.next()})};t.prototype.HideEditorButtonForPad=function(){var u=this,n=u.mydvs,t=u.bPadViewer,f=document.getElementById("rotateBtn"+n.postfix),i,r;f&&(f.style.display=t?"none":"");i=document.getElementById("deskewBtn"+n.postfix);i&&(i.style.display=t?"none":"");r=document.getElementById("changeImageSizeBtn"+n.postfix);r&&(r.style.display=t?"none":"")};t.prototype.BackImageData=function(){var n=this,t;n._stwain._isMobileMode()&&n.bShowImageEdit&&(t=n.GetCurrentIndex(),t>=0&&n.GetImageData(n.GetUidByIndex(t)).then(function(i){n.BackImageBuffer=i.originalData;var r=n.mydvs.getMetaDataByIndex(t);r&&(n.BackModelImageControl={},n.BackModelImageControl.imageWidth=r.imageWidth,n.BackModelImageControl.imageHeight=r.imageHeight,n.BackModelImageControl.imageBitDepth=r.imageBitDepth,n.BackModelImageControl.imageXResolution=r.imageXResolution,n.BackModelImageControl.imageYResolution=r.imageYResolution)}))};t.prototype.CloseShowImageEditor=function(){var n=this,t;n.mydvs.showHeader=n.config_showHeader;n.mydvs.showTopMenu=n.config_showTopMenu;n.mydvs.showFooter=n.config_showFooter;n.mydvs.showMain=n.config_showMain;n.mydvs.showThumbnail=n.config_showThumbnail;n.mydvs.bOnlyShowThumbnailsView=n.config_fullThumbnail;n.mydvs.canvasBackground=n.config_canvasBackground;n.SetMouseShape(n.config_iMouseShape);n.SetSelectionRectAspectRatio(n.config_SelectionRectAspectRatio);n.config_uiConfig&&n.mydvs.updateUISettings(n.config_uiConfig);n.config_Zoom==1?n.mydvs.fittype="window":n.mydvs.zoom=n.config_Zoom;n.cvsContainer&&n.cvsContainer!=""&&n.cvsParentId&&n.cvsParentId!=""&&(t=document.getElementById(n.cvsParentId),t&&t.appendChild(n.cvsContainer[0]),n.cvsStatus=="playing"&&n._stwain&&n._stwain.Addon&&n._stwain.Addon.Camera&&n._stwain.Addon.Camera.resume())};t.prototype.ShowThumbnail=function(t,i){var r=this,u=0;t?(n.isUndefined(i)&&(i=0),u=n.isString(i)&&i.indexOf("%")>=0?r.mydvs.width*(100-parseInt(i))/100:r.mydvs.width-i,u<=0?(r.mydvs.bOnlyShowThumbnailsView=!0,r.mydvs.showThumbnail=!0,r.mydvs.showMain=!1):(r.mydvs.bOnlyShowThumbnailsView=!1,r.mydvs.showThumbnail=!0,r.mydvs.showMain=!0,r.mydvs.thumbnailWidth=parseInt(u))):(r.mydvs.bOnlyShowThumbnailsView=!0,r.mydvs.showThumbnail=!0,r.mydvs.showMain=!1)};t.prototype.GetUidByIndex=function(t){var i=this;return t<0||t>=i.GetHowManyImagesInBuffer()?(n.Errors.IndexOutOfRange(i._stwain),-1):i.mydvs.getUidByIndex(t)};t.prototype.GetIndexByUid=function(t){var i=this;return!t||t==""||t==-1?(n.Errors.IndexOutOfRange(i._stwain),-1):i.mydvs.getIndexByUid(t)};t.prototype.SetMetaDataByIndex=function(t,i){var r=this;if(t<0||t>=r.GetHowManyImagesInBuffer()){n.Errors.IndexOutOfRange(r._stwain);return}return r.mydvs.setMetaDataByIndex(t,i)};t.prototype.GetMetaDataByIndex=function(t){var i=this;if(t<0||t>=i.GetHowManyImagesInBuffer()){n.Errors.IndexOutOfRange(i._stwain);return}return i.mydvs.getMetaDataByIndex(t)};t.prototype.GetCustomDataByIndex=function(t){var i=this,r;if(t<0||t>=i.GetHowManyImagesInBuffer()){n.Errors.IndexOutOfRange(i._stwain);return}return r=n.isArray(t)?t[0]:t,i.mydvs.getCustomDataByIndex(r)};t.prototype.GetHowManyImagesInBuffer=function(){var t=this;return n.isUndefined(t.mydvs.currentImageCount)?n.isUndefined(t.mydvs.imageCount)?0:t.mydvs.imageCount:t.mydvs.currentImageCount};t.prototype.SetHowManyImagesInBuffer=function(n){var t=this;t._HowManyImagesInBuffer=n};t.prototype.GetHowManyImagesInBufferInner=function(){var t=this,t=this;return n.isUndefined(t.mydvs.currentImageCount)?n.isUndefined(t.mydvs.imageCount)?0:t.mydvs.imageCount:t.mydvs.currentImageCount};t.prototype.UpdateInfo=function(){var n=this;Dynamsoft.Lib.hideMask()};t.prototype.AppendImage=function(t,i){var r=this,e=t.imageUrl,o=t.minImageUrl,s=t.serverId,h=t.bAppendImage,c=t.index,u={},f;return i&&(n.isUndef(i.imageWidth)||(u.imageWidth=i.imageWidth),n.isUndef(i.imageHeight)||(u.imageHeight=i.imageHeight),n.isUndef(i.imageBitDepth)||(u.imageBitDepth=i.imageBitDepth),n.isUndef(i.imageXResolution)||(u.imageXResolution=i.imageXResolution),n.isUndef(i.imageYResolution)||(u.imageYResolution=i.imageYResolution)),n.log("AppendImage_originalData:"+e),h||h==!1&&r.GetHowManyImagesInBuffer()==0?(f=r.mydvs.appendImageSync("file1",[{originalData:e,minData:o,metaData:u,customData:{imageId:s}}]),t.uuid=f[0],r.UpdateInfo(),r.updateMode(),r.BackImageData(),f[0]):(f=r.mydvs.insertImageSync("file1",[{originalData:e,minData:o,metaData:u,customData:{imageId:s}}],c),t.uuid=f[0],r.UpdateInfo(),r.updateMode(),r.BackImageData(),f[0])};t.prototype.MobileAppendImage=function(t,i){var r=this,e=t.bAppendImage,o=t.index,u={},f;return(i.imageId=t.serverId,i&&i.metaData&&(n.isUndef(i.metaData.imageWidth)||(u.imageWidth=i.metaData.imageWidth),n.isUndef(i.metaData.imageHeight)||(u.imageHeight=i.metaData.imageHeight),n.isUndef(i.metaData.imageBitDepth)||(u.imageBitDepth=i.metaData.imageBitDepth),n.isUndef(i.metaData.imageXResolution)||(u.imageXResolution=i.metaData.imageXResolution),n.isUndef(i.metaData.imageYResolution)||(u.imageYResolution=i.metaData.imageYResolution),delete i.metaData),i.dataType=="url"||!("srcId"in i))?("src"in i&&(t.imageUrl=i.src,delete i.src),"imageUrl"in i&&(t.imageUrl=i.imageUrl,delete i.imageUrl),r.AppendImage(t,u)):e==!1&&r.GetHowManyImagesInBuffer()==0?(f=r.mydvs.appendImageSync("file1",[{originalData:null,minData:null,metaData:u,customData:i}]),t.uuid=f[0],r.UpdateInfo(),r.updateMode(),r.BackImageData(),f[0]):(f=r.mydvs.insertImageSync("file1",[{originalData:null,minData:null,metaData:u,customData:i}],o),t.uuid=f[0],r.UpdateInfo(),r.updateMode(),r.BackImageData(),f[0])};t.prototype.UpdateImage=function(t,i){var f=this,e=t.imageUrl,o=t.minImageUrl,s=t.serverId,u=t.uuid,r={};return(i&&(n.isUndef(i.imageWidth)||(r.imageWidth=i.imageWidth),n.isUndef(i.imageHeight)||(r.imageHeight=i.imageHeight),n.isUndef(i.imageBitDepth)||(r.imageBitDepth=i.imageBitDepth),n.isUndef(i.imageXResolution)||(r.imageXResolution=i.imageXResolution),n.isUndef(i.imageYResolution)||(r.imageYResolution=i.imageYResolution)),!u||u==""||u==-1)?(n.Errors.IndexOutOfRange(f._stwain),!1):(f._UpdateImageInner(u,{originalData:e,minData:o,customData:{imageId:s},metaData:r}),f.UpdateInfo(),u)};t.prototype.MobileUpdateImage=function(t,i){var f=this,s=t.index,e=t.uuid,r={},u={},o;return!e||e==""||e==-1?(n.Errors.IndexOutOfRange(f._stwain),!1):(r=f.mydvs.getMetaDataByIndex(s),r&&"metaData"in i&&i.metaData&&(n.isUndef(i.metaData.imageWidth)||(r.imageWidth=i.metaData.imageWidth),n.isUndef(i.metaData.imageHeight)||(r.imageHeight=i.metaData.imageHeight),n.isUndef(i.metaData.imageBitDepth)||(r.imageBitDepth=i.metaData.imageBitDepth),n.isUndef(i.metaData.imageXResolution)||(r.imageXResolution=i.metaData.imageXResolution),n.isUndef(i.metaData.imageYResolution)||(r.imageYResolution=i.metaData.imageYResolution)),i.dataType=="url"||!("srcId"in i))?("src"in i&&(t.imageUrl=i.src),"imageUrl"in i&&(t.imageUrl=i.imageUrl),f.UpdateImage(t,r)):(i&&i.src&&i.srcId&&(u=f.mydvs.getCustomDataByIndex(s),u&&(u.src=i.src,u.srcId=i.srcId,n.isUndef(i.imgType)||(u.imgType=i.imgType),o={},u&&(o.customData=u,o.metaData=r,f._UpdateImageInner(e,o))),f.UpdateInfo()),e)};t.prototype._UpdateImageInner=function(n,t){var i=this,r;i._stwain._isMobileMode()&&i.bShowImageEdit?(r=i.GetIndexByUid(n),r>=0?i.GetImageData(n).then(function(r){var u=!0;i.BackImageBuffer==r.originalData&&(u=!1);i.mydvs.updateImageSync(n,t,u)}):i.mydvs.updateImageSync(n,t)):i.mydvs.updateImageSync(n,t)};t.prototype.RemoveByIndex=function(t){var i=this,r,u;return t<0||t>=i.GetHowManyImagesInBuffer()?(n.Errors.IndexOutOfRange(i._stwain),!1):(u=[],u.push(t),r=i.mydvs.removeSync(u),r?(i.UpdateInfo(),i.BackImageData()):n.Errors.WebviewerError(i._stwain,i.mydvs.errorMessage,i.mydvs.errorCode),r)};t.prototype.RemoveAllImages=function(){var t=this,i;return i=t.mydvs.removeAllSync(),i?t.UpdateInfo():n.Errors.WebviewerError(t._stwain,t.mydvs.errorMessage,t.mydvs.errorCode),i};t.prototype.SetCurrentIndex=function(t){var i=this,r=!1;return t<0||t>=i.GetHowManyImagesInBuffer()?(n.Errors.IndexOutOfRange(i._stwain),!1):(i.mydvs.goToPage(t),i.mydvs.thumbnailScrollTo(t),r=i.mydvs.setCurrentIndex(t),r||n.Errors.WebviewerError(i._stwain,i.mydvs.errorMessage,i.mydvs.errorCode),i.UpdateInfo(),r)};t.prototype.OnlySetCurrentIndex=function(t){var i=this,r=!1;return t<0||t>=i.GetHowManyImagesInBuffer()?(n.Errors.IndexOutOfRange(i._stwain),!1):(r=i.mydvs.setCurrentIndex(t),r||n.Errors.WebviewerError(i._stwain,i.mydvs.errorMessage,i.mydvs.errorCode),r)};t.prototype.GetCurrentIndex=function(){var t=this,i=-1;return t.GetHowManyImagesInBuffer()>0&&(i=t.mydvs.getCurrentIndex(),(n.isUndef(i)||i<0)&&n.Errors.WebviewerError(t._stwain,t.mydvs.errorMessage,t.mydvs.errorCode)),i};t.prototype.SetSelectedindexes=function(t){var i=this,r=!1;return r=i.mydvs.setSelectedIndexes(t),r||n.Errors.WebviewerError(i._stwain,i.mydvs.errorMessage,i.mydvs.errorCode),r};t.prototype.GetSelectedindexes=function(){var n=this;return n.mydvs.getSelectedIndexes()};t.prototype.SetShowPageNumber=function(n){var t=this;t.mydvs.showPageNumber=n};t.prototype.GoToPage=function(t){var i=this,r=!1;return t<0||t>=i.GetHowManyImagesInBuffer()?(n.Errors.IndexOutOfRange(i._stwain),!1):(r=i.mydvs.goToPage(t),r||n.Errors.WebviewerError(i._stwain,i.mydvs.errorMessage,i.mydvs.errorCode),i.UpdateInfo(),r)};t.prototype.SetSelectedImageArea=function(t,i,r,u){var f=this,e=!1;return e=f.mydvs.setSelectedImageArea(t,i,r-t,u-i),e||n.Errors.WebviewerError(f._stwain,f.mydvs.errorMessage,f.mydvs.errorCode),e};t.prototype.SetSelectedThumbnailArea=function(t,i,r,u){var f=this,e=!1;return e=f.mydvs.setSelectedThumbnailArea(t,i,r-t,u-i),e||n.Errors.WebviewerError(f._stwain,f.mydvs.errorMessage,f.mydvs.errorCode),e};t.prototype.SetSelectionRectAspectRatio=function(n){var t=this;return t.mydvs.selectionRectAspectRatio=n,!0};t.prototype.ZoomIn=function(){var t=this,i=!1;return i=t.mydvs.zoomIn(),i||n.Errors.WebviewerError(t._stwain,t.mydvs.errorMessage,t.mydvs.errorCode),i};t.prototype.ZoomOut=function(){var t=this,i=!1;return i=t.mydvs.zoomOut(),i||n.Errors.WebviewerError(t._stwain,t.mydvs.errorMessage,t.mydvs.errorCode),i};t.prototype.SetZoom=function(t,i,r){var u=this,f=!1;return f=i&r?u.mydvs.zoomTo(t,i,r):u.mydvs.zoomTo(t),f||n.Errors.WebviewerError(u._stwain,u.mydvs.errorMessage,u.mydvs.errorCode),f};t.prototype.GetZoom=function(){var n=this;return n.mydvs.zoom};t.prototype.SetFitType=function(n){var i=this,t;switch(n){case 0:t="window";break;case 1:t="height";break;case 2:t="width";break;case 4:t="stretch";break;case 5:t="origin";break;default:t="origin"}return i.mydvs.fitType=t,!0};t.prototype.SetMouseShape=function(n){var i=this,r="pointer",t;switch(n){case EnumDWT_MouseShape.Default:t="default";i.SetOperationMode(1);break;case EnumDWT_MouseShape.Hand:t="pointer";i.SetOperationMode(0);break;case EnumDWT_MouseShape.Crosshair:t="crosshair";i.SetOperationMode(1);r=i.sHorizontalImageCount==1&&i.sVerticalImageCount==1||i.sHorizontalImageCount==-1&&i.sVerticalImageCount==-1?"crosshair":"pointer";break;case EnumDWT_MouseShape.Zoom:t="zoom-in";i.SetOperationMode(2);break;case EnumDWT_MouseShape.NWResize:t="nw-resize";break;case EnumDWT_MouseShape.EResize:t="e-resize";break;case EnumDWT_MouseShape.NResize:t="n-resize";break;case EnumDWT_MouseShape.Resize:t="all-scroll";break;case EnumDWT_MouseShape.Move:t="move";break;default:t="default"}return i.mydvs.canvasMouseShape=t,i.mydvs.cursorOverThumbnailsView=r,!0};t.prototype.SetImageMargin=function(n){var t=this;return t.mydvs.imageMargin=n,!0};t.prototype.GetImageMargin=function(){var n=this;return n.mydvs.imageMargin};t.prototype.SetSelectionImageBorderColor=function(n){var t=this;return t.mydvs.selectedImageBorderColor=n,!0};t.prototype.SetBackgroundColor=function(n){var t=this;return t.mydvs.thumbnailBackground=n,t.mydvs.canvasBackground=n,!0};t.prototype.SetViewerBorderColor=function(n){var t=this;return t.mydvs.viewerBorderColor=n,!0};t.prototype.SetWidth=function(n){var t=this;return t.WebviewerWidth=n,t.SetWidthInner(n)};t.prototype.SetWidthInner=function(t,i){var r=this,u;return i?r.mydvs.width=t:n.isString(t)&&t.indexOf("%")>=0?(u=n.one("#"+r._stwain._containerID),r.mydvs.width=parseInt(n.css(u,"width")*parseInt(t)/100)):r.mydvs.width=t,!0};t.prototype.SetHeight=function(n){var t=this;return t.WebviewerHeight=n,t.SetHeightInner(n)};t.prototype.SetHeightInner=function(t,i){var r=this,u;return i?r.mydvs.height=t:n.isString(t)&&t.indexOf("%")>=0?(u=n.one("#"+r._stwain._containerID),r.mydvs.height=parseInt(n.css(u,"height")*parseInt(t)/100)):r.mydvs.height=t,!0};t.prototype.SwitchImage=function(t,i){var r=this,u=!1;return t<0||t>=r.GetHowManyImagesInBuffer()||i<0||i>=r.GetHowManyImagesInBuffer()?(n.Errors.IndexOutOfRange(r._stwain),!1):(u=r.mydvs.switchImage(t,i),u||n.Errors.WebviewerError(r._stwain,r.mydvs.errorMessage,r.mydvs.errorCode),u)};t.prototype.MoveImage=function(t,i){var r=this,u=!1;return t<0||t>=r.GetHowManyImagesInBuffer()||i<0||i>=r.GetHowManyImagesInBuffer()?(n.Errors.IndexOutOfRange(r._stwain),!1):(u=r.mydvs.moveImage(t,i),u||n.Errors.WebviewerError(r._stwain,r.mydvs.errorMessage,r.mydvs.errorCode),u)};t.prototype.SetViewMode=function(t,i){var r=this,u=!1,f;return r.sHorizontalImageCount=t,r.sVerticalImageCount=i,t==-1&&i==-1?(r.bShowImageEdit?(r.config_showMain=!0,r.config_showTopMenu=!1,r.config_showHeader=!1,r.config_showFooter=!1,r.config_showThumbnail=!1,r.config_canvasBackground=r._UIView.BackgroundColor):(r.mydvs.showMain=!0,r.mydvs.showTopMenu=!1,r.mydvs.showHeader=!1,r.mydvs.showFooter=!1,r.mydvs.showThumbnail=!1,r.SetBackgroundColor(r._UIView.BackgroundColor),r.SetSelectedImageBackground(r._UIView.BackgroundColor)),u=!0):(r.bShowImageEdit?r.config_showMain&&(r.config_showMain=!1,r.config_showThumbnail=!0,r.config_fullThumbnail=!0):r.mydvs.showMain&&(r.mydvs.showMain=!1,r.mydvs.showThumbnail=!0,r.mydvs.bOnlyShowThumbnailsView=!0),i<0?u=r.mydvs.setViewMode(t,i):(f=t,t>0&&(f=0-t),u=r.mydvs.setViewMode(f,i)),u||n.Errors.WebviewerError(r._stwain,r.mydvs.errorMessage,r.mydvs.errorCode),t>1||t<-1||i>1||i<-1?r.SetSelectedImageBackground(r.SelectedImageBackground):r.SetSelectedImageBackground(r._UIView.BackgroundColor),r.ThumbnailScrollTo(r.GetCurrentIndex())),u};t.prototype.SetIfAutoScroll=function(n){var t=this;return t.mydvs.autoScroll=n,t.mydvs.showLatestImage=n,!0};t.prototype.SetSelectedImagesCount=function(n){var t=this;return t.mydvs.selectedImageCount=n,!0};t.prototype.GetSelectedImagesCount=function(){var n=this;return n.mydvs.selectedImageCount};t.prototype.SetSelectedImageIndex=function(t,i){var r=this,u=!1;return t<0||t>=r.GetHowManyImagesInBuffer()||i<0||i>=r.GetHowManyImagesInBuffer()?(n.Errors.IndexOutOfRange(r._stwain),!1):(u=r.mydvs.setSelectImageIndex(t,i),u||n.Errors.WebviewerError(r._stwain,r.mydvs.errorMessage,r.mydvs.errorCode),u)};t.prototype.RemoveImageTag=function(t){var i=this,r,u=!1;return t<0||t>=i.GetHowManyImagesInBuffer()?(n.Errors.IndexOutOfRange(i._stwain),!1):(r=i.GetUidByIndex(t),r&&r!=""&&r!=-1?(u=i.mydvs.removeImageTag(r),u||n.Errors.WebviewerError(i._stwain,i.mydvs.errorMessage,i.mydvs.errorCode),u):(n.Errors.WebviewerError(i._stwain,i.mydvs.errorMessage,i.mydvs.errorCode),!1))};t.prototype.FilterImagesByTag=function(t,i,r){var u=this,f=!1;return t.length==0?(u._currentTag="",f=u.mydvs.openAll().then(function(){u.mydvs.setDefaultTag("");n.isFunction(i)&&i()},function(t){n.isFunction(r)&&r(t.code,t.message)})):(u._currentTag=t,u.mydvs.openTag(t).then(function(){u.mydvs.setDefaultTag(t);n.isFunction(i)&&i()},function(t){n.isFunction(r)&&r(t.code,t.message)})),!0};t.prototype.GetTagContents=function(t){var i=this,r=!1;return r=t.length>0?i.mydvs.getTagContents(t):i.mydvs.getAllContents(),r||n.Errors.WebviewerError(i._stwain,i.mydvs.errorMessage,i.mydvs.errorCode),r};t.prototype.SetDefaultTag=function(t){var i=this,r=!1;return i._currentTag=t,i.mydvs.addTag(t),r=i.mydvs.setDefaultTag(t),r||n.Errors.WebviewerError(i._stwain,i.mydvs.errorMessage,i.mydvs.errorCode),r};t.prototype.AddImageTag=function(n,t){var r=this,f,i,u;for(r.mydvs.addTag(t),r._currentTag=t,u=0;u<n.length;u++)f=n[u],f>=0&&(i=r.GetUidByIndex(f),i&&i!=""&&i!=-1&&r.mydvs.addImageTag(i,t));return!0};t.prototype.GetCurrentTag=function(){var n=this;return n._currentTag};t.prototype.OverlayRectangle=function(t,i,r,u,f,e,o){var s=this,h=!1;return t<0||t>=s.GetHowManyImagesInBuffer()?(n.Errors.IndexOutOfRange(s._stwain),!1):(h=s.mydvs.overlayRectangle(t,i,r,u-i,f-r,e,o),h||n.Errors.WebviewerError(s._stwain,s.mydvs.errorMessage,s.mydvs.errorCode),h)};t.prototype.ChangeButtonClass=function(n,t){var i=this;return i.mydvs.setButtonClass(n,t)};t.prototype.SetOperationMode=function(n){var t=this;t.mydvs.operationMode=n};t.prototype.UnbindContent=function(){var n=this;n.mydvs.unbindContent()};t.prototype.GetIfShowVideoContainer=function(){var n=this;return n.mydvs.showVideoContainer};t.prototype.ShowVideoContainer=function(n){var t=this;return t.mydvs.showVideoContainer==n?!0:(n?(t.OldShowThumbnail=t.mydvs.showThumbnail,t.mydvs.showThumbnail=!1):t.mydvs.showThumbnail=t.OldShowThumbnail,t.mydvs.showVideoContainer=n,!0)};t.prototype.UpdateVideoContainer=function(t){var i=this,r;return r=i.mydvs.updateVideoContainer(t),r||n.Errors.WebviewerError(i._stwain,i.mydvs.errorMessage,i.mydvs.errorCode),r};t.prototype.ThumbnailScrollTo=function(n){var t=this;t.mydvs.thumbnailScrollTo(n)};t.prototype.GetImageData=function(n){var t=this;return t.mydvs.getData(n)};t.prototype.SetSelectedImageBackground=function(n){var t=this;t.mydvs.selectedImageBackground=n};t.prototype.SetLogLevel=function(n){var t=this;t.mydvs.setLogLevel(n)};t.prototype.SetLogFunc=function(n){var t=this;t.mydvs.setLogFunc(n)};t.prototype.RotateByWebViewer=function(t,i){var r=this,u,f=[];return f.push(t),u=r.mydvs.rotate(f,i),u||n.Errors.WebviewerError(r._stwain,r.mydvs.errorMessage,r.mydvs.errorCode),u};t.prototype.MirrorByWebViewer=function(t){var i=this,r,u=[];return u.push(t),r=i.mydvs.mirror(u),r||n.Errors.WebviewerError(i._stwain,i.mydvs.errorMessage,i.mydvs.errorCode),r};t.prototype.FlipByWebViewer=function(t){var i=this,r,u=[];return u.push(t),r=i.mydvs.flip(u),r||n.Errors.WebviewerError(i._stwain,i.mydvs.errorMessage,i.mydvs.errorCode),r};t.prototype.CropByWebViewer=function(t,i,r,u,f){var e=this,o;return[].push(t),o=e.mydvs.crop(t,i,r,u-i,f-r),o||n.Errors.WebviewerError(e._stwain,e.mydvs.errorMessage,e.mydvs.errorCode),o};t.prototype.DVSRotate=function(t){var i=this,r;return r=i.mydvs.rotate(t),r||n.Errors.WebviewerError(i._stwain,i.mydvs.errorMessage,i.mydvs.errorCode),r};t.prototype.DVSFlip=function(){var t=this,i;return i=t.mydvs.flip(),i||n.Errors.WebviewerError(t._stwain,t.mydvs.errorMessage,t.mydvs.errorCode),i};t.prototype.DVSMirror=function(){var t=this,i;return i=t.mydvs.mirror(),i||n.Errors.WebviewerError(t._stwain,t.mydvs.errorMessage,t.mydvs.errorCode),i};t.prototype.DVSCrop=function(t,i,r,u){var f=this,e;return e=f.mydvs.crop(t,i,r-t,u-i),e||n.Errors.WebviewerError(f._stwain,f.mydvs.errorMessage,f.mydvs.errorCode),e};t.prototype.DVSErase=function(t,i,r,u){var f=this,e;return e=f.mydvs.erase(t,i,r-t,u-i,f._UIView.BackgroundColor),e||n.Errors.WebviewerError(f._stwain,f.mydvs.errorMessage,f.mydvs.errorCode),e};t.prototype.DVSSaveTransformResult=function(){var t=this,i;return i=t.mydvs.saveTransformResult(),i||n.Errors.WebviewerError(t._stwain,t.mydvs.errorMessage,t.mydvs.errorCode),i};t.prototype.updateButtons=function(){var n=this;n._IfChangedWithinTheEditor==!0?(n.ChangeButtonClass("save","icon-saveImage"),n.ChangeButtonClass("restore","icon-restore")):(n.ChangeButtonClass("save","icon-saveImage-grey"),n.ChangeButtonClass("restore","icon-restore-grey"))};t.prototype.updateMode=function(){var n=this,t;if(n.bShowImageEdit)if(t=n.GetHowManyImagesInBuffer(),t>1?(n.GetCurrentIndex()==t-1||n.GetHowManyImagesInBuffer()<=1?n.ChangeButtonClass("nextImage","icon-nextImage-grey"):n.ChangeButtonClass("nextImage","icon-nextImage"),n.GetCurrentIndex()<=0||n.GetHowManyImagesInBuffer()<=1?n.ChangeButtonClass("previousImage","icon-preImage-grey"):n.ChangeButtonClass("previousImage","icon-preImage")):(n.ChangeButtonClass("nextImage","icon-nextImage-grey"),n.ChangeButtonClass("previousImage","icon-preImage-grey")),n.updateButtons(),n.__SetCropButtonGrey(!0),n.__SetEraseButtonGrey(!0),n.bMobile)switch(n.cursorStatus){case"rectselect":n.OnSelect();break;case"zoom":n.OnClicktozoomin();break;default:n.OnHand()}else switch(n.cursorStatus){case"hand":n.OnHand();break;case"zoom":n.OnClicktozoomin();break;default:n.OnSelect()}};t.prototype.__SaveImageInner=function(t,i){var r=this,o,f,e;if(r.iChangedIndex==-1&&r._IfSaveChangesOutSideOfTheEditor==!1)return r._IfChangedWithinTheEditor=!1,i&&i(),!1;if(r._IfChangedWithinTheEditor!=!0&&r._IfSaveChangesOutSideOfTheEditor==!1)return alert(u.CustomizableDisplayInfo.errorMessages.imageNotChanged),r._IfChangedWithinTheEditor=!1,i&&i(),!1;if(r._IfSaveChangesOutSideOfTheEditor&&(r.iChangedIndex=r.GetCurrentIndex()),o=function(u,f,e){if(r.updateMode(),u){t==!0&&(n.log("__SaveImageInner: "+[u.guid].join(",")),r.GetCurrentIndex()==f&&(r._stwain._isMobileMode()?r.MobileUpdateImage(u,e):r.UpdateImage(u,e)));r._IfChangedWithinTheEditor=!1;r.iChangedIndex=-1;var o=u.serverId;if(o==-1)return i&&i(),!1}else r._IfChangedWithinTheEditor=!1,r.iChangedIndex=-1;return r.updateButtons(),i&&i(),!0},f=!0,r._IfChangedWithinTheEditor==!0||r._IfSaveChangesOutSideOfTheEditor==!0){if(e=r.getImageManager().convertClientIndexToServerId(r.iChangedIndex),e==-1)return i&&i(),!1;r.OnGetImageFromServerForEdit(r._UIView.mapModelImageControl[e],r.iChangedIndex,2,o);f=!1}return r._IfSaveChangesOutSideOfTheEditor=!1,f&&(r._IfChangedWithinTheEditor=!1,i&&i()),!0};t.prototype.ShowDialogForSaveImage=function(t,i,f,e){var s=this,l=['<div class="dynamsoft-dwt-dlg-tips">',"<div>",u.CustomizableDisplayInfo.dialogText.saveChangedImage[0],"<\/div>",'<div style="width: 200px;white-space:nowrap;margin-left: auto;margin-right: auto;">','<input class="dynamsoft_btnSave" style="width: 100px; height:30px; margin-right: 10px; margin-top: 10px;"  type="button" value="',u.CustomizableDisplayInfo.dialogText.saveChangedImage[1],'" /><input class="dynamsoft_btnCancel" style="width: 100px; height:30px;"  type="button" value="',u.CustomizableDisplayInfo.dialogText.saveChangedImage[2],'" /><\/div>',"<\/div>"],h,c;s.bMobile?Dynamsoft.WebTwainEnv.ShowDialog(300,0,l.join(""),!0):Dynamsoft.WebTwainEnv.ShowDialog(420,0,l.join(""),!0);h=n.one(".dynamsoft_btnSave").getEL();h&&(h.onclick=function(){s.__SaveImageInner(!0,function(){var u=s._stwain._containerID;o.DCP_DWT_OnClickCloseInstall(u);n.bChangeImage=1;t==-1?s.OnClose():s.__goInner(t);i&&(document.body.style.overflow="");r.isFunction(f)&&f()})});c=n.one(".dynamsoft_btnCancel").getEL();c&&(c.onclick=function(){s.__RestoreImageInner(t,function(){var u=s._stwain._containerID;o.DCP_DWT_OnClickCloseInstall(u);n.bChangeImage=0;t==-1?s.OnClose():s.__goInner(t);i&&(document.body.style.overflow="");r.isFunction(e)&&e()})})};t.prototype.__SetCropButtonGrey=function(n){var t=this;t.ChangeButtonClass("crop","icon-cropImage-grey");n&&t.SetSelectedImageArea(0,0,0,0)};t.prototype.__SetEraseButtonGrey=function(n){var t=this;t.ChangeButtonClass("erase","icon-erase-grey");n&&t.SetSelectedImageArea(0,0,0,0)};t.prototype.__SetZoomInButtonEnable=function(n){var t=this;n==!0?t.ChangeButtonClass("zoomin","icon-zoomin"):t.ChangeButtonClass("zoomin","icon-zoomin-grey")};t.prototype.__SetZoomOutButtonEnable=function(n){var t=this;n==!0?t.ChangeButtonClass("zoomout","icon-zoomout"):t.ChangeButtonClass("zoomout","icon-zoomout-grey")};t.prototype.pageChange=function(t){var f=this,i,e=f.GetHowManyImagesInBuffer(),o;if(n.log("OnPagination"),e<=0){r.output(f,"No image in Buffer");return}if(e!=1){if(o=/^\d+$/,!o.test(t)||t<=0){alert(u.CustomizableDisplayInfo.errorMessages.invalidIndex);return}i=parseInt(t)-1;i<0?i=0:i>=e&&(i=e-1);i!=f.GetCurrentIndex()&&f.go(i)}};t.prototype.onFirstImage=function(){var n=this,t,i=n.GetHowManyImagesInBuffer();if(i<=0){r.output(n,"No image in Buffer");return}i!=1&&(t=0,t!=n.GetCurrentIndex()&&n.go(t))};t.prototype.onLastImage=function(){var n=this,t,i=n.GetHowManyImagesInBuffer();if(i<=0){r.output(n,"No image in Buffer");return}i!=1&&(t=i-1,t!=n.GetCurrentIndex()&&n.go(t))};t.prototype.OnPreviousImage=function(){var t=this,i=n.one(".icon-preImage-grey");(n.Errors.ClearErrorInfo(t._stwain),i&&i.getEL())||t.previous()};t.prototype.previous=function(){var n=this,t,i=n.GetHowManyImagesInBuffer();if(i<=0){r.output(n,"No image in Buffer");return}i!=1&&(t=n.GetCurrentIndex()-1,t<0&&(t=0),t!=n.GetCurrentIndex()&&n.go(t))};t.prototype.OnNextImage=function(){var t=this,i=n.one(".icon-nextImage-grey");(n.Errors.ClearErrorInfo(t._stwain),i&&i.getEL())||t.next()};t.prototype.next=function(){var n=this,t,i=n.GetHowManyImagesInBuffer();if(i<=0){r.output(n,"No image in Buffer");return}i!=1&&(t=n.GetCurrentIndex()+1,t>=i&&(t=i-1),t!=n.GetCurrentIndex()&&n.go(t))};t.prototype.go=function(n){var t=this;if(t.GetHowManyImagesInBuffer()<=0){r.output(t,"No image in Buffer");return}if(t._IfChangedWithinTheEditor==!0){t.ShowDialogForSaveImage(n,!1);return}t.__goInner(n)};t.prototype.__goInner=function(n){var t=this;if(typeof n!="undefined"){if(n==-1)return!1;t.bShowImageEdit&&(t.bCouldBeTimeConsuming=!0);Dynamsoft.Lib.showMask();t.SetCurrentIndex(n)}return t.bShowImageEdit&&(t.updateMode(),t.BackImageData()),!0};t.prototype.OnAcquire=function(){var t=this,i=function(){t._stwain.SelectSource(function(){t._stwain.CloseSource();t._stwain.OpenSource();t._stwain.IfShowUI=!0;Dynamsoft.WebTwainEnv.IfConfineMaskWithinTheViewer==!0?(Dynamsoft.WebTwainEnv.IfConfineMaskWithinTheViewer=!1,t._stwain.AcquireImage({},function(){Dynamsoft.WebTwainEnv.IfConfineMaskWithinTheViewer=!0;window.onresize==null&&(window.onresize=function(){t.ShowImageEditorEx(-1,-1,-1,-1)})},function(){window.onresize==null&&(window.onresize=function(){t.ShowImageEditorEx(-1,-1,-1,-1)})})):t._stwain.AcquireImage()},function(){n.log("User did not select a source")})};n.Errors.ClearErrorInfo(t._stwain);t._IfChangedWithinTheEditor?t.ShowDialogForSaveImage(t.GetCurrentIndex(),!1,i,i):i()};t.prototype.OnLoadImage=function(){var t=this,i=null,r=function(){var f,e,o,r,u,s;if(t._stwain._isMobileMode()){f=document.getElementById(t.dwtMobileFileId);f.value="";f.click();return}e=function(){n.log("Loaded an image successfully.");i!=null&&t._stwain.Addon.PDF.SetConvertMode(i)};o=function(r,u){n.log("Loading failed with the error: "+u);i!=null&&t._stwain.Addon.PDF.SetConvertMode(i)};t._stwain.IfShowFileDialog=!0;t._stwain.Addon&&t._stwain.Addon.PDF&&(r=!1,s=t._stwain._isMobileMode()?n.License.checkProductKey(t._stwain,{PDFRasterizer:!0,Wasm:!0},!0):n.License.checkProductKey(t._stwain,{PDFRasterizer:!0},!0),s&&(i=t._stwain.Addon.PDF.GetConvertMode(),u=t._stwain._innerFun("GetAddOnVersion",Dynamsoft.Lib.html5.Funs.makeParams("pdf")),n.env.bMac&&u==Dynamsoft.PdfMacVersion?r=!0:n.env.bLinux&&u==Dynamsoft.PdfLinuxVersion?r=!0:u==Dynamsoft.PdfVersion&&(r=!0),r&&t._stwain.Addon.PDF.SetConvertMode(1)));t._stwain.LoadImageEx("",5,e,o)};n.Errors.ClearErrorInfo(t._stwain);t._IfChangedWithinTheEditor?t.ShowDialogForSaveImage(t.GetCurrentIndex(),!1,r,r):r()};t.prototype.OnPrint=function(){var t=this;if(n.Errors.ClearErrorInfo(t._stwain),t.GetCurrentIndex()<0){r.output(t,"No image in Buffer");return}t._UIView.Print()};t.prototype.OnRemoveAll=function(){var t=this;if(n.Errors.ClearErrorInfo(t._stwain),t.GetHowManyImagesInBuffer()<=0){r.output(t,"No image in Buffer");return}t._stwain.RemoveAllImages()};t.prototype.OnRemove=function(){var t=this;if(n.Errors.ClearErrorInfo(t._stwain),t.GetHowManyImagesInBuffer()<=0){r.output(t,"No image in Buffer");return}t._stwain.RemoveAllSelectedImages()};t.prototype.OnRotateLeft=function(){var t=this;if(n.Errors.ClearErrorInfo(t._stwain),t.GetHowManyImagesInBuffer()<=0){r.output(t,"No image in Buffer");return}t._ImgManager.bImageChangedInViewer==!0?(t._IfSaveChangesOutSideOfTheEditor=!0,t.__SaveImageInner(!1,function(){t.bCouldBeTimeConsuming=!0;Dynamsoft.Lib.showMask();t._ImgManager.bImageJustChangedInEditor=!0;t.bMobile_function?(t.DVSRotate(270),t.UpdateInfo()):t._stwain.RotateLeft(t.GetCurrentIndex());t._IfChangedWithinTheEditor=!0;t.iChangedIndex=t.GetCurrentIndex()})):(t.bCouldBeTimeConsuming=!0,Dynamsoft.Lib.showMask(),t._IfSaveChangesOutSideOfTheEditor=!1,t._ImgManager.bImageJustChangedInEditor=!0,t._IfChangedWithinTheEditor=!0,t.iChangedIndex=t.GetCurrentIndex(),t.bMobile_function?(t.DVSRotate(270),t.UpdateInfo()):t._stwain.RotateLeft(t.GetCurrentIndex()));t.updateMode()};t.prototype.Rotate=function(n,t){var i=this;if(i.GetHowManyImagesInBuffer()<=0){r.output(i,"No image in Buffer");return}typeof n=="undefined"||typeof t=="undefined"?alert(u.CustomizableDisplayInfo.errorMessages.insufficientParas):i._ImgManager.bImageChangedInViewer==!0?(i._IfSaveChangesOutSideOfTheEditor=!0,i.__SaveImageInner(!1,function(){i.bCouldBeTimeConsuming=!0;Dynamsoft.Lib.showMask();i._stwain.Rotate(i.GetCurrentIndex(),n,t);i._ImgManager.bImageJustChangedInEditor=!0;i._IfChangedWithinTheEditor=!0;i.iChangedIndex=i.GetCurrentIndex()})):(i.bCouldBeTimeConsuming=!0,Dynamsoft.Lib.showMask(),i._IfSaveChangesOutSideOfTheEditor=!1,i._stwain.Rotate(i.GetCurrentIndex(),n,t),i._ImgManager.bImageJustChangedInEditor=!0,i._IfChangedWithinTheEditor=!0,i.iChangedIndex=i.GetCurrentIndex());i.updateMode()};t.prototype.RotateEx=function(n,t,i){var f=this;if(f.GetHowManyImagesInBuffer()<=0){r.output(f,"No image in Buffer");return}typeof n=="undefined"||typeof t=="undefined"||typeof i=="undefined"?alert(u.CustomizableDisplayInfo.errorMessages.insufficientParas):f._ImgManager.bImageChangedInViewer==!0?(f._IfSaveChangesOutSideOfTheEditor=!0,f.__SaveImageInner(!1,function(){f.bCouldBeTimeConsuming=!0;Dynamsoft.Lib.showMask();f._ImgManager.bImageJustChangedInEditor=!0;f._stwain.RotateEx(f.GetCurrentIndex(),n,t,i);f._IfChangedWithinTheEditor=!0;f.iChangedIndex=f.GetCurrentIndex()})):(f.bCouldBeTimeConsuming=!0,Dynamsoft.Lib.showMask(),f._IfSaveChangesOutSideOfTheEditor=!1,f._ImgManager.bImageJustChangedInEditor=!0,f._IfChangedWithinTheEditor=!0,f.iChangedIndex=f.GetCurrentIndex(),f._stwain.RotateEx(f.GetCurrentIndex(),n,t,i));f.updateMode()};t.prototype.OnRotate=function(t){var i=this,a,o,v,y,s,f,h,c,l;if(n.Errors.ClearErrorInfo(i._stwain),i.GetHowManyImagesInBuffer()<=0){r.output(i,"No image in Buffer");return}n.hide("dynamsoft_ImgSizeEditor");n.get("dynamsoft_RotateAnyAngle")||(a=['<div id="dynamsoft_RotateAnyAngle" class="dynamsoft-dwt-imgSizeEditor" style="display:none; z-index: 99999;">',"<ul>",'<li><label for="dynamsoft_Angle"><b>',u.CustomizableDisplayInfo.dialogText.dlgRotateAnyAngle[0],'<\/b><input type="text" id="dynamsoft_Angle" style="width:50%;" size="10"/><\/label><\/li>','<li><label for="dynamsoft_Angle_InterpolationMethod"><b>',u.CustomizableDisplayInfo.dialogText.dlgRotateAnyAngle[1],'<\/b>&nbsp;<select size="1" id="dynamsoft_Angle_InterpolationMethod"><option value = ""><\/option><\/select><\/li>','<li><label for="dynamsoft_KeepSize"><b><\/b>','<input type="checkbox" id="dynamsoft_KeepSize"/>',u.CustomizableDisplayInfo.dialogText.dlgRotateAnyAngle[2],"<\/label><\/li><\/ul>","<div>",'<input id="dynamsoft_btnRotateAnyAngleOK" type="button" value="',u.CustomizableDisplayInfo.dialogText.dlgRotateAnyAngle[3],'"/><span><input id= "dynamsoft_btnCancelRotateAnyAngle" type="button" value="',u.CustomizableDisplayInfo.dialogText.dlgRotateAnyAngle[4],'" /><\/span><\/div>',"<\/div>"],n.one("body").append(a.join("")));o=n.get("dynamsoft_Angle_InterpolationMethod");o.options.length=0;o.options.add(new Option("NearestNeighbor",1));o.options.add(new Option("Bilinear",2));o.options.add(new Option("Bicubic",3));o=null;v=n.get("dynamsoft_btnRotateAnyAngleOK");v.onclick=function(){var t=n.get("dynamsoft_Angle").value,r,f,e,o,s;if(n.get("dynamsoft_Angle").className="",r=/^\d+$/,!r.test(t)||t<=0){n.get("dynamsoft_Angle").className+=" invalid";n.get("dynamsoft_Angle").focus();alert(u.CustomizableDisplayInfo.errorMessages.invalidAngle);return}if(f=n.get("dynamsoft_KeepSize"),e=f.checked,i.bCouldBeTimeConsuming=!0,Dynamsoft.Lib.showMask(),o=parseInt(t),s=i.RotateEx(o,e,n.get("dynamsoft_Angle_InterpolationMethod").selectedIndex+1),i._stwain.ErrorCode==0){n.hide("dynamsoft_RotateAnyAngle");return}};y=n.get("dynamsoft_btnCancelRotateAnyAngle");y.onclick=function(){n.hide("dynamsoft_RotateAnyAngle")};s=n.get("dynamsoft_RotateAnyAngle");n.toggle("dynamsoft_RotateAnyAngle");f=t.srcElement||t.target;h=f.y;h||(h=f.offsetTop+1);c=f.x;c||(c=f.offsetLeft+1);i.UIEditor&&i.UIEditor.nodeName=="DIV"?(s.style.top=h+f.offsetHeight+document.documentElement.scrollTop+"px",s.style.left=c+document.documentElement.scrollLeft+"px"):(l=e.getElementById(i.UIEditor),s.style.top=h+f.offsetHeight+r.getTop(l)+"px",s.style.left=c+r.getLeft(l)+"px");n.get("dynamsoft_Angle").value="45"};t.prototype.OnRotateRight=function(){var t=this;if(n.Errors.ClearErrorInfo(t._stwain),t.GetHowManyImagesInBuffer()<=0){r.output(t,"No image in Buffer");return}t._ImgManager.bImageChangedInViewer==!0?(t._IfSaveChangesOutSideOfTheEditor=!0,t.__SaveImageInner(!1,function(){t.bCouldBeTimeConsuming=!0;Dynamsoft.Lib.showMask();t.bMobile_function?(t.DVSRotate(90),t.UpdateInfo()):t._stwain.RotateRight(t.GetCurrentIndex());t._ImgManager.bImageJustChangedInEditor=!0;t._IfChangedWithinTheEditor=!0;t.iChangedIndex=t.GetCurrentIndex()})):(t.bCouldBeTimeConsuming=!0,Dynamsoft.Lib.showMask(),t._IfSaveChangesOutSideOfTheEditor=!1,t._ImgManager.bImageJustChangedInEditor=!0,t._IfChangedWithinTheEditor=!0,t.iChangedIndex=t.GetCurrentIndex(),t.bMobile_function?(t.DVSRotate(90),t.UpdateInfo()):t._stwain.RotateRight(t.GetCurrentIndex()));t.updateMode()};t.prototype.OnDeskew=function(){var t=this;if(n.Errors.ClearErrorInfo(t._stwain),t.GetHowManyImagesInBuffer()<=0){r.output(t,"No image in Buffer");return}t._ImgManager.bImageChangedInViewer==!0?(t._IfSaveChangesOutSideOfTheEditor=!0,t.__SaveImageInner(!1,function(){t.bCouldBeTimeConsuming=!0;Dynamsoft.Lib.showMask();t._stwain._isMobileMode()?t._stwain.GetSkewAngle(t.GetCurrentIndex(),function(i){t.RotateEx(i,!0,1);n.log("Mobile_GetSkewAngle:"+i)}):t.RotateEx(t._stwain.GetSkewAngle(t.GetCurrentIndex()),!0,1);t._ImgManager.bImageJustChangedInEditor=!0;t._IfChangedWithinTheEditor=!0;t.iChangedIndex=t.GetCurrentIndex()})):(t.bCouldBeTimeConsuming=!0,Dynamsoft.Lib.showMask(),t._IfSaveChangesOutSideOfTheEditor=!1,t._ImgManager.bImageJustChangedInEditor=!0,t._IfChangedWithinTheEditor=!0,t.iChangedIndex=t.GetCurrentIndex(),t._stwain._isMobileMode()?t._stwain.GetSkewAngle(t.GetCurrentIndex(),function(i){t.RotateEx(i,!0,1);n.log("Mobile_GetSkewAngle:"+i)}):t.RotateEx(t._stwain.GetSkewAngle(t.GetCurrentIndex()),!0,1))};t.prototype.OnCrop=function(){var i=this,t;n.Errors.ClearErrorInfo(i._stwain);t=n.one(".icon-cropImage");t&&t.getEL()&&i.Crop()};t.prototype.Crop=function(){var n=this,o;if(n.GetHowManyImagesInBuffer()<=0){r.output(n,"No image in Buffer");return}if(o=n.actualSelectedCanvasAreas,o.length!=2){r.output(n,"No area selected for cropping");return}var e=o[1],t=e.left,i=e.top,u=e.right,f=e.bottom;parseInt(t)-parseInt(u)!=0&&parseInt(i)-parseInt(f)!=0&&(n._ImgManager.bImageChangedInViewer==!0?(n._IfSaveChangesOutSideOfTheEditor=!0,n.__SaveImageInner(!1,function(){n.bCouldBeTimeConsuming=!0;Dynamsoft.Lib.showMask();n.bMobile_function?(n.DVSCrop(parseInt(t),parseInt(i),parseInt(u),parseInt(f)),n.UpdateInfo()):n._stwain.Crop(n.GetCurrentIndex(),parseInt(t),parseInt(i),parseInt(u),parseInt(f));n._ImgManager.bImageJustChangedInEditor=!0;n.__SetCropButtonGrey(!0);n.__SetEraseButtonGrey(!0);n._IfChangedWithinTheEditor=!0;n.iChangedIndex=n.GetCurrentIndex()})):(n.bCouldBeTimeConsuming=!0,Dynamsoft.Lib.showMask(),n._IfSaveChangesOutSideOfTheEditor=!1,n._ImgManager.bImageJustChangedInEditor=!0,n._IfChangedWithinTheEditor=!0,n.iChangedIndex=n.GetCurrentIndex(),n.bMobile_function?(n.DVSCrop(parseInt(t),parseInt(i),parseInt(u),parseInt(f)),n.UpdateInfo()):n._stwain.Crop(n.GetCurrentIndex(),parseInt(t),parseInt(i),parseInt(u),parseInt(f)),n.__SetCropButtonGrey(!0),n.__SetEraseButtonGrey(!0)),n.updateMode())};t.prototype.OnErase=function(){var t=this,i=n.one(".icon-erase");n.Errors.ClearErrorInfo(t._stwain);i&&i.getEL()&&t.Erase()};t.prototype.Erase=function(){var n=this,t=!1,i,u;if(n.GetHowManyImagesInBuffer()<=0){r.output(n,"No image in Buffer");return}if(i=n.actualSelectedCanvasAreas,i.length==1){r.output(n,"No area selected for erasing");return}if(n._ImgManager.bImageChangedInViewer==!0)n._IfSaveChangesOutSideOfTheEditor=!0,n.__SaveImageInner(!1,function(){for(var r=1;r<i.length;r++){var u=i[r],f=u.left,e=u.top,o=u.right,s=u.bottom;parseInt(f)-parseInt(o)!=0&&parseInt(e)-parseInt(s)!=0&&(n.bCouldBeTimeConsuming=!0,Dynamsoft.Lib.showMask(),n.bMobile_function?(n.DVSErase(parseInt(f),parseInt(e),parseInt(o),parseInt(s)),n.UpdateInfo()):n._stwain.Erase(n.GetCurrentIndex(),parseInt(f),parseInt(e),parseInt(o),parseInt(s)),n._ImgManager.bImageJustChangedInEditor=!0,n._IfChangedWithinTheEditor=!0,n.iChangedIndex=n.GetCurrentIndex(),t=!0)}n.__SetEraseButtonGrey(t);n.__SetCropButtonGrey(t)});else{for(n._IfSaveChangesOutSideOfTheEditor=!1,n._IfChangedWithinTheEditor=!0,n.iChangedIndex=n.GetCurrentIndex(),u=1;u<i.length;u++){var f=i[u],e=f.left,o=f.top,s=f.right,h=f.bottom;parseInt(e)-parseInt(s)!=0&&parseInt(o)-parseInt(h)!=0&&(n.bCouldBeTimeConsuming=!0,Dynamsoft.Lib.showMask(),n.bMobile_function?(n.DVSErase(parseInt(e),parseInt(o),parseInt(s),parseInt(h)),n.UpdateInfo()):n._stwain.Erase(n.GetCurrentIndex(),parseInt(e),parseInt(o),parseInt(s),parseInt(h)),n._ImgManager.bImageJustChangedInEditor=!0,n._IfChangedWithinTheEditor=!0,n.iChangedIndex=n.GetCurrentIndex(),t=!0)}n.__SetEraseButtonGrey(t);n.__SetCropButtonGrey(t)}n.updateMode()};t.prototype.ChangeImageSize=function(n,t,i){var u=this;if(u.GetHowManyImagesInBuffer()<=0){r.output(u,"No image in Buffer");return}u._ImgManager.bImageChangedInViewer==!0?(u._IfSaveChangesOutSideOfTheEditor=!0,u.__SaveImageInner(!1,function(){u.bCouldBeTimeConsuming=!0;Dynamsoft.Lib.showMask();u._stwain.ChangeImageSize(u.GetCurrentIndex(),n,t,i);u._ImgManager.bImageJustChangedInEditor=!0;u._IfChangedWithinTheEditor=!0;u.iChangedIndex=u.GetCurrentIndex()})):(u.bCouldBeTimeConsuming=!0,Dynamsoft.Lib.showMask(),u._IfSaveChangesOutSideOfTheEditor=!1,u._ImgManager.bImageJustChangedInEditor=!0,u._IfChangedWithinTheEditor=!0,u.iChangedIndex=u.GetCurrentIndex(),u._stwain.ChangeImageSize(u.GetCurrentIndex(),n,t,i));u.updateMode()};t.prototype.OnChangeImageSize=function(t){var i=this,y,o,p,w,s,b,f,h,c,a,l,v;if(n.Errors.ClearErrorInfo(i._stwain),i.GetHowManyImagesInBuffer()<=0){r.output(i,"No image in Buffer");return}return(n.hide("dynamsoft_RotateAnyAngle"),n.get("dynamsoft_ImgSizeEditor")||(y=['<div id="dynamsoft_ImgSizeEditor" class="dynamsoft-dwt-imgSizeEditor" style="display:none;z-index: 99999;">',"<ul>",'<li><label for="dynamsoft_img_height"><b>',u.CustomizableDisplayInfo.dialogText.dlgChangeImageSize[0],'<\/b><input type="text" id="dynamsoft_img_height" style="width:50%;" size="10"/>pixel<\/label><\/li>','<li><label for="dynamsoft_img_width"><b>',u.CustomizableDisplayInfo.dialogText.dlgChangeImageSize[1],'<\/b>&nbsp;<input type="text" id="dynamsoft_img_width" style="width:50%;" size="10"/>pixel<\/label><\/li>',"<li>",u.CustomizableDisplayInfo.dialogText.dlgChangeImageSize[2],'<select size="1" id="dynamsoft_InterpolationMethod"><option value = ""><\/option><\/select><\/li>',"<\/ul>","<div>",'<input id="dynamsoft_btnChangeImageSizeOK" type="button" value="',u.CustomizableDisplayInfo.dialogText.dlgChangeImageSize[3],'"/><span><input id= "dynamsoft_btnCancelChange" type="button" value="',u.CustomizableDisplayInfo.dialogText.dlgChangeImageSize[4],'"/><\/span><\/div>',"<\/div>"],n.one("body").append(y.join(""))),o=n.get("dynamsoft_InterpolationMethod"),o.options.length=0,o.options.add(new Option("NearestNeighbor",1)),o.options.add(new Option("Bilinear",2)),o.options.add(new Option("Bicubic",3)),o=null,p=n.get("dynamsoft_btnChangeImageSizeOK"),p.onclick=function(){var t=n.get("dynamsoft_img_width").value,r=n.get("dynamsoft_img_height").value,f,e;if(n.get("dynamsoft_img_width").className="",n.get("dynamsoft_img_height").className="",f=/^\d+$/,!f.test(r)||r<=0){n.get("dynamsoft_img_height").className+=" invalid";n.get("dynamsoft_img_height").focus();alert(u.CustomizableDisplayInfo.errorMessages.invalidHeightOrWidth);return}if(!f.test(t)||t<=0){n.get("dynamsoft_img_width").className+=" invalid";n.get("dynamsoft_img_width").focus();alert(u.CustomizableDisplayInfo.errorMessages.invalidHeightOrWidth);return}if(e=i.ChangeImageSize(t,r,n.get("dynamsoft_InterpolationMethod").selectedIndex+1),i._stwain.ErrorCode==0){n.hide("dynamsoft_ImgSizeEditor");return}},w=n.get("dynamsoft_btnCancelChange"),w.onclick=function(){n.hide("dynamsoft_ImgSizeEditor")},s=n.get("dynamsoft_ImgSizeEditor"),n.toggle("dynamsoft_ImgSizeEditor"),f=t.srcElement||t.target,h=f.y,h||(h=f.offsetTop+1),c=f.x,c||(c=f.offsetLeft+1),i.UIEditor&&i.UIEditor.nodeName=="DIV"?(s.style.top=h+f.offsetHeight+document.documentElement.scrollTop+"px",s.style.left=c+document.documentElement.scrollLeft+"px"):(a=e.getElementById(i.UIEditor),s.style.top=h+f.offsetHeight+r.getTop(a)+"px",s.style.left=c+r.getLeft(a)+"px"),l=i.GetCurrentIndex(),v=i.getImageManager().convertClientIndexToServerId(l),v==-1)?!1:(b=i._UIView.mapModelImageControl[v],b)?(n.get("dynamsoft_img_width").value=i.getImageManager().GetImageWidth(l),n.get("dynamsoft_img_height").value=i.getImageManager().GetImageHeight(l),!0):!1};t.prototype.OnFlip=function(){var t=this;if(n.Errors.ClearErrorInfo(t._stwain),t.GetHowManyImagesInBuffer()<=0){r.output(t,"No image in Buffer");return}t._ImgManager.bImageChangedInViewer==!0?(t._IfSaveChangesOutSideOfTheEditor=!0,t.__SaveImageInner(!1,function(){t.bCouldBeTimeConsuming=!0;Dynamsoft.Lib.showMask();t.bMobile_function?(t.DVSFlip(),t.UpdateInfo()):t._stwain.Flip(t.GetCurrentIndex());t._ImgManager.bImageJustChangedInEditor=!0;t._IfChangedWithinTheEditor=!0;t.iChangedIndex=t.GetCurrentIndex()})):(t.bCouldBeTimeConsuming=!0,Dynamsoft.Lib.showMask(),t._IfSaveChangesOutSideOfTheEditor=!1,t._ImgManager.bImageJustChangedInEditor=!0,t._IfChangedWithinTheEditor=!0,t.iChangedIndex=t.GetCurrentIndex(),t.bMobile_function?(t.DVSFlip(),t.UpdateInfo()):t._stwain.Flip(t.GetCurrentIndex()));t.updateMode()};t.prototype.OnMirror=function(){var t=this;if(n.Errors.ClearErrorInfo(t._stwain),t.GetHowManyImagesInBuffer()<=0){r.output(t,"No image in Buffer");return}t._ImgManager.bImageChangedInViewer==!0?(t._IfSaveChangesOutSideOfTheEditor=!0,t.__SaveImageInner(!1,function(){t.bCouldBeTimeConsuming=!0;Dynamsoft.Lib.showMask();t.bMobile_function?(t.DVSMirror(),t.UpdateInfo()):t._stwain.Mirror(t.GetCurrentIndex());t._ImgManager.bImageJustChangedInEditor=!0;t._IfChangedWithinTheEditor=!0;t.iChangedIndex=t.GetCurrentIndex()})):(t.bCouldBeTimeConsuming=!0,Dynamsoft.Lib.showMask(),t._IfSaveChangesOutSideOfTheEditor=!1,t._ImgManager.bImageJustChangedInEditor=!0,t._IfChangedWithinTheEditor=!0,t.iChangedIndex=t.GetCurrentIndex(),t.bMobile_function?(t.DVSMirror(),t.UpdateInfo()):t._stwain.Mirror(t.GetCurrentIndex()));t.updateMode()};t.prototype.OnZoomin=function(){var t=this,f=n.one(".icon-zoomin-grey"),i;if(!f||!f.getEL()){if(n.Errors.ClearErrorInfo(t._stwain),t.GetHowManyImagesInBuffer()<=0){r.output(t,"No image in Buffer");return}t._UIView?(t._UIView.bSingleMode=!0,i=Math.floor(t.GetZoom()*100*t._UIView.zoomInStep)+1,!i||1<i&&i<2501?(t.ZoomIn(),t.__SetZoomInButtonEnable(!0)):(alert(u.CustomizableDisplayInfo.errorMessages.limitReachedForZoomIn),t.__SetZoomInButtonEnable(!1)),t.__SetZoomOutButtonEnable(!0)):(t.__SetZoomInButtonEnable(!1),t.__SetZoomOutButtonEnable(!0));t.__SetCropButtonGrey(!0);t.__SetEraseButtonGrey(!0)}};t.prototype.OnOriginalsize=function(){var t=this;if(n.Errors.ClearErrorInfo(t._stwain),t.GetHowManyImagesInBuffer()<=0){r.output(t,"No image in Buffer");return}t._UIView&&(t._UIView.bSingleMode=!0,t.SetFitType(5));t.__SetZoomInButtonEnable(!0);t.__SetZoomOutButtonEnable(!0);t.__SetCropButtonGrey(!0);t.__SetEraseButtonGrey(!0);return};t.prototype.OnZoomout=function(){var t=this,f=n.one(".icon-zoomout-grey"),i;if(!f||!f.getEL()){if(n.Errors.ClearErrorInfo(t._stwain),t.GetHowManyImagesInBuffer()<=0){r.output(t,"No image in Buffer");return}t._UIView?(t._UIView.bSingleMode=!0,i=Math.floor(t.GetZoom()*100*t._UIView.zoomOutStep)-1,!i||1<i&&i<6501?(t.ZoomOut(),t.__SetZoomOutButtonEnable(!0)):(alert(u.CustomizableDisplayInfo.errorMessages.limitReachedForZoomOut),t.__SetZoomOutButtonEnable(!1)),t.__SetZoomInButtonEnable(!0)):(t.__SetZoomOutButtonEnable(!1),t.__SetZoomInButtonEnable(!0));t.__SetCropButtonGrey(!0);t.__SetEraseButtonGrey(!0)}};t.prototype.OnStretch=function(){var t=this;if(n.Errors.ClearErrorInfo(t._stwain),t.GetHowManyImagesInBuffer()<=0){r.output(t,"No image in Buffer");return}t._UIView&&(t._UIView.bSingleMode=!0,t._UIView.SetIfFitWindowAndType(4));t.__SetZoomInButtonEnable(!0);t.__SetZoomOutButtonEnable(!0);t.__SetCropButtonGrey(!0);t.__SetEraseButtonGrey(!0)};t.prototype.OnFitPage=function(){var t=this;if(n.Errors.ClearErrorInfo(t._stwain),t.GetHowManyImagesInBuffer()<=0){r.output(t,"No image in Buffer");return}t._UIView&&(t._UIView.bSingleMode=!0,t._UIView.SetIfFitWindowAndType(0));t.__SetZoomInButtonEnable(!0);t.__SetZoomOutButtonEnable(!0);t.__SetCropButtonGrey(!0);t.__SetEraseButtonGrey(!0)};t.prototype.OnFitWidth=function(){var t=this;if(n.Errors.ClearErrorInfo(t._stwain),t.GetHowManyImagesInBuffer()<=0){r.output(t,"No image in Buffer");return}t._UIView&&(t._UIView.bSingleMode=!0,t._UIView.SetIfFitWindowAndType(2));t.__SetZoomInButtonEnable(!0);t.__SetZoomOutButtonEnable(!0);t.__SetCropButtonGrey(!0);t.__SetEraseButtonGrey(!0)};t.prototype.OnFitHeight=function(){var t=this;if(n.Errors.ClearErrorInfo(t._stwain),t.GetHowManyImagesInBuffer()<=0){r.output(t,"No image in Buffer");return}t._UIView&&(t._UIView.bSingleMode=!0,t._UIView.SetIfFitWindowAndType(1));t.__SetZoomInButtonEnable(!0);t.__SetZoomOutButtonEnable(!0);t.__SetCropButtonGrey(!0);t.__SetEraseButtonGrey(!0);return};t.prototype.OnHand=function(){var n=this,t=EnumDWT_MouseShape.Hand;n.SetMouseSelectInner(t)};t.prototype.OnSelect=function(){var n=this,t=EnumDWT_MouseShape.Crosshair;n.SetMouseSelectInner(t)};t.prototype.OnClicktozoomin=function(){var n=this,t=EnumDWT_MouseShape.Zoom;n.SetMouseSelectInner(t)};t.prototype.SetMouseSelectInner=function(t){var i=this;if(n.Errors.ClearErrorInfo(i._stwain),i.GetHowManyImagesInBuffer()<=0){r.output(i,"No image in Buffer");return}if(i._ImgManager._isNoUI()||i.SetMouseShape(t),i.__EnableMouseShapButtons(t),i.bMobile)switch(t){case EnumDWT_MouseShape.Crosshair:i.cursorStatus="rectselect";break;case EnumDWT_MouseShape.Zoom:i.cursorStatus="zoom";break;default:i.cursorStatus="hand"}else switch(t){case EnumDWT_MouseShape.Hand:i.cursorStatus="hand";break;case EnumDWT_MouseShape.Zoom:i.cursorStatus="zoom";break;default:i.cursorStatus="rectselect"}};t.prototype.OnRestore=function(){var t=this,i=n.one(".icon-saveImage-grey");if(!i||!i.getEL()){if(n.Errors.ClearErrorInfo(t._stwain),t.GetHowManyImagesInBuffer()<=0){r.output(t,"No image in Buffer");return}t.__RestoreImageInner(-1)}};t.prototype.__RestoreImageInner=function(t,i){var r=this,e,u,f;if(r.iChangedIndex==-1){r._IfChangedWithinTheEditor=!1;i&&i();return}e=function(u,f,e){var o;if(n.log("__RestoreImageInner: "+[u.guid].join(",")),r.GetCurrentIndex()==f&&(r._stwain._isMobileMode()?r.MobileUpdateImage(u,e):r.UpdateImage(u,e)),r._IfChangedWithinTheEditor=!1,r.iChangedIndex=-1,o=u.serverId,o==-1)return r.updateButtons(),i&&i(),!1;if(r.updateButtons(),t==-1&&(o=r.getImageManager().convertClientIndexToServerId(r.GetCurrentIndex()),o==-1))return n.Errors.IndexOutOfRange(r._stwain),i&&i(),!1;i&&i()};u=!0;r._IfChangedWithinTheEditor==!0&&(f=r.getImageManager().convertClientIndexToServerId(r.iChangedIndex),f!=-1&&r.OnGetImageFromServerForEdit(r._UIView.mapModelImageControl[f],r.iChangedIndex,1,e),u=!1);u&&(r._IfChangedWithinTheEditor=!1,i&&i())};t.prototype.OnGetImageFromServerForEdit=function(t,i,r,u){var e=this,h,s,o;if(u&&e._UIView.BaseUrl){if(s=e.getImageManager().convertClientIndexToServerId(i),s==-1)return!1;e.SetCurrentIndex(i);e._stwain._isMobileMode()?r==1?(o=e.mydvs.getMetaDataByIndex(i),o&&(o.imageWidth=e.BackModelImageControl.imageWidth,o.imageHeight=e.BackModelImageControl.imageHeight,o.imageBitDepth=e.BackModelImageControl.imageBitDepth,o.imageXResolution=e.BackModelImageControl.imageXResolution,o.imageYResolution=e.BackModelImageControl.imageYResolution),t.ticks=Date.now(),t.imageUrl=e.BackImageBuffer,u(t,i,{metaData:o})):(e.bMobile_function&&e.DVSSaveTransformResult(),e.BackImageData(),u(null,-1,null)):(h=f.getUrlByAct(e._UIView.BaseUrl,s,r),n.ajax({method:"GET",url:h,onSuccess:function(){var r,n;t.ticks=Date.now();t.imageUrl=f.getImageUrl(e._UIView.BaseUrl,s,-1,-1,t.ticks);t.minImageUrl=f.getImageUrl(e._UIView.BaseUrl,s,parseInt(t.iImageControlWidth),parseInt(t.iImageControlHeight),t.ticks);r=e.mydvs.getMetaDataByIndex(i);r&&(n=e._UIView.GetDataImageControl(s),r.imageWidth=n&&n.imageWidth?n.imageWidth:e._stwain.GetImageWidth(i),r.imageHeight=n&&n.imageHeight?n.imageHeight:e._stwain.GetImageHeight(i));u(t,i,r)},onError:function(){}}))}return!0};t.prototype.OnSave=function(){var t=this,i=n.one(".icon-saveImage-grey");if(!i||!i.getEL()){if(n.Errors.ClearErrorInfo(t._stwain),t.GetHowManyImagesInBuffer()<=0){r.output(t,"No image in Buffer");return}t.__SaveImageInner(!0,function(){var i=t.getImageManager().convertClientIndexToServerId(t.GetCurrentIndex());if(i==-1)return n.Errors.IndexOutOfRange(t._stwain),!1})}};t.prototype.OnClose=function(){var t=this,i,r;if(n.Errors.ClearErrorInfo(t._stwain),t._IfChangedWithinTheEditor==!0){t.ShowDialogForSaveImage(-1,!0);return}t.UIEditor&&t.UIEditor.nodeName=="DIV"?(t.UIEditor.childNodes.length>0&&(i=document.getElementById(t.iContainerId),i&&i.appendChild(t.UIEditor.childNodes[0]),t.UIEditor.parentNode.removeChild(t.UIEditor),t.SetWidthInner(t.WebviewerWidth),t.SetHeightInner(t.WebviewerHeight)),r=document.getElementById("wrapper"),r&&(r.style.display="")):t.UnbindContent();t.bShowImageEdit=!1;t.bShowImageEditForFullScreen=!1;t.CloseShowImageEditor();t.mydvs.off("topImageChange");t.ThumbnailScrollTo(t.GetCurrentIndex());t.mydvs.on("topImageChange",function(n,i){t.topImageChange(n,i)});n.hide("dynamsoft_ImgSizeEditor");n.hide("dynamsoft_RotateAnyAngle");window.onresize=null;document.body.style.overflow="";n.isFunction(t._stwain.__CloseImageEditorUI)&&t._stwain.__CloseImageEditorUI()};t.prototype.__EnableMouseShapButtons=function(n){var t=this;t.ChangeButtonClass("hand","icon-hand");t.ChangeButtonClass("select","icon-select");t.ChangeButtonClass("clicktozoomin","icon-clicktozoomin");n==EnumDWT_MouseShape.Hand?t.ChangeButtonClass("hand","dynamsoft-dwt-EditorButton-selected"):n==EnumDWT_MouseShape.Crosshair?t.ChangeButtonClass("select","dynamsoft-dwt-EditorButton-selected"):n==EnumDWT_MouseShape.Zoom&&t.ChangeButtonClass("clicktozoomin","dynamsoft-dwt-EditorButton-selected")};t.prototype.topImageChange=function(n,t){var i=this;i.bShowImageEdit||i._UIView.__fireEvent("onTopImageInTheViewChanged",{index:n,bByScrollBar:t})};t.prototype.click=function(t){var i=this;i.bShowImageEdit?(n.hide("dynamsoft_ImgSizeEditor"),n.hide("dynamsoft_RotateAnyAngle")):i._UIView.__fireEvent("onMouseClick",{e:t,x:t.x,y:t.y,index:i.GetCurrentIndex()})};t.prototype.imageClick=function(n,t){var i=this;i.UpdateInfo();i._UIView.__fireEvent("onMouseClick",{e:t,x:t.x,y:t.y,index:n})};t.prototype.rightClick=function(n){var t=this;t.bShowImageEdit||t._UIView.__fireEvent("onMouseRightClick",{e:n,x:n.x,y:n.y,index:t.GetCurrentIndex()})};t.prototype.imageRightClick=function(n,t){var i=this;i._UIView.__fireEvent("onMouseRightClick",{e:t,x:t.x,y:t.y,index:n})};t.prototype.doubleClick=function(n){var t=this;t.bShowImageEdit||t._UIView.__fireEvent("onMouseDoubleClick",{e:n,x:n.x,y:n.y,index:t.GetCurrentIndex()})};t.prototype.imageDoubleClick=function(n,t){var i=this;i._UIView.__fireEvent("onMouseDoubleClick",{e:t,x:t.x,y:t.y,index:n})};t.prototype.move=function(n){var t=this;t.bShowImageEdit||t._UIView.__fireEvent("onMouseMove",{e:n,x:n.x,y:n.y,index:t.GetCurrentIndex()})};t.prototype.imageMove=function(n,t){var i=this;i._UIView.__fireEvent("onMouseMove",{e:t,x:t.x,y:t.y,index:n})};t.prototype.imageAreaSelected=function(n){var t=this,i=1;n.areaIndex&&(i=parseInt(n.areaIndex)+1);t.bShowImageEdit?(i>0&&i<t.actualSelectedCanvasAreas.length?t.actualSelectedCanvasAreas[i]={left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height}:i==t.actualSelectedCanvasAreas.length&&t.actualSelectedCanvasAreas.push({left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height}),t.actualSelectedCanvasAreas.length==2&&n.width>0&&n.height>0?(t.ChangeButtonClass("crop","icon-cropImage"),t.ChangeButtonClass("erase","icon-erase")):(t.__SetCropButtonGrey(!1),t.__SetEraseButtonGrey(!1))):t._UIView.__fireEvent("onImageAreaSelected",{index:n.index,left:parseInt(n.x),top:parseInt(n.y),right:parseInt(n.x+n.width),bottom:parseInt(n.y+n.height),areaIndex:i})};t.prototype.imageAreaUnselected=function(n){var t=this;t.bShowImageEdit?(t.actualSelectedCanvasAreas=[{left:0,top:0,right:0,bottom:0}],t.ChangeButtonClass("crop","icon-cropImage-grey"),t.ChangeButtonClass("erase","icon-erase-grey")):t._UIView.__fireEvent("onImageAreaDeSelected",n)};t.prototype.dragDone=function(t){var i=this;n.isFunction(i._stwain.__OnIndexChangeDragDropDone)&&i._stwain.__OnIndexChangeDragDropDone(t)};t.prototype.RegistLoadCallback=function(n){var t=this;return t._bRegistedLoad||(t.mydvs.setLoadCallback(n),t._bRegistedLoad=!0),!0};t.prototype.onDrop=function(t){var i=this,u,r,e=null,a=function(t){t&&n.html5.Funs2.output(null,t+" was loaded successfully!");e!=null&&i._stwain.Addon.PDF.SetConvertMode(e)},v=function(t,r,u){u&&n.html5.Funs2.output(null,u+" failed to load. Error code: "+t+"Error String: "+r);e!=null&&i._stwain.Addon.PDF.SetConvertMode(e)},h,o,f,s,l;try{for(h=t.dataTransfer.files,o=0;o<h.length;o++){u=h[o];switch(u.type){case"image/bmp":r=EnumDWT_ImageType.IT_BMP;break;case"image/jpeg":r=EnumDWT_ImageType.IT_JPG;break;case"image/tiff":r=EnumDWT_ImageType.IT_TIF;break;case"image/png":r=EnumDWT_ImageType.IT_PNG;break;case"application/pdf":r=EnumDWT_ImageType.IT_PDF;break;default:n.html5.Funs2.output(null,u.name+" failed to load because the file type is not supported!");r=-1;n.Errors.UnrecognizedExt(i._stwain)}r!=-1&&(n.showProgress(i._stwain,"DropLoading",!0),i._stwain._OnPercentDone([0,-1,Dynamsoft.MSG.Loading]),i._stwain.Addon&&i._stwain.Addon.PDF&&(f=!1,l=i._stwain._isMobileMode()?n.License.checkProductKey(i._stwain,{PDFRasterizer:!0,Wasm:!0},!0):n.License.checkProductKey(i._stwain,{PDFRasterizer:!0},!0),l&&(i._stwain._isMobileMode()?f=!0:(e=i._stwain.Addon.PDF.GetConvertMode(),s=i._stwain._innerFun("GetAddOnVersion",Dynamsoft.Lib.html5.Funs.makeParams("pdf")),n.env.bMac&&s==Dynamsoft.PdfMacVersion?f=!0:n.env.bLinux&&s==Dynamsoft.PdfLinuxVersion?f=!0:s==Dynamsoft.PdfVersion&&(f=!0)),f&&i._stwain.Addon.PDF.SetConvertMode(1))),i._stwain._isMobileMode()?i._stwain.LoadImageFromBinary(u,function(){Dynamsoft.Lib.closeProgress()},function(){Dynamsoft.Lib.closeProgress()}):i._stwain.__LoadImageFromBytes(u,r,"",!0,a,v,0,u.size))}}catch(c){n.log(c.stack||c,"error");setTimeout(function(){throw c;},0)}};t.prototype.getImageManager=function(){var n=this;return n._ImgManager};n.UI=n.UI||{};n.UI.WebViewer=t}});Dynamsoft.Ready(function(n){function f(u,f){var s={Stwain:u};if(!u._isNoUI()){var h,e=u._width,o=u._height,c=r;h=n.one("#"+u._containerID);n.isString(e)&&e.indexOf("%")>=0?(e=n.css(h,"width")*parseInt(e)/100,c=i):e=parseInt(e);n.isString(o)&&o.indexOf("%")>=0?(o=n.css(h,"height")*parseInt(o)/100,c=i):o=parseInt(o);s={Stwain:u,Container:f,Width:e,Height:o}}t.bindUIViewEvents(u,s);u._ImgManager?(u._ImgManager&&u._ImgManager._UIView&&u._ImgManager._UIView.BackgroundColor&&(s.BackgroundColor=u._ImgManager._UIView.BackgroundColor),u._ImgManager._Init(u,s)):u._ImgManager=new n.UI.ImageManager(u,s);c&&t.changeImageUISize(u,u._width,u._height)}function e(n,t){var i=t||{};n.__OnImageAreaDeSelected=i.onImageAreaDeSelected||"";n.__OnImageAreaSelected=i.onImageAreaSelected||"";n.__OnMouseClick=i.onMouseClick||"";n.__OnMouseDoubleClick=i.onMouseDoubleClick||"";n.__OnMouseMove=i.onMouseMove||"";n.__OnMouseRightClick=i.onMouseRightClick||"";n.__OnTopImageInTheViewChanged=i.onTopImageInTheViewChanged||""}var o=Dynamsoft;if(n.product.bHTML5Edition){var s=n.getNavInfo(),t=n.html5.Funs,r=!1,i=!0,u=function(t){var i,u;n.dlgProgress||n.initProgress();i=n.one(".dynamsoft-btnCancel");i&&i.getEL()&&(u=function(){var i=n.cancelFrome;n.closeProgress(0);i==1||i==2?n.bio&&(n.bio.abort(),n.bio=r):i==3||i==4?t.SetCancel():i==5&&n.isFunction(t.__OnCancel)&&t.__OnCancel()},n.addEventListener(i[0],"mousedown",u))};n.mix(t,{changeImageUISize:function(u,f,e){var o,c,v=f,y=e,l=r,s,h,a;return(o=n.one("#"+u._containerID),n.isString(f)&&f.indexOf("%")>=0?(s=n.css(o,"width"),s==0&&(o[0].style.width="100%"),s=n.css(o,"width")*parseInt(f)/100,l=i):(s=parseInt(f),v=[s+2,"px"].join("")),n.isString(e)&&e.indexOf("%")>=0?(h=n.css(o,"height"),h==0&&(o[0].style.height="100%"),h=n.css(o,"height")*parseInt(e)/100,l=i):(h=parseInt(e),y=[h+2,"px"].join("")),o&&(c=n.one(".dynamsoft-dwt-container-box",o),c&&c.getEL()&&(c.style("width",v),c.style("height",y))),l?(u.__funResize||(u.__funResize=function(){var n=t.__innerGetUIViewRealSize(u._containerID,u._width,u._height);return u._ImgManager?u._ImgManager.ChangeSize(n.width,n.height):i}),n.removeEventListener(window,"resize",u.__funResize),n.addEventListener(window,"resize",u.__funResize)):u.__funResize&&(n.removeEventListener(window,"resize",u.__funResize),u.__funResize=r),a=t.__innerGetUIViewRealSize(u._containerID,s,h),u._ImgManager)?u._ImgManager.ChangeSize(a.width,a.height):i},__innerGetUIViewRealSize:function(t,i,r){var e,u=-1,f=-1;return e=n.one("#"+t),n.isString(i)&&i.indexOf("%")>=0&&(u=n.css(e,"width")*parseInt(i)/100),u<0&&i&&(u=parseInt(i)),n.isString(r)&&r.indexOf("%")>=0&&(f=n.css(e,"height")*parseInt(r)/100),f<0&&r&&(f=parseInt(r)),{width:u,height:f}},bindUIViewEvents:function(r,u){var f=r,e;u.onSelected=function(t){if(!f._isNoUI()){var i=t.length,r;i>0&&(f._ImgManager.SetSelectedImageCount(i),r=t[i-1],e=!0,e&&n.isFunction(f.__OnRefreshUI)&&f.__OnRefreshUI(r))}};u.onRefreshUI=function(n){f._isNoUI()||t.__innerRefreshFromUIView(f,n)};u.onResetCurrentIndex=function(t){if(!f._isNoUI()){var i=f._ImgManager.getCurrentImageIndex();t>=0&&t<f._ImgManager.count()&&i!=t&&n.isFunction(f.__OnIndexChangeDuringDragDrop)&&f.__OnIndexChangeDuringDragDrop(i,t)}};u.onMouseMove=function(t){var i,r,u;f._isNoUI()||(i=t.index,t&&(r=t.x,u=t.y,f.__MouseX=r,f.__MouseY=u),n.isFunction(f.__OnMouseMove)&&f.__OnMouseMove(i))};u.onMouseClick=function(t){var i,r,u;f._isNoUI()||(i=t.index,t&&(r=t.x,u=t.y,f.__MouseX=r,f.__MouseY=u),n.isFunction(f.__OnMouseClick)&&f.__OnMouseClick(i))};u.onMouseDoubleClick=function(t){if(!f._isNoUI()){var i=t.index;n.isFunction(f.__OnMouseDoubleClick)&&f.__OnMouseDoubleClick(i)}};u.onMouseRightClick=function(t){var r,u,e;if(!f._isNoUI())return(r=t.index,t&&(u=t.x,e=t.y,f.__MouseX=u,f.__MouseY=e),n.isFunction(f.__OnMouseRightClick))?f.__OnMouseRightClick(r):i};u.onImageAreaSelected=function(t){f._isNoUI()||n.isFunction(f.__OnImageAreaSelected)&&f.__OnImageAreaSelected(t.index,t.left,t.top,t.right,t.bottom,t.areaIndex)};u.onImageAreaDeSelected=function(t){f._isNoUI()||n.isFunction(f.__OnImageAreaDeSelected)&&f.__OnImageAreaDeSelected(t)}},__innerRefreshFromUIView:function(t,i){var r=t;n.isFunction(r.__OnRefreshUI)&&r.__OnRefreshUI(i)}});n.html5.ui={init:function(t,i){var r;t._isNoUI()?t._containerID="":(t._containerID=i.containerID,t._width=i.width,t._height=i.height,u(t),r=n.one("#"+t._containerID));t._ifBindViewer=i.ifBindViewer;f(t,r);e(t,t.config);t.__OnMouseClick=i.onMouseClick||"";t.__OnMouseDoubleClick=i.onMouseDoubleClick||"";t.__OnMouseRightClick=i.onMouseRightClick||"";t.__OnMouseMove=i.onMouseMove||"";t.__OnImageAreaSelected=i.onImageAreaSelected||"";t.__OnImageAreaDeSelected=i.onImageAreaDeSelected||"";t.__OnRefreshUI=i.onRefreshUI||"";t.__MouseX=0;t.__MouseY=0;t.__style=new n.html5.STwainStyle(t);t.__fSelectionRectAspectRatio=0},unLoad:function(t){var r=t._containerID,i=n.get(r);i&&(i.innerHTML="")},addMethods:function(u){n.mix(u,{OverlayRectangle:function(t,i,r,u,f,e,o){var s=this,h;return(s._resetErr(),s._isNoUI())?s._nouiNotSupport("OverlayRectangle"):i>u||r>f||i==u&&r==f?(n.Errors.Overlay_InvalidLeftOrTopOrRightOrBottom(s),!1):(h=n.isNumber(e)?"#"+e.toString(16):e,s._ImgManager.OverlayRectangle(t,i,r,u,f,h,o))},SetViewMode:function(t,i){var u=this,f,e;return(u._resetErr(),u._isNoUI())?u._nouiNotSupport("SetViewMode"):n.isString(t)||n.isString(i)||t<-1&&i<-1?(n.Errors.InvalidValue(u),r):(f=Math.floor(t),e=Math.floor(i),u._ImgManager.SetViewMode(f,e),!0)},Print:function(n){var i=this,r;return(i._resetErr(),i._isNoUI())?i._nouiNotSupport("Print"):!i._isMobileMode()&&n?(r=!0,i._innerSend("PrintEx",t.makeParams(r),!0,function(){},function(){})):(i._ImgManager.Print(),!0)},ShowImageEditor:function(n,i,u,f){var e=this;return(e._resetErr(),e._isNoUI())?e._nouiNotSupport("ShowImageEditor"):!e._isMobileMode()&&t.isServerInvalid(e)?r:e._ImgManager.getWebViewer().bShowImageEdit?e.ShowImageEditorEx(-1,-1,-1,-1,3):n&&i&&u?e.ShowImageEditorEx(-1,-1,i,u,0,!0,n,f):e.ShowImageEditorEx(-1,-1,-1,-1,0,!1)},ShowImageEditorEx:function(n,t,i,r,u,f,e,o){var s=this;return(s._resetErr(),s._isNoUI())?s._nouiNotSupport("ShowImageEditorEx"):s._ImgManager.ShowImageEditorEx(n,t,i,r,u,f,e,o)},SetSelectedImageArea:function(i,r,u,f,e){var o=this,s;return(o._resetErr(),o._isNoUI())?o._nouiNotSupport("SetSelectedImageArea"):(s=parseInt(i),isNaN(s)||s<0||s>=o._ImgManager.count())?(n.Errors.IndexOutOfRange(o),!1):!o._isMobileMode()&&t.isServerInvalid(o)?!1:o._ImgManager.SetSelectedImageArea(s,r,u,f,e)},first:function(){var n=this,r=n._ImgManager.count();return(n._resetErr(),n._isNoUI())?n._nouiNotSupport("first"):(r>0&&(n._ImgManager.Go(0),t.__innerRefreshFromUIView(n,n._ImgManager.getCurrentImageIndex())),i)},previous:function(){var n=this,r=n._ImgManager.count();return(n._resetErr(),n._isNoUI())?n._nouiNotSupport("previous"):(r>0&&(n._ImgManager.__Previous(),t.__innerRefreshFromUIView(n,n._ImgManager.getCurrentImageIndex())),i)},next:function(){var n=this,r=n._ImgManager.count();return(n._resetErr(),n._isNoUI())?n._nouiNotSupport("next"):(r>0&&(n._ImgManager.__Next(),t.__innerRefreshFromUIView(n,n._ImgManager.getCurrentImageIndex())),i)},last:function(){var n=this,r=n._ImgManager.count();return(n._resetErr(),n._isNoUI())?n._nouiNotSupport("last"):(r>0&&(n._ImgManager.Go(r-1),t.__innerRefreshFromUIView(n,n._ImgManager.getCurrentImageIndex())),i)}})}}}});Dynamsoft.Ready(function(n){var u=Dynamsoft;if(n.product.bHTML5Edition){var i=n.html5.Funs,r=!1,t=i.DEF;n.attachPropertyUI=function(u){t(u,"Width",{get:function(){return(u._resetErr(),u._isNoUI())?(u._nouiNotSupport("Width"),0):u._width},set:function(t){var r=!1,f;return(u._resetErr(),u._isNoUI())?u._nouiNotSupport("Width"):(Dynamsoft.Lib.isString(t)&&t.length>0&&t.charAt(t.length-1)==="%"&&(r=t),!r&&t&&(f=parseInt(t),f>0?r=f+"px":n.Errors.MobileServer_InvalidWidth(u)),r)?(u._width=r,i.changeImageUISize(u,r,!1)):!1}});t(u,"Height",{get:function(){return(u._resetErr(),u._isNoUI())?(u._nouiNotSupport("Height"),0):u._height},set:function(t){var r=!1,f;return(u._resetErr(),u._isNoUI())?u._nouiNotSupport("Height"):(Dynamsoft.Lib.isString(t)&&t.length>0&&t.charAt(t.length-1)==="%"&&(r=t),!r&&t&&(f=parseInt(t),f>0?r=f+"px":n.Errors.MobileServer_InvalidHeight(u)),r)?(u._height=r,i.changeImageUISize(u,!1,r)):!1}});t(u,"AllowMultiSelect",{get:function(){return u._isNoUI()?u._nouiNotSupport("AllowMultiSelect"):u._ImgManager.GetAllowMultiSelect()},set:function(n){if(u._isNoUI())return u._nouiNotSupport("AllowMultiSelect");u._ImgManager.SetAllowMultiSelect(n)}});t(u,"BackgroundColor",{get:function(){return u._isNoUI()?(u._nouiNotSupport("BackgroundColor"),""):u._ImgManager.GetBackgroundColor()},set:function(n){return u._isNoUI()?u._nouiNotSupport("BackgroundColor"):u._ImgManager.SetBackgroundColor(n)}});t(u,"BackgroundFillColor",{get:function(){var t,i,r;return(u._resetErr(),u._isNoUI())?(u._nouiNotSupport("BackgroundFillColor"),""):u._isMobileMode()?(t=u.__BackgroundFillColor,n.isUndefined(t)&&(t=u._ImgManager._UIView.BackgroundColor),n.isNumber(t))?n.getColor(t):(i=parseInt(t.slice(1),16),t=i,t):(r=u._innerFun("BackgroundFillColor"),n.BGR2RGB(r))},set:function(t){if(u._isNoUI())return u._nouiNotSupport("BackgroundFillColor");var f=t*1,e;return!n.isNumber(f)||isNaN(f)?(n.Errors.InvalidValue(u),r):(u._resetErr(),u._isMobileMode())?(u.__BackgroundFillColor=n.getColor(f),!0):(e=n.RGB2BGR(f),u._innerFun("BackgroundFillColor",i.makeParams(e)))}});t(u,"FitWindowType",{get:function(){return(u._resetErr(),u._isNoUI())?(u._nouiNotSupport("FitWindowType"),0):u._ImgManager.GetFitWindowType()},set:function(n){if(u._isNoUI())return u._nouiNotSupport("FitWindowType");var t=n*1;return u._resetErr(),u._ImgManager.SetFitWindowType(t)}});t(u,"IfFitWindow",{get:function(){return(u._resetErr(),u._isNoUI())?u._nouiNotSupport("IfFitWindow"):u._ImgManager.GetIfFitWindow()},set:function(n){return(u._resetErr(),u._isNoUI())?u._nouiNotSupport("IfFitWindow"):n?u._ImgManager.SetIfFitWindow(!0):u._ImgManager.SetIfFitWindow(!1)}});t(u,"ImageMargin",{get:function(){return(u._resetErr(),u._isNoUI())?(u._nouiNotSupport("ImageMargin"),0):u._ImgManager.GetImageMargin()},set:function(n){if(u._resetErr(),u._isNoUI())return u._nouiNotSupport("ImageMargin");var t=parseInt(n);if(!isNaN(t))return u._ImgManager.SetImageMargin(t)}});t(u,"MouseX",{get:function(){return(u._resetErr(),u._isNoUI())?(u._nouiNotSupport("MouseX"),0):u.__MouseX}});t(u,"MouseY",{get:function(){return(u._resetErr(),u._isNoUI())?(u._nouiNotSupport("MouseY"),0):u.__MouseY}});t(u,"SelectionImageBorderColor",{get:function(){return(u._resetErr(),u._isNoUI())?(u._nouiNotSupport("SelectionImageBorderColor"),""):u._ImgManager.GetSelectionImageBorderColor()},set:function(n){return(u._resetErr(),u._isNoUI())?u._nouiNotSupport("SelectionImageBorderColor"):u._ImgManager.SetSelectionImageBorderColor(n)}});t(u,"Zoom",{get:function(){return(u._resetErr(),u._isNoUI())?(u._nouiNotSupport("Zoom"),0):u._ImgManager.GetZoom()},set:function(n){return(u._resetErr(),u._isNoUI())?u._nouiNotSupport("Zoom"):u._ImgManager.SetZoom(n)}});t(u,"MouseShape",{get:function(){if(u._resetErr(),u._isNoUI())return u._nouiNotSupport("MouseShape");var n=u._ImgManager.GetMouseShape();return n==EnumDWT_MouseShape.Hand},set:function(n){if(u._resetErr(),u._isNoUI())return u._nouiNotSupport("MouseShape");var t=EnumDWT_MouseShape.Crosshair;return n&&(t=EnumDWT_MouseShape.Hand),u._ImgManager.SetMouseShape(t)}});t(u,"SelectionRectAspectRatio",{get:function(){return(u._resetErr(),u._isNoUI())?(u._nouiNotSupport("SelectionRectAspectRatio"),0):u._ImgManager.GetSelectionRectAspectRatio()},set:function(n){if(u._resetErr(),u._isNoUI())return u._nouiNotSupport("SelectionRectAspectRatio");var t=parseFloat(n);return t>=0?(u._ImgManager.SetSelectionRectAspectRatio(t),!0):!1}});t(u,"ShowPageNumber",{get:function(){return(u._resetErr(),u._isNoUI())?u._nouiNotSupport("ShowPageNumber"):u._ImgManager.GetShowPageNumber()},set:function(n){return(u._resetErr(),u._isNoUI())?u._nouiNotSupport("ShowPageNumber"):u._ImgManager.SetShowPageNumber(n)}});t(u,"IfAutoScroll",{get:function(){return(u._resetErr(),u._isNoUI())?u._nouiNotSupport("IfAutoScroll"):u._ImgManager.GetIfAutoScroll()},set:function(n){return(u._resetErr(),u._isNoUI())?u._nouiNotSupport("IfAutoScroll"):u._ImgManager.SetIfAutoScroll(n)}})};n.detect.viewerScriptLoaded=!0}});